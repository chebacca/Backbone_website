# Dashboard v14 Licensing Website - Cursor Rules

## 🚨 CRITICAL ERROR PREVENTION - READ FIRST

### ** MANDATORY LLM AGENT MPC LIBRARY CONSULTATION - ALWAYS REQUIRED **

#### ** LLM AGENT MPC LIBRARY CONSULTATION REQUIREMENT (ALWAYS REQUIRED FOR ALL LLM AGENTS) **
  ```markdown
## 🤖 **LLM AGENT MPC LIBRARY CONSULTATION REQUIREMENT**

### **MANDATORY FOR ALL LLM AGENTS (Claude, ChatGPT, etc.)**

#### **1. ALWAYS CONSULT SHARED MPC LIBRARY FIRST**
- [ ] **Search shared MPC library** for relevant documentation before any code generation
- [ ] **Reference established patterns** from shared MPC library documentation
- [ ] **Follow documented architecture** and coding standards
- [ ] **Use documented API patterns** and integration methods
- [ ] **Consult feature-specific documentation** in appropriate shared MPC library folders

#### **2. SHARED MPC LIBRARY STRUCTURE (ALWAYS REFERENCE)**
  ```bash
  shared-mpc-library/                  # SHARED LOCATION FOR BOTH PROJECTS
  ├── MPC_INDEX.md                    # Complete feature overview (234+ docs)
  ├── APPLICATION_ARCHITECTURE_MPC.md  # System architecture overview
  ├── APPLICATION_COMPONENT_HIERARCHY.md # Component relationships
  ├── APPLICATION_DATA_FLOW_MPC.md     # Data flow patterns
  ├── API_INTEGRATION_MPC.md          # API structure and patterns
  ├── BACKEND_ARCHITECTURE_MPC.md     # Backend patterns and guidelines
  ├── CODING_STANDARDS_MPC.md         # Code organization and standards
  ├── authentication/                  # Complete authentication documentation
  ├── desktop/                        # 14 comprehensive Electron documentation files
  ├── sessions/                       # Session management documentation
  ├── inventory/                      # Inventory management documentation
  ├── messages/                       # Messaging system documentation
  ├── workflow/                       # Workflow system documentation
  ├── user-management/                # User management documentation
  ├── system/                         # System architecture and optimizations
  └── [feature-specific folders]/     # Feature-specific documentation
  ```

#### **3. LLM AGENT WORKFLOW REQUIREMENTS**
- [ ] **ALWAYS start with shared MPC library search** for relevant documentation
- [ ] **NEVER generate code** without consulting established patterns
- [ ] **ALWAYS reference shared MPC library** in code comments and documentation
- [ ] **ALWAYS follow documented standards** for authentication, theming, API integration
- [ ] **ALWAYS use established component patterns** from shared MPC library
- [ ] **ALWAYS validate against shared MPC library** before finalizing any implementation

#### **4. SHARED MPC LIBRARY CONSULTATION CHECKLIST**
- [ ] **Searched MPC_INDEX.md** for feature overview
- [ ] **Consulted feature-specific folder** for detailed implementation
- [ ] **Referenced established patterns** from shared MPC library
- [ ] **Followed documented coding standards** from shared MPC library
- [ ] **Used documented API patterns** from shared MPC library
- [ ] **Applied documented authentication patterns** from shared MPC library
- [ ] **Used documented theme integration patterns** from shared MPC library
- [ ] **Followed documented database patterns** from shared MPC library

### ** MANDATORY TODO LIST PROTOCOL - ALWAYS REQUIRED **

#### ** TODO LIST CREATION REQUIREMENT (ALWAYS REQUIRED FOR MULTI-STEP CHANGES) **
  ```markdown
## 📋 **TODO LIST - [FEATURE NAME]**

### **Phase 1: Analysis & Planning**
- [ ] **Search existing codebase** for similar implementations
- [ ] **Identify required files** to modify/create
- [ ] **Check shared MPC library** for relevant documentation patterns
- [ ] **Validate authentication** requirements (jwtService, auth headers)
- [ ] **Verify theme integration** requirements (useTheme, useEnhancedThemeMode)
- [ ] **Check database schema** requirements (Prisma models, migrations)
- [ ] **Identify API endpoints** needed (routes, controllers, services)
- [ ] **Verify production mode** compatibility and deployment readiness

### **Phase 2: Implementation Steps**
- [ ] **Step 1**: [Specific action with file path]
- [ ] **Step 2**: [Specific action with file path]
- [ ] **Step 3**: [Specific action with file path]
- [ ] **Step 4**: [Specific action with file path]

### **Phase 3: Validation & Testing**
- [ ] **Authentication compliance** (jwtService, auth headers)
- [ ] **Theme integration** (useTheme, theme.palette)
- [ ] **TypeScript compliance** (interfaces, no any types)
- [ ] **Error handling** (try-catch, error boundaries)
- [ ] **Linter compliance** (no unused imports, proper syntax)
- [ ] **Database validation** (migrations, relationships)
- [ ] **API validation** (endpoints, controllers, services)
- [ ] **Production deployment** readiness and environment compatibility

### **Phase 4: Documentation**
- [ ] **Update shared MPC library** with new documentation
- [ ] **Cross-reference** related documentation
- [ ] **Add usage examples** and integration patterns
- [ ] **Update component hierarchy** if applicable
- [ ] **Update API integration** docs if applicable
- [ ] **Document production** deployment requirements

### **CRITICAL COMPLIANCE CHECKLIST**
- [ ] ✅ **Authentication**: jwtService.getToken() + Authorization: Bearer
- [ ] ✅ **Theme**: useTheme() + useEnhancedThemeMode() + theme.palette
- [ ] ✅ **API**: Use unified getApiBaseUrl() utility (NOT hardcoded URLs)
- [ ] ✅ **TypeScript**: Proper interfaces, no any types
- [ ] ✅ **Error Handling**: try-catch blocks for all async operations
- [ ] ✅ **Imports**: Organized, no duplicates, no unused imports
- [ ] ✅ **ES Modules**: Named exports, no CommonJS syntax
- [ ] ✅ **Database**: Prisma models with id, createdAt, updatedAt
- [ ] ✅ **Linter**: No errors, proper syntax, consistent formatting
- [ ] ✅ **Production**: Environment variables, secure configurations, deployment ready
```

#### ** TODO LIST ENFORCEMENT RULES **
  - **ALWAYS create TODO list** before any multi-step implementation
  - **ALWAYS check off items** as they are completed
  - **ALWAYS validate** each step against compliance checklist
  - **ALWAYS update TODO list** if new steps are discovered
  - **NEVER skip TODO list** for complex changes
  - **NEVER proceed** without completing previous steps
  - **ALWAYS reference TODO list** during implementation
  - **ALWAYS validate final result** against TODO checklist

---

## 🏗️ PROJECT ARCHITECTURE

This is the Dashboard v14 Licensing Website, a production-ready licensing management system that shares the MPC Library with the main Dashboard-v14_2 project.

### 📚 PRIMARY DOCUMENTATION SOURCE
  ** ALWAYS refer to the shared MPC Library first:** `../shared-mpc-library/`
    - ** Main Index **: `../shared-mpc-library/MPC_INDEX.md` - Complete feature overview with 234+ documentation files
      - ** Application Architecture **: `../shared-mpc-library/APPLICATION_ARCHITECTURE_MPC.md` - System architecture overview
        - ** Component Hierarchy **: `../shared-mpc-library/APPLICATION_COMPONENT_HIERARCHY.md` - Component relationships
          - ** Data Flow **: `../shared-mpc-library/APPLICATION_DATA_FLOW_MPC.md` - Data flow patterns
            - ** API Integration **: `../shared-mpc-library/API_INTEGRATION_MPC.md` - API structure and patterns
              - ** Backend Architecture **: `../shared-mpc-library/BACKEND_ARCHITECTURE_MPC.md` - Backend patterns and guidelines
                - ** Coding Standards **: `../shared-mpc-library/CODING_STANDARDS_MPC.md` - Code organization and standards

### 🌐 **PORT CONFIGURATION**
- **Frontend Port**: `3000` (React production server)
- **Backend Port**: `3001` (Express API server)
- **Database**: PostgreSQL (default port 5432)

**⚠️ CRITICAL**: Always use the correct ports when coding:
- Frontend API calls: `http://localhost:3001/api/*`
- Frontend production: `http://localhost:3000`
- Backend server: `http://localhost:3001`

---

## 🔐 AUTHENTICATION SYSTEM

### Default Test Credentials
  ```bash
# Primary Admin Account - USE FOR ALL PRODUCTION & TESTING
Email: chebacca@gmail.com
Password: admin1234
Role: ADMIN (Full system access)

# Default curl command for getting auth token:
export AUTH_TOKEN=$(curl -s -X POST http://localhost:3001/api/auth/login \
  -H "Content-Type: application/json" \
  -d '{"email":"chebacca@gmail.com","password":"admin1234"}' | \
  jq -r '.token')

# Use token in API calls:
curl -H "Authorization: Bearer $AUTH_TOKEN" http://localhost:3001/api/sessions
```

---

## 🚨 **MANDATORY PATTERNS TO PREVENT LINTER ERRORS**

#### ** 1. Authentication Pattern(ALWAYS REQUIRED) **
  ```typescript
// ✅ CORRECT - Always use this exact pattern
import { jwtService } from './jwtService';
import { getApiBaseUrl } from '../utils/apiUrl';

const apiClient = axios.create({
  baseURL: getApiBaseUrl(), // Use unified base URL utility
  withCredentials: true,
  headers: { 'Content-Type': 'application/json' }
});

apiClient.interceptors.request.use((config) => {
  const token = jwtService.getToken();
  if (token) {
    config.headers.Authorization = `Bearer ${ token } `;
  }
  return config;
});

// ❌ NEVER create API calls without authentication
// ❌ NEVER hardcode base URLs - always use getApiBaseUrl()
```

#### ** 2. Theme Integration Pattern(ALWAYS REQUIRED) **
  ```typescript
// ✅ CORRECT - Always use this exact pattern
import { useTheme } from '@mui/material/styles';
import { useEnhancedThemeMode } from '@dashboard/ui/theme/EnhancedThemeProvider';

const MyComponent: React.FC = () => {
  const theme = useTheme(); // Gets enhanced theme automatically
  const { mode, customizations, updateCustomizations } = useEnhancedThemeMode();
  
  return (
    <Card sx={{ 
      backgroundColor: theme.palette.background.paper,
      borderRadius: theme.shape.borderRadius,
      padding: theme.spacing(2),
      margin: theme.spacing(1),
      boxShadow: theme.shadows[customizations.card?.shadowIntensity || 'medium'],
      '&:hover': customizations.card?.hoverEffect === 'lift' ? {
        transform: 'translateY(-2px)',
        boxShadow: theme.shadows[8]
      } : {}
    }}>
      <Typography variant="h6" sx={{ 
        fontWeight: theme.typography.h6.fontWeight,
        color: theme.palette.text.primary
      }}>
        Theme-aware content
      </Typography>
    </Card>
  );
};

// ❌ NEVER use hardcoded styles like: backgroundColor: '#ffffff'
```

#### ** 3. TypeScript Interface Pattern(ALWAYS REQUIRED) **
  ```typescript
// ✅ CORRECT - Always define proper interfaces
interface ComponentProps {
  id: string;
  name: string;
  children?: React.ReactNode;
}

export const Component: React.FC<ComponentProps> = ({ id, name, children }) => {
  // Component implementation
};

// ❌ NEVER use 'any' type or skip interfaces
```

#### ** 4. Error Handling Pattern(ALWAYS REQUIRED) **
  ```typescript
// ✅ CORRECT - Always wrap async operations
const fetchData = async (): Promise<DataType> => {
  try {
    const response = await apiClient.get('/endpoint');
    return response.data;
  } catch (error) {
    console.error('Error fetching data:', error);
    throw error;
  }
};

// ❌ NEVER create async functions without try-catch
```

---

## 🔥 ENHANCED ERROR PREVENTION GUIDELINES

### **COMMON LINTER ERROR FIXES**

#### **1. Unused Import Errors**
```typescript
// ❌ WRONG - Will cause linter error
import React, { useState, useEffect } from 'react'; // useEffect not used
import { Box, Typography, Card } from '@mui/material'; // Card not used

// ✅ CORRECT - Only import what you use
import React, { useState } from 'react';
import { Box, Typography } from '@mui/material';
```

#### **2. Missing Return Type Errors**
```typescript
// ❌ WRONG - Will cause linter error
const fetchUser = async (id: string) => {
  return await userService.getUser(id);
};

// ✅ CORRECT - Always include return types
const fetchUser = async (id: string): Promise<User> => {
  return await userService.getUser(id);
};
```

#### **3. TypeScript 'any' Type Errors**
```typescript
// ❌ WRONG - Will cause linter error
const handleData = (data: any) => {
  return data.someProperty;
};

// ✅ CORRECT - Use proper interfaces
interface ApiResponse {
  someProperty: string;
}

const handleData = (data: ApiResponse): string => {
  return data.someProperty;
};
```

---

## 📋 DOCUMENTATION ORGANIZATION RULES

### 🗂️ Automatic .md File Placement in Shared MPC Library

**ALL .md files MUST be placed in the appropriate shared MPC library folder based on their content and purpose:**

#### **LLM AGENT DOCUMENTATION REQUIREMENTS (ALWAYS REQUIRED)**
- [ ] **ALWAYS consult shared MPC library** before creating new documentation
- [ ] **ALWAYS place new .md files** in appropriate shared MPC library folders
- [ ] **ALWAYS reference existing documentation** from shared MPC library
- [ ] **ALWAYS follow established documentation patterns** from shared MPC library
- [ ] **ALWAYS update MPC_INDEX.md** when adding new documentation
- [ ] **ALWAYS cross-reference related documentation** within shared MPC library

---

## 🚨 **DUPLICATE CODE PREVENTION - CRITICAL**

### **MANDATORY DUPLICATE PREVENTION PROTOCOLS**

#### **1. Code Search Protocol (ALWAYS REQUIRED BEFORE CREATING)**
  ```typescript
// ✅ CORRECT - Always search before creating new code
// Step 1: Use codebase_search for semantic understanding
// Step 2: Use grep_search for exact pattern matching  
// Step 3: Use file_search for specific file locations
// Step 4: Check shared MPC library documentation (REQUIRED FOR LLM AGENTS)
// Step 5: Extend existing code instead of duplicating

// ❌ NEVER create new code without searching first
// ❌ NEVER generate code without consulting shared MPC library (LLM AGENTS)
```

---

## 🎯 **MODE AWARENESS SYSTEM - CRITICAL IMPLEMENTATION**

### ⚠️ **MANDATORY MODE AWARENESS INTEGRATION**

**This licensing website implements Mode Awareness System that supports dual-mode operation:**
- **🖥️ Standalone Mode**: Desktop-like experience with local projects and offline capability
- **🌐 Network Mode**: Collaborative experience with real-time features and team workspaces

---

## 🎨 ENHANCED THEME PROVIDER SYSTEM

### ⚠️ CRITICAL CODING RULE: Always Use Theme-Aware Styling

**EVERY COMPONENT MUST USE ENHANCED THEME PROVIDER** patterns for consistent design across the application.

---

## 🔧 API SERVICE AUTHENTICATION REQUIREMENTS

### ⚠️ CRITICAL CODING RULE: API Service Authentication

**ALWAYS ASSUME API ENDPOINTS REQUIRE AUTHENTICATION** unless explicitly documented as public.

---

## 📊 **DEVELOPMENT ANALYTICS AND INSIGHTS**

### **Code Quality Metrics**
```typescript
// AI Assistant should track and report:
const codeQualityMetrics = {
  // Documentation quality
  documentationQuality: {
    completeness: 'Percentage of documented components',
    accuracy: 'Code-documentation consistency',
    freshness: 'Documentation age vs code changes'
  },

  // Code quality
  codeQuality: {
    complexity: 'Cyclomatic complexity analysis',
    duplication: 'Code duplication detection',
    maintainability: 'Maintainability index calculation'
  },

  // Performance metrics
  performanceMetrics: {
    bundleSize: 'JavaScript bundle size analysis',
    renderPerformance: 'Component render performance',
    apiPerformance: 'API response time analysis'
  }
};
```

---

**ENHANCED REMINDER**: The AI Assistant should now provide intelligent, context-aware assistance that goes beyond basic code generation to include pattern recognition, quality assurance, performance optimization, and continuous improvement suggestions.

**CRITICAL**: Always consult the shared MPC library (`../shared-mpc-library/`) before any code generation or documentation creation. This ensures consistency across both projects and prevents duplication of effort.
