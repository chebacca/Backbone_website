import{j as t,B as u,T as r,c as d,r as f,a as g,w as S,x as j,z as x,D as w}from"./mui-CbJLuC6G.js";import{r as n,b as P}from"./vendor-CjD1bmmO.js";import{i as T,c as b,o as O,s as $}from"./CloudProjectIntegration-BddzAYxW.js";import"./index-BgQ_svsr.js";import"./stripe-iaBWsbMy.js";const N=()=>{const[l,y]=n.useState(T()),[m,v]=n.useState([]),[h,E]=n.useState([]),[i,o]=n.useState(!1),[p,s]=n.useState("");n.useEffect(()=>{const e=()=>y(!0),a=()=>y(!1);return window.addEventListener("online",e),window.addEventListener("offline",a),()=>{window.removeEventListener("online",e),window.removeEventListener("offline",a)}},[]);const c=async()=>{o(!0);try{const e=await b.getUserProjects();v(e);const a=await O.getOfflineProjects();E(a)}catch(e){console.error("Failed to load projects:",e),s(`Error: ${e instanceof Error?e.message:String(e)}`)}finally{o(!1)}},C=async()=>{o(!0);try{const e=`Test Project ${new Date().toLocaleTimeString()}`;s(`Creating project: ${e}...`);const a=await b.createCloudProject({name:e,description:"Test project for offline creation",storageMode:"cloud",cloudConfig:{provider:"firestore"},collaborationSettings:{maxCollaborators:5,enableRealTime:!0,enableComments:!0,enableFileSharing:!0}});s(`Project created with ID: ${a}`),await c()}catch(e){console.error("Failed to create project:",e),s(`Error: ${e instanceof Error?e.message:String(e)}`)}finally{o(!1)}},L=async()=>{o(!0);try{s("Syncing...");const e=await $.forceSyncNow();s(`Sync ${e?"succeeded":"failed"}`),await c()}catch(e){console.error("Failed to sync:",e),s(`Error: ${e instanceof Error?e.message:String(e)}`)}finally{o(!1)}};return n.useEffect(()=>{c()},[]),t.jsxs(u,{sx:{p:3,maxWidth:800,mx:"auto"},children:[t.jsx(r,{variant:"h4",gutterBottom:!0,children:"Offline Project Creation Test"}),t.jsxs(d,{sx:{p:2,mb:3},children:[t.jsx(r,{variant:"h6",gutterBottom:!0,children:"Network Status"}),t.jsxs(u,{display:"flex",alignItems:"center",mb:2,children:[t.jsx(f,{label:l?"Online":"Offline",color:l?"success":"error",sx:{mr:2}}),t.jsx(r,{children:l?"You are online. Projects will be created in Firestore.":"You are offline. Projects will be created locally."})]}),t.jsxs(u,{display:"flex",gap:2,children:[t.jsx(g,{variant:"contained",onClick:C,disabled:i,children:"Create Test Project"}),t.jsx(g,{variant:"outlined",onClick:L,disabled:i||!l,children:"Force Sync"}),t.jsx(g,{variant:"outlined",onClick:c,disabled:i,children:"Refresh"})]})]}),p&&t.jsx(d,{sx:{p:2,mb:3,bgcolor:"info.light",color:"info.contrastText"},children:t.jsx(r,{children:p})}),t.jsxs(d,{sx:{p:2,mb:3},children:[t.jsxs(r,{variant:"h6",gutterBottom:!0,children:["All Projects (",m.length,")"]}),i?t.jsx(r,{children:"Loading..."}):t.jsx(S,{children:m.length===0?t.jsx(j,{children:t.jsx(x,{primary:"No projects found"})}):m.map(e=>t.jsxs(P.Fragment,{children:[t.jsxs(j,{children:[t.jsx(x,{primary:e.name,secondary:`ID: ${e.id} | Created: ${new Date(e.createdAt).toLocaleString()}`}),e.id.startsWith("offline_")&&t.jsx(f,{label:"Offline",color:"warning",size:"small",sx:{mr:1}}),e.pendingSync&&t.jsx(f,{label:"Pending Sync",color:"info",size:"small"})]}),t.jsx(w,{})]},e.id))})]}),t.jsxs(d,{sx:{p:2},children:[t.jsxs(r,{variant:"h6",gutterBottom:!0,children:["Offline Projects (",h.length,")"]}),i?t.jsx(r,{children:"Loading..."}):t.jsx(S,{children:h.length===0?t.jsx(j,{children:t.jsx(x,{primary:"No offline projects found"})}):h.map(e=>t.jsxs(P.Fragment,{children:[t.jsxs(j,{children:[t.jsx(x,{primary:e.name,secondary:`ID: ${e.id} | Created: ${new Date(e.createdAt).toLocaleString()}`}),e.pendingSync&&t.jsx(f,{label:"Pending Sync",color:"info",size:"small"})]}),t.jsx(w,{})]},e.id))})]})]})};export{N as default};
