import{j as e,a as E,T as u,t as J,b9 as He,ba as D,c as T,G as m,S as V,u as b,bW as ze,bX as O,aR as Be,aS as Je,aT as Ve,a4 as re,aU as W,d as y,R as Ke,aq as ce,bY as de,bZ as Ge,b_ as Qe,D as M,b$ as Xe,c0 as qe,c1 as Ze,c2 as et,aC as U,aD as N,aE as S,aF as n,aG as F,h as tt,aB as at}from"./mui-DpsxcHA8.js";import{r as p}from"./vendor-DIxetjBo.js";import{c as v,e as k}from"./index-C1W8Si7L.js";import"./stripe-GgbZzTKy.js";const lt=()=>{var X,q,Z,ee,te;const[he,xe]=p.useState([]),[H,me]=p.useState(""),[z,ue]=p.useState(""),[I,ge]=p.useState(0),[g,pe]=p.useState(null),[d,K]=p.useState(null),[je,be]=p.useState([]),[ye,Se]=p.useState([]),[B,fe]=p.useState(0),[C,L]=p.useState(""),[w,_]=p.useState(""),[$,Te]=p.useState("US_SALES_TAX"),[o,f]=p.useState({legalName:"",taxId:"",addressLine1:"",addressLine2:"",city:"",region:"",postalCode:"",country:"US",contactEmail:""}),[ve,Ce]=p.useState([]),[P,we]=p.useState("NY"),[G,$e]=p.useState("US"),[Le,_e]=p.useState(null),Y=[{code:"AL",name:"Alabama"},{code:"AK",name:"Alaska"},{code:"AZ",name:"Arizona"},{code:"AR",name:"Arkansas"},{code:"CA",name:"California",portal:"https://onlineservices.cdtfa.ca.gov"},{code:"CO",name:"Colorado"},{code:"CT",name:"Connecticut"},{code:"DE",name:"Delaware"},{code:"FL",name:"Florida",portal:"https://floridarevenue.com/taxes/Pages/return_drt.aspx"},{code:"GA",name:"Georgia"},{code:"HI",name:"Hawaii"},{code:"ID",name:"Idaho"},{code:"IL",name:"Illinois"},{code:"IN",name:"Indiana"},{code:"IA",name:"Iowa"},{code:"KS",name:"Kansas"},{code:"KY",name:"Kentucky"},{code:"LA",name:"Louisiana"},{code:"ME",name:"Maine"},{code:"MD",name:"Maryland"},{code:"MA",name:"Massachusetts"},{code:"MI",name:"Michigan"},{code:"MN",name:"Minnesota"},{code:"MS",name:"Mississippi"},{code:"MO",name:"Missouri"},{code:"MT",name:"Montana"},{code:"NE",name:"Nebraska"},{code:"NV",name:"Nevada"},{code:"NH",name:"New Hampshire"},{code:"NJ",name:"New Jersey"},{code:"NM",name:"New Mexico"},{code:"NY",name:"New York",portal:"https://www.tax.ny.gov/online/"},{code:"NC",name:"North Carolina"},{code:"ND",name:"North Dakota"},{code:"OH",name:"Ohio"},{code:"OK",name:"Oklahoma"},{code:"OR",name:"Oregon"},{code:"PA",name:"Pennsylvania"},{code:"RI",name:"Rhode Island"},{code:"SC",name:"South Carolina"},{code:"SD",name:"South Dakota"},{code:"TN",name:"Tennessee"},{code:"TX",name:"Texas",portal:"https://comptroller.texas.gov/taxes/file-pay/"},{code:"UT",name:"Utah"},{code:"VT",name:"Vermont"},{code:"VA",name:"Virginia"},{code:"WA",name:"Washington",portal:"https://secure.dor.wa.gov/"},{code:"WV",name:"West Virginia"},{code:"WI",name:"Wisconsin"},{code:"WY",name:"Wyoming"},{code:"DC",name:"District of Columbia"}];p.useEffect(()=>{try{const r=localStorage.getItem("filing_company_default");r&&f(JSON.parse(r))}catch{}const t=new Date,a=new Date(t.getFullYear(),t.getMonth()-1,1),l=new Date(t.getFullYear(),t.getMonth(),0),c=r=>`${r.getFullYear()}-${String(r.getMonth()+1).padStart(2,"0")}-${String(r.getDate()).padStart(2,"0")}`;L(c(a)),_(c(l))},[]);const Ae=t=>{const a=new Date,l=i=>`${i.getFullYear()}-${String(i.getMonth()+1).padStart(2,"0")}-${String(i.getDate()).padStart(2,"0")}`,c=(i,s)=>new Date(i,s,1),r=(i,s)=>new Date(i,s+1,0),x=(i,s)=>new Date(i,s*3,1),h=(i,s)=>new Date(i,s*3+3,0);if(t==="THIS_MONTH"){const i=c(a.getFullYear(),a.getMonth()),s=r(a.getFullYear(),a.getMonth());L(l(i)),_(l(s));return}if(t==="LAST_MONTH"){const i=c(a.getFullYear(),a.getMonth()-1),s=r(a.getFullYear(),a.getMonth()-1);L(l(i)),_(l(s));return}if(t==="THIS_QUARTER"){const i=Math.floor(a.getMonth()/3),s=x(a.getFullYear(),i),j=h(a.getFullYear(),i);L(l(s)),_(l(j));return}if(t==="LAST_QUARTER"){let i=Math.floor(a.getMonth()/3)-1,s=a.getFullYear();i<0&&(i=3,s-=1);const j=x(s,i),A=h(s,i);L(l(j)),_(l(A));return}if(t==="YTD"){const i=new Date(a.getFullYear(),0,1),s=a;L(l(i)),_(l(s));return}if(t==="LAST_YEAR"){const i=a.getFullYear()-1,s=new Date(i,0,1),j=new Date(i,11,31);L(l(s)),_(l(j));return}},Ie=async()=>{try{localStorage.setItem("filing_company_default",JSON.stringify(o))}catch{}try{await v.post(k.admin.companyFilingSave(),o)}catch{}},Ee=()=>{try{const t=localStorage.getItem("filing_company_default");t&&f(JSON.parse(t))}catch{}},Q=async()=>{var a,l;const t=await v.get(k.accounting.payments(),{params:{limit:50}});xe(((l=(a=t.data)==null?void 0:a.data)==null?void 0:l.payments)||[])};p.useEffect(()=>{(async()=>{var h,i,s,j,A,R,ae,ne,se,ie;Q();const[a,l,c,r]=await Promise.all([v.get("accounting/overview"),v.get("accounting/tax/summary"),v.get("accounting/kyc"),v.get("accounting/compliance-events")]);pe(((h=a.data)==null?void 0:h.data)||null),K(((i=l.data)==null?void 0:i.data)||null),be(((j=(s=c.data)==null?void 0:s.data)==null?void 0:j.users)||[]),Se(((R=(A=r.data)==null?void 0:A.data)==null?void 0:R.events)||[]);const x=(((ne=(ae=c.data)==null?void 0:ae.data)==null?void 0:ne.users)||[]).filter(oe=>String(oe.kycStatus||"").toUpperCase()!=="COMPLETED").length;fe(x);try{const le=(ie=(se=(await v.get(k.admin.companyFilingGet())).data)==null?void 0:se.data)==null?void 0:ie.company;le&&f(We=>({...We,...le}))}catch{}})()},[]);const Re=async()=>{var s,j;const t={from:H,to:z,includePII:!1},l=((j=(s=(await v.post(k.accounting.exportPayments(),t)).data)==null?void 0:s.data)==null?void 0:j.rows)||[],r=[Object.keys(l[0]||{}).join(","),...l.map(A=>Object.values(A).map(R=>JSON.stringify(R??"")).join(","))].join(`
`),x=new Blob([r],{type:"text/csv"}),h=URL.createObjectURL(x),i=document.createElement("a");i.href=h,i.download=`payments_${H||"all"}_${z||"all"}.csv`,i.click(),URL.revokeObjectURL(h)},De=async()=>{var s,j;const t={from:C,to:w,includePII:!1},l=((j=(s=(await v.post(k.accounting.exportPayments(),t)).data)==null?void 0:s.data)==null?void 0:j.rows)||[],r=[Object.keys(l[0]||{}).join(","),...l.map(A=>Object.values(A).map(R=>JSON.stringify(R??"")).join(","))].join(`
`),x=new Blob([r],{type:"text/csv"}),h=URL.createObjectURL(x),i=document.createElement("a");i.href=h,i.download=`payments_${C||"all"}_${w||"all"}.csv`,i.click(),URL.revokeObjectURL(h)},Oe=async()=>{var l,c,r;const t=await v.get("accounting/tax/summary",{params:{from:C||void 0,to:w||void 0}});K(((l=t.data)==null?void 0:l.data)||null);const a=await v.get(k.accounting.payments(),{params:{from:C||void 0,to:w||void 0,limit:500}});Ce(((r=(c=a.data)==null?void 0:c.data)==null?void 0:r.payments)||[])},Me=()=>{if(!d)return;const t=[];if($==="US_SALES_TAX"){const h=(d==null?void 0:d.byJurisdiction)||{};for(const[i,s]of Object.entries(h))t.push({jurisdiction:i,tax_cents:s.tax_cents??0,taxable_cents:s.taxable_cents??0,count:s.count??0})}else{const h=(d==null?void 0:d.byCountry)||{};for(const[i,s]of Object.entries(h))t.push({country:i,tax_cents:s.tax_cents??0,taxable_cents:s.taxable_cents??0,count:s.count??0})}const l=[Object.keys(t[0]||{}).join(","),...t.map(h=>Object.values(h).map(i=>JSON.stringify(i??"")).join(","))].join(`
`),c=new Blob([l],{type:"text/csv"}),r=URL.createObjectURL(c),x=document.createElement("a");x.href=r,x.download=`filing_summary_${$}_${C||"all"}_${w||"all"}.csv`,x.click(),URL.revokeObjectURL(r)},Ue=()=>{const t=window.open("","PRINT","height=800,width=800");if(!t)return;const a=`${C||"Start"} to ${w||"End"}`,l=$==="US_SALES_TAX"?(d==null?void 0:d.byJurisdiction)||{}:(d==null?void 0:d.byCountry)||{},c=Object.values(l).reduce((x,h)=>({tax:x.tax+((h==null?void 0:h.tax_cents)||0),taxable:x.taxable+((h==null?void 0:h.taxable_cents)||0),count:x.count+((h==null?void 0:h.count)||0)}),{tax:0,taxable:0,count:0}),r=`<!doctype html><html><head><meta charset="utf-8"><title>Filing Cover Sheet</title>
      <style>body{font-family: -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; padding:24px;} h1,h2{margin:0 0 8px;} table{border-collapse: collapse; width:100%; margin-top:16px;} th,td{border:1px solid #ccc; padding:8px; text-align:left;} small{color:#666}</style>
    </head><body>
      <h1>Tax Filing Cover Sheet</h1>
      <small>Generated by Accounting Dashboard</small>
      <h2>Company</h2>
      <div>${o.legalName||"-"}</div>
      <div>${o.addressLine1||""} ${o.addressLine2||""}</div>
      <div>${o.city||""} ${o.region||""} ${o.postalCode||""} ${o.country||""}</div>
      <div>Tax ID: ${o.taxId||"-"}</div>
      <div>Contact: ${o.contactEmail||"-"}</div>
      <h2>Filing</h2>
      <div>Scheme: ${$}</div>
      <div>Period: ${a}</div>
      <table>
        <tr><th>Total Taxable</th><th>Total Tax</th><th>Transactions</th></tr>
        <tr><td>${(c.taxable/100).toLocaleString()}</td><td>${(c.tax/100).toLocaleString()}</td><td>${c.count}</td></tr>
      </table>
      <p style="margin-top:16px">Attach the jurisdiction/member-state summary CSV and payments CSV for the filing period when submitting via your tax portal or provider.</p>
      <script>window.onload=function(){window.print(); setTimeout(()=>window.close(), 300);}<\/script>
    </body></html>`;t.document.write(r),t.document.close(),t.focus()},Ne={AT:"Austria",BE:"Belgium",BG:"Bulgaria",HR:"Croatia",CY:"Cyprus",CZ:"Czechia",DK:"Denmark",EE:"Estonia",FI:"Finland",FR:"France",DE:"Germany",GR:"Greece",HU:"Hungary",IE:"Ireland",IT:"Italy",LV:"Latvia",LT:"Lithuania",LU:"Luxembourg",MT:"Malta",NL:"Netherlands",PL:"Poland",PT:"Portugal",RO:"Romania",SK:"Slovakia",SI:"Slovenia",ES:"Spain",SE:"Sweden"},Fe=()=>{if(!d)return;const t=window.open("","PRINT","height=900,width=1000");if(!t)return;const a=`${C||"Start"} to ${w||"End"}`,l=$==="US_SALES_TAX"?(d==null?void 0:d.byJurisdiction)||{}:(d==null?void 0:d.byCountry)||{},c=Object.entries(l).map(([i,s])=>`<tr><td>${$==="EU_OSS"?`${Ne[i]||i} (${i})`:i}</td><td>${(((s==null?void 0:s.taxable_cents)||0)/100).toLocaleString()}</td><td>${(((s==null?void 0:s.tax_cents)||0)/100).toLocaleString()}</td><td>${(s==null?void 0:s.count)||0}</td></tr>`).join(""),r=Object.values(l).reduce((i,s)=>({tax:i.tax+((s==null?void 0:s.tax_cents)||0),taxable:i.taxable+((s==null?void 0:s.taxable_cents)||0),count:i.count+((s==null?void 0:s.count)||0)}),{tax:0,taxable:0,count:0}),x=$==="US_SALES_TAX"?"Jurisdiction":"Member State",h=`<!doctype html><html><head><meta charset="utf-8"><title>Filing Worksheet</title>
      <style>body{font-family: -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; padding:24px;} h1,h2{margin:0 0 8px;} table{border-collapse: collapse; width:100%; margin-top:16px;} th,td{border:1px solid #ccc; padding:8px; text-align:left;} small{color:#666} tfoot td{font-weight:600}</style>
    </head><body>
      <h1>Filing Worksheet</h1>
      <small>Generated by Accounting Dashboard</small>
      <h2>Company</h2>
      <div>${o.legalName||"-"}</div>
      <div>${o.addressLine1||""} ${o.addressLine2||""}</div>
      <div>${o.city||""} ${o.region||""} ${o.postalCode||""} ${o.country||""}</div>
      <div>Tax ID: ${o.taxId||"-"}</div>
      <div>Contact: ${o.contactEmail||"-"}</div>
      <h2>Period: ${a} — Scheme: ${$}</h2>
      <table>
        <thead><tr><th>${x}</th><th>Taxable</th><th>Tax</th><th>Count</th></tr></thead>
        <tbody>${c}</tbody>
        <tfoot><tr><td>Total</td><td>${(r.taxable/100).toLocaleString()}</td><td>${(r.tax/100).toLocaleString()}</td><td>${r.count}</td></tr></tfoot>
      </table>
      <p style="margin-top:16px">Use this worksheet to transcribe totals into your state portal (e-file) or retain for records.</p>
      <script>window.onload=function(){window.print(); setTimeout(()=>window.close(), 300);}<\/script>
    </body></html>`;t.document.write(h),t.document.close(),t.focus()},ke=()=>{var a;const t={};for(const l of ve){if(String(l.status).toUpperCase()!=="SUCCEEDED")continue;const c=((a=l.billingAddress)==null?void 0:a.state)||"UNKNOWN",r=l.taxAmount??0,x=(l.amount??0)-r;t[c]=t[c]||{taxable_cents:0,tax_cents:0,count:0},t[c].taxable_cents+=x,t[c].tax_cents+=r,t[c].count+=1}return t},Ye=t=>{const l=ke()[t]||{taxable_cents:0,tax_cents:0,count:0},c=`${C||"Start"} to ${w||"End"}`,r=Y.find(i=>i.code===t),x=window.open("","PRINT","height=900,width=1000");if(!x)return;const h=`<!doctype html><html><head><meta charset="utf-8"><title>${t} Sales Tax Worksheet</title>
      <style>body{font-family:-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;padding:24px;} h1{margin:0 0 8px} table{border-collapse:collapse;width:100%;margin-top:16px;} th,td{border:1px solid #ccc;padding:8px;text-align:left;} small{color:#666}</style>
    </head><body>
      <h1>${(r==null?void 0:r.name)||t} Sales and Use Tax Return (Worksheet)</h1>
      <small>For reference only. Most states require e-filing via their tax portal.</small>
      <h2>Company</h2>
      <div>${o.legalName||"-"}</div>
      <div>${o.addressLine1||""} ${o.addressLine2||""}</div>
      <div>${o.city||""} ${o.region||""} ${o.postalCode||""} ${o.country||""}</div>
      <div>Tax ID: ${o.taxId||"-"}</div>
      <div>Contact: ${o.contactEmail||"-"}</div>
      <h2>Period: ${c}</h2>
      <table>
        <tr><th>Taxable sales (${t})</th><td>${(l.taxable_cents/100).toLocaleString()}</td></tr>
        <tr><th>Sales and use tax due (${t})</th><td>${(l.tax_cents/100).toLocaleString()}</td></tr>
        <tr><th>Transactions</th><td>${l.count}</td></tr>
      </table>
      ${r!=null&&r.portal?`<p style="margin-top:16px">Portal: <a href="${r.portal}" target="_blank" rel="noreferrer">${r.portal}</a></p>`:""}
      <script>window.onload=function(){window.print(); setTimeout(()=>window.close(), 300);}<\/script>
    </body></html>`;x.document.write(h),x.document.close(),x.focus()},Pe=t=>{const a=`${C||"Start"} to ${w||"End"}`,c=((d==null?void 0:d.byCountry)||{})[t]||{tax_cents:0,taxable_cents:0,count:0},r=window.open("","PRINT","height=900,width=1000");if(!r)return;const x=`<!doctype html><html><head><meta charset="utf-8"><title>${t} VAT/Sales Worksheet</title>
      <style>body{font-family:-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;padding:24px;} h1{margin:0 0 8px} table{border-collapse:collapse;width:100%;margin-top:16px;} th,td{border:1px solid #ccc;padding:8px;text-align:left;} small{color:#666}</style>
    </head><body>
      <h1>${t} Indirect Tax Worksheet</h1>
      <small>For reference only. File via your national portal (e.g., EU OSS, CRA GST/HST).</small>
      <h2>Company</h2>
      <div>${o.legalName||"-"}</div>
      <div>${o.addressLine1||""} ${o.addressLine2||""}</div>
      <div>${o.city||""} ${o.region||""} ${o.postalCode||""} ${o.country||""}</div>
      <div>Tax ID: ${o.taxId||"-"}</div>
      <div>Contact: ${o.contactEmail||"-"}</div>
      <h2>Period: ${a}</h2>
      <table>
        <tr><th>Taxable amount (${t})</th><td>${(c.taxable_cents/100).toLocaleString()}</td></tr>
        <tr><th>Tax due (${t})</th><td>${(c.tax_cents/100).toLocaleString()}</td></tr>
        <tr><th>Transactions</th><td>${c.count||0}</td></tr>
      </table>
      <script>window.onload=function(){window.print(); setTimeout(()=>window.close(), 300);}<\/script>
    </body></html>`;r.document.write(x),r.document.close(),r.focus()};return e.jsxs(E,{sx:{p:3},children:[e.jsx(u,{variant:"h4",fontWeight:700,gutterBottom:!0,children:"Accounting & Compliance"}),e.jsx(u,{variant:"body2",color:"text.secondary",gutterBottom:!0,children:"Financial reporting, tax, KYC/AML, and regulatory oversight snapshot."}),B>0&&e.jsxs(J,{severity:"warning",sx:{mb:2},children:[B," user",B===1?"":"s"," require KYC verification. Review the KYC tab for details."]}),e.jsxs(He,{value:I,onChange:(t,a)=>ge(a),sx:{mb:2},children:[e.jsx(D,{label:"Overview"}),e.jsx(D,{label:"Payments"}),e.jsx(D,{label:"Tax"}),e.jsx(D,{label:"Filings"}),e.jsx(D,{label:"KYC"}),e.jsx(D,{label:"Compliance"})]}),I===3&&e.jsx(E,{children:e.jsxs(T,{sx:{p:2},children:[e.jsx(u,{variant:"subtitle1",gutterBottom:!0,children:"Filing Packet"}),e.jsxs(m,{container:!0,spacing:2,children:[e.jsxs(m,{item:!0,xs:12,md:6,children:[e.jsx(u,{variant:"overline",children:"Filing Period"}),e.jsxs(V,{direction:{xs:"column",sm:"row"},spacing:2,sx:{mb:2},children:[e.jsx(b,{label:"From (YYYY-MM-DD)",placeholder:"2025-01-01",value:C,onChange:t=>L(t.target.value),size:"small"}),e.jsx(b,{label:"To (YYYY-MM-DD)",placeholder:"2025-12-31",value:w,onChange:t=>_(t.target.value),size:"small"})]}),e.jsxs(ze,{exclusive:!0,size:"small",value:Le,onChange:(t,a)=>{if(_e(a),!a)return;Ae({THIS_MONTH:"THIS_MONTH",LAST_MONTH:"LAST_MONTH",THIS_QUARTER:"THIS_QUARTER",LAST_QUARTER:"LAST_QUARTER",YTD:"YTD",LAST_YEAR:"LAST_YEAR"}[a])},sx:{mb:2,flexWrap:"wrap"},children:[e.jsx(O,{value:"THIS_MONTH",children:"This Month"}),e.jsx(O,{value:"LAST_MONTH",children:"Last Month"}),e.jsx(O,{value:"THIS_QUARTER",children:"This Quarter"}),e.jsx(O,{value:"LAST_QUARTER",children:"Last Quarter"}),e.jsx(O,{value:"YTD",children:"YTD"}),e.jsx(O,{value:"LAST_YEAR",children:"Last Year"})]}),e.jsxs(Be,{size:"small",sx:{minWidth:240},children:[e.jsx(Je,{id:"scheme-label",children:"Scheme"}),e.jsxs(Ve,{labelId:"scheme-label",id:"scheme",value:$,label:"Scheme",onChange:t=>Te(t.target.value),children:[e.jsx(re,{value:"US_SALES_TAX",children:"US Sales Tax (state/county)"}),e.jsx(re,{value:"EU_OSS",children:"EU OSS VAT (member state)"})]})]}),e.jsxs(W,{variant:"contained",size:"small",sx:{mt:2,flexWrap:"wrap"},children:[e.jsx(y,{color:"inherit",startIcon:e.jsx(Ke,{}),onClick:Oe,children:"Refresh"}),e.jsx(y,{color:"primary",startIcon:e.jsx(ce,{}),onClick:Me,children:"Summary CSV"}),e.jsx(y,{color:"secondary",startIcon:e.jsx(ce,{}),onClick:De,children:"Payments CSV"})]})]}),e.jsxs(m,{item:!0,xs:12,md:6,children:[e.jsx(u,{variant:"overline",children:"Company Info (for cover sheet)"}),e.jsxs(m,{container:!0,spacing:1,children:[e.jsx(m,{item:!0,xs:12,children:e.jsx(b,{fullWidth:!0,size:"small",label:"Legal Name",value:o.legalName,onChange:t=>f({...o,legalName:t.target.value})})}),e.jsx(m,{item:!0,xs:12,sm:6,children:e.jsx(b,{fullWidth:!0,size:"small",label:"Tax ID / VAT",value:o.taxId,onChange:t=>f({...o,taxId:t.target.value})})}),e.jsx(m,{item:!0,xs:12,sm:6,children:e.jsx(b,{fullWidth:!0,size:"small",label:"Contact Email",value:o.contactEmail,onChange:t=>f({...o,contactEmail:t.target.value})})}),e.jsx(m,{item:!0,xs:12,children:e.jsx(b,{fullWidth:!0,size:"small",label:"Address Line 1",value:o.addressLine1,onChange:t=>f({...o,addressLine1:t.target.value})})}),e.jsx(m,{item:!0,xs:12,children:e.jsx(b,{fullWidth:!0,size:"small",label:"Address Line 2",value:o.addressLine2,onChange:t=>f({...o,addressLine2:t.target.value})})}),e.jsx(m,{item:!0,xs:12,sm:4,children:e.jsx(b,{fullWidth:!0,size:"small",label:"City",value:o.city,onChange:t=>f({...o,city:t.target.value})})}),e.jsx(m,{item:!0,xs:12,sm:4,children:e.jsx(b,{fullWidth:!0,size:"small",label:"Region/State",value:o.region,onChange:t=>f({...o,region:t.target.value})})}),e.jsx(m,{item:!0,xs:12,sm:4,children:e.jsx(b,{fullWidth:!0,size:"small",label:"Postal Code",value:o.postalCode,onChange:t=>f({...o,postalCode:t.target.value})})})]}),e.jsxs(W,{variant:"outlined",size:"small",sx:{mt:2,flexWrap:"wrap"},children:[e.jsx(y,{startIcon:e.jsx(de,{}),onClick:Ue,children:"Cover Sheet"}),e.jsx(y,{startIcon:e.jsx(de,{}),onClick:Fe,children:"Jurisdiction"}),e.jsx(y,{startIcon:e.jsx(Ge,{}),onClick:Ie,children:"Save Defaults"}),e.jsx(y,{startIcon:e.jsx(Qe,{}),onClick:Ee,children:"Load Defaults"})]}),e.jsx(M,{sx:{my:2}}),e.jsxs(m,{container:!0,spacing:2,children:[e.jsxs(m,{item:!0,xs:12,md:6,children:[e.jsx(u,{variant:"overline",children:"US State Worksheets"}),e.jsx(Xe,{options:Y,getOptionLabel:t=>`${t.code} — ${t.name}`,value:Y.find(t=>t.code===P)||null,onChange:(t,a)=>we((a==null?void 0:a.code)||"NY"),renderInput:t=>e.jsx(b,{...t,label:"Select State",size:"small"}),sx:{maxWidth:400,mt:1}}),e.jsxs(W,{size:"small",sx:{mt:2,flexWrap:"wrap"},children:[e.jsx(y,{variant:"contained",startIcon:e.jsx(qe,{}),onClick:()=>Ye(P),children:"Print State Worksheet"}),((X=Y.find(t=>t.code===P))==null?void 0:X.portal)&&e.jsx(y,{variant:"outlined",startIcon:e.jsx(Ze,{}),onClick:()=>window.open(Y.find(t=>t.code===P).portal,"_blank","noreferrer"),children:"Open Portal"})]})]}),e.jsxs(m,{item:!0,xs:12,md:6,children:[e.jsx(u,{variant:"overline",children:"International (Country) Worksheets"}),e.jsx(b,{label:"Country Code (ISO alpha-2)",size:"small",value:G,onChange:t=>$e(t.target.value.toUpperCase()),sx:{maxWidth:240,mt:1}}),e.jsx(W,{size:"small",sx:{mt:2,flexWrap:"wrap"},children:e.jsx(y,{variant:"contained",startIcon:e.jsx(et,{}),onClick:()=>Pe(G),children:"Print Country Worksheet"})}),e.jsx(J,{severity:"info",sx:{mt:2},children:"For EU OSS, use scheme EU_OSS and the jurisdiction summary CSV; for Canada, file GST/HST per CRA portal."})]})]})]})]}),e.jsx(J,{severity:"info",sx:{mt:2},children:"This packet mirrors common filings used by SaaS: US Sales Tax returns (state/county totals) and EU OSS VAT returns (member-state totals). Attach the CSV summaries and payments export when filing via your tax portal or provider."})]})}),I===0&&e.jsxs(E,{children:[e.jsxs(m,{container:!0,spacing:2,sx:{mb:2},children:[e.jsx(m,{item:!0,xs:12,md:3,children:e.jsxs(T,{sx:{p:2},children:[e.jsx(u,{variant:"overline",children:"Revenue (USD)"}),e.jsx(u,{variant:"h5",children:((((q=g==null?void 0:g.totals)==null?void 0:q.revenue_cents)||0)/100).toLocaleString()})]})}),e.jsx(m,{item:!0,xs:12,md:3,children:e.jsxs(T,{sx:{p:2},children:[e.jsx(u,{variant:"overline",children:"Tax Collected"}),e.jsx(u,{variant:"h5",children:((((Z=g==null?void 0:g.totals)==null?void 0:Z.tax_cents)||0)/100).toLocaleString()})]})}),e.jsx(m,{item:!0,xs:12,md:3,children:e.jsxs(T,{sx:{p:2},children:[e.jsx(u,{variant:"overline",children:"Payments"}),e.jsx(u,{variant:"h5",children:((ee=g==null?void 0:g.totals)==null?void 0:ee.paymentsCount)||0})]})}),e.jsx(m,{item:!0,xs:12,md:3,children:e.jsxs(T,{sx:{p:2},children:[e.jsx(u,{variant:"overline",children:"KYC Completed"}),e.jsx(u,{variant:"h5",children:((te=g==null?void 0:g.kycCounts)==null?void 0:te.COMPLETED)||0})]})})]}),e.jsxs(T,{sx:{p:2,mb:2},children:[e.jsx(u,{variant:"subtitle1",gutterBottom:!0,children:"Recent Payments"}),e.jsx(M,{sx:{mb:1}}),e.jsxs(U,{size:"small",children:[e.jsx(N,{children:e.jsxs(S,{children:[e.jsx(n,{children:"Date"}),e.jsx(n,{children:"Invoice"}),e.jsx(n,{align:"right",children:"Amount"}),e.jsx(n,{children:"Tax"}),e.jsx(n,{children:"Jurisdiction"})]})}),e.jsx(F,{children:((g==null?void 0:g.recentPayments)||[]).map(t=>e.jsxs(S,{children:[e.jsx(n,{children:new Date(t.createdAt).toLocaleDateString()}),e.jsx(n,{children:t.stripeInvoiceId}),e.jsx(n,{align:"right",children:(t.amount??0)/100}),e.jsxs(n,{children:[((t.taxAmount??0)/100).toFixed(2)," (",((t.taxRate??0)*100).toFixed(2),"%)"]}),e.jsx(n,{children:t.jurisdiction})]},t.id))})]})]}),e.jsxs(T,{sx:{p:2},children:[e.jsx(u,{variant:"subtitle1",gutterBottom:!0,children:"Tax by Jurisdiction"}),e.jsx(M,{sx:{mb:1}}),e.jsx(V,{direction:"row",spacing:1,flexWrap:"wrap",children:(g==null?void 0:g.taxByJurisdiction)&&Object.entries(g.taxByJurisdiction).map(([t,a])=>e.jsx(tt,{label:`${t}: ${(a/100).toLocaleString()}`},t))})]})]}),I===1&&e.jsxs(E,{children:[e.jsxs(V,{direction:{xs:"column",sm:"row"},spacing:2,sx:{mb:2},children:[e.jsx(b,{label:"From (YYYY-MM-DD)",placeholder:"2025-01-01",value:H,onChange:t=>me(t.target.value),size:"small"}),e.jsx(b,{label:"To (YYYY-MM-DD)",placeholder:"2025-12-31",value:z,onChange:t=>ue(t.target.value),size:"small"}),e.jsx(y,{variant:"contained",onClick:Re,children:"Export CSV"}),e.jsx(y,{variant:"outlined",onClick:Q,children:"Refresh"})]}),e.jsx(at,{component:T,children:e.jsxs(U,{size:"small",children:[e.jsx(N,{children:e.jsxs(S,{children:[e.jsx(n,{children:"Date"}),e.jsx(n,{children:"Invoice"}),e.jsx(n,{align:"right",children:"Amount"}),e.jsx(n,{children:"Currency"}),e.jsx(n,{children:"Status"}),e.jsx(n,{children:"Tax"}),e.jsx(n,{children:"Jurisdiction"}),e.jsx(n,{children:"User Email"}),e.jsx(n,{children:"Residency"})]})}),e.jsx(F,{children:he.map(t=>{var a,l,c;return e.jsxs(S,{children:[e.jsx(n,{children:new Date(t.createdAt).toLocaleDateString()}),e.jsx(n,{children:t.stripeInvoiceId}),e.jsx(n,{align:"right",children:(t.amount??0)/100}),e.jsx(n,{children:t.currency}),e.jsx(n,{children:t.status}),e.jsxs(n,{children:[((t.taxAmount??0)/100).toFixed(2)," (",((t.taxRate??0)*100).toFixed(2),"%)"]}),e.jsx(n,{children:t.taxJurisdiction}),e.jsx(n,{children:(a=t.user)==null?void 0:a.email}),e.jsx(n,{children:(c=(l=t.user)==null?void 0:l.taxInformation)==null?void 0:c.taxResidency})]},t.id)})})]})})]}),I===2&&e.jsx(E,{children:e.jsxs(T,{sx:{p:2},children:[e.jsx(u,{variant:"subtitle1",gutterBottom:!0,children:"Tax Summary"}),e.jsx(M,{sx:{mb:1}}),e.jsxs(m,{container:!0,spacing:2,children:[e.jsxs(m,{item:!0,xs:12,md:6,children:[e.jsx(u,{variant:"overline",children:"By Jurisdiction"}),e.jsxs(U,{size:"small",children:[e.jsx(N,{children:e.jsxs(S,{children:[e.jsx(n,{children:"Jurisdiction"}),e.jsx(n,{align:"right",children:"Tax"}),e.jsx(n,{align:"right",children:"Taxable"}),e.jsx(n,{align:"right",children:"Count"})]})}),e.jsx(F,{children:(d==null?void 0:d.byJurisdiction)&&Object.entries(d.byJurisdiction).map(([t,a])=>e.jsxs(S,{children:[e.jsx(n,{children:t}),e.jsx(n,{align:"right",children:((a.tax_cents||0)/100).toLocaleString()}),e.jsx(n,{align:"right",children:((a.taxable_cents||0)/100).toLocaleString()}),e.jsx(n,{align:"right",children:a.count})]},t))})]})]}),e.jsxs(m,{item:!0,xs:12,md:6,children:[e.jsx(u,{variant:"overline",children:"By Country"}),e.jsxs(U,{size:"small",children:[e.jsx(N,{children:e.jsxs(S,{children:[e.jsx(n,{children:"Country"}),e.jsx(n,{align:"right",children:"Tax"}),e.jsx(n,{align:"right",children:"Taxable"}),e.jsx(n,{align:"right",children:"Count"})]})}),e.jsx(F,{children:(d==null?void 0:d.byCountry)&&Object.entries(d.byCountry).map(([t,a])=>e.jsxs(S,{children:[e.jsx(n,{children:t}),e.jsx(n,{align:"right",children:((a.tax_cents||0)/100).toLocaleString()}),e.jsx(n,{align:"right",children:((a.taxable_cents||0)/100).toLocaleString()}),e.jsx(n,{align:"right",children:a.count})]},t))})]})]})]})]})}),I===4&&e.jsx(E,{children:e.jsxs(T,{sx:{p:2},children:[e.jsx(u,{variant:"subtitle1",gutterBottom:!0,children:"KYC Overview"}),e.jsx(M,{sx:{mb:1}}),e.jsxs(U,{size:"small",children:[e.jsx(N,{children:e.jsxs(S,{children:[e.jsx(n,{children:"Email"}),e.jsx(n,{children:"Status"}),e.jsx(n,{children:"Completed At"}),e.jsx(n,{children:"Name"}),e.jsx(n,{children:"Nationality"}),e.jsx(n,{children:"Residence"}),e.jsx(n,{children:"Company"})]})}),e.jsx(F,{children:je.map(t=>{var a,l,c,r,x;return e.jsxs(S,{children:[e.jsx(n,{children:t.email}),e.jsx(n,{children:t.kycStatus}),e.jsx(n,{children:t.kycCompletedAt?new Date(t.kycCompletedAt).toLocaleDateString():"-"}),e.jsxs(n,{children:[(a=t.complianceProfile)==null?void 0:a.firstName," ",(l=t.complianceProfile)==null?void 0:l.lastName]}),e.jsx(n,{children:(c=t.complianceProfile)==null?void 0:c.nationality}),e.jsx(n,{children:(r=t.complianceProfile)==null?void 0:r.countryOfResidence}),e.jsx(n,{children:(x=t.businessProfile)==null?void 0:x.companyName})]},t.id)})})]})]})}),I===5&&e.jsx(E,{children:e.jsxs(T,{sx:{p:2},children:[e.jsx(u,{variant:"subtitle1",gutterBottom:!0,children:"Compliance Events"}),e.jsx(M,{sx:{mb:1}}),e.jsxs(U,{size:"small",children:[e.jsx(N,{children:e.jsxs(S,{children:[e.jsx(n,{children:"Type"}),e.jsx(n,{children:"Severity"}),e.jsx(n,{children:"Description"})]})}),e.jsx(F,{children:ye.map(t=>e.jsxs(S,{children:[e.jsx(n,{children:t.eventType}),e.jsx(n,{children:t.severity}),e.jsx(n,{children:t.description})]},t.id))})]})]})})]})};export{lt as default};
