import{j as e,a as R,T as m,t as J,b9 as Be,ba as O,c as v,G as u,S as V,u as y,bW as Je,bX as k,aR as Ve,aS as Ke,aT as Ge,a4 as he,aU as W,d as f,R as Qe,aq as xe,bY as Xe,bZ as qe,b_ as Ze,D as E,b$ as et,c0 as tt,c1 as at,c2 as nt,aC as M,aD as N,aE as b,aF as a,aG as U,h as st,aB as it}from"./mui-DpsxcHA8.js";import{r as j}from"./vendor-DIxetjBo.js";import{c as S,e as D}from"./index-D0x5EZoX.js";import"./stripe-GgbZzTKy.js";const dt=()=>{var X,q,Z,ee,te;const[me,ue]=j.useState([]),[z,je]=j.useState(""),[H,pe]=j.useState(""),[L,ge]=j.useState(0),[p,ye]=j.useState(null),[x,K]=j.useState(null),[be,Se]=j.useState([]),[ve,fe]=j.useState([]),[Te,Ce]=j.useState([]),[B,we]=j.useState(0),[w,_]=j.useState(""),[A,$]=j.useState(""),[P,Ae]=j.useState("US_SALES_TAX"),[o,T]=j.useState({legalName:"",taxId:"",addressLine1:"",addressLine2:"",city:"",region:"",postalCode:"",country:"US",contactEmail:""}),[Le,_e]=j.useState([]),[F,$e]=j.useState("NY"),[G,Ie]=j.useState("US"),[Re,De]=j.useState(null),Y=[{code:"AL",name:"Alabama"},{code:"AK",name:"Alaska"},{code:"AZ",name:"Arizona"},{code:"AR",name:"Arkansas"},{code:"CA",name:"California",portal:"https://onlineservices.cdtfa.ca.gov"},{code:"CO",name:"Colorado"},{code:"CT",name:"Connecticut"},{code:"DE",name:"Delaware"},{code:"FL",name:"Florida",portal:"https://floridarevenue.com/taxes/Pages/return_drt.aspx"},{code:"GA",name:"Georgia"},{code:"HI",name:"Hawaii"},{code:"ID",name:"Idaho"},{code:"IL",name:"Illinois"},{code:"IN",name:"Indiana"},{code:"IA",name:"Iowa"},{code:"KS",name:"Kansas"},{code:"KY",name:"Kentucky"},{code:"LA",name:"Louisiana"},{code:"ME",name:"Maine"},{code:"MD",name:"Maryland"},{code:"MA",name:"Massachusetts"},{code:"MI",name:"Michigan"},{code:"MN",name:"Minnesota"},{code:"MS",name:"Mississippi"},{code:"MO",name:"Missouri"},{code:"MT",name:"Montana"},{code:"NE",name:"Nebraska"},{code:"NV",name:"Nevada"},{code:"NH",name:"New Hampshire"},{code:"NJ",name:"New Jersey"},{code:"NM",name:"New Mexico"},{code:"NY",name:"New York",portal:"https://www.tax.ny.gov/online/"},{code:"NC",name:"North Carolina"},{code:"ND",name:"North Dakota"},{code:"OH",name:"Ohio"},{code:"OK",name:"Oklahoma"},{code:"OR",name:"Oregon"},{code:"PA",name:"Pennsylvania"},{code:"RI",name:"Rhode Island"},{code:"SC",name:"South Carolina"},{code:"SD",name:"South Dakota"},{code:"TN",name:"Tennessee"},{code:"TX",name:"Texas",portal:"https://comptroller.texas.gov/taxes/file-pay/"},{code:"UT",name:"Utah"},{code:"VT",name:"Vermont"},{code:"VA",name:"Virginia"},{code:"WA",name:"Washington",portal:"https://secure.dor.wa.gov/"},{code:"WV",name:"West Virginia"},{code:"WI",name:"Wisconsin"},{code:"WY",name:"Wyoming"},{code:"DC",name:"District of Columbia"}];j.useEffect(()=>{try{const l=localStorage.getItem("filing_company_default");l&&T(JSON.parse(l))}catch{}const t=new Date,n=new Date(t.getFullYear(),t.getMonth()-1,1),s=new Date(t.getFullYear(),t.getMonth(),0),c=l=>`${l.getFullYear()}-${String(l.getMonth()+1).padStart(2,"0")}-${String(l.getDate()).padStart(2,"0")}`;_(c(n)),$(c(s))},[]);const Oe=t=>{const n=new Date,s=i=>`${i.getFullYear()}-${String(i.getMonth()+1).padStart(2,"0")}-${String(i.getDate()).padStart(2,"0")}`,c=(i,r)=>new Date(i,r,1),l=(i,r)=>new Date(i,r+1,0),h=(i,r)=>new Date(i,r*3,1),d=(i,r)=>new Date(i,r*3+3,0);if(t==="THIS_MONTH"){const i=c(n.getFullYear(),n.getMonth()),r=l(n.getFullYear(),n.getMonth());_(s(i)),$(s(r));return}if(t==="LAST_MONTH"){const i=c(n.getFullYear(),n.getMonth()-1),r=l(n.getFullYear(),n.getMonth()-1);_(s(i)),$(s(r));return}if(t==="THIS_QUARTER"){const i=Math.floor(n.getMonth()/3),r=h(n.getFullYear(),i),g=d(n.getFullYear(),i);_(s(r)),$(s(g));return}if(t==="LAST_QUARTER"){let i=Math.floor(n.getMonth()/3)-1,r=n.getFullYear();i<0&&(i=3,r-=1);const g=h(r,i),C=d(r,i);_(s(g)),$(s(C));return}if(t==="YTD"){const i=new Date(n.getFullYear(),0,1),r=n;_(s(i)),$(s(r));return}if(t==="LAST_YEAR"){const i=n.getFullYear()-1,r=new Date(i,0,1),g=new Date(i,11,31);_(s(r)),$(s(g));return}},Ee=async()=>{try{localStorage.setItem("filing_company_default",JSON.stringify(o))}catch{}try{await S.post(D.admin.companyFilingSave(),o)}catch{}},Me=()=>{try{const t=localStorage.getItem("filing_company_default");t&&T(JSON.parse(t))}catch{}},Q=async()=>{var n,s;const t=await S.get(D.accounting.payments(),{params:{limit:50}});ue(((s=(n=t.data)==null?void 0:n.data)==null?void 0:s.payments)||[])};j.useEffect(()=>{(async()=>{var i,r,g,C,I,ae,ne,se,ie,oe,le,re;Q();const[n,s,c,l,h]=await Promise.all([S.get("accounting/overview"),S.get("accounting/tax/summary"),S.get("accounting/kyc"),S.get("accounting/compliance-events"),S.get(D.accounting.consentsLatest())]);ye(((i=n.data)==null?void 0:i.data)||null),K(((r=s.data)==null?void 0:r.data)||null),Se(((C=(g=c.data)==null?void 0:g.data)==null?void 0:C.users)||[]),fe(((ae=(I=l.data)==null?void 0:I.data)==null?void 0:ae.events)||[]),Ce(((se=(ne=h.data)==null?void 0:ne.data)==null?void 0:se.users)||[]);const d=(((oe=(ie=c.data)==null?void 0:ie.data)==null?void 0:oe.users)||[]).filter(ce=>String(ce.kycStatus||"").toUpperCase()!=="COMPLETED").length;we(d);try{const de=(re=(le=(await S.get(D.admin.companyFilingGet())).data)==null?void 0:le.data)==null?void 0:re.company;de&&T(He=>({...He,...de}))}catch{}})()},[]);const Ne=async()=>{var r,g;const t={from:z,to:H,includePII:!1},s=((g=(r=(await S.post(D.accounting.exportPayments(),t)).data)==null?void 0:r.data)==null?void 0:g.rows)||[],l=[Object.keys(s[0]||{}).join(","),...s.map(C=>Object.values(C).map(I=>JSON.stringify(I??"")).join(","))].join(`
`),h=new Blob([l],{type:"text/csv"}),d=URL.createObjectURL(h),i=document.createElement("a");i.href=d,i.download=`payments_${z||"all"}_${H||"all"}.csv`,i.click(),URL.revokeObjectURL(d)},Ue=async()=>{var r,g;const t={from:w,to:A,includePII:!1},s=((g=(r=(await S.post(D.accounting.exportPayments(),t)).data)==null?void 0:r.data)==null?void 0:g.rows)||[],l=[Object.keys(s[0]||{}).join(","),...s.map(C=>Object.values(C).map(I=>JSON.stringify(I??"")).join(","))].join(`
`),h=new Blob([l],{type:"text/csv"}),d=URL.createObjectURL(h),i=document.createElement("a");i.href=d,i.download=`payments_${w||"all"}_${A||"all"}.csv`,i.click(),URL.revokeObjectURL(d)},ke=async()=>{var s,c,l;const t=await S.get("accounting/tax/summary",{params:{from:w||void 0,to:A||void 0}});K(((s=t.data)==null?void 0:s.data)||null);const n=await S.get(D.accounting.payments(),{params:{from:w||void 0,to:A||void 0,limit:500}});_e(((l=(c=n.data)==null?void 0:c.data)==null?void 0:l.payments)||[])},Pe=()=>{if(!x)return;const t=[];if(P==="US_SALES_TAX"){const d=(x==null?void 0:x.byJurisdiction)||{};for(const[i,r]of Object.entries(d))t.push({jurisdiction:i,tax_cents:r.tax_cents??0,taxable_cents:r.taxable_cents??0,count:r.count??0})}else{const d=(x==null?void 0:x.byCountry)||{};for(const[i,r]of Object.entries(d))t.push({country:i,tax_cents:r.tax_cents??0,taxable_cents:r.taxable_cents??0,count:r.count??0})}const s=[Object.keys(t[0]||{}).join(","),...t.map(d=>Object.values(d).map(i=>JSON.stringify(i??"")).join(","))].join(`
`),c=new Blob([s],{type:"text/csv"}),l=URL.createObjectURL(c),h=document.createElement("a");h.href=l,h.download=`filing_summary_${P}_${w||"all"}_${A||"all"}.csv`,h.click(),URL.revokeObjectURL(l)},Ye=()=>{const t=window.open("","PRINT","height=800,width=800");if(!t)return;const n=`${w||"Start"} to ${A||"End"}`,s=P==="US_SALES_TAX"?(x==null?void 0:x.byJurisdiction)||{}:(x==null?void 0:x.byCountry)||{},c=Object.values(s).reduce((h,d)=>({tax:h.tax+((d==null?void 0:d.tax_cents)||0),taxable:h.taxable+((d==null?void 0:d.taxable_cents)||0),count:h.count+((d==null?void 0:d.count)||0)}),{tax:0,taxable:0,count:0}),l=`<!doctype html><html><head><meta charset="utf-8"><title>Filing Cover Sheet</title>
      <style>body{font-family: -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; padding:24px;} h1,h2{margin:0 0 8px;} table{border-collapse: collapse; width:100%; margin-top:16px;} th,td{border:1px solid #ccc; padding:8px; text-align:left;} small{color:#666}</style>
    </head><body>
      <h1>Tax Filing Cover Sheet</h1>
      <small>Generated by Accounting Dashboard</small>
      <h2>Company</h2>
      <div>${o.legalName||"-"}</div>
      <div>${o.addressLine1||""} ${o.addressLine2||""}</div>
      <div>${o.city||""} ${o.region||""} ${o.postalCode||""} ${o.country||""}</div>
      <div>Tax ID: ${o.taxId||"-"}</div>
      <div>Contact: ${o.contactEmail||"-"}</div>
      <h2>Filing</h2>
      <div>Scheme: ${P}</div>
      <div>Period: ${n}</div>
      <table>
        <tr><th>Total Taxable</th><th>Total Tax</th><th>Transactions</th></tr>
        <tr><td>${(c.taxable/100).toLocaleString()}</td><td>${(c.tax/100).toLocaleString()}</td><td>${c.count}</td></tr>
      </table>
      <p style="margin-top:16px">Attach the jurisdiction/member-state summary CSV and payments CSV for the filing period when submitting via your tax portal or provider.</p>
      <script>window.onload=function(){window.print(); setTimeout(()=>window.close(), 300);}<\/script>
    </body></html>`;t.document.write(l),t.document.close(),t.focus()},Fe=()=>{var n;const t={};for(const s of Le){if(String(s.status).toUpperCase()!=="SUCCEEDED")continue;const c=((n=s.billingAddress)==null?void 0:n.state)||"UNKNOWN",l=s.taxAmount??0,h=(s.amount??0)-l;t[c]=t[c]||{taxable_cents:0,tax_cents:0,count:0},t[c].taxable_cents+=h,t[c].tax_cents+=l,t[c].count+=1}return t},We=t=>{const s=Fe()[t]||{taxable_cents:0,tax_cents:0,count:0},c=`${w||"Start"} to ${A||"End"}`,l=Y.find(i=>i.code===t),h=window.open("","PRINT","height=900,width=1000");if(!h)return;const d=`<!doctype html><html><head><meta charset="utf-8"><title>${t} Sales Tax Worksheet</title>
      <style>body{font-family:-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;padding:24px;} h1{margin:0 0 8px} table{border-collapse:collapse;width:100%;margin-top:16px;} th,td{border:1px solid #ccc;padding:8px;text-align:left;} small{color:#666}</style>
    </head><body>
      <h1>${(l==null?void 0:l.name)||t} Sales and Use Tax Return (Worksheet)</h1>
      <small>For reference only. Most states require e-filing via their tax portal.</small>
      <h2>Company</h2>
      <div>${o.legalName||"-"}</div>
      <div>${o.addressLine1||""} ${o.addressLine2||""}</div>
      <div>${o.city||""} ${o.region||""} ${o.postalCode||""} ${o.country||""}</div>
      <div>Tax ID: ${o.taxId||"-"}</div>
      <div>Contact: ${o.contactEmail||"-"}</div>
      <h2>Period: ${c}</h2>
      <table>
        <tr><th>Taxable sales (${t})</th><td>${(s.taxable_cents/100).toLocaleString()}</td></tr>
        <tr><th>Sales and use tax due (${t})</th><td>${(s.tax_cents/100).toLocaleString()}</td></tr>
        <tr><th>Transactions</th><td>${s.count}</td></tr>
      </table>
      ${l!=null&&l.portal?`<p style="margin-top:16px">Portal: <a href="${l.portal}" target="_blank" rel="noreferrer">${l.portal}</a></p>`:""}
      <script>window.onload=function(){window.print(); setTimeout(()=>window.close(), 300);}<\/script>
    </body></html>`;h.document.write(d),h.document.close(),h.focus()},ze=t=>{const n=`${w||"Start"} to ${A||"End"}`,c=((x==null?void 0:x.byCountry)||{})[t]||{tax_cents:0,taxable_cents:0,count:0},l=window.open("","PRINT","height=900,width=1000");if(!l)return;const h=`<!doctype html><html><head><meta charset="utf-8"><title>${t} VAT/Sales Worksheet</title>
      <style>body{font-family:-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;padding:24px;} h1{margin:0 0 8px} table{border-collapse:collapse;width:100%;margin-top:16px;} th,td{border:1px solid #ccc;padding:8px;text-align:left;} small{color:#666}</style>
    </head><body>
      <h1>${t} Indirect Tax Worksheet</h1>
      <small>For reference only. File via your national portal (e.g., EU OSS, CRA GST/HST).</small>
      <h2>Company</h2>
      <div>${o.legalName||"-"}</div>
      <div>${o.addressLine1||""} ${o.addressLine2||""}</div>
      <div>${o.city||""} ${o.region||""} ${o.postalCode||""} ${o.country||""}</div>
      <div>Tax ID: ${o.taxId||"-"}</div>
      <div>Contact: ${o.contactEmail||"-"}</div>
      <h2>Period: ${n}</h2>
      <table>
        <tr><th>Taxable amount (${t})</th><td>${(c.taxable_cents/100).toLocaleString()}</td></tr>
        <tr><th>Tax due (${t})</th><td>${(c.tax_cents/100).toLocaleString()}</td></tr>
        <tr><th>Transactions</th><td>${c.count||0}</td></tr>
      </table>
      <script>window.onload=function(){window.print(); setTimeout(()=>window.close(), 300);}<\/script>
    </body></html>`;l.document.write(h),l.document.close(),l.focus()};return e.jsxs(R,{sx:{p:3},children:[e.jsx(m,{variant:"h4",fontWeight:700,gutterBottom:!0,children:"Accounting & Compliance"}),e.jsx(m,{variant:"body2",color:"text.secondary",gutterBottom:!0,children:"Financial reporting, tax, KYC/AML, and regulatory oversight snapshot."}),B>0&&e.jsxs(J,{severity:"warning",sx:{mb:2},children:[B," user",B===1?"":"s"," require KYC verification. Review the KYC tab for details."]}),e.jsxs(Be,{value:L,onChange:(t,n)=>ge(n),sx:{mb:2},children:[e.jsx(O,{label:"Overview"}),e.jsx(O,{label:"Payments"}),e.jsx(O,{label:"Tax"}),e.jsx(O,{label:"Filings"}),e.jsx(O,{label:"KYC"}),e.jsx(O,{label:"Compliance"}),e.jsx(O,{label:"Terms"})]}),L===3&&e.jsx(R,{children:e.jsxs(v,{sx:{p:2},children:[e.jsx(m,{variant:"subtitle1",gutterBottom:!0,children:"Filing Packet"}),e.jsxs(u,{container:!0,spacing:2,children:[e.jsxs(u,{item:!0,xs:12,md:6,children:[e.jsx(m,{variant:"overline",children:"Filing Period"}),e.jsxs(V,{direction:{xs:"column",sm:"row"},spacing:2,sx:{mb:2},children:[e.jsx(y,{label:"From (YYYY-MM-DD)",placeholder:"2025-01-01",value:w,onChange:t=>_(t.target.value),size:"small"}),e.jsx(y,{label:"To (YYYY-MM-DD)",placeholder:"2025-12-31",value:A,onChange:t=>$(t.target.value),size:"small"})]}),e.jsxs(Je,{exclusive:!0,size:"small",value:Re,onChange:(t,n)=>{if(De(n),!n)return;Oe({THIS_MONTH:"THIS_MONTH",LAST_MONTH:"LAST_MONTH",THIS_QUARTER:"THIS_QUARTER",LAST_QUARTER:"LAST_QUARTER",YTD:"YTD",LAST_YEAR:"LAST_YEAR"}[n])},sx:{mb:2,flexWrap:"wrap"},children:[e.jsx(k,{value:"THIS_MONTH",children:"This Month"}),e.jsx(k,{value:"LAST_MONTH",children:"Last Month"}),e.jsx(k,{value:"THIS_QUARTER",children:"This Quarter"}),e.jsx(k,{value:"LAST_QUARTER",children:"Last Quarter"}),e.jsx(k,{value:"YTD",children:"YTD"}),e.jsx(k,{value:"LAST_YEAR",children:"Last Year"})]}),e.jsxs(Ve,{size:"small",sx:{minWidth:240},children:[e.jsx(Ke,{id:"scheme-label",children:"Scheme"}),e.jsxs(Ge,{labelId:"scheme-label",id:"scheme",value:P,label:"Scheme",onChange:t=>Ae(t.target.value),children:[e.jsx(he,{value:"US_SALES_TAX",children:"US Sales Tax (state/county)"}),e.jsx(he,{value:"EU_OSS",children:"EU OSS VAT (member state)"})]})]}),e.jsxs(W,{variant:"contained",size:"small",sx:{mt:2,flexWrap:"wrap"},children:[e.jsx(f,{color:"inherit",startIcon:e.jsx(Qe,{}),onClick:ke,children:"Refresh"}),e.jsx(f,{color:"primary",startIcon:e.jsx(xe,{}),onClick:Pe,children:"Summary CSV"}),e.jsx(f,{color:"secondary",startIcon:e.jsx(xe,{}),onClick:Ue,children:"Payments CSV"})]})]}),e.jsxs(u,{item:!0,xs:12,md:6,children:[e.jsx(m,{variant:"overline",children:"Company Info (for cover sheet)"}),e.jsxs(u,{container:!0,spacing:1,children:[e.jsx(u,{item:!0,xs:12,children:e.jsx(y,{fullWidth:!0,size:"small",label:"Legal Name",value:o.legalName,onChange:t=>T({...o,legalName:t.target.value})})}),e.jsx(u,{item:!0,xs:12,sm:6,children:e.jsx(y,{fullWidth:!0,size:"small",label:"Tax ID / VAT",value:o.taxId,onChange:t=>T({...o,taxId:t.target.value})})}),e.jsx(u,{item:!0,xs:12,sm:6,children:e.jsx(y,{fullWidth:!0,size:"small",label:"Contact Email",value:o.contactEmail,onChange:t=>T({...o,contactEmail:t.target.value})})}),e.jsx(u,{item:!0,xs:12,children:e.jsx(y,{fullWidth:!0,size:"small",label:"Address Line 1",value:o.addressLine1,onChange:t=>T({...o,addressLine1:t.target.value})})}),e.jsx(u,{item:!0,xs:12,children:e.jsx(y,{fullWidth:!0,size:"small",label:"Address Line 2",value:o.addressLine2,onChange:t=>T({...o,addressLine2:t.target.value})})}),e.jsx(u,{item:!0,xs:12,sm:4,children:e.jsx(y,{fullWidth:!0,size:"small",label:"City",value:o.city,onChange:t=>T({...o,city:t.target.value})})}),e.jsx(u,{item:!0,xs:12,sm:4,children:e.jsx(y,{fullWidth:!0,size:"small",label:"Region/State",value:o.region,onChange:t=>T({...o,region:t.target.value})})}),e.jsx(u,{item:!0,xs:12,sm:4,children:e.jsx(y,{fullWidth:!0,size:"small",label:"Postal Code",value:o.postalCode,onChange:t=>T({...o,postalCode:t.target.value})})})]}),e.jsxs(W,{variant:"outlined",size:"small",sx:{mt:2,flexWrap:"wrap"},children:[e.jsx(f,{startIcon:e.jsx(Xe,{}),onClick:Ye,children:"Cover Sheet"}),e.jsx(f,{startIcon:e.jsx(qe,{}),onClick:Ee,children:"Save Defaults"}),e.jsx(f,{startIcon:e.jsx(Ze,{}),onClick:Me,children:"Load Defaults"})]}),e.jsx(E,{sx:{my:2}}),e.jsxs(u,{container:!0,spacing:2,children:[e.jsxs(u,{item:!0,xs:12,md:6,children:[e.jsx(m,{variant:"overline",children:"US State Worksheets"}),e.jsx(et,{options:Y,getOptionLabel:t=>`${t.code} — ${t.name}`,value:Y.find(t=>t.code===F)||null,onChange:(t,n)=>$e((n==null?void 0:n.code)||"NY"),renderInput:t=>e.jsx(y,{...t,label:"Select State",size:"small"}),sx:{maxWidth:400,mt:1}}),e.jsxs(W,{size:"small",sx:{mt:2,flexWrap:"wrap"},children:[e.jsx(f,{variant:"contained",startIcon:e.jsx(tt,{}),onClick:()=>We(F),children:"Print State Worksheet"}),((X=Y.find(t=>t.code===F))==null?void 0:X.portal)&&e.jsx(f,{variant:"outlined",startIcon:e.jsx(at,{}),onClick:()=>window.open(Y.find(t=>t.code===F).portal,"_blank","noreferrer"),children:"Open Portal"})]})]}),e.jsxs(u,{item:!0,xs:12,md:6,children:[e.jsx(m,{variant:"overline",children:"International (Country) Worksheets"}),e.jsx(y,{label:"Country Code (ISO alpha-2)",size:"small",value:G,onChange:t=>Ie(t.target.value.toUpperCase()),sx:{maxWidth:240,mt:1}}),e.jsx(W,{size:"small",sx:{mt:2,flexWrap:"wrap"},children:e.jsx(f,{variant:"contained",startIcon:e.jsx(nt,{}),onClick:()=>ze(G),children:"Print Country Worksheet"})}),e.jsx(J,{severity:"info",sx:{mt:2},children:"For EU OSS, use scheme EU_OSS and the jurisdiction summary CSV; for Canada, file GST/HST per CRA portal."})]})]})]})]}),e.jsx(J,{severity:"info",sx:{mt:2},children:"This packet mirrors common filings used by SaaS: US Sales Tax returns (state/county totals) and EU OSS VAT returns (member-state totals). Attach the CSV summaries and payments export when filing via your tax portal or provider."})]})}),L===0&&e.jsxs(R,{children:[e.jsxs(u,{container:!0,spacing:2,sx:{mb:2},children:[e.jsx(u,{item:!0,xs:12,md:3,children:e.jsxs(v,{sx:{p:2},children:[e.jsx(m,{variant:"overline",children:"Revenue (USD)"}),e.jsx(m,{variant:"h5",children:((((q=p==null?void 0:p.totals)==null?void 0:q.revenue_cents)||0)/100).toLocaleString()})]})}),e.jsx(u,{item:!0,xs:12,md:3,children:e.jsxs(v,{sx:{p:2},children:[e.jsx(m,{variant:"overline",children:"Tax Collected"}),e.jsx(m,{variant:"h5",children:((((Z=p==null?void 0:p.totals)==null?void 0:Z.tax_cents)||0)/100).toLocaleString()})]})}),e.jsx(u,{item:!0,xs:12,md:3,children:e.jsxs(v,{sx:{p:2},children:[e.jsx(m,{variant:"overline",children:"Payments"}),e.jsx(m,{variant:"h5",children:((ee=p==null?void 0:p.totals)==null?void 0:ee.paymentsCount)||0})]})}),e.jsx(u,{item:!0,xs:12,md:3,children:e.jsxs(v,{sx:{p:2},children:[e.jsx(m,{variant:"overline",children:"KYC Completed"}),e.jsx(m,{variant:"h5",children:((te=p==null?void 0:p.kycCounts)==null?void 0:te.COMPLETED)||0})]})})]}),e.jsxs(v,{sx:{p:2,mb:2},children:[e.jsx(m,{variant:"subtitle1",gutterBottom:!0,children:"Recent Payments"}),e.jsx(E,{sx:{mb:1}}),e.jsxs(M,{size:"small",children:[e.jsx(N,{children:e.jsxs(b,{children:[e.jsx(a,{children:"Date"}),e.jsx(a,{children:"Invoice"}),e.jsx(a,{align:"right",children:"Amount"}),e.jsx(a,{children:"Tax"}),e.jsx(a,{children:"Jurisdiction"})]})}),e.jsx(U,{children:((p==null?void 0:p.recentPayments)||[]).map(t=>e.jsxs(b,{children:[e.jsx(a,{children:new Date(t.createdAt).toLocaleDateString()}),e.jsx(a,{children:t.stripeInvoiceId}),e.jsx(a,{align:"right",children:(t.amount??0)/100}),e.jsxs(a,{children:[((t.taxAmount??0)/100).toFixed(2)," (",((t.taxRate??0)*100).toFixed(2),"%)"]}),e.jsx(a,{children:t.jurisdiction})]},t.id))})]})]}),e.jsxs(v,{sx:{p:2},children:[e.jsx(m,{variant:"subtitle1",gutterBottom:!0,children:"Tax by Jurisdiction"}),e.jsx(E,{sx:{mb:1}}),e.jsx(V,{direction:"row",spacing:1,flexWrap:"wrap",children:(p==null?void 0:p.taxByJurisdiction)&&Object.entries(p.taxByJurisdiction).map(([t,n])=>e.jsx(st,{label:`${t}: ${(n/100).toLocaleString()}`},t))})]})]}),L===1&&e.jsxs(R,{children:[e.jsxs(V,{direction:{xs:"column",sm:"row"},spacing:2,sx:{mb:2},children:[e.jsx(y,{label:"From (YYYY-MM-DD)",placeholder:"2025-01-01",value:z,onChange:t=>je(t.target.value),size:"small"}),e.jsx(y,{label:"To (YYYY-MM-DD)",placeholder:"2025-12-31",value:H,onChange:t=>pe(t.target.value),size:"small"}),e.jsx(f,{variant:"contained",onClick:Ne,children:"Export CSV"}),e.jsx(f,{variant:"outlined",onClick:Q,children:"Refresh"})]}),e.jsx(it,{component:v,children:e.jsxs(M,{size:"small",children:[e.jsx(N,{children:e.jsxs(b,{children:[e.jsx(a,{children:"Date"}),e.jsx(a,{children:"Invoice"}),e.jsx(a,{align:"right",children:"Amount"}),e.jsx(a,{children:"Currency"}),e.jsx(a,{children:"Status"}),e.jsx(a,{children:"Tax"}),e.jsx(a,{children:"Jurisdiction"}),e.jsx(a,{children:"User Email"}),e.jsx(a,{children:"Residency"})]})}),e.jsx(U,{children:me.map(t=>{var n,s,c;return e.jsxs(b,{children:[e.jsx(a,{children:new Date(t.createdAt).toLocaleDateString()}),e.jsx(a,{children:t.stripeInvoiceId}),e.jsx(a,{align:"right",children:(t.amount??0)/100}),e.jsx(a,{children:t.currency}),e.jsx(a,{children:t.status}),e.jsxs(a,{children:[((t.taxAmount??0)/100).toFixed(2)," (",((t.taxRate??0)*100).toFixed(2),"%)"]}),e.jsx(a,{children:t.taxJurisdiction}),e.jsx(a,{children:(n=t.user)==null?void 0:n.email}),e.jsx(a,{children:(c=(s=t.user)==null?void 0:s.taxInformation)==null?void 0:c.taxResidency})]},t.id)})})]})})]}),L===2&&e.jsx(R,{children:e.jsxs(v,{sx:{p:2},children:[e.jsx(m,{variant:"subtitle1",gutterBottom:!0,children:"Tax Summary"}),e.jsx(E,{sx:{mb:1}}),e.jsxs(u,{container:!0,spacing:2,children:[e.jsxs(u,{item:!0,xs:12,md:6,children:[e.jsx(m,{variant:"overline",children:"By Jurisdiction"}),e.jsxs(M,{size:"small",children:[e.jsx(N,{children:e.jsxs(b,{children:[e.jsx(a,{children:"Jurisdiction"}),e.jsx(a,{align:"right",children:"Tax"}),e.jsx(a,{align:"right",children:"Taxable"}),e.jsx(a,{align:"right",children:"Count"})]})}),e.jsx(U,{children:(x==null?void 0:x.byJurisdiction)&&Object.entries(x.byJurisdiction).map(([t,n])=>e.jsxs(b,{children:[e.jsx(a,{children:t}),e.jsx(a,{align:"right",children:((n.tax_cents||0)/100).toLocaleString()}),e.jsx(a,{align:"right",children:((n.taxable_cents||0)/100).toLocaleString()}),e.jsx(a,{align:"right",children:n.count})]},t))})]})]}),e.jsxs(u,{item:!0,xs:12,md:6,children:[e.jsx(m,{variant:"overline",children:"By Country"}),e.jsxs(M,{size:"small",children:[e.jsx(N,{children:e.jsxs(b,{children:[e.jsx(a,{children:"Country"}),e.jsx(a,{align:"right",children:"Tax"}),e.jsx(a,{align:"right",children:"Taxable"}),e.jsx(a,{align:"right",children:"Count"})]})}),e.jsx(U,{children:(x==null?void 0:x.byCountry)&&Object.entries(x.byCountry).map(([t,n])=>e.jsxs(b,{children:[e.jsx(a,{children:t}),e.jsx(a,{align:"right",children:((n.tax_cents||0)/100).toLocaleString()}),e.jsx(a,{align:"right",children:((n.taxable_cents||0)/100).toLocaleString()}),e.jsx(a,{align:"right",children:n.count})]},t))})]})]})]})]})}),L===4&&e.jsx(R,{children:e.jsxs(v,{sx:{p:2},children:[e.jsx(m,{variant:"subtitle1",gutterBottom:!0,children:"KYC Overview"}),e.jsx(E,{sx:{mb:1}}),e.jsxs(M,{size:"small",children:[e.jsx(N,{children:e.jsxs(b,{children:[e.jsx(a,{children:"Email"}),e.jsx(a,{children:"Status"}),e.jsx(a,{children:"Completed At"}),e.jsx(a,{children:"Name"}),e.jsx(a,{children:"Nationality"}),e.jsx(a,{children:"Residence"}),e.jsx(a,{children:"Company"})]})}),e.jsx(U,{children:be.map(t=>{var n,s,c,l,h;return e.jsxs(b,{children:[e.jsx(a,{children:t.email}),e.jsx(a,{children:t.kycStatus}),e.jsx(a,{children:t.kycCompletedAt?new Date(t.kycCompletedAt).toLocaleDateString():"-"}),e.jsxs(a,{children:[(n=t.complianceProfile)==null?void 0:n.firstName," ",(s=t.complianceProfile)==null?void 0:s.lastName]}),e.jsx(a,{children:(c=t.complianceProfile)==null?void 0:c.nationality}),e.jsx(a,{children:(l=t.complianceProfile)==null?void 0:l.countryOfResidence}),e.jsx(a,{children:(h=t.businessProfile)==null?void 0:h.companyName})]},t.id)})})]})]})}),L===5&&e.jsx(R,{children:e.jsxs(v,{sx:{p:2},children:[e.jsx(m,{variant:"subtitle1",gutterBottom:!0,children:"Compliance Events"}),e.jsx(E,{sx:{mb:1}}),e.jsxs(M,{size:"small",children:[e.jsx(N,{children:e.jsxs(b,{children:[e.jsx(a,{children:"Type"}),e.jsx(a,{children:"Severity"}),e.jsx(a,{children:"Description"})]})}),e.jsx(U,{children:ve.map(t=>e.jsxs(b,{children:[e.jsx(a,{children:t.eventType}),e.jsx(a,{children:t.severity}),e.jsx(a,{children:t.description})]},t.id))})]})]})}),L===6&&e.jsx(R,{children:e.jsxs(v,{sx:{p:2},children:[e.jsx(m,{variant:"subtitle1",gutterBottom:!0,children:"Terms & Privacy Acceptance"}),e.jsx(E,{sx:{mb:1}}),e.jsxs(M,{size:"small",children:[e.jsx(N,{children:e.jsxs(b,{children:[e.jsx(a,{children:"Email"}),e.jsx(a,{children:"Terms Version"}),e.jsx(a,{children:"Terms Accepted At"}),e.jsx(a,{children:"Privacy Version"}),e.jsx(a,{children:"Privacy Accepted At"}),e.jsx(a,{children:"Actions"})]})}),e.jsx(U,{children:Te.map(t=>e.jsxs(b,{children:[e.jsx(a,{children:t.email}),e.jsx(a,{children:t.termsVersionAccepted||"-"}),e.jsx(a,{children:t.termsAcceptedAt?new Date(t.termsAcceptedAt).toLocaleString():"-"}),e.jsx(a,{children:t.privacyPolicyVersionAccepted||"-"}),e.jsx(a,{children:t.privacyPolicyAcceptedAt?new Date(t.privacyPolicyAcceptedAt).toLocaleString():"-"}),e.jsx(a,{children:e.jsx(f,{size:"small",onClick:async()=>{var r,g;const s=((g=(r=(await S.get(D.accounting.userConsentHistory(t.id),{params:{includePII:!1}})).data)==null?void 0:r.data)==null?void 0:g.consents)||[],l=[Object.keys(s[0]||{}).join(","),...s.map(C=>Object.values(C).map(I=>JSON.stringify(I??"")).join(","))].join(`
`),h=new Blob([l],{type:"text/csv"}),d=URL.createObjectURL(h),i=document.createElement("a");i.href=d,i.download=`consent_history_${t.email}.csv`,i.click(),URL.revokeObjectURL(d)},children:"Export History"})})]},t.id))})]})]})})]})};export{dt as default};
