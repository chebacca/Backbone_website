import{j as t,a as k,T as u,t as Z,b9 as $t,ba as R,c as S,G as m,S as E,u as y,d as j,aR as _t,aS as Lt,aT as Dt,a4 as tt,D as U,aC as O,aD as I,aE as f,aF as n,aG as P,h as At,aB as kt}from"./mui-pHPyF4nf.js";import{r as p}from"./vendor-DIxetjBo.js";import{c as w,e as N}from"./index-CRo8D_pe.js";import"./stripe-B5n5czio.js";const Ot=()=>{var X,K,V,Q;const[et,nt]=p.useState([]),[M,at]=p.useState(""),[W,st]=p.useState(""),[A,it]=p.useState(0),[g,lt]=p.useState(null),[h,J]=p.useState(null),[ot,rt]=p.useState([]),[ct,dt]=p.useState([]),[z,ht]=p.useState(0),[v,$]=p.useState(""),[T,_]=p.useState(""),[L,xt]=p.useState("US_SALES_TAX"),[i,C]=p.useState({legalName:"",taxId:"",addressLine1:"",addressLine2:"",city:"",region:"",postalCode:"",country:"US",contactEmail:""}),[ut,mt]=p.useState([]);p.useEffect(()=>{try{const c=localStorage.getItem("filing_company_default");c&&C(JSON.parse(c))}catch{}const e=new Date,a=new Date(e.getFullYear(),e.getMonth()-1,1),o=new Date(e.getFullYear(),e.getMonth(),0),r=c=>`${c.getFullYear()}-${String(c.getMonth()+1).padStart(2,"0")}-${String(c.getDate()).padStart(2,"0")}`;$(r(a)),_(r(o))},[]);const Y=e=>{const a=new Date,o=l=>`${l.getFullYear()}-${String(l.getMonth()+1).padStart(2,"0")}-${String(l.getDate()).padStart(2,"0")}`,r=(l,s)=>new Date(l,s,1),c=(l,s)=>new Date(l,s+1,0),x=(l,s)=>new Date(l,s*3,1),d=(l,s)=>new Date(l,s*3+3,0);if(e==="THIS_MONTH"){const l=r(a.getFullYear(),a.getMonth()),s=c(a.getFullYear(),a.getMonth());$(o(l)),_(o(s));return}if(e==="LAST_MONTH"){const l=r(a.getFullYear(),a.getMonth()-1),s=c(a.getFullYear(),a.getMonth()-1);$(o(l)),_(o(s));return}if(e==="THIS_QUARTER"){const l=Math.floor(a.getMonth()/3),s=x(a.getFullYear(),l),b=d(a.getFullYear(),l);$(o(s)),_(o(b));return}if(e==="LAST_QUARTER"){let l=Math.floor(a.getMonth()/3)-1,s=a.getFullYear();l<0&&(l=3,s-=1);const b=x(s,l),D=d(s,l);$(o(b)),_(o(D));return}if(e==="YTD"){const l=new Date(a.getFullYear(),0,1),s=a;$(o(l)),_(o(s));return}if(e==="LAST_YEAR"){const l=a.getFullYear()-1,s=new Date(l,0,1),b=new Date(l,11,31);$(o(s)),_(o(b));return}},gt=()=>{try{localStorage.setItem("filing_company_default",JSON.stringify(i))}catch{}},jt=()=>{try{const e=localStorage.getItem("filing_company_default");e&&C(JSON.parse(e))}catch{}},B=async()=>{var a,o;const e=await w.get(N.accounting.payments(),{params:{limit:50}});nt(((o=(a=e.data)==null?void 0:a.data)==null?void 0:o.payments)||[])};p.useEffect(()=>{(async()=>{var d,l,s,b,D,F,G,q;B();const[a,o,r,c]=await Promise.all([w.get("accounting/overview"),w.get("accounting/tax/summary"),w.get("accounting/kyc"),w.get("accounting/compliance-events")]);lt(((d=a.data)==null?void 0:d.data)||null),J(((l=o.data)==null?void 0:l.data)||null),rt(((b=(s=r.data)==null?void 0:s.data)==null?void 0:b.users)||[]),dt(((F=(D=c.data)==null?void 0:D.data)==null?void 0:F.events)||[]);const x=(((q=(G=r.data)==null?void 0:G.data)==null?void 0:q.users)||[]).filter(wt=>String(wt.kycStatus||"").toUpperCase()!=="COMPLETED").length;ht(x)})()},[]);const pt=async()=>{var s,b;const e={from:M,to:W,includePII:!1},o=((b=(s=(await w.post(N.accounting.exportPayments(),e)).data)==null?void 0:s.data)==null?void 0:b.rows)||[],c=[Object.keys(o[0]||{}).join(","),...o.map(D=>Object.values(D).map(F=>JSON.stringify(F??"")).join(","))].join(`
`),x=new Blob([c],{type:"text/csv"}),d=URL.createObjectURL(x),l=document.createElement("a");l.href=d,l.download=`payments_${M||"all"}_${W||"all"}.csv`,l.click(),URL.revokeObjectURL(d)},bt=async()=>{var s,b;const e={from:v,to:T,includePII:!1},o=((b=(s=(await w.post(N.accounting.exportPayments(),e)).data)==null?void 0:s.data)==null?void 0:b.rows)||[],c=[Object.keys(o[0]||{}).join(","),...o.map(D=>Object.values(D).map(F=>JSON.stringify(F??"")).join(","))].join(`
`),x=new Blob([c],{type:"text/csv"}),d=URL.createObjectURL(x),l=document.createElement("a");l.href=d,l.download=`payments_${v||"all"}_${T||"all"}.csv`,l.click(),URL.revokeObjectURL(d)},yt=async()=>{var o,r,c;const e=await w.get("accounting/tax/summary",{params:{from:v||void 0,to:T||void 0}});J(((o=e.data)==null?void 0:o.data)||null);const a=await w.get(N.accounting.payments(),{params:{from:v||void 0,to:T||void 0,limit:500}});mt(((c=(r=a.data)==null?void 0:r.data)==null?void 0:c.payments)||[])},ft=()=>{if(!h)return;const e=[];if(L==="US_SALES_TAX"){const d=(h==null?void 0:h.byJurisdiction)||{};for(const[l,s]of Object.entries(d))e.push({jurisdiction:l,tax_cents:s.tax_cents??0,taxable_cents:s.taxable_cents??0,count:s.count??0})}else{const d=(h==null?void 0:h.byCountry)||{};for(const[l,s]of Object.entries(d))e.push({country:l,tax_cents:s.tax_cents??0,taxable_cents:s.taxable_cents??0,count:s.count??0})}const o=[Object.keys(e[0]||{}).join(","),...e.map(d=>Object.values(d).map(l=>JSON.stringify(l??"")).join(","))].join(`
`),r=new Blob([o],{type:"text/csv"}),c=URL.createObjectURL(r),x=document.createElement("a");x.href=c,x.download=`filing_summary_${L}_${v||"all"}_${T||"all"}.csv`,x.click(),URL.revokeObjectURL(c)},St=()=>{const e=window.open("","PRINT","height=800,width=800");if(!e)return;const a=`${v||"Start"} to ${T||"End"}`,o=L==="US_SALES_TAX"?(h==null?void 0:h.byJurisdiction)||{}:(h==null?void 0:h.byCountry)||{},r=Object.values(o).reduce((x,d)=>({tax:x.tax+((d==null?void 0:d.tax_cents)||0),taxable:x.taxable+((d==null?void 0:d.taxable_cents)||0),count:x.count+((d==null?void 0:d.count)||0)}),{tax:0,taxable:0,count:0}),c=`<!doctype html><html><head><meta charset="utf-8"><title>Filing Cover Sheet</title>
      <style>body{font-family: -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; padding:24px;} h1,h2{margin:0 0 8px;} table{border-collapse: collapse; width:100%; margin-top:16px;} th,td{border:1px solid #ccc; padding:8px; text-align:left;} small{color:#666}</style>
    </head><body>
      <h1>Tax Filing Cover Sheet</h1>
      <small>Generated by Accounting Dashboard</small>
      <h2>Company</h2>
      <div>${i.legalName||"-"}</div>
      <div>${i.addressLine1||""} ${i.addressLine2||""}</div>
      <div>${i.city||""} ${i.region||""} ${i.postalCode||""} ${i.country||""}</div>
      <div>Tax ID: ${i.taxId||"-"}</div>
      <div>Contact: ${i.contactEmail||"-"}</div>
      <h2>Filing</h2>
      <div>Scheme: ${L}</div>
      <div>Period: ${a}</div>
      <table>
        <tr><th>Total Taxable</th><th>Total Tax</th><th>Transactions</th></tr>
        <tr><td>${(r.taxable/100).toLocaleString()}</td><td>${(r.tax/100).toLocaleString()}</td><td>${r.count}</td></tr>
      </table>
      <p style="margin-top:16px">Attach the jurisdiction/member-state summary CSV and payments CSV for the filing period when submitting via your tax portal or provider.</p>
      <script>window.onload=function(){window.print(); setTimeout(()=>window.close(), 300);}<\/script>
    </body></html>`;e.document.write(c),e.document.close(),e.focus()},vt=()=>{if(!h)return;const e=window.open("","PRINT","height=900,width=1000");if(!e)return;const a=`${v||"Start"} to ${T||"End"}`,o=L==="US_SALES_TAX"?(h==null?void 0:h.byJurisdiction)||{}:(h==null?void 0:h.byCountry)||{},r=Object.entries(o).map(([l,s])=>`<tr><td>${l}</td><td>${(((s==null?void 0:s.taxable_cents)||0)/100).toLocaleString()}</td><td>${(((s==null?void 0:s.tax_cents)||0)/100).toLocaleString()}</td><td>${(s==null?void 0:s.count)||0}</td></tr>`).join(""),c=Object.values(o).reduce((l,s)=>({tax:l.tax+((s==null?void 0:s.tax_cents)||0),taxable:l.taxable+((s==null?void 0:s.taxable_cents)||0),count:l.count+((s==null?void 0:s.count)||0)}),{tax:0,taxable:0,count:0}),x=L==="US_SALES_TAX"?"Jurisdiction":"Member State",d=`<!doctype html><html><head><meta charset="utf-8"><title>Filing Worksheet</title>
      <style>body{font-family: -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; padding:24px;} h1,h2{margin:0 0 8px;} table{border-collapse: collapse; width:100%; margin-top:16px;} th,td{border:1px solid #ccc; padding:8px; text-align:left;} small{color:#666} tfoot td{font-weight:600}</style>
    </head><body>
      <h1>Filing Worksheet</h1>
      <small>Generated by Accounting Dashboard</small>
      <h2>Company</h2>
      <div>${i.legalName||"-"}</div>
      <div>${i.addressLine1||""} ${i.addressLine2||""}</div>
      <div>${i.city||""} ${i.region||""} ${i.postalCode||""} ${i.country||""}</div>
      <div>Tax ID: ${i.taxId||"-"}</div>
      <div>Contact: ${i.contactEmail||"-"}</div>
      <h2>Period: ${a} â€” Scheme: ${L}</h2>
      <table>
        <thead><tr><th>${x}</th><th>Taxable</th><th>Tax</th><th>Count</th></tr></thead>
        <tbody>${r}</tbody>
        <tfoot><tr><td>Total</td><td>${(c.taxable/100).toLocaleString()}</td><td>${(c.tax/100).toLocaleString()}</td><td>${c.count}</td></tr></tfoot>
      </table>
      <p style="margin-top:16px">Use this worksheet to transcribe totals into your state portal (e-file) or retain for records.</p>
      <script>window.onload=function(){window.print(); setTimeout(()=>window.close(), 300);}<\/script>
    </body></html>`;e.document.write(d),e.document.close(),e.focus()},H=()=>{var a;const e={};for(const o of ut){if(String(o.status).toUpperCase()!=="SUCCEEDED")continue;const r=((a=o.billingAddress)==null?void 0:a.state)||"UNKNOWN",c=o.taxAmount??0,x=(o.amount??0)-c;e[r]=e[r]||{taxable_cents:0,tax_cents:0,count:0},e[r].taxable_cents+=x,e[r].tax_cents+=c,e[r].count+=1}return e},Tt=()=>{const a=H().NY||{taxable_cents:0,tax_cents:0,count:0},o=`${v||"Start"} to ${T||"End"}`,r=window.open("","PRINT","height=900,width=1000");if(!r)return;const c=`<!doctype html><html><head><meta charset="utf-8"><title>NY ST-100 Worksheet</title>
      <style>body{font-family:-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;padding:24px;} h1{margin:0 0 8px} table{border-collapse:collapse;width:100%;margin-top:16px;} th,td{border:1px solid #ccc;padding:8px;text-align:left;} small{color:#666}</style>
    </head><body>
      <h1>NY ST-100 Quarterly Sales and Use Tax Return (Worksheet)</h1>
      <small>For reference only. File electronically via NYS Sales Tax Web File.</small>
      <h2>Company</h2>
      <div>${i.legalName||"-"}</div>
      <div>${i.addressLine1||""} ${i.addressLine2||""}</div>
      <div>${i.city||""} ${i.region||""} ${i.postalCode||""} ${i.country||""}</div>
      <div>Tax ID: ${i.taxId||"-"}</div>
      <div>Contact: ${i.contactEmail||"-"}</div>
      <h2>Period: ${o}</h2>
      <table>
        <tr><th>Taxable sales (NY)</th><td>${(a.taxable_cents/100).toLocaleString()}</td></tr>
        <tr><th>Sales and use tax due (NY)</th><td>${(a.tax_cents/100).toLocaleString()}</td></tr>
        <tr><th>Transactions</th><td>${a.count}</td></tr>
      </table>
      <p style="margin-top:16px">Portal: <a href="https://www.tax.ny.gov/online/" target="_blank" rel="noreferrer">NYS Sales Tax Web File</a></p>
      <script>window.onload=function(){window.print(); setTimeout(()=>window.close(), 300);}<\/script>
    </body></html>`;r.document.write(c),r.document.close(),r.focus()},Ct=()=>{const a=H().TX||{taxable_cents:0,tax_cents:0,count:0},o=`${v||"Start"} to ${T||"End"}`,r=window.open("","PRINT","height=900,width=1000");if(!r)return;const c=`<!doctype html><html><head><meta charset="utf-8"><title>TX 01-114 Worksheet</title>
      <style>body{font-family:-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;padding:24px;} h1{margin:0 0 8px} table{border-collapse:collapse;width:100%;margin-top:16px;} th,td{border:1px solid #ccc;padding:8px;text-align:left;} small{color:#666}</style>
    </head><body>
      <h1>Texas 01-114 Sales and Use Tax Return (Worksheet)</h1>
      <small>For reference only. File via Texas Webfile.</small>
      <h2>Company</h2>
      <div>${i.legalName||"-"}</div>
      <div>${i.addressLine1||""} ${i.addressLine2||""}</div>
      <div>${i.city||""} ${i.region||""} ${i.postalCode||""} ${i.country||""}</div>
      <div>Tax ID: ${i.taxId||"-"}</div>
      <div>Contact: ${i.contactEmail||"-"}</div>
      <h2>Period: ${o}</h2>
      <table>
        <tr><th>Taxable sales (TX)</th><td>${(a.taxable_cents/100).toLocaleString()}</td></tr>
        <tr><th>Sales and use tax due (TX)</th><td>${(a.tax_cents/100).toLocaleString()}</td></tr>
        <tr><th>Transactions</th><td>${a.count}</td></tr>
      </table>
      <p style="margin-top:16px">Portal: <a href="https://comptroller.texas.gov/taxes/file-pay/" target="_blank" rel="noreferrer">Texas Webfile</a></p>
      <script>window.onload=function(){window.print(); setTimeout(()=>window.close(), 300);}<\/script>
    </body></html>`;r.document.write(c),r.document.close(),r.focus()};return t.jsxs(k,{sx:{p:3},children:[t.jsx(u,{variant:"h4",fontWeight:700,gutterBottom:!0,children:"Accounting & Compliance"}),t.jsx(u,{variant:"body2",color:"text.secondary",gutterBottom:!0,children:"Financial reporting, tax, KYC/AML, and regulatory oversight snapshot."}),z>0&&t.jsxs(Z,{severity:"warning",sx:{mb:2},children:[z," user",z===1?"":"s"," require KYC verification. Review the KYC tab for details."]}),t.jsxs($t,{value:A,onChange:(e,a)=>it(a),sx:{mb:2},children:[t.jsx(R,{label:"Overview"}),t.jsx(R,{label:"Payments"}),t.jsx(R,{label:"Tax"}),t.jsx(R,{label:"Filings"}),t.jsx(R,{label:"KYC"}),t.jsx(R,{label:"Compliance"})]}),A===3&&t.jsx(k,{children:t.jsxs(S,{sx:{p:2},children:[t.jsx(u,{variant:"subtitle1",gutterBottom:!0,children:"Filing Packet"}),t.jsxs(m,{container:!0,spacing:2,children:[t.jsxs(m,{item:!0,xs:12,md:6,children:[t.jsx(u,{variant:"overline",children:"Filing Period"}),t.jsxs(E,{direction:{xs:"column",sm:"row"},spacing:2,sx:{mb:2},children:[t.jsx(y,{label:"From (YYYY-MM-DD)",placeholder:"2025-01-01",value:v,onChange:e=>$(e.target.value),size:"small"}),t.jsx(y,{label:"To (YYYY-MM-DD)",placeholder:"2025-12-31",value:T,onChange:e=>_(e.target.value),size:"small"})]}),t.jsxs(E,{direction:{xs:"column",sm:"row"},spacing:1,sx:{mb:2},children:[t.jsx(j,{size:"small",variant:"outlined",onClick:()=>Y("THIS_MONTH"),children:"This Month"}),t.jsx(j,{size:"small",variant:"outlined",onClick:()=>Y("LAST_MONTH"),children:"Last Month"}),t.jsx(j,{size:"small",variant:"outlined",onClick:()=>Y("THIS_QUARTER"),children:"This Quarter"}),t.jsx(j,{size:"small",variant:"outlined",onClick:()=>Y("LAST_QUARTER"),children:"Last Quarter"}),t.jsx(j,{size:"small",variant:"outlined",onClick:()=>Y("YTD"),children:"YTD"}),t.jsx(j,{size:"small",variant:"outlined",onClick:()=>Y("LAST_YEAR"),children:"Last Year"})]}),t.jsxs(_t,{size:"small",sx:{minWidth:240},children:[t.jsx(Lt,{id:"scheme-label",children:"Scheme"}),t.jsxs(Dt,{labelId:"scheme-label",id:"scheme",value:L,label:"Scheme",onChange:e=>xt(e.target.value),children:[t.jsx(tt,{value:"US_SALES_TAX",children:"US Sales Tax (state/county)"}),t.jsx(tt,{value:"EU_OSS",children:"EU OSS VAT (member state)"})]})]}),t.jsxs(E,{direction:{xs:"column",sm:"row"},spacing:2,sx:{mt:2},children:[t.jsx(j,{variant:"outlined",onClick:yt,children:"Refresh Summary"}),t.jsx(j,{variant:"contained",onClick:ft,children:"Download Summary CSV"}),t.jsx(j,{variant:"outlined",onClick:bt,children:"Download Payments CSV"})]})]}),t.jsxs(m,{item:!0,xs:12,md:6,children:[t.jsx(u,{variant:"overline",children:"Company Info (for cover sheet)"}),t.jsxs(m,{container:!0,spacing:1,children:[t.jsx(m,{item:!0,xs:12,children:t.jsx(y,{fullWidth:!0,size:"small",label:"Legal Name",value:i.legalName,onChange:e=>C({...i,legalName:e.target.value})})}),t.jsx(m,{item:!0,xs:12,sm:6,children:t.jsx(y,{fullWidth:!0,size:"small",label:"Tax ID / VAT",value:i.taxId,onChange:e=>C({...i,taxId:e.target.value})})}),t.jsx(m,{item:!0,xs:12,sm:6,children:t.jsx(y,{fullWidth:!0,size:"small",label:"Contact Email",value:i.contactEmail,onChange:e=>C({...i,contactEmail:e.target.value})})}),t.jsx(m,{item:!0,xs:12,children:t.jsx(y,{fullWidth:!0,size:"small",label:"Address Line 1",value:i.addressLine1,onChange:e=>C({...i,addressLine1:e.target.value})})}),t.jsx(m,{item:!0,xs:12,children:t.jsx(y,{fullWidth:!0,size:"small",label:"Address Line 2",value:i.addressLine2,onChange:e=>C({...i,addressLine2:e.target.value})})}),t.jsx(m,{item:!0,xs:12,sm:4,children:t.jsx(y,{fullWidth:!0,size:"small",label:"City",value:i.city,onChange:e=>C({...i,city:e.target.value})})}),t.jsx(m,{item:!0,xs:12,sm:4,children:t.jsx(y,{fullWidth:!0,size:"small",label:"Region/State",value:i.region,onChange:e=>C({...i,region:e.target.value})})}),t.jsx(m,{item:!0,xs:12,sm:4,children:t.jsx(y,{fullWidth:!0,size:"small",label:"Postal Code",value:i.postalCode,onChange:e=>C({...i,postalCode:e.target.value})})})]}),t.jsxs(E,{direction:{xs:"column",sm:"row"},spacing:2,sx:{mt:2},children:[t.jsx(j,{variant:"outlined",onClick:St,children:"Print Filing Cover Sheet"}),t.jsx(j,{variant:"outlined",onClick:vt,children:"Print Jurisdiction Worksheet"}),t.jsx(j,{variant:"outlined",onClick:Tt,children:"NY ST-100 Worksheet"}),t.jsx(j,{variant:"outlined",onClick:Ct,children:"TX 01-114 Worksheet"}),t.jsx(j,{variant:"text",onClick:gt,children:"Save as Default"}),t.jsx(j,{variant:"text",onClick:jt,children:"Load Default"})]})]})]}),t.jsx(Z,{severity:"info",sx:{mt:2},children:"This packet mirrors common filings used by SaaS: US Sales Tax returns (state/county totals) and EU OSS VAT returns (member-state totals). Attach the CSV summaries and payments export when filing via your tax portal or provider."})]})}),A===0&&t.jsxs(k,{children:[t.jsxs(m,{container:!0,spacing:2,sx:{mb:2},children:[t.jsx(m,{item:!0,xs:12,md:3,children:t.jsxs(S,{sx:{p:2},children:[t.jsx(u,{variant:"overline",children:"Revenue (USD)"}),t.jsx(u,{variant:"h5",children:((((X=g==null?void 0:g.totals)==null?void 0:X.revenue_cents)||0)/100).toLocaleString()})]})}),t.jsx(m,{item:!0,xs:12,md:3,children:t.jsxs(S,{sx:{p:2},children:[t.jsx(u,{variant:"overline",children:"Tax Collected"}),t.jsx(u,{variant:"h5",children:((((K=g==null?void 0:g.totals)==null?void 0:K.tax_cents)||0)/100).toLocaleString()})]})}),t.jsx(m,{item:!0,xs:12,md:3,children:t.jsxs(S,{sx:{p:2},children:[t.jsx(u,{variant:"overline",children:"Payments"}),t.jsx(u,{variant:"h5",children:((V=g==null?void 0:g.totals)==null?void 0:V.paymentsCount)||0})]})}),t.jsx(m,{item:!0,xs:12,md:3,children:t.jsxs(S,{sx:{p:2},children:[t.jsx(u,{variant:"overline",children:"KYC Completed"}),t.jsx(u,{variant:"h5",children:((Q=g==null?void 0:g.kycCounts)==null?void 0:Q.COMPLETED)||0})]})})]}),t.jsxs(S,{sx:{p:2,mb:2},children:[t.jsx(u,{variant:"subtitle1",gutterBottom:!0,children:"Recent Payments"}),t.jsx(U,{sx:{mb:1}}),t.jsxs(O,{size:"small",children:[t.jsx(I,{children:t.jsxs(f,{children:[t.jsx(n,{children:"Date"}),t.jsx(n,{children:"Invoice"}),t.jsx(n,{align:"right",children:"Amount"}),t.jsx(n,{children:"Tax"}),t.jsx(n,{children:"Jurisdiction"})]})}),t.jsx(P,{children:((g==null?void 0:g.recentPayments)||[]).map(e=>t.jsxs(f,{children:[t.jsx(n,{children:new Date(e.createdAt).toLocaleDateString()}),t.jsx(n,{children:e.stripeInvoiceId}),t.jsx(n,{align:"right",children:(e.amount??0)/100}),t.jsxs(n,{children:[((e.taxAmount??0)/100).toFixed(2)," (",((e.taxRate??0)*100).toFixed(2),"%)"]}),t.jsx(n,{children:e.jurisdiction})]},e.id))})]})]}),t.jsxs(S,{sx:{p:2},children:[t.jsx(u,{variant:"subtitle1",gutterBottom:!0,children:"Tax by Jurisdiction"}),t.jsx(U,{sx:{mb:1}}),t.jsx(E,{direction:"row",spacing:1,flexWrap:"wrap",children:(g==null?void 0:g.taxByJurisdiction)&&Object.entries(g.taxByJurisdiction).map(([e,a])=>t.jsx(At,{label:`${e}: ${(a/100).toLocaleString()}`},e))})]})]}),A===1&&t.jsxs(k,{children:[t.jsxs(E,{direction:{xs:"column",sm:"row"},spacing:2,sx:{mb:2},children:[t.jsx(y,{label:"From (YYYY-MM-DD)",placeholder:"2025-01-01",value:M,onChange:e=>at(e.target.value),size:"small"}),t.jsx(y,{label:"To (YYYY-MM-DD)",placeholder:"2025-12-31",value:W,onChange:e=>st(e.target.value),size:"small"}),t.jsx(j,{variant:"contained",onClick:pt,children:"Export CSV"}),t.jsx(j,{variant:"outlined",onClick:B,children:"Refresh"})]}),t.jsx(kt,{component:S,children:t.jsxs(O,{size:"small",children:[t.jsx(I,{children:t.jsxs(f,{children:[t.jsx(n,{children:"Date"}),t.jsx(n,{children:"Invoice"}),t.jsx(n,{align:"right",children:"Amount"}),t.jsx(n,{children:"Currency"}),t.jsx(n,{children:"Status"}),t.jsx(n,{children:"Tax"}),t.jsx(n,{children:"Jurisdiction"}),t.jsx(n,{children:"User Email"}),t.jsx(n,{children:"Residency"})]})}),t.jsx(P,{children:et.map(e=>{var a,o,r;return t.jsxs(f,{children:[t.jsx(n,{children:new Date(e.createdAt).toLocaleDateString()}),t.jsx(n,{children:e.stripeInvoiceId}),t.jsx(n,{align:"right",children:(e.amount??0)/100}),t.jsx(n,{children:e.currency}),t.jsx(n,{children:e.status}),t.jsxs(n,{children:[((e.taxAmount??0)/100).toFixed(2)," (",((e.taxRate??0)*100).toFixed(2),"%)"]}),t.jsx(n,{children:e.taxJurisdiction}),t.jsx(n,{children:(a=e.user)==null?void 0:a.email}),t.jsx(n,{children:(r=(o=e.user)==null?void 0:o.taxInformation)==null?void 0:r.taxResidency})]},e.id)})})]})})]}),A===2&&t.jsx(k,{children:t.jsxs(S,{sx:{p:2},children:[t.jsx(u,{variant:"subtitle1",gutterBottom:!0,children:"Tax Summary"}),t.jsx(U,{sx:{mb:1}}),t.jsxs(m,{container:!0,spacing:2,children:[t.jsxs(m,{item:!0,xs:12,md:6,children:[t.jsx(u,{variant:"overline",children:"By Jurisdiction"}),t.jsxs(O,{size:"small",children:[t.jsx(I,{children:t.jsxs(f,{children:[t.jsx(n,{children:"Jurisdiction"}),t.jsx(n,{align:"right",children:"Tax"}),t.jsx(n,{align:"right",children:"Taxable"}),t.jsx(n,{align:"right",children:"Count"})]})}),t.jsx(P,{children:(h==null?void 0:h.byJurisdiction)&&Object.entries(h.byJurisdiction).map(([e,a])=>t.jsxs(f,{children:[t.jsx(n,{children:e}),t.jsx(n,{align:"right",children:((a.tax_cents||0)/100).toLocaleString()}),t.jsx(n,{align:"right",children:((a.taxable_cents||0)/100).toLocaleString()}),t.jsx(n,{align:"right",children:a.count})]},e))})]})]}),t.jsxs(m,{item:!0,xs:12,md:6,children:[t.jsx(u,{variant:"overline",children:"By Country"}),t.jsxs(O,{size:"small",children:[t.jsx(I,{children:t.jsxs(f,{children:[t.jsx(n,{children:"Country"}),t.jsx(n,{align:"right",children:"Tax"}),t.jsx(n,{align:"right",children:"Taxable"}),t.jsx(n,{align:"right",children:"Count"})]})}),t.jsx(P,{children:(h==null?void 0:h.byCountry)&&Object.entries(h.byCountry).map(([e,a])=>t.jsxs(f,{children:[t.jsx(n,{children:e}),t.jsx(n,{align:"right",children:((a.tax_cents||0)/100).toLocaleString()}),t.jsx(n,{align:"right",children:((a.taxable_cents||0)/100).toLocaleString()}),t.jsx(n,{align:"right",children:a.count})]},e))})]})]})]})]})}),A===4&&t.jsx(k,{children:t.jsxs(S,{sx:{p:2},children:[t.jsx(u,{variant:"subtitle1",gutterBottom:!0,children:"KYC Overview"}),t.jsx(U,{sx:{mb:1}}),t.jsxs(O,{size:"small",children:[t.jsx(I,{children:t.jsxs(f,{children:[t.jsx(n,{children:"Email"}),t.jsx(n,{children:"Status"}),t.jsx(n,{children:"Completed At"}),t.jsx(n,{children:"Name"}),t.jsx(n,{children:"Nationality"}),t.jsx(n,{children:"Residence"}),t.jsx(n,{children:"Company"})]})}),t.jsx(P,{children:ot.map(e=>{var a,o,r,c,x;return t.jsxs(f,{children:[t.jsx(n,{children:e.email}),t.jsx(n,{children:e.kycStatus}),t.jsx(n,{children:e.kycCompletedAt?new Date(e.kycCompletedAt).toLocaleDateString():"-"}),t.jsxs(n,{children:[(a=e.complianceProfile)==null?void 0:a.firstName," ",(o=e.complianceProfile)==null?void 0:o.lastName]}),t.jsx(n,{children:(r=e.complianceProfile)==null?void 0:r.nationality}),t.jsx(n,{children:(c=e.complianceProfile)==null?void 0:c.countryOfResidence}),t.jsx(n,{children:(x=e.businessProfile)==null?void 0:x.companyName})]},e.id)})})]})]})}),A===5&&t.jsx(k,{children:t.jsxs(S,{sx:{p:2},children:[t.jsx(u,{variant:"subtitle1",gutterBottom:!0,children:"Compliance Events"}),t.jsx(U,{sx:{mb:1}}),t.jsxs(O,{size:"small",children:[t.jsx(I,{children:t.jsxs(f,{children:[t.jsx(n,{children:"Type"}),t.jsx(n,{children:"Severity"}),t.jsx(n,{children:"Description"})]})}),t.jsx(P,{children:ct.map(e=>t.jsxs(f,{children:[t.jsx(n,{children:e.eventType}),t.jsx(n,{children:e.severity}),t.jsx(n,{children:e.description})]},e.id))})]})]})})]})};export{Ot as default};
