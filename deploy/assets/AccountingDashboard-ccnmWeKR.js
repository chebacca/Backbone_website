import{j as e,a as I,T as u,t as J,b9 as Fe,ba as R,c as f,G as m,S as V,u as y,bW as Pe,bX as O,aR as We,aS as ze,aT as He,a4 as re,aU as W,d as v,R as Be,aq as ce,bY as Je,bZ as Ve,b_ as Ke,D as M,b$ as Ge,c0 as Qe,c1 as Xe,c2 as qe,aC as E,aD as N,aE as b,aF as a,aG as Y,h as Ze,aB as et}from"./mui-DpsxcHA8.js";import{r as g}from"./vendor-DIxetjBo.js";import{c as T,e as U}from"./index-Ck1Tw4F8.js";import"./stripe-GgbZzTKy.js";const it=()=>{var X,q,Z,ee,te;const[de,he]=g.useState([]),[z,xe]=g.useState(""),[H,me]=g.useState(""),[$,ue]=g.useState(0),[j,je]=g.useState(null),[x,K]=g.useState(null),[ge,pe]=g.useState([]),[ye,be]=g.useState([]),[B,Se]=g.useState(0),[C,A]=g.useState(""),[w,_]=g.useState(""),[k,fe]=g.useState("US_SALES_TAX"),[o,S]=g.useState({legalName:"",taxId:"",addressLine1:"",addressLine2:"",city:"",region:"",postalCode:"",country:"US",contactEmail:""}),[ve,Te]=g.useState([]),[P,Ce]=g.useState("NY"),[G,we]=g.useState("US"),[Ae,_e]=g.useState(null),F=[{code:"AL",name:"Alabama"},{code:"AK",name:"Alaska"},{code:"AZ",name:"Arizona"},{code:"AR",name:"Arkansas"},{code:"CA",name:"California",portal:"https://onlineservices.cdtfa.ca.gov"},{code:"CO",name:"Colorado"},{code:"CT",name:"Connecticut"},{code:"DE",name:"Delaware"},{code:"FL",name:"Florida",portal:"https://floridarevenue.com/taxes/Pages/return_drt.aspx"},{code:"GA",name:"Georgia"},{code:"HI",name:"Hawaii"},{code:"ID",name:"Idaho"},{code:"IL",name:"Illinois"},{code:"IN",name:"Indiana"},{code:"IA",name:"Iowa"},{code:"KS",name:"Kansas"},{code:"KY",name:"Kentucky"},{code:"LA",name:"Louisiana"},{code:"ME",name:"Maine"},{code:"MD",name:"Maryland"},{code:"MA",name:"Massachusetts"},{code:"MI",name:"Michigan"},{code:"MN",name:"Minnesota"},{code:"MS",name:"Mississippi"},{code:"MO",name:"Missouri"},{code:"MT",name:"Montana"},{code:"NE",name:"Nebraska"},{code:"NV",name:"Nevada"},{code:"NH",name:"New Hampshire"},{code:"NJ",name:"New Jersey"},{code:"NM",name:"New Mexico"},{code:"NY",name:"New York",portal:"https://www.tax.ny.gov/online/"},{code:"NC",name:"North Carolina"},{code:"ND",name:"North Dakota"},{code:"OH",name:"Ohio"},{code:"OK",name:"Oklahoma"},{code:"OR",name:"Oregon"},{code:"PA",name:"Pennsylvania"},{code:"RI",name:"Rhode Island"},{code:"SC",name:"South Carolina"},{code:"SD",name:"South Dakota"},{code:"TN",name:"Tennessee"},{code:"TX",name:"Texas",portal:"https://comptroller.texas.gov/taxes/file-pay/"},{code:"UT",name:"Utah"},{code:"VT",name:"Vermont"},{code:"VA",name:"Virginia"},{code:"WA",name:"Washington",portal:"https://secure.dor.wa.gov/"},{code:"WV",name:"West Virginia"},{code:"WI",name:"Wisconsin"},{code:"WY",name:"Wyoming"},{code:"DC",name:"District of Columbia"}];g.useEffect(()=>{try{const l=localStorage.getItem("filing_company_default");l&&S(JSON.parse(l))}catch{}const t=new Date,n=new Date(t.getFullYear(),t.getMonth()-1,1),s=new Date(t.getFullYear(),t.getMonth(),0),c=l=>`${l.getFullYear()}-${String(l.getMonth()+1).padStart(2,"0")}-${String(l.getDate()).padStart(2,"0")}`;A(c(n)),_(c(s))},[]);const Le=t=>{const n=new Date,s=i=>`${i.getFullYear()}-${String(i.getMonth()+1).padStart(2,"0")}-${String(i.getDate()).padStart(2,"0")}`,c=(i,r)=>new Date(i,r,1),l=(i,r)=>new Date(i,r+1,0),h=(i,r)=>new Date(i,r*3,1),d=(i,r)=>new Date(i,r*3+3,0);if(t==="THIS_MONTH"){const i=c(n.getFullYear(),n.getMonth()),r=l(n.getFullYear(),n.getMonth());A(s(i)),_(s(r));return}if(t==="LAST_MONTH"){const i=c(n.getFullYear(),n.getMonth()-1),r=l(n.getFullYear(),n.getMonth()-1);A(s(i)),_(s(r));return}if(t==="THIS_QUARTER"){const i=Math.floor(n.getMonth()/3),r=h(n.getFullYear(),i),p=d(n.getFullYear(),i);A(s(r)),_(s(p));return}if(t==="LAST_QUARTER"){let i=Math.floor(n.getMonth()/3)-1,r=n.getFullYear();i<0&&(i=3,r-=1);const p=h(r,i),L=d(r,i);A(s(p)),_(s(L));return}if(t==="YTD"){const i=new Date(n.getFullYear(),0,1),r=n;A(s(i)),_(s(r));return}if(t==="LAST_YEAR"){const i=n.getFullYear()-1,r=new Date(i,0,1),p=new Date(i,11,31);A(s(r)),_(s(p));return}},$e=async()=>{try{localStorage.setItem("filing_company_default",JSON.stringify(o))}catch{}try{await T.post(U.admin.companyFilingSave(),o)}catch{}},Ie=()=>{try{const t=localStorage.getItem("filing_company_default");t&&S(JSON.parse(t))}catch{}},Q=async()=>{var n,s;const t=await T.get(U.accounting.payments(),{params:{limit:50}});he(((s=(n=t.data)==null?void 0:n.data)==null?void 0:s.payments)||[])};g.useEffect(()=>{(async()=>{var d,i,r,p,L,D,ae,ne,se,ie;Q();const[n,s,c,l]=await Promise.all([T.get("accounting/overview"),T.get("accounting/tax/summary"),T.get("accounting/kyc"),T.get("accounting/compliance-events")]);je(((d=n.data)==null?void 0:d.data)||null),K(((i=s.data)==null?void 0:i.data)||null),pe(((p=(r=c.data)==null?void 0:r.data)==null?void 0:p.users)||[]),be(((D=(L=l.data)==null?void 0:L.data)==null?void 0:D.events)||[]);const h=(((ne=(ae=c.data)==null?void 0:ae.data)==null?void 0:ne.users)||[]).filter(oe=>String(oe.kycStatus||"").toUpperCase()!=="COMPLETED").length;Se(h);try{const le=(ie=(se=(await T.get(U.admin.companyFilingGet())).data)==null?void 0:se.data)==null?void 0:ie.company;le&&S(ke=>({...ke,...le}))}catch{}})()},[]);const De=async()=>{var r,p;const t={from:z,to:H,includePII:!1},s=((p=(r=(await T.post(U.accounting.exportPayments(),t)).data)==null?void 0:r.data)==null?void 0:p.rows)||[],l=[Object.keys(s[0]||{}).join(","),...s.map(L=>Object.values(L).map(D=>JSON.stringify(D??"")).join(","))].join(`
`),h=new Blob([l],{type:"text/csv"}),d=URL.createObjectURL(h),i=document.createElement("a");i.href=d,i.download=`payments_${z||"all"}_${H||"all"}.csv`,i.click(),URL.revokeObjectURL(d)},Re=async()=>{var r,p;const t={from:C,to:w,includePII:!1},s=((p=(r=(await T.post(U.accounting.exportPayments(),t)).data)==null?void 0:r.data)==null?void 0:p.rows)||[],l=[Object.keys(s[0]||{}).join(","),...s.map(L=>Object.values(L).map(D=>JSON.stringify(D??"")).join(","))].join(`
`),h=new Blob([l],{type:"text/csv"}),d=URL.createObjectURL(h),i=document.createElement("a");i.href=d,i.download=`payments_${C||"all"}_${w||"all"}.csv`,i.click(),URL.revokeObjectURL(d)},Oe=async()=>{var s,c,l;const t=await T.get("accounting/tax/summary",{params:{from:C||void 0,to:w||void 0}});K(((s=t.data)==null?void 0:s.data)||null);const n=await T.get(U.accounting.payments(),{params:{from:C||void 0,to:w||void 0,limit:500}});Te(((l=(c=n.data)==null?void 0:c.data)==null?void 0:l.payments)||[])},Me=()=>{if(!x)return;const t=[];if(k==="US_SALES_TAX"){const d=(x==null?void 0:x.byJurisdiction)||{};for(const[i,r]of Object.entries(d))t.push({jurisdiction:i,tax_cents:r.tax_cents??0,taxable_cents:r.taxable_cents??0,count:r.count??0})}else{const d=(x==null?void 0:x.byCountry)||{};for(const[i,r]of Object.entries(d))t.push({country:i,tax_cents:r.tax_cents??0,taxable_cents:r.taxable_cents??0,count:r.count??0})}const s=[Object.keys(t[0]||{}).join(","),...t.map(d=>Object.values(d).map(i=>JSON.stringify(i??"")).join(","))].join(`
`),c=new Blob([s],{type:"text/csv"}),l=URL.createObjectURL(c),h=document.createElement("a");h.href=l,h.download=`filing_summary_${k}_${C||"all"}_${w||"all"}.csv`,h.click(),URL.revokeObjectURL(l)},Ee=()=>{const t=window.open("","PRINT","height=800,width=800");if(!t)return;const n=`${C||"Start"} to ${w||"End"}`,s=k==="US_SALES_TAX"?(x==null?void 0:x.byJurisdiction)||{}:(x==null?void 0:x.byCountry)||{},c=Object.values(s).reduce((h,d)=>({tax:h.tax+((d==null?void 0:d.tax_cents)||0),taxable:h.taxable+((d==null?void 0:d.taxable_cents)||0),count:h.count+((d==null?void 0:d.count)||0)}),{tax:0,taxable:0,count:0}),l=`<!doctype html><html><head><meta charset="utf-8"><title>Filing Cover Sheet</title>
      <style>body{font-family: -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; padding:24px;} h1,h2{margin:0 0 8px;} table{border-collapse: collapse; width:100%; margin-top:16px;} th,td{border:1px solid #ccc; padding:8px; text-align:left;} small{color:#666}</style>
    </head><body>
      <h1>Tax Filing Cover Sheet</h1>
      <small>Generated by Accounting Dashboard</small>
      <h2>Company</h2>
      <div>${o.legalName||"-"}</div>
      <div>${o.addressLine1||""} ${o.addressLine2||""}</div>
      <div>${o.city||""} ${o.region||""} ${o.postalCode||""} ${o.country||""}</div>
      <div>Tax ID: ${o.taxId||"-"}</div>
      <div>Contact: ${o.contactEmail||"-"}</div>
      <h2>Filing</h2>
      <div>Scheme: ${k}</div>
      <div>Period: ${n}</div>
      <table>
        <tr><th>Total Taxable</th><th>Total Tax</th><th>Transactions</th></tr>
        <tr><td>${(c.taxable/100).toLocaleString()}</td><td>${(c.tax/100).toLocaleString()}</td><td>${c.count}</td></tr>
      </table>
      <p style="margin-top:16px">Attach the jurisdiction/member-state summary CSV and payments CSV for the filing period when submitting via your tax portal or provider.</p>
      <script>window.onload=function(){window.print(); setTimeout(()=>window.close(), 300);}<\/script>
    </body></html>`;t.document.write(l),t.document.close(),t.focus()},Ne=()=>{var n;const t={};for(const s of ve){if(String(s.status).toUpperCase()!=="SUCCEEDED")continue;const c=((n=s.billingAddress)==null?void 0:n.state)||"UNKNOWN",l=s.taxAmount??0,h=(s.amount??0)-l;t[c]=t[c]||{taxable_cents:0,tax_cents:0,count:0},t[c].taxable_cents+=h,t[c].tax_cents+=l,t[c].count+=1}return t},Ye=t=>{const s=Ne()[t]||{taxable_cents:0,tax_cents:0,count:0},c=`${C||"Start"} to ${w||"End"}`,l=F.find(i=>i.code===t),h=window.open("","PRINT","height=900,width=1000");if(!h)return;const d=`<!doctype html><html><head><meta charset="utf-8"><title>${t} Sales Tax Worksheet</title>
      <style>body{font-family:-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;padding:24px;} h1{margin:0 0 8px} table{border-collapse:collapse;width:100%;margin-top:16px;} th,td{border:1px solid #ccc;padding:8px;text-align:left;} small{color:#666}</style>
    </head><body>
      <h1>${(l==null?void 0:l.name)||t} Sales and Use Tax Return (Worksheet)</h1>
      <small>For reference only. Most states require e-filing via their tax portal.</small>
      <h2>Company</h2>
      <div>${o.legalName||"-"}</div>
      <div>${o.addressLine1||""} ${o.addressLine2||""}</div>
      <div>${o.city||""} ${o.region||""} ${o.postalCode||""} ${o.country||""}</div>
      <div>Tax ID: ${o.taxId||"-"}</div>
      <div>Contact: ${o.contactEmail||"-"}</div>
      <h2>Period: ${c}</h2>
      <table>
        <tr><th>Taxable sales (${t})</th><td>${(s.taxable_cents/100).toLocaleString()}</td></tr>
        <tr><th>Sales and use tax due (${t})</th><td>${(s.tax_cents/100).toLocaleString()}</td></tr>
        <tr><th>Transactions</th><td>${s.count}</td></tr>
      </table>
      ${l!=null&&l.portal?`<p style="margin-top:16px">Portal: <a href="${l.portal}" target="_blank" rel="noreferrer">${l.portal}</a></p>`:""}
      <script>window.onload=function(){window.print(); setTimeout(()=>window.close(), 300);}<\/script>
    </body></html>`;h.document.write(d),h.document.close(),h.focus()},Ue=t=>{const n=`${C||"Start"} to ${w||"End"}`,c=((x==null?void 0:x.byCountry)||{})[t]||{tax_cents:0,taxable_cents:0,count:0},l=window.open("","PRINT","height=900,width=1000");if(!l)return;const h=`<!doctype html><html><head><meta charset="utf-8"><title>${t} VAT/Sales Worksheet</title>
      <style>body{font-family:-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;padding:24px;} h1{margin:0 0 8px} table{border-collapse:collapse;width:100%;margin-top:16px;} th,td{border:1px solid #ccc;padding:8px;text-align:left;} small{color:#666}</style>
    </head><body>
      <h1>${t} Indirect Tax Worksheet</h1>
      <small>For reference only. File via your national portal (e.g., EU OSS, CRA GST/HST).</small>
      <h2>Company</h2>
      <div>${o.legalName||"-"}</div>
      <div>${o.addressLine1||""} ${o.addressLine2||""}</div>
      <div>${o.city||""} ${o.region||""} ${o.postalCode||""} ${o.country||""}</div>
      <div>Tax ID: ${o.taxId||"-"}</div>
      <div>Contact: ${o.contactEmail||"-"}</div>
      <h2>Period: ${n}</h2>
      <table>
        <tr><th>Taxable amount (${t})</th><td>${(c.taxable_cents/100).toLocaleString()}</td></tr>
        <tr><th>Tax due (${t})</th><td>${(c.tax_cents/100).toLocaleString()}</td></tr>
        <tr><th>Transactions</th><td>${c.count||0}</td></tr>
      </table>
      <script>window.onload=function(){window.print(); setTimeout(()=>window.close(), 300);}<\/script>
    </body></html>`;l.document.write(h),l.document.close(),l.focus()};return e.jsxs(I,{sx:{p:3},children:[e.jsx(u,{variant:"h4",fontWeight:700,gutterBottom:!0,children:"Accounting & Compliance"}),e.jsx(u,{variant:"body2",color:"text.secondary",gutterBottom:!0,children:"Financial reporting, tax, KYC/AML, and regulatory oversight snapshot."}),B>0&&e.jsxs(J,{severity:"warning",sx:{mb:2},children:[B," user",B===1?"":"s"," require KYC verification. Review the KYC tab for details."]}),e.jsxs(Fe,{value:$,onChange:(t,n)=>ue(n),sx:{mb:2},children:[e.jsx(R,{label:"Overview"}),e.jsx(R,{label:"Payments"}),e.jsx(R,{label:"Tax"}),e.jsx(R,{label:"Filings"}),e.jsx(R,{label:"KYC"}),e.jsx(R,{label:"Compliance"})]}),$===3&&e.jsx(I,{children:e.jsxs(f,{sx:{p:2},children:[e.jsx(u,{variant:"subtitle1",gutterBottom:!0,children:"Filing Packet"}),e.jsxs(m,{container:!0,spacing:2,children:[e.jsxs(m,{item:!0,xs:12,md:6,children:[e.jsx(u,{variant:"overline",children:"Filing Period"}),e.jsxs(V,{direction:{xs:"column",sm:"row"},spacing:2,sx:{mb:2},children:[e.jsx(y,{label:"From (YYYY-MM-DD)",placeholder:"2025-01-01",value:C,onChange:t=>A(t.target.value),size:"small"}),e.jsx(y,{label:"To (YYYY-MM-DD)",placeholder:"2025-12-31",value:w,onChange:t=>_(t.target.value),size:"small"})]}),e.jsxs(Pe,{exclusive:!0,size:"small",value:Ae,onChange:(t,n)=>{if(_e(n),!n)return;Le({THIS_MONTH:"THIS_MONTH",LAST_MONTH:"LAST_MONTH",THIS_QUARTER:"THIS_QUARTER",LAST_QUARTER:"LAST_QUARTER",YTD:"YTD",LAST_YEAR:"LAST_YEAR"}[n])},sx:{mb:2,flexWrap:"wrap"},children:[e.jsx(O,{value:"THIS_MONTH",children:"This Month"}),e.jsx(O,{value:"LAST_MONTH",children:"Last Month"}),e.jsx(O,{value:"THIS_QUARTER",children:"This Quarter"}),e.jsx(O,{value:"LAST_QUARTER",children:"Last Quarter"}),e.jsx(O,{value:"YTD",children:"YTD"}),e.jsx(O,{value:"LAST_YEAR",children:"Last Year"})]}),e.jsxs(We,{size:"small",sx:{minWidth:240},children:[e.jsx(ze,{id:"scheme-label",children:"Scheme"}),e.jsxs(He,{labelId:"scheme-label",id:"scheme",value:k,label:"Scheme",onChange:t=>fe(t.target.value),children:[e.jsx(re,{value:"US_SALES_TAX",children:"US Sales Tax (state/county)"}),e.jsx(re,{value:"EU_OSS",children:"EU OSS VAT (member state)"})]})]}),e.jsxs(W,{variant:"contained",size:"small",sx:{mt:2,flexWrap:"wrap"},children:[e.jsx(v,{color:"inherit",startIcon:e.jsx(Be,{}),onClick:Oe,children:"Refresh"}),e.jsx(v,{color:"primary",startIcon:e.jsx(ce,{}),onClick:Me,children:"Summary CSV"}),e.jsx(v,{color:"secondary",startIcon:e.jsx(ce,{}),onClick:Re,children:"Payments CSV"})]})]}),e.jsxs(m,{item:!0,xs:12,md:6,children:[e.jsx(u,{variant:"overline",children:"Company Info (for cover sheet)"}),e.jsxs(m,{container:!0,spacing:1,children:[e.jsx(m,{item:!0,xs:12,children:e.jsx(y,{fullWidth:!0,size:"small",label:"Legal Name",value:o.legalName,onChange:t=>S({...o,legalName:t.target.value})})}),e.jsx(m,{item:!0,xs:12,sm:6,children:e.jsx(y,{fullWidth:!0,size:"small",label:"Tax ID / VAT",value:o.taxId,onChange:t=>S({...o,taxId:t.target.value})})}),e.jsx(m,{item:!0,xs:12,sm:6,children:e.jsx(y,{fullWidth:!0,size:"small",label:"Contact Email",value:o.contactEmail,onChange:t=>S({...o,contactEmail:t.target.value})})}),e.jsx(m,{item:!0,xs:12,children:e.jsx(y,{fullWidth:!0,size:"small",label:"Address Line 1",value:o.addressLine1,onChange:t=>S({...o,addressLine1:t.target.value})})}),e.jsx(m,{item:!0,xs:12,children:e.jsx(y,{fullWidth:!0,size:"small",label:"Address Line 2",value:o.addressLine2,onChange:t=>S({...o,addressLine2:t.target.value})})}),e.jsx(m,{item:!0,xs:12,sm:4,children:e.jsx(y,{fullWidth:!0,size:"small",label:"City",value:o.city,onChange:t=>S({...o,city:t.target.value})})}),e.jsx(m,{item:!0,xs:12,sm:4,children:e.jsx(y,{fullWidth:!0,size:"small",label:"Region/State",value:o.region,onChange:t=>S({...o,region:t.target.value})})}),e.jsx(m,{item:!0,xs:12,sm:4,children:e.jsx(y,{fullWidth:!0,size:"small",label:"Postal Code",value:o.postalCode,onChange:t=>S({...o,postalCode:t.target.value})})})]}),e.jsxs(W,{variant:"outlined",size:"small",sx:{mt:2,flexWrap:"wrap"},children:[e.jsx(v,{startIcon:e.jsx(Je,{}),onClick:Ee,children:"Cover Sheet"}),e.jsx(v,{startIcon:e.jsx(Ve,{}),onClick:$e,children:"Save Defaults"}),e.jsx(v,{startIcon:e.jsx(Ke,{}),onClick:Ie,children:"Load Defaults"})]}),e.jsx(M,{sx:{my:2}}),e.jsxs(m,{container:!0,spacing:2,children:[e.jsxs(m,{item:!0,xs:12,md:6,children:[e.jsx(u,{variant:"overline",children:"US State Worksheets"}),e.jsx(Ge,{options:F,getOptionLabel:t=>`${t.code} — ${t.name}`,value:F.find(t=>t.code===P)||null,onChange:(t,n)=>Ce((n==null?void 0:n.code)||"NY"),renderInput:t=>e.jsx(y,{...t,label:"Select State",size:"small"}),sx:{maxWidth:400,mt:1}}),e.jsxs(W,{size:"small",sx:{mt:2,flexWrap:"wrap"},children:[e.jsx(v,{variant:"contained",startIcon:e.jsx(Qe,{}),onClick:()=>Ye(P),children:"Print State Worksheet"}),((X=F.find(t=>t.code===P))==null?void 0:X.portal)&&e.jsx(v,{variant:"outlined",startIcon:e.jsx(Xe,{}),onClick:()=>window.open(F.find(t=>t.code===P).portal,"_blank","noreferrer"),children:"Open Portal"})]})]}),e.jsxs(m,{item:!0,xs:12,md:6,children:[e.jsx(u,{variant:"overline",children:"International (Country) Worksheets"}),e.jsx(y,{label:"Country Code (ISO alpha-2)",size:"small",value:G,onChange:t=>we(t.target.value.toUpperCase()),sx:{maxWidth:240,mt:1}}),e.jsx(W,{size:"small",sx:{mt:2,flexWrap:"wrap"},children:e.jsx(v,{variant:"contained",startIcon:e.jsx(qe,{}),onClick:()=>Ue(G),children:"Print Country Worksheet"})}),e.jsx(J,{severity:"info",sx:{mt:2},children:"For EU OSS, use scheme EU_OSS and the jurisdiction summary CSV; for Canada, file GST/HST per CRA portal."})]})]})]})]}),e.jsx(J,{severity:"info",sx:{mt:2},children:"This packet mirrors common filings used by SaaS: US Sales Tax returns (state/county totals) and EU OSS VAT returns (member-state totals). Attach the CSV summaries and payments export when filing via your tax portal or provider."})]})}),$===0&&e.jsxs(I,{children:[e.jsxs(m,{container:!0,spacing:2,sx:{mb:2},children:[e.jsx(m,{item:!0,xs:12,md:3,children:e.jsxs(f,{sx:{p:2},children:[e.jsx(u,{variant:"overline",children:"Revenue (USD)"}),e.jsx(u,{variant:"h5",children:((((q=j==null?void 0:j.totals)==null?void 0:q.revenue_cents)||0)/100).toLocaleString()})]})}),e.jsx(m,{item:!0,xs:12,md:3,children:e.jsxs(f,{sx:{p:2},children:[e.jsx(u,{variant:"overline",children:"Tax Collected"}),e.jsx(u,{variant:"h5",children:((((Z=j==null?void 0:j.totals)==null?void 0:Z.tax_cents)||0)/100).toLocaleString()})]})}),e.jsx(m,{item:!0,xs:12,md:3,children:e.jsxs(f,{sx:{p:2},children:[e.jsx(u,{variant:"overline",children:"Payments"}),e.jsx(u,{variant:"h5",children:((ee=j==null?void 0:j.totals)==null?void 0:ee.paymentsCount)||0})]})}),e.jsx(m,{item:!0,xs:12,md:3,children:e.jsxs(f,{sx:{p:2},children:[e.jsx(u,{variant:"overline",children:"KYC Completed"}),e.jsx(u,{variant:"h5",children:((te=j==null?void 0:j.kycCounts)==null?void 0:te.COMPLETED)||0})]})})]}),e.jsxs(f,{sx:{p:2,mb:2},children:[e.jsx(u,{variant:"subtitle1",gutterBottom:!0,children:"Recent Payments"}),e.jsx(M,{sx:{mb:1}}),e.jsxs(E,{size:"small",children:[e.jsx(N,{children:e.jsxs(b,{children:[e.jsx(a,{children:"Date"}),e.jsx(a,{children:"Invoice"}),e.jsx(a,{align:"right",children:"Amount"}),e.jsx(a,{children:"Tax"}),e.jsx(a,{children:"Jurisdiction"})]})}),e.jsx(Y,{children:((j==null?void 0:j.recentPayments)||[]).map(t=>e.jsxs(b,{children:[e.jsx(a,{children:new Date(t.createdAt).toLocaleDateString()}),e.jsx(a,{children:t.stripeInvoiceId}),e.jsx(a,{align:"right",children:(t.amount??0)/100}),e.jsxs(a,{children:[((t.taxAmount??0)/100).toFixed(2)," (",((t.taxRate??0)*100).toFixed(2),"%)"]}),e.jsx(a,{children:t.jurisdiction})]},t.id))})]})]}),e.jsxs(f,{sx:{p:2},children:[e.jsx(u,{variant:"subtitle1",gutterBottom:!0,children:"Tax by Jurisdiction"}),e.jsx(M,{sx:{mb:1}}),e.jsx(V,{direction:"row",spacing:1,flexWrap:"wrap",children:(j==null?void 0:j.taxByJurisdiction)&&Object.entries(j.taxByJurisdiction).map(([t,n])=>e.jsx(Ze,{label:`${t}: ${(n/100).toLocaleString()}`},t))})]})]}),$===1&&e.jsxs(I,{children:[e.jsxs(V,{direction:{xs:"column",sm:"row"},spacing:2,sx:{mb:2},children:[e.jsx(y,{label:"From (YYYY-MM-DD)",placeholder:"2025-01-01",value:z,onChange:t=>xe(t.target.value),size:"small"}),e.jsx(y,{label:"To (YYYY-MM-DD)",placeholder:"2025-12-31",value:H,onChange:t=>me(t.target.value),size:"small"}),e.jsx(v,{variant:"contained",onClick:De,children:"Export CSV"}),e.jsx(v,{variant:"outlined",onClick:Q,children:"Refresh"})]}),e.jsx(et,{component:f,children:e.jsxs(E,{size:"small",children:[e.jsx(N,{children:e.jsxs(b,{children:[e.jsx(a,{children:"Date"}),e.jsx(a,{children:"Invoice"}),e.jsx(a,{align:"right",children:"Amount"}),e.jsx(a,{children:"Currency"}),e.jsx(a,{children:"Status"}),e.jsx(a,{children:"Tax"}),e.jsx(a,{children:"Jurisdiction"}),e.jsx(a,{children:"User Email"}),e.jsx(a,{children:"Residency"})]})}),e.jsx(Y,{children:de.map(t=>{var n,s,c;return e.jsxs(b,{children:[e.jsx(a,{children:new Date(t.createdAt).toLocaleDateString()}),e.jsx(a,{children:t.stripeInvoiceId}),e.jsx(a,{align:"right",children:(t.amount??0)/100}),e.jsx(a,{children:t.currency}),e.jsx(a,{children:t.status}),e.jsxs(a,{children:[((t.taxAmount??0)/100).toFixed(2)," (",((t.taxRate??0)*100).toFixed(2),"%)"]}),e.jsx(a,{children:t.taxJurisdiction}),e.jsx(a,{children:(n=t.user)==null?void 0:n.email}),e.jsx(a,{children:(c=(s=t.user)==null?void 0:s.taxInformation)==null?void 0:c.taxResidency})]},t.id)})})]})})]}),$===2&&e.jsx(I,{children:e.jsxs(f,{sx:{p:2},children:[e.jsx(u,{variant:"subtitle1",gutterBottom:!0,children:"Tax Summary"}),e.jsx(M,{sx:{mb:1}}),e.jsxs(m,{container:!0,spacing:2,children:[e.jsxs(m,{item:!0,xs:12,md:6,children:[e.jsx(u,{variant:"overline",children:"By Jurisdiction"}),e.jsxs(E,{size:"small",children:[e.jsx(N,{children:e.jsxs(b,{children:[e.jsx(a,{children:"Jurisdiction"}),e.jsx(a,{align:"right",children:"Tax"}),e.jsx(a,{align:"right",children:"Taxable"}),e.jsx(a,{align:"right",children:"Count"})]})}),e.jsx(Y,{children:(x==null?void 0:x.byJurisdiction)&&Object.entries(x.byJurisdiction).map(([t,n])=>e.jsxs(b,{children:[e.jsx(a,{children:t}),e.jsx(a,{align:"right",children:((n.tax_cents||0)/100).toLocaleString()}),e.jsx(a,{align:"right",children:((n.taxable_cents||0)/100).toLocaleString()}),e.jsx(a,{align:"right",children:n.count})]},t))})]})]}),e.jsxs(m,{item:!0,xs:12,md:6,children:[e.jsx(u,{variant:"overline",children:"By Country"}),e.jsxs(E,{size:"small",children:[e.jsx(N,{children:e.jsxs(b,{children:[e.jsx(a,{children:"Country"}),e.jsx(a,{align:"right",children:"Tax"}),e.jsx(a,{align:"right",children:"Taxable"}),e.jsx(a,{align:"right",children:"Count"})]})}),e.jsx(Y,{children:(x==null?void 0:x.byCountry)&&Object.entries(x.byCountry).map(([t,n])=>e.jsxs(b,{children:[e.jsx(a,{children:t}),e.jsx(a,{align:"right",children:((n.tax_cents||0)/100).toLocaleString()}),e.jsx(a,{align:"right",children:((n.taxable_cents||0)/100).toLocaleString()}),e.jsx(a,{align:"right",children:n.count})]},t))})]})]})]})]})}),$===4&&e.jsx(I,{children:e.jsxs(f,{sx:{p:2},children:[e.jsx(u,{variant:"subtitle1",gutterBottom:!0,children:"KYC Overview"}),e.jsx(M,{sx:{mb:1}}),e.jsxs(E,{size:"small",children:[e.jsx(N,{children:e.jsxs(b,{children:[e.jsx(a,{children:"Email"}),e.jsx(a,{children:"Status"}),e.jsx(a,{children:"Completed At"}),e.jsx(a,{children:"Name"}),e.jsx(a,{children:"Nationality"}),e.jsx(a,{children:"Residence"}),e.jsx(a,{children:"Company"})]})}),e.jsx(Y,{children:ge.map(t=>{var n,s,c,l,h;return e.jsxs(b,{children:[e.jsx(a,{children:t.email}),e.jsx(a,{children:t.kycStatus}),e.jsx(a,{children:t.kycCompletedAt?new Date(t.kycCompletedAt).toLocaleDateString():"-"}),e.jsxs(a,{children:[(n=t.complianceProfile)==null?void 0:n.firstName," ",(s=t.complianceProfile)==null?void 0:s.lastName]}),e.jsx(a,{children:(c=t.complianceProfile)==null?void 0:c.nationality}),e.jsx(a,{children:(l=t.complianceProfile)==null?void 0:l.countryOfResidence}),e.jsx(a,{children:(h=t.businessProfile)==null?void 0:h.companyName})]},t.id)})})]})]})}),$===5&&e.jsx(I,{children:e.jsxs(f,{sx:{p:2},children:[e.jsx(u,{variant:"subtitle1",gutterBottom:!0,children:"Compliance Events"}),e.jsx(M,{sx:{mb:1}}),e.jsxs(E,{size:"small",children:[e.jsx(N,{children:e.jsxs(b,{children:[e.jsx(a,{children:"Type"}),e.jsx(a,{children:"Severity"}),e.jsx(a,{children:"Description"})]})}),e.jsx(Y,{children:ye.map(t=>e.jsxs(b,{children:[e.jsx(a,{children:t.eventType}),e.jsx(a,{children:t.severity}),e.jsx(a,{children:t.description})]},t.id))})]})]})})]})};export{it as default};
