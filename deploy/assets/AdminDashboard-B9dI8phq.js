import{j as e,a as n,b as Cs,an as Is,T as r,h,G as d,k as K,l as q,au as ws,bN as Ds,aa as As,aQ as Q,c as P,b9 as Ls,ba as J,u as m,v as N,I,bO as Ce,az as Ie,d as j,aB as ee,aC as se,aD as te,aE as b,aF as a,aG as ae,aK as Ge,b1 as Us,y as Es,aq as Ps,a4 as u,t as ne,n as we,aM as re,aN as ie,aO as le,aR as Xe,aS as Ze,aT as Ke,aP as oe,O as ks}from"./mui-BmK9T4iY.js";import{u as Rs,r as i}from"./vendor-DIxetjBo.js";import{u as Ns}from"./notistack.esm-Bg0Tn0tt.js";import{u as Ts,c as f,e as v}from"./index-wji9WUCF.js";import{N as zs}from"./Navigation-4-Dj3rrN.js";import{F as Ws}from"./Footer-CFQhTI6x.js";import"./stripe-6nutOR1s.js";const Gs=()=>{var Te;const{enqueueSnackbar:M}=Ns(),{user:y}=Ts();Rs();const[w,qe]=i.useState(0),[D,ce]=i.useState({totalUsers:0,activeSubscriptions:0,totalRevenue:0,pendingApprovals:0,systemHealth:"healthy"}),[T,de]=i.useState([]),[Y,H]=i.useState([]),[Fs,De]=i.useState([]),[B,Qe]=i.useState([]),[z,xe]=i.useState(1),[he,Je]=i.useState(1),[p,_]=i.useState({}),[es,ue]=i.useState(!1),[S,ss]=i.useState({}),[k,Ae]=i.useState(null),[ts,V]=i.useState(!1),[as,me]=i.useState(!1),[ns,G]=i.useState(!1),[A,X]=i.useState({userId:"",subscriptionId:"",tier:"PRO",seats:1}),[Le,Ue]=i.useState([]),[L,Ee]=i.useState(""),[U,Pe]=i.useState(""),[E,ke]=i.useState(""),je=i.useMemo(()=>{if(!L.trim())return T;const s=L.toLowerCase();return T.filter(t=>t.firstName.toLowerCase().includes(s)||t.lastName.toLowerCase().includes(s)||t.email.toLowerCase().includes(s)||t.role.toLowerCase().includes(s)||t.status.toLowerCase().includes(s)||t.subscription&&t.subscription.toLowerCase().includes(s))},[T,L]),pe=i.useMemo(()=>{if(!U.trim())return Y;const s=U.toLowerCase();return Y.filter(t=>t.key.toLowerCase().includes(s)||t.userEmail.toLowerCase().includes(s)||t.tier.toLowerCase().includes(s)||t.status.toLowerCase().includes(s)||new Date(t.expiresAt).toLocaleDateString().includes(s)||new Date(t.activatedAt).toLocaleDateString().includes(s))},[Y,U]),W=s=>{if(!s)return new Date(NaN);if(typeof s=="string")return new Date(s);if(s instanceof Date)return s;if(typeof s=="object"&&s!==null){if(typeof s._seconds=="number")return new Date(s._seconds*1e3);if(typeof s.seconds=="number")return new Date(s.seconds*1e3);if(typeof s.toDate=="function")try{return s.toDate()}catch{}}return new Date(s)},Re=s=>`$${((typeof s=="number"?s:0)/100).toFixed(2)}`,ge=i.useMemo(()=>{if(!E.trim())return B;const s=E.toLowerCase();return B.filter(t=>{var c,x;return t.id.toLowerCase().includes(s)||((c=t.user)==null?void 0:c.email)&&t.user.email.toLowerCase().includes(s)||((x=t.subscription)==null?void 0:x.tier)&&t.subscription.tier.toLowerCase().includes(s)||t.status.toLowerCase().includes(s)||W(t.createdAt).toLocaleDateString().toLowerCase().includes(s)||Re(t.amount).toLowerCase().includes(s)})},[B,E]),rs=()=>Ee(""),is=()=>Pe(""),ls=()=>ke("");i.useEffect(()=>{let s=!0;return(async()=>{var t,c,x,l,g,C,F,$,ze,We,Fe,$e,Oe;try{if(String((y==null?void 0:y.role)||"").toUpperCase()!=="SUPERADMIN"){de([]),H([]),ce(o=>({...o,systemHealth:"warning"}));return}const[ve,bs,$s,Se,fs]=await Promise.all([f.get(`${v.admin.users()}?page=1&limit=100`),f.get(`${v.admin.licenses()}?page=1&limit=500`),f.get(v.admin.paymentAnalytics()),f.get(v.admin.systemHealth()),f.get(v.admin.dashboardStats())]),Me=((c=(t=ve.data)==null?void 0:t.data)==null?void 0:c.users)??[],vs=((l=(x=bs.data)==null?void 0:x.data)==null?void 0:l.licenses)??[],R=((C=(g=fs.data)==null?void 0:g.data)==null?void 0:C.stats)??{totalRevenue:0,activeSubscriptions:0},Ss=(R==null?void 0:R.recentPayments)??[],Ye=((ze=($=(F=Se.data)==null?void 0:F.data)==null?void 0:$.health)==null?void 0:ze.overall)||((Fe=(We=Se.data)==null?void 0:We.data)==null?void 0:Fe.overall)||((Oe=($e=Se.data)==null?void 0:$e.data)==null?void 0:Oe.status)||"healthy";if(!s)return;de(Me.map(o=>{var O,He,Z,Be,_e,Ve;return{id:o.id,email:o.email,firstName:((O=o.name)==null?void 0:O.split(" ")[0])??"",lastName:((He=o.name)==null?void 0:He.split(" ").slice(1).join(" "))??"",role:o.role,status:((Be=(Z=o.status)==null?void 0:Z.toLowerCase)==null?void 0:Be.call(Z))||"active",subscription:((Ve=(_e=o.subscriptions)==null?void 0:_e[0])==null?void 0:Ve.tier)??void 0,lastLogin:o.lastLoginAt||new Date().toISOString(),createdAt:o.createdAt||new Date().toISOString()}})),H(vs.map(o=>{var O;return{id:o.id,key:o.key,userId:o.userId,userEmail:((O=o.user)==null?void 0:O.email)??"",tier:o.tier,status:String(o.status||"").toLowerCase(),activatedAt:new Date(W(o.activatedAt||o.createdAt)).toISOString(),expiresAt:new Date(W(o.expiresAt||o.createdAt)).toISOString(),lastUsed:new Date(W(o.updatedAt||o.createdAt)).toISOString()}})),ce({totalUsers:Number(R.totalUsers||Me.length)||0,activeSubscriptions:R.activeSubscriptions??0,totalRevenue:Math.round(R.totalRevenue??0)/100,pendingApprovals:0,systemHealth:Ye==="healthy"?"healthy":Ye==="degraded"?"warning":"error"}),De(Ss)}catch{if(!s)return;de([]),H([]),ce(ve=>({...ve,systemHealth:"error"})),De([])}})(),()=>{s=!1}},[y==null?void 0:y.role]);const Ne=async(s=1)=>{var g,C,F,$;const t=new URLSearchParams;t.set("page",String(s)),t.set("limit","100"),p.status&&t.set("status",p.status),p.email&&t.set("email",p.email),p.from&&t.set("from",p.from),p.to&&t.set("to",p.to);const c=await f.get(`${v.admin.payments()}?${t.toString()}`),x=((C=(g=c.data)==null?void 0:g.data)==null?void 0:C.payments)??[],l=(($=(F=c.data)==null?void 0:F.data)==null?void 0:$.pagination)??{pages:1,page:1};Qe(x),xe(l.page||s),Je(l.pages||1)};i.useEffect(()=>{String((y==null?void 0:y.role)||"").toUpperCase()==="SUPERADMIN"&&w===2&&Ne(z).catch(()=>{})},[w,z,p,y==null?void 0:y.role]);const os=async s=>{var t;try{const x=((t=(await f.get(v.admin.paymentDetails(s))).data)==null?void 0:t.data)||{};ss({payment:x.payment,licenses:x.licenses||[]}),ue(!0)}catch{M("Failed to load payment details",{variant:"error"})}},cs=s=>{Ae(s),V(!0)},ds=()=>{M("User updated successfully",{variant:"success"}),V(!1),Ae(null)},xs=()=>{me(!0)},hs=async()=>{G(!0)},us=async s=>{var t,c,x;if(X(l=>({...l,userId:s,subscriptionId:""})),s){const g=((x=(c=(t=(await f.get(v.admin.userDetails(s))).data)==null?void 0:t.data)==null?void 0:c.user)==null?void 0:x.subscriptions)||[];Ue(g.filter(C=>C.status==="ACTIVE"))}else Ue([])},ms=async()=>{var s,t;try{await f.post(v.admin.createLicense(),A),M("License(s) created",{variant:"success"}),G(!1);const x=((t=(s=(await f.get(v.admin.licenses())).data)==null?void 0:s.data)==null?void 0:t.licenses)??[];H(x.map(l=>{var g;return{id:l.id,key:l.key,userId:l.userId,userEmail:((g=l.user)==null?void 0:g.email)??"",tier:l.tier,status:(l.status||"").toLowerCase(),activatedAt:l.activatedAt||l.createdAt,expiresAt:l.expiresAt||l.createdAt,lastUsed:l.updatedAt||l.createdAt}}))}catch(c){M((c==null?void 0:c.message)||"Failed to create license",{variant:"error"})}},ye=s=>{switch(s){case"active":return"success";case"pending":return"warning";case"suspended":return"error";default:return"default"}},js=s=>{switch(String(s||"").toUpperCase()){case"SUPERADMIN":return"secondary";case"ADMIN":return"primary";default:return"default"}},be=s=>{switch(String(s||"").toUpperCase()){case"ENTERPRISE":return"secondary";case"PRO":return"success";case"BASIC":return"default";default:return"default"}},fe=s=>String(s||"").toUpperCase()==="BASIC"?"outlined":"filled",ps=s=>{switch(s){case"healthy":return"success";case"warning":return"warning";case"error":return"error";default:return"default"}},gs=s=>{switch(s){case"healthy":return e.jsx(we,{});case"warning":return e.jsx(Q,{});case"error":return e.jsx(ks,{});default:return e.jsx(Q,{})}};return e.jsxs(e.Fragment,{children:[e.jsx(zs,{}),e.jsx(n,{sx:{pt:8,pb:4},children:e.jsxs(Cs,{maxWidth:"xl",children:[e.jsxs(n,{sx:{opacity:0,transform:"translateY(20px)",animation:"fadeInUp 0.6s ease-out forwards","@keyframes fadeInUp":{"0%":{opacity:0,transform:"translateY(20px)"},"100%":{opacity:1,transform:"translateY(0)"}}},children:[e.jsxs(n,{sx:{display:"flex",alignItems:"center",gap:2,mb:4},children:[e.jsx(Is,{sx:{fontSize:32,color:"primary.main"}}),e.jsx(r,{variant:"h4",sx:{fontWeight:700},children:"Admin Dashboard"}),e.jsx(h,{icon:gs(D.systemHealth),label:`System ${D.systemHealth}`,color:ps(D.systemHealth),size:"small"})]}),e.jsxs(d,{container:!0,spacing:3,sx:{mb:4},children:[e.jsx(d,{item:!0,xs:12,sm:6,lg:3,children:e.jsx(n,{sx:{opacity:0,transform:"translateY(20px)",animation:"fadeInUp 0.6s ease-out 0.1s forwards"},children:e.jsx(K,{sx:{background:"linear-gradient(135deg, rgba(0, 212, 255, 0.1) 0%, rgba(102, 126, 234, 0.1) 100%)",border:"1px solid rgba(0, 212, 255, 0.2)"},children:e.jsxs(q,{children:[e.jsxs(n,{sx:{display:"flex",alignItems:"center",gap:2,mb:2},children:[e.jsx(ws,{sx:{color:"primary.main"}}),e.jsx(r,{variant:"h6",color:"text.secondary",children:"Total Users"})]}),e.jsx(r,{variant:"h3",sx:{fontWeight:700,color:"primary.main"},children:D.totalUsers.toLocaleString()})]})})})}),e.jsx(d,{item:!0,xs:12,sm:6,lg:3,children:e.jsx(n,{sx:{opacity:0,transform:"translateY(20px)",animation:"fadeInUp 0.6s ease-out 0.2s forwards"},children:e.jsx(K,{sx:{background:"linear-gradient(135deg, rgba(255, 255, 255, 0.1) 0%, rgba(255, 255, 255, 0.05) 100%)",border:"1px solid rgba(255, 255, 255, 0.1)"},children:e.jsxs(q,{children:[e.jsxs(n,{sx:{display:"flex",alignItems:"center",gap:2,mb:2},children:[e.jsx(Ds,{sx:{color:"secondary.main"}}),e.jsx(r,{variant:"h6",color:"text.secondary",children:"Active Subscriptions"})]}),e.jsx(r,{variant:"h3",sx:{fontWeight:700},children:D.activeSubscriptions.toLocaleString()})]})})})}),e.jsx(d,{item:!0,xs:12,sm:6,lg:3,children:e.jsx(n,{sx:{opacity:0,transform:"translateY(20px)",animation:"fadeInUp 0.6s ease-out 0.3s forwards"},children:e.jsx(K,{sx:{background:"linear-gradient(135deg, rgba(76, 175, 80, 0.1) 0%, rgba(139, 195, 74, 0.1) 100%)",border:"1px solid rgba(76, 175, 80, 0.2)"},children:e.jsxs(q,{children:[e.jsxs(n,{sx:{display:"flex",alignItems:"center",gap:2,mb:2},children:[e.jsx(As,{sx:{color:"success.main"}}),e.jsx(r,{variant:"h6",color:"text.secondary",children:"Total Revenue"})]}),e.jsxs(r,{variant:"h3",sx:{fontWeight:700,color:"success.main"},children:["$",D.totalRevenue.toLocaleString()]})]})})})}),e.jsx(d,{item:!0,xs:12,sm:6,lg:3,children:e.jsx(n,{sx:{opacity:0,transform:"translateY(20px)",animation:"fadeInUp 0.6s ease-out 0.4s forwards"},children:e.jsx(K,{sx:{background:"linear-gradient(135deg, rgba(255, 152, 0, 0.1) 0%, rgba(255, 193, 7, 0.1) 100%)",border:"1px solid rgba(255, 152, 0, 0.2)"},children:e.jsxs(q,{children:[e.jsxs(n,{sx:{display:"flex",alignItems:"center",gap:2,mb:2},children:[e.jsx(Q,{sx:{color:"warning.main"}}),e.jsx(r,{variant:"h6",color:"text.secondary",children:"Pending Approvals"})]}),e.jsx(r,{variant:"h3",sx:{fontWeight:700,color:"warning.main"},children:D.pendingApprovals})]})})})})]}),e.jsx(P,{sx:{mb:3},children:e.jsxs(Ls,{value:w,onChange:(s,t)=>qe(t),sx:{borderBottom:1,borderColor:"divider","& .MuiTab-root":{textTransform:"none",fontWeight:600}},children:[e.jsx(J,{label:"Users"}),e.jsx(J,{label:"Licenses"}),e.jsx(J,{label:"Invoices"}),e.jsx(J,{label:"System Health"})]})}),w===0&&e.jsxs(n,{sx:{opacity:0,transform:"translateY(20px)",animation:"fadeInUp 0.6s ease-out forwards"},children:[e.jsxs(n,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[e.jsx(m,{placeholder:"Search users by name, email, role, status, or subscription...",value:L,onChange:s=>Ee(s.target.value),size:"small",sx:{minWidth:400},InputProps:{startAdornment:e.jsx(N,{position:"start",children:e.jsx(Ie,{})}),endAdornment:L&&e.jsx(N,{position:"end",children:e.jsx(I,{size:"small",onClick:rs,children:e.jsx(Ce,{})})})}}),e.jsx(j,{variant:"contained",onClick:hs,children:"Add License"})]}),L&&e.jsx(n,{sx:{mb:2},children:e.jsx(h,{label:`${je.length} of ${T.length} users found`,color:"primary",variant:"outlined"})}),e.jsx(ee,{component:P,children:e.jsxs(se,{children:[e.jsx(te,{children:e.jsxs(b,{children:[e.jsx(a,{children:"User"}),e.jsx(a,{children:"Role"}),e.jsx(a,{children:"Status"}),e.jsx(a,{children:"Subscription"}),e.jsx(a,{children:"Last Login"}),e.jsx(a,{children:"Actions"})]})}),e.jsx(ae,{children:je.length>0?je.map(s=>e.jsxs(b,{children:[e.jsx(a,{children:e.jsxs(n,{children:[e.jsxs(r,{variant:"subtitle2",children:[s.firstName," ",s.lastName]}),e.jsx(r,{variant:"body2",color:"text.secondary",children:s.email})]})}),e.jsx(a,{children:e.jsx(h,{label:s.role,size:"small",color:js(s.role)})}),e.jsx(a,{children:e.jsx(h,{label:s.status,size:"small",color:ye(s.status)})}),e.jsx(a,{children:s.subscription&&e.jsx(h,{label:s.subscription,size:"small",color:be(s.subscription),variant:fe(s.subscription)})}),e.jsx(a,{children:e.jsx(r,{variant:"body2",children:new Date(s.lastLogin).toLocaleDateString()})}),e.jsxs(a,{children:[e.jsx(I,{size:"small",onClick:()=>cs(s),children:e.jsx(Ge,{})}),e.jsx(I,{size:"small",color:"error",children:e.jsx(Us,{})})]})]},s.id)):e.jsx(b,{children:e.jsx(a,{colSpan:6,align:"center",children:e.jsx(n,{sx:{py:4},children:e.jsx(r,{variant:"body1",color:"text.secondary",children:L?"No users found matching your search criteria.":"No users available."})})})})})]})})]}),w===1&&e.jsxs(n,{sx:{opacity:0,transform:"translateY(20px)",animation:"fadeInUp 0.6s ease-out forwards"},children:[e.jsx(n,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:e.jsx(m,{placeholder:"Search licenses by key, user email, tier, status, or dates...",value:U,onChange:s=>Pe(s.target.value),size:"small",sx:{minWidth:400},InputProps:{startAdornment:e.jsx(N,{position:"start",children:e.jsx(Ie,{})}),endAdornment:U&&e.jsx(N,{position:"end",children:e.jsx(I,{size:"small",onClick:is,children:e.jsx(Ce,{})})})}})}),U&&e.jsx(n,{sx:{mb:2},children:e.jsx(h,{label:`${pe.length} of ${Y.length} licenses found`,color:"primary",variant:"outlined"})}),e.jsx(ee,{component:P,children:e.jsxs(se,{children:[e.jsx(te,{children:e.jsxs(b,{children:[e.jsx(a,{children:"License Key"}),e.jsx(a,{children:"User"}),e.jsx(a,{children:"Tier"}),e.jsx(a,{children:"Status"}),e.jsx(a,{children:"Expires"}),e.jsx(a,{children:"Actions"})]})}),e.jsx(ae,{children:pe.length>0?pe.map(s=>e.jsxs(b,{children:[e.jsx(a,{children:e.jsx(r,{variant:"body2",fontFamily:"monospace",children:s.key})}),e.jsx(a,{children:e.jsx(r,{variant:"body2",children:s.userEmail})}),e.jsx(a,{children:e.jsx(h,{label:s.tier,size:"small",color:be(s.tier),variant:fe(s.tier)})}),e.jsx(a,{children:e.jsx(h,{label:s.status,size:"small",color:ye(String(s.status).toLowerCase())})}),e.jsx(a,{children:e.jsx(r,{variant:"body2",children:new Date(s.expiresAt).toLocaleDateString()})}),e.jsxs(a,{children:[e.jsx(I,{size:"small",onClick:()=>xs(),children:e.jsx(Ge,{})}),e.jsx(I,{size:"small",children:e.jsx(Es,{})}),e.jsx(I,{size:"small",children:e.jsx(Ps,{})})]})]},s.id)):e.jsx(b,{children:e.jsx(a,{colSpan:6,align:"center",children:e.jsx(n,{sx:{py:4},children:e.jsx(r,{variant:"body1",color:"text.secondary",children:U?"No licenses found matching your search criteria.":"No licenses available."})})})})})]})})]}),w===2&&e.jsxs(n,{sx:{opacity:0,transform:"translateY(20px)",animation:"fadeInUp 0.6s ease-out forwards"},children:[e.jsxs(n,{sx:{display:"flex",flexDirection:"column",gap:2,mb:2},children:[e.jsxs(n,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsx(m,{placeholder:"Search payments by ID, email, tier, status, amount, or date...",value:E,onChange:s=>ke(s.target.value),size:"small",sx:{minWidth:400},InputProps:{startAdornment:e.jsx(N,{position:"start",children:e.jsx(Ie,{})}),endAdornment:E&&e.jsx(N,{position:"end",children:e.jsx(I,{size:"small",onClick:ls,children:e.jsx(Ce,{})})})}}),E&&e.jsx(h,{label:`${ge.length} of ${B.length} payments found`,color:"primary",variant:"outlined"})]}),e.jsxs(n,{sx:{display:"flex",gap:2,flexWrap:"wrap"},children:[e.jsx(m,{label:"Filter by Email",size:"small",value:p.email||"",onChange:s=>_(t=>({...t,email:s.target.value}))}),e.jsx(m,{label:"From",size:"small",type:"date",InputLabelProps:{shrink:!0},value:p.from||"",onChange:s=>_(t=>({...t,from:s.target.value}))}),e.jsx(m,{label:"To",size:"small",type:"date",InputLabelProps:{shrink:!0},value:p.to||"",onChange:s=>_(t=>({...t,to:s.target.value}))}),e.jsxs(m,{label:"Status",select:!0,size:"small",value:p.status||"",onChange:s=>_(t=>({...t,status:s.target.value||void 0})),sx:{minWidth:160},children:[e.jsx(u,{value:"",children:"All"}),e.jsx(u,{value:"SUCCEEDED",children:"SUCCEEDED"}),e.jsx(u,{value:"PENDING",children:"PENDING"}),e.jsx(u,{value:"FAILED",children:"FAILED"}),e.jsx(u,{value:"REFUNDED",children:"REFUNDED"})]}),e.jsx(j,{variant:"outlined",onClick:()=>Ne(1),children:"Apply Filters"})]})]}),e.jsx(ee,{component:P,children:e.jsxs(se,{children:[e.jsx(te,{children:e.jsxs(b,{children:[e.jsx(a,{children:"Payment ID"}),e.jsx(a,{children:"User"}),e.jsx(a,{children:"Tier"}),e.jsx(a,{children:"Amount"}),e.jsx(a,{children:"Status"}),e.jsx(a,{children:"Date"}),e.jsx(a,{children:"Invoice"}),e.jsx(a,{children:"Details"})]})}),e.jsx(ae,{children:ge.length>0?ge.map(s=>{var t,c,x,l;return e.jsxs(b,{children:[e.jsx(a,{children:e.jsx(r,{variant:"body2",fontFamily:"monospace",children:s.id})}),e.jsx(a,{children:e.jsx(r,{variant:"body2",children:((t=s.user)==null?void 0:t.email)||"—"})}),e.jsx(a,{children:e.jsx(h,{size:"small",label:((c=s.subscription)==null?void 0:c.tier)||"—",color:be((x=s.subscription)==null?void 0:x.tier),variant:fe((l=s.subscription)==null?void 0:l.tier)})}),e.jsx(a,{children:e.jsx(r,{variant:"body2",children:Re(s.amount)})}),e.jsx(a,{children:e.jsx(h,{size:"small",label:s.status,color:s.status==="SUCCEEDED"?"success":s.status==="FAILED"?"error":"default"})}),e.jsx(a,{children:e.jsx(r,{variant:"body2",children:W(s.createdAt).toLocaleDateString()})}),e.jsx(a,{children:s.stripeInvoiceId?e.jsx(j,{size:"small",variant:"outlined",onClick:()=>{const g=localStorage.getItem("auth_token"),C=`/api/invoices/${s.stripeInvoiceId}/pdf${g?`?token=${encodeURIComponent(g)}`:""}`;window.open(C,"_blank")},children:"View"}):s.receiptUrl?e.jsx(j,{size:"small",variant:"outlined",onClick:()=>window.open(s.receiptUrl,"_blank"),children:"View"}):e.jsx(r,{variant:"body2",color:"text.secondary",children:"N/A"})}),e.jsx(a,{children:e.jsx(j,{size:"small",onClick:()=>os(s.id),children:"Open"})})]},s.id)}):e.jsx(b,{children:e.jsx(a,{colSpan:8,align:"center",children:e.jsx(n,{sx:{py:4},children:e.jsx(r,{variant:"body1",color:"text.secondary",children:E?"No payments found matching your search criteria.":"No payments available."})})})})})]})}),e.jsxs(n,{sx:{display:"flex",gap:1,justifyContent:"flex-end",mt:2},children:[e.jsx(j,{disabled:z<=1,onClick:()=>xe(s=>Math.max(1,s-1)),children:"Prev"}),e.jsx(h,{label:`Page ${z} of ${he}`}),e.jsx(j,{disabled:z>=he,onClick:()=>xe(s=>Math.min(he,s+1)),children:"Next"})]})]}),w===3&&e.jsx(n,{sx:{opacity:0,transform:"translateY(20px)",animation:"fadeInUp 0.6s ease-out forwards"},children:e.jsxs(d,{container:!0,spacing:3,children:[e.jsx(d,{item:!0,xs:12,md:6,children:e.jsxs(P,{sx:{p:3},children:[e.jsx(r,{variant:"h6",sx:{mb:2},children:"System Status"}),e.jsx(ne,{severity:"success",sx:{mb:2},children:"All systems operational"}),e.jsx(ne,{severity:"info",sx:{mb:2},children:"Database connection: Healthy"}),e.jsx(ne,{severity:"info",sx:{mb:2},children:"API response time: 45ms"}),e.jsx(ne,{severity:"warning",children:"Storage usage: 78% (Consider cleanup)"})]})}),e.jsx(d,{item:!0,xs:12,md:6,children:e.jsxs(P,{sx:{p:3},children:[e.jsx(r,{variant:"h6",sx:{mb:2},children:"Recent Activity"}),e.jsxs(n,{sx:{display:"flex",flexDirection:"column",gap:2},children:[e.jsxs(n,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsx(we,{color:"success"}),e.jsx(r,{variant:"body2",children:"New user registration: john.doe@company.com"})]}),e.jsxs(n,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsx(we,{color:"success"}),e.jsx(r,{variant:"body2",children:"License activated: LIC-XXXX-YYYY-ZZZZ-0001"})]}),e.jsxs(n,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsx(Q,{color:"warning"}),e.jsx(r,{variant:"body2",children:"Payment failed: jane.smith@startup.io"})]})]})]})})]})})]}),e.jsxs(re,{open:ts,onClose:()=>V(!1),maxWidth:"sm",fullWidth:!0,children:[e.jsx(ie,{children:"Edit User"}),e.jsx(le,{children:k&&e.jsxs(d,{container:!0,spacing:3,sx:{mt:1},children:[e.jsx(d,{item:!0,xs:12,sm:6,children:e.jsx(m,{fullWidth:!0,label:"First Name",value:k.firstName})}),e.jsx(d,{item:!0,xs:12,sm:6,children:e.jsx(m,{fullWidth:!0,label:"Last Name",value:k.lastName})}),e.jsx(d,{item:!0,xs:12,children:e.jsx(m,{fullWidth:!0,label:"Email",value:k.email})}),e.jsx(d,{item:!0,xs:12,sm:6,children:e.jsxs(Xe,{fullWidth:!0,children:[e.jsx(Ze,{children:"Role"}),e.jsxs(Ke,{value:k.role,label:"Role",inputProps:{"aria-label":"Select user role",title:"Choose the user role"},children:[e.jsx(u,{value:"USER",children:"User"}),e.jsx(u,{value:"ADMIN",children:"Admin"})]})]})}),e.jsx(d,{item:!0,xs:12,sm:6,children:e.jsxs(Xe,{fullWidth:!0,children:[e.jsx(Ze,{children:"Status"}),e.jsxs(Ke,{value:k.status,label:"Status",inputProps:{"aria-label":"Select user status",title:"Choose the user status"},children:[e.jsx(u,{value:"active",children:"Active"}),e.jsx(u,{value:"suspended",children:"Suspended"}),e.jsx(u,{value:"pending",children:"Pending"})]})]})})]})}),e.jsxs(oe,{children:[e.jsx(j,{onClick:()=>V(!1),children:"Cancel"}),e.jsx(j,{onClick:ds,variant:"contained",children:"Save Changes"})]})]}),e.jsxs(re,{open:es,onClose:()=>ue(!1),maxWidth:"md",fullWidth:!0,children:[e.jsx(ie,{children:"Payment Details"}),e.jsx(le,{children:S.payment?e.jsxs(n,{sx:{display:"flex",flexDirection:"column",gap:2},children:[e.jsxs(n,{sx:{display:"flex",gap:2,flexWrap:"wrap"},children:[e.jsx(h,{label:`ID: ${S.payment.id}`}),e.jsx(h,{label:`User: ${((Te=S.payment.user)==null?void 0:Te.email)||"—"}`}),e.jsx(h,{label:`Amount: $${(S.payment.amount/100).toFixed(2)}`}),e.jsx(h,{label:`Status: ${S.payment.status}`}),e.jsx(h,{label:`Date: ${new Date(S.payment.createdAt).toLocaleString()}`}),S.payment.receiptUrl&&e.jsx(j,{size:"small",variant:"outlined",onClick:()=>window.open(S.payment.receiptUrl,"_blank"),children:"View Invoice"})]}),e.jsx(r,{variant:"subtitle2",children:"Related Licenses"}),e.jsx(ee,{component:P,children:e.jsxs(se,{size:"small",children:[e.jsx(te,{children:e.jsxs(b,{children:[e.jsx(a,{children:"License Key"}),e.jsx(a,{children:"Status"}),e.jsx(a,{children:"Activated"}),e.jsx(a,{children:"Expires"})]})}),e.jsx(ae,{children:(S.licenses||[]).map(s=>e.jsxs(b,{children:[e.jsx(a,{children:e.jsx(r,{variant:"body2",fontFamily:"monospace",children:s.key})}),e.jsx(a,{children:e.jsx(h,{size:"small",label:s.status,color:ye(String(s.status).toLowerCase())})}),e.jsx(a,{children:s.activatedAt?new Date(s.activatedAt).toLocaleDateString():"—"}),e.jsx(a,{children:s.expiresAt?new Date(s.expiresAt).toLocaleDateString():"—"})]},s.id))})]})})]}):e.jsx(r,{variant:"body2",color:"text.secondary",children:"No details."})}),e.jsx(oe,{children:e.jsx(j,{onClick:()=>ue(!1),children:"Close"})})]}),e.jsxs(re,{open:as,onClose:()=>me(!1),maxWidth:"sm",fullWidth:!0,children:[e.jsx(ie,{children:"Edit License"}),e.jsx(le,{children:e.jsx(r,{variant:"body2",color:"text.secondary",sx:{mb:2},children:"License management options will be available here."})}),e.jsx(oe,{children:e.jsx(j,{onClick:()=>me(!1),children:"Close"})})]}),e.jsxs(re,{open:ns,onClose:()=>G(!1),maxWidth:"sm",fullWidth:!0,children:[e.jsx(ie,{children:"Add License"}),e.jsx(le,{children:e.jsxs(d,{container:!0,spacing:2,sx:{mt:.5},children:[e.jsx(d,{item:!0,xs:12,children:e.jsx(m,{select:!0,fullWidth:!0,label:"User",value:A.userId,onChange:s=>us(s.target.value),children:T.map(s=>e.jsx(u,{value:s.id,children:s.email},s.id))})}),e.jsx(d,{item:!0,xs:12,children:e.jsx(m,{select:!0,fullWidth:!0,label:"Subscription",value:A.subscriptionId,onChange:s=>X(t=>({...t,subscriptionId:s.target.value})),disabled:!Le.length,children:Le.map(s=>e.jsxs(u,{value:s.id,children:[s.tier," — seats ",s.seats]},s.id))})}),e.jsx(d,{item:!0,xs:6,children:e.jsxs(m,{select:!0,fullWidth:!0,label:"Tier",value:A.tier,onChange:s=>X(t=>({...t,tier:s.target.value})),children:[e.jsx(u,{value:"BASIC",children:"BASIC"}),e.jsx(u,{value:"PRO",children:"PRO"}),e.jsx(u,{value:"ENTERPRISE",children:"ENTERPRISE"})]})}),e.jsx(d,{item:!0,xs:6,children:e.jsx(m,{fullWidth:!0,type:"number",label:"Seats",inputProps:{min:1,max:1e3},value:A.seats,onChange:s=>X(t=>({...t,seats:Math.max(1,Math.min(1e3,parseInt(s.target.value)||1))}))})})]})}),e.jsxs(oe,{children:[e.jsx(j,{onClick:()=>G(!1),children:"Cancel"}),e.jsx(j,{variant:"contained",onClick:ms,disabled:!A.userId||!A.subscriptionId,children:"Create"})]})]})]})}),e.jsx(Ws,{})]})};export{Gs as default};
