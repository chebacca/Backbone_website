import{bN as Zt,bO as es,bP as _t,j as e,a as g,b as ts,an as ss,T as S,h as E,G as w,k as ge,l as je,au as is,bQ as rs,aa as ns,aQ as Ze,c as ue,b9 as as,ba as Ae,u as B,v as pe,I as re,bR as et,az as tt,d as M,aB as Te,aC as Ce,aD as Re,aE as J,aF as u,aG as ke,aK as It,b1 as ls,a4 as L,F as os,a1 as cs,bS as ds,y as hs,aq as us,aM as Ne,aN as Pe,aO as Ue,aR as Ct,aS as wt,aT as zt,aP as Oe,O as ms,n as xs,t as ps}from"./mui-tD5_pp2G.js";import{r as b,u as fs}from"./vendor-DIxetjBo.js";import{u as gs}from"./notistack.esm-Bg0Tn0tt.js";import{u as js,c as q,e as V}from"./index-DfQOZwGY.js";import{N as vs}from"./Navigation-0cHEOEUC.js";import{F as ys}from"./Footer-CiyRi9rg.js";import"./stripe-d5qSedlv.js";let K;typeof window<"u"?K=window:typeof self<"u"?K=self:K=global;let at=null,lt=null;const Lt=20,st=K.clearTimeout,Et=K.setTimeout,it=K.cancelAnimationFrame||K.mozCancelAnimationFrame||K.webkitCancelAnimationFrame,Dt=K.requestAnimationFrame||K.mozRequestAnimationFrame||K.webkitRequestAnimationFrame;it==null||Dt==null?(at=st,lt=function(s){return Et(s,Lt)}):(at=function([s,n]){it(s),st(n)},lt=function(s){const n=Dt(function(){st(m),s()}),m=Et(function(){it(n),s()},Lt);return[n,m]});function bs(d){let s,n,m,x,A,D,T;const P=typeof document<"u"&&document.attachEvent;if(!P){D=function(a){const h=a.__resizeTriggers__,p=h.firstElementChild,v=h.lastElementChild,f=p.firstElementChild;v.scrollLeft=v.scrollWidth,v.scrollTop=v.scrollHeight,f.style.width=p.offsetWidth+1+"px",f.style.height=p.offsetHeight+1+"px",p.scrollLeft=p.scrollWidth,p.scrollTop=p.scrollHeight},A=function(a){return a.offsetWidth!==a.__resizeLast__.width||a.offsetHeight!==a.__resizeLast__.height},T=function(a){if(a.target.className&&typeof a.target.className.indexOf=="function"&&a.target.className.indexOf("contract-trigger")<0&&a.target.className.indexOf("expand-trigger")<0)return;const h=this;D(this),this.__resizeRAF__&&at(this.__resizeRAF__),this.__resizeRAF__=lt(function(){A(h)&&(h.__resizeLast__.width=h.offsetWidth,h.__resizeLast__.height=h.offsetHeight,h.__resizeListeners__.forEach(function(f){f.call(h,a)}))})};let o=!1,_="";m="animationstart";const j="Webkit Moz O ms".split(" ");let i="webkitAnimationStart animationstart oAnimationStart MSAnimationStart".split(" "),l="";{const a=document.createElement("fakeelement");if(a.style.animationName!==void 0&&(o=!0),o===!1){for(let h=0;h<j.length;h++)if(a.style[j[h]+"AnimationName"]!==void 0){l=j[h],_="-"+l.toLowerCase()+"-",m=i[h],o=!0;break}}}n="resizeanim",s="@"+_+"keyframes "+n+" { from { opacity: 0; } to { opacity: 0; } } ",x=_+"animation: 1ms "+n+"; "}const U=function(o){if(!o.getElementById("detectElementResize")){const _=(s||"")+".resize-triggers { "+(x||"")+'visibility: hidden; opacity: 0; } .resize-triggers, .resize-triggers > div, .contract-trigger:before { content: " "; display: block; position: absolute; top: 0; left: 0; height: 100%; width: 100%; overflow: hidden; z-index: -1; } .resize-triggers > div { background: #eee; overflow: auto; } .contract-trigger:before { width: 200%; height: 200%; }',j=o.head||o.getElementsByTagName("head")[0],i=o.createElement("style");i.id="detectElementResize",i.type="text/css",d!=null&&i.setAttribute("nonce",d),i.styleSheet?i.styleSheet.cssText=_:i.appendChild(o.createTextNode(_)),j.appendChild(i)}};return{addResizeListener:function(o,_){if(P)o.attachEvent("onresize",_);else{if(!o.__resizeTriggers__){const j=o.ownerDocument,i=K.getComputedStyle(o);i&&i.position==="static"&&(o.style.position="relative"),U(j),o.__resizeLast__={},o.__resizeListeners__=[],(o.__resizeTriggers__=j.createElement("div")).className="resize-triggers";const l=j.createElement("div");l.className="expand-trigger",l.appendChild(j.createElement("div"));const a=j.createElement("div");a.className="contract-trigger",o.__resizeTriggers__.appendChild(l),o.__resizeTriggers__.appendChild(a),o.appendChild(o.__resizeTriggers__),D(o),o.addEventListener("scroll",T,!0),m&&(o.__resizeTriggers__.__animationListener__=function(p){p.animationName===n&&D(o)},o.__resizeTriggers__.addEventListener(m,o.__resizeTriggers__.__animationListener__))}o.__resizeListeners__.push(_)}},removeResizeListener:function(o,_){if(P)o.detachEvent("onresize",_);else if(o.__resizeListeners__.splice(o.__resizeListeners__.indexOf(_),1),!o.__resizeListeners__.length){o.removeEventListener("scroll",T,!0),o.__resizeTriggers__.__animationListener__&&(o.__resizeTriggers__.removeEventListener(m,o.__resizeTriggers__.__animationListener__),o.__resizeTriggers__.__animationListener__=null);try{o.__resizeTriggers__=!o.removeChild(o.__resizeTriggers__)}catch{}}}}}class Ss extends b.Component{constructor(...s){super(...s),this.state={height:this.props.defaultHeight||0,width:this.props.defaultWidth||0},this._autoSizer=null,this._detectElementResize=null,this._didLogDeprecationWarning=!1,this._parentNode=null,this._resizeObserver=null,this._timeoutId=null,this._onResize=()=>{this._timeoutId=null;const{disableHeight:n,disableWidth:m,onResize:x}=this.props;if(this._parentNode){const A=window.getComputedStyle(this._parentNode)||{},D=parseFloat(A.paddingLeft||"0"),T=parseFloat(A.paddingRight||"0"),P=parseFloat(A.paddingTop||"0"),U=parseFloat(A.paddingBottom||"0"),R=this._parentNode.getBoundingClientRect(),W=R.height-P-U,o=R.width-D-T;if(!n&&this.state.height!==W||!m&&this.state.width!==o){this.setState({height:W,width:o});const _=()=>{this._didLogDeprecationWarning||(this._didLogDeprecationWarning=!0,console.warn("scaledWidth and scaledHeight parameters have been deprecated; use width and height instead"))};typeof x=="function"&&x({height:W,width:o,get scaledHeight(){return _(),W},get scaledWidth(){return _(),o}})}}},this._setRef=n=>{this._autoSizer=n}}componentDidMount(){const{nonce:s}=this.props,n=this._autoSizer?this._autoSizer.parentNode:null;if(n!=null&&n.ownerDocument&&n.ownerDocument.defaultView&&n instanceof n.ownerDocument.defaultView.HTMLElement){this._parentNode=n;const m=n.ownerDocument.defaultView.ResizeObserver;m!=null?(this._resizeObserver=new m(()=>{this._timeoutId=setTimeout(this._onResize,0)}),this._resizeObserver.observe(n)):(this._detectElementResize=bs(s),this._detectElementResize.addResizeListener(n,this._onResize)),this._onResize()}}componentWillUnmount(){this._parentNode&&(this._detectElementResize&&this._detectElementResize.removeResizeListener(this._parentNode,this._onResize),this._timeoutId!==null&&clearTimeout(this._timeoutId),this._resizeObserver&&this._resizeObserver.disconnect())}render(){const{children:s,defaultHeight:n,defaultWidth:m,disableHeight:x=!1,disableWidth:A=!1,doNotBailOutOnEmptyChildren:D=!1,nonce:T,onResize:P,style:U={},tagName:R="div",...W}=this.props,{height:o,width:_}=this.state,j={overflow:"visible"},i={};let l=!1;return x||(o===0&&(l=!0),j.height=0,i.height=o,i.scaledHeight=o),A||(_===0&&(l=!0),j.width=0,i.width=_,i.scaledWidth=_),D&&(l=!1),b.createElement(R,{ref:this._setRef,style:{...j,...U},...W},!l&&s(i))}}var At=Number.isNaN||function(s){return typeof s=="number"&&s!==s};function _s(d,s){return!!(d===s||At(d)&&At(s))}function Is(d,s){if(d.length!==s.length)return!1;for(var n=0;n<d.length;n++)if(!_s(d[n],s[n]))return!1;return!0}function rt(d,s){s===void 0&&(s=Is);var n,m=[],x,A=!1;function D(){for(var T=[],P=0;P<arguments.length;P++)T[P]=arguments[P];return A&&n===this&&s(T,m)||(x=d.apply(this,T),A=!0,n=this,m=T),x}return D}var Cs=typeof performance=="object"&&typeof performance.now=="function",Tt=Cs?function(){return performance.now()}:function(){return Date.now()};function Rt(d){cancelAnimationFrame(d.id)}function ws(d,s){var n=Tt();function m(){Tt()-n>=s?d.call(null):x.id=requestAnimationFrame(m)}var x={id:requestAnimationFrame(m)};return x}var nt=-1;function kt(d){if(d===void 0&&(d=!1),nt===-1||d){var s=document.createElement("div"),n=s.style;n.width="50px",n.height="50px",n.overflow="scroll",document.body.appendChild(s),nt=s.offsetWidth-s.clientWidth,document.body.removeChild(s)}return nt}var fe=null;function Nt(d){if(d===void 0&&(d=!1),fe===null||d){var s=document.createElement("div"),n=s.style;n.width="50px",n.height="50px",n.overflow="scroll",n.direction="rtl";var m=document.createElement("div"),x=m.style;return x.width="100px",x.height="100px",s.appendChild(m),document.body.appendChild(s),s.scrollLeft>0?fe="positive-descending":(s.scrollLeft=1,s.scrollLeft===0?fe="negative":fe="positive-ascending"),document.body.removeChild(s),fe}return fe}var zs=150,Ls=function(s,n){return s};function Es(d){var s,n=d.getItemOffset,m=d.getEstimatedTotalSize,x=d.getItemSize,A=d.getOffsetForIndexAndAlignment,D=d.getStartIndexForOffset,T=d.getStopIndexForStartIndex,P=d.initInstanceProps,U=d.shouldResetStyleCacheOnItemSizeChange,R=d.validateProps;return s=function(W){Zt(o,W);function o(j){var i;return i=W.call(this,j)||this,i._instanceProps=P(i.props,_t(i)),i._outerRef=void 0,i._resetIsScrollingTimeoutId=null,i.state={instance:_t(i),isScrolling:!1,scrollDirection:"forward",scrollOffset:typeof i.props.initialScrollOffset=="number"?i.props.initialScrollOffset:0,scrollUpdateWasRequested:!1},i._callOnItemsRendered=void 0,i._callOnItemsRendered=rt(function(l,a,h,p){return i.props.onItemsRendered({overscanStartIndex:l,overscanStopIndex:a,visibleStartIndex:h,visibleStopIndex:p})}),i._callOnScroll=void 0,i._callOnScroll=rt(function(l,a,h){return i.props.onScroll({scrollDirection:l,scrollOffset:a,scrollUpdateWasRequested:h})}),i._getItemStyle=void 0,i._getItemStyle=function(l){var a=i.props,h=a.direction,p=a.itemSize,v=a.layout,f=i._getItemStyleCache(U&&p,U&&v,U&&h),z;if(f.hasOwnProperty(l))z=f[l];else{var k=n(i.props,l,i._instanceProps),O=x(i.props,l,i._instanceProps),Y=h==="horizontal"||v==="horizontal",G=h==="rtl",ne=Y?k:0;f[l]=z={position:"absolute",left:G?void 0:ne,right:G?ne:void 0,top:Y?0:k,height:Y?"100%":O,width:Y?O:"100%"}}return z},i._getItemStyleCache=void 0,i._getItemStyleCache=rt(function(l,a,h){return{}}),i._onScrollHorizontal=function(l){var a=l.currentTarget,h=a.clientWidth,p=a.scrollLeft,v=a.scrollWidth;i.setState(function(f){if(f.scrollOffset===p)return null;var z=i.props.direction,k=p;if(z==="rtl")switch(Nt()){case"negative":k=-p;break;case"positive-descending":k=v-h-p;break}return k=Math.max(0,Math.min(k,v-h)),{isScrolling:!0,scrollDirection:f.scrollOffset<k?"forward":"backward",scrollOffset:k,scrollUpdateWasRequested:!1}},i._resetIsScrollingDebounced)},i._onScrollVertical=function(l){var a=l.currentTarget,h=a.clientHeight,p=a.scrollHeight,v=a.scrollTop;i.setState(function(f){if(f.scrollOffset===v)return null;var z=Math.max(0,Math.min(v,p-h));return{isScrolling:!0,scrollDirection:f.scrollOffset<z?"forward":"backward",scrollOffset:z,scrollUpdateWasRequested:!1}},i._resetIsScrollingDebounced)},i._outerRefSetter=function(l){var a=i.props.outerRef;i._outerRef=l,typeof a=="function"?a(l):a!=null&&typeof a=="object"&&a.hasOwnProperty("current")&&(a.current=l)},i._resetIsScrollingDebounced=function(){i._resetIsScrollingTimeoutId!==null&&Rt(i._resetIsScrollingTimeoutId),i._resetIsScrollingTimeoutId=ws(i._resetIsScrolling,zs)},i._resetIsScrolling=function(){i._resetIsScrollingTimeoutId=null,i.setState({isScrolling:!1},function(){i._getItemStyleCache(-1,null)})},i}o.getDerivedStateFromProps=function(i,l){return Ds(i,l),R(i),null};var _=o.prototype;return _.scrollTo=function(i){i=Math.max(0,i),this.setState(function(l){return l.scrollOffset===i?null:{scrollDirection:l.scrollOffset<i?"forward":"backward",scrollOffset:i,scrollUpdateWasRequested:!0}},this._resetIsScrollingDebounced)},_.scrollToItem=function(i,l){l===void 0&&(l="auto");var a=this.props,h=a.itemCount,p=a.layout,v=this.state.scrollOffset;i=Math.max(0,Math.min(i,h-1));var f=0;if(this._outerRef){var z=this._outerRef;p==="vertical"?f=z.scrollWidth>z.clientWidth?kt():0:f=z.scrollHeight>z.clientHeight?kt():0}this.scrollTo(A(this.props,i,l,v,this._instanceProps,f))},_.componentDidMount=function(){var i=this.props,l=i.direction,a=i.initialScrollOffset,h=i.layout;if(typeof a=="number"&&this._outerRef!=null){var p=this._outerRef;l==="horizontal"||h==="horizontal"?p.scrollLeft=a:p.scrollTop=a}this._callPropsCallbacks()},_.componentDidUpdate=function(){var i=this.props,l=i.direction,a=i.layout,h=this.state,p=h.scrollOffset,v=h.scrollUpdateWasRequested;if(v&&this._outerRef!=null){var f=this._outerRef;if(l==="horizontal"||a==="horizontal")if(l==="rtl")switch(Nt()){case"negative":f.scrollLeft=-p;break;case"positive-ascending":f.scrollLeft=p;break;default:var z=f.clientWidth,k=f.scrollWidth;f.scrollLeft=k-z-p;break}else f.scrollLeft=p;else f.scrollTop=p}this._callPropsCallbacks()},_.componentWillUnmount=function(){this._resetIsScrollingTimeoutId!==null&&Rt(this._resetIsScrollingTimeoutId)},_.render=function(){var i=this.props,l=i.children,a=i.className,h=i.direction,p=i.height,v=i.innerRef,f=i.innerElementType,z=i.innerTagName,k=i.itemCount,O=i.itemData,Y=i.itemKey,G=Y===void 0?Ls:Y,ne=i.layout,We=i.outerElementType,me=i.outerTagName,Me=i.style,ve=i.useIsScrolling,$e=i.width,ae=this.state.isScrolling,Q=h==="horizontal"||ne==="horizontal",xe=Q?this._onScrollHorizontal:this._onScrollVertical,ye=this._getRangeToRender(),we=ye[0],I=ye[1],le=[];if(k>0)for(var ee=we;ee<=I;ee++)le.push(b.createElement(l,{data:O,key:G(ee,O),index:ee,isScrolling:ve?ae:void 0,style:this._getItemStyle(ee)}));var be=m(this.props,this._instanceProps);return b.createElement(We||me||"div",{className:a,onScroll:xe,ref:this._outerRefSetter,style:es({position:"relative",height:p,width:$e,overflow:"auto",WebkitOverflowScrolling:"touch",willChange:"transform",direction:h},Me)},b.createElement(f||z||"div",{children:le,ref:v,style:{height:Q?"100%":be,pointerEvents:ae?"none":void 0,width:Q?be:"100%"}}))},_._callPropsCallbacks=function(){if(typeof this.props.onItemsRendered=="function"){var i=this.props.itemCount;if(i>0){var l=this._getRangeToRender(),a=l[0],h=l[1],p=l[2],v=l[3];this._callOnItemsRendered(a,h,p,v)}}if(typeof this.props.onScroll=="function"){var f=this.state,z=f.scrollDirection,k=f.scrollOffset,O=f.scrollUpdateWasRequested;this._callOnScroll(z,k,O)}},_._getRangeToRender=function(){var i=this.props,l=i.itemCount,a=i.overscanCount,h=this.state,p=h.isScrolling,v=h.scrollDirection,f=h.scrollOffset;if(l===0)return[0,0,0,0];var z=D(this.props,f,this._instanceProps),k=T(this.props,z,f,this._instanceProps),O=!p||v==="backward"?Math.max(1,a):1,Y=!p||v==="forward"?Math.max(1,a):1;return[Math.max(0,z-O),Math.max(0,Math.min(l-1,k+Y)),z,k]},o}(b.PureComponent),s.defaultProps={direction:"ltr",itemData:void 0,layout:"vertical",overscanCount:2,useIsScrolling:!1},s}var Ds=function(s,n){s.children,s.direction,s.height,s.layout,s.innerTagName,s.outerTagName,s.width,n.instance},As=Es({getItemOffset:function(s,n){var m=s.itemSize;return n*m},getItemSize:function(s,n){var m=s.itemSize;return m},getEstimatedTotalSize:function(s){var n=s.itemCount,m=s.itemSize;return m*n},getOffsetForIndexAndAlignment:function(s,n,m,x,A,D){var T=s.direction,P=s.height,U=s.itemCount,R=s.itemSize,W=s.layout,o=s.width,_=T==="horizontal"||W==="horizontal",j=_?o:P,i=Math.max(0,U*R-j),l=Math.min(i,n*R),a=Math.max(0,n*R-j+R+D);switch(m==="smart"&&(x>=a-j&&x<=l+j?m="auto":m="center"),m){case"start":return l;case"end":return a;case"center":{var h=Math.round(a+(l-a)/2);return h<Math.ceil(j/2)?0:h>i+Math.floor(j/2)?i:h}case"auto":default:return x>=a&&x<=l?x:x<a?a:l}},getStartIndexForOffset:function(s,n){var m=s.itemCount,x=s.itemSize;return Math.max(0,Math.min(m-1,Math.floor(n/x)))},getStopIndexForStartIndex:function(s,n,m){var x=s.direction,A=s.height,D=s.itemCount,T=s.itemSize,P=s.layout,U=s.width,R=x==="horizontal"||P==="horizontal",W=n*T,o=R?U:A,_=Math.ceil((o+m-W)/T);return Math.max(0,Math.min(D-1,n+_-1))},initInstanceProps:function(s){},shouldResetStyleCacheOnItemSizeChange:!0,validateProps:function(s){s.itemSize}});const Fe=({title:d,data:s})=>{const n=(s==null?void 0:s.status)==="healthy"?"success":(s==null?void 0:s.status)==="degraded"?"warning":(s==null?void 0:s.status)==="unhealthy"?"error":"default";return e.jsx(ge,{variant:"outlined",children:e.jsxs(je,{children:[e.jsxs(g,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mb:1},children:[e.jsx(S,{variant:"subtitle1",children:d}),e.jsx(E,{size:"small",label:((s==null?void 0:s.status)||"unknown").toUpperCase(),color:n})]}),e.jsxs(w,{container:!0,spacing:2,children:[e.jsx(w,{item:!0,xs:12,sm:6,children:e.jsxs(S,{variant:"body2",color:"text.secondary",children:["Response time: ",(s==null?void 0:s.responseTimeMs)!=null?`${s.responseTimeMs} ms`:"—"]})}),e.jsx(w,{item:!0,xs:12,sm:6,children:e.jsx(S,{variant:"body2",color:"text.secondary",children:(s==null?void 0:s.message)||""})}),(s==null?void 0:s.error)&&e.jsx(w,{item:!0,xs:12,children:e.jsx(ps,{severity:"warning",children:s.error})})]})]})})},Fs=()=>{var pt,ft;const{enqueueSnackbar:d}=gs(),{user:s}=js();fs();const[n,m]=b.useState(0),[x,A]=b.useState({totalUsers:0,activeSubscriptions:0,totalRevenue:0,pendingApprovals:0,systemHealth:"healthy"}),[D,T]=b.useState([]),[P,U]=b.useState([]),[R,W]=b.useState({}),[o,_]=b.useState([]),[j,i]=b.useState([]),[l,a]=b.useState(1),[h,p]=b.useState(1),[v,f]=b.useState({}),[z,k]=b.useState(!1),[O,Y]=b.useState({}),[G,ne]=b.useState(null),[We,me]=b.useState(!1),[Me,ve]=b.useState(!1),[$e,ae]=b.useState(!1),[Q,xe]=b.useState({userId:"",subscriptionId:"",tier:"PRO",seats:1}),[ye,we]=b.useState([]),[I,le]=b.useState(null),[ee,be]=b.useState(!1),[oe,ot]=b.useState(""),[te,ct]=b.useState(""),[ce,dt]=b.useState(""),[ht,Pt]=b.useState(new Set),[Be,Ut]=b.useState(!1),ze=b.useMemo(()=>{if(!oe.trim())return D;const t=oe.toLowerCase();return D.filter(r=>r.firstName.toLowerCase().includes(t)||r.lastName.toLowerCase().includes(t)||r.email.toLowerCase().includes(t)||r.role.toLowerCase().includes(t)||r.status.toLowerCase().includes(t)||r.subscription&&r.subscription.toLowerCase().includes(t))},[D,oe]),He=b.useMemo(()=>{if(!te.trim())return P;const t=te.toLowerCase();return P.filter(r=>r.key.toLowerCase().includes(t)||r.userEmail.toLowerCase().includes(t)||r.tier.toLowerCase().includes(t)||r.status.toLowerCase().includes(t)||new Date(r.expiresAt).toLocaleDateString().includes(t)||new Date(r.activatedAt).toLocaleDateString().includes(t))},[P,te]),qe=b.useMemo(()=>{const t=new Map;He.forEach(y=>{const c=t.get(y.userId)||[];c.push(y),t.set(y.userId,c)});const r=D.map(y=>{const c=t.get(y.id)||[],N=c.filter($=>$.status==="active").length;return{userId:y.id,userEmail:y.email,licenses:c,totalLicenses:c.length,activeLicenses:N}});return(Be?r:r.filter(y=>y.totalLicenses>0)).sort((y,c)=>y.userEmail.localeCompare(c.userEmail))},[D,He,Be]),Se=t=>{if(!t)return new Date(NaN);if(typeof t=="string")return new Date(t);if(t instanceof Date)return t;if(typeof t=="object"&&t!==null){if(typeof t._seconds=="number")return new Date(t._seconds*1e3);if(typeof t.seconds=="number")return new Date(t.seconds*1e3);if(typeof t.toDate=="function")try{return t.toDate()}catch{}}return new Date(t)},ut=t=>`$${((typeof t=="number"?t:0)/100).toFixed(2)}`,Ve=b.useMemo(()=>{if(!ce.trim())return j;const t=ce.toLowerCase();return j.filter(r=>{var C,y;return r.id.toLowerCase().includes(t)||((C=r.user)==null?void 0:C.email)&&r.user.email.toLowerCase().includes(t)||((y=r.subscription)==null?void 0:y.tier)&&r.subscription.tier.toLowerCase().includes(t)||r.status.toLowerCase().includes(t)||Se(r.createdAt).toLocaleDateString().toLowerCase().includes(t)||ut(r.amount).toLowerCase().includes(t)})},[j,ce]),Ot=()=>ot(""),mt=()=>ct(""),Ft=()=>dt(""),Wt=t=>{Pt(r=>{const C=new Set(r);return C.has(t)?C.delete(t):C.add(t),C})};b.useEffect(()=>{let t=!0;return(async()=>{var r,C,y,c,N,$,se,ie,_e;try{if(String((s==null?void 0:s.role)||"").toUpperCase()!=="SUPERADMIN"){T([]),U([]),A(X=>({...X,systemHealth:"warning"}));return}const[H,de,Le,Xe,Ie]=await Promise.all([q.get(`${V.admin.users()}?page=1&limit=100`),q.get(`${V.admin.licenses()}?page=1&limit=100`),q.get(V.admin.paymentAnalytics()),q.get(V.admin.systemHealth()),q.get(V.admin.dashboardStats())]),Ee=((C=(r=H.data)==null?void 0:r.data)==null?void 0:C.users)??[],Je=((c=(y=de.data)==null?void 0:y.data)==null?void 0:c.licenses)??[],Z=(($=(N=Ie.data)==null?void 0:N.data)==null?void 0:$.stats)??{totalRevenue:0,activeSubscriptions:0},Jt=(Z==null?void 0:Z.recentPayments)??[],he=((ie=(se=Xe.data)==null?void 0:se.data)==null?void 0:ie.health)||((_e=Xe.data)==null?void 0:_e.data),gt=(he==null?void 0:he.overall)||(he==null?void 0:he.status)||"healthy";if(!t)return;T(Ee.map(X=>{var jt,vt,De,yt,bt,St;return{id:X.id,email:X.email,firstName:((jt=X.name)==null?void 0:jt.split(" ")[0])??"",lastName:((vt=X.name)==null?void 0:vt.split(" ").slice(1).join(" "))??"",role:X.role,status:((yt=(De=X.status)==null?void 0:De.toLowerCase)==null?void 0:yt.call(De))||"active",subscription:((St=(bt=X.subscriptions)==null?void 0:bt[0])==null?void 0:St.tier)??void 0,lastLogin:X.lastLoginAt||new Date().toISOString(),createdAt:X.createdAt||new Date().toISOString()}})),U([]),A({totalUsers:Number(Z.totalUsers||Ee.length)||0,activeSubscriptions:Z.activeSubscriptions??0,totalRevenue:Math.round(Z.totalRevenue??0)/100,pendingApprovals:0,systemHealth:gt==="healthy"?"healthy":gt==="degraded"?"warning":"error"}),le(he||null),_(Jt)}catch{if(!t)return;T([]),U([]),A(H=>({...H,systemHealth:"error"})),_([]),le(null)}})(),()=>{t=!1}},[s==null?void 0:s.role]);const Ke=async()=>{var $,se,ie,_e;const t=F=>{const H=new URLSearchParams;return H.set("page",String(F)),H.set("limit","100"),R.tier&&H.set("tier",String(R.tier)),R.status&&H.set("status",String(R.status)),H.toString()},r=await q.get(`${V.admin.licenses()}?${t(1)}`),C=((se=($=r.data)==null?void 0:$.data)==null?void 0:se.licenses)??[],y=((_e=(ie=r.data)==null?void 0:ie.data)==null?void 0:_e.pagination)??{pages:1},c=Math.max(1,Number(y.pages)||1);let N=[...C];if(c>1){const F=Array.from({length:c-1},(de,Le)=>Le+2),H=5;for(let de=0;de<F.length;de+=H){const Le=F.slice(de,de+H);(await Promise.all(Le.map(Ie=>q.get(`${V.admin.licenses()}?${t(Ie)}`)))).forEach(Ie=>{var Je,Z;const Ee=((Z=(Je=Ie.data)==null?void 0:Je.data)==null?void 0:Z.licenses)??[];N=N.concat(Ee)})}}U(N.map(F=>{var H;return{id:F.id,key:F.key,userId:F.userId,userEmail:((H=F.user)==null?void 0:H.email)??"",tier:F.tier,status:String(F.status||"").toLowerCase(),activatedAt:new Date(Se(F.activatedAt||F.createdAt)).toISOString(),expiresAt:new Date(Se(F.expiresAt||F.createdAt)).toISOString(),lastUsed:new Date(Se(F.updatedAt||F.createdAt)).toISOString()}}))};b.useEffect(()=>{String((s==null?void 0:s.role)||"").toUpperCase()==="SUPERADMIN"&&n===1&&Ke().catch(()=>{})},[n,R,s==null?void 0:s.role]);const Mt=async()=>{var t,r,C;try{be(!0);const y=await q.get(V.admin.systemHealth()),c=((r=(t=y.data)==null?void 0:t.data)==null?void 0:r.health)||((C=y.data)==null?void 0:C.data);le(c||null);const N=(c==null?void 0:c.overall)||"healthy";A($=>({...$,systemHealth:N==="healthy"?"healthy":N==="degraded"?"warning":"error"}))}catch{le(null),A(y=>({...y,systemHealth:"error"}))}finally{be(!1)}},xt=async(t=1)=>{var N,$,se,ie;const r=new URLSearchParams;r.set("page",String(t)),r.set("limit","100"),v.status&&r.set("status",v.status),v.email&&r.set("email",v.email),v.from&&r.set("from",v.from),v.to&&r.set("to",v.to);const C=await q.get(`${V.admin.payments()}?${r.toString()}`),y=(($=(N=C.data)==null?void 0:N.data)==null?void 0:$.payments)??[],c=((ie=(se=C.data)==null?void 0:se.data)==null?void 0:ie.pagination)??{pages:1,page:1};i(y),a(c.page||t),p(c.pages||1)};b.useEffect(()=>{String((s==null?void 0:s.role)||"").toUpperCase()==="SUPERADMIN"&&n===2&&xt(l).catch(()=>{})},[n,l,v,s==null?void 0:s.role]);const $t=async t=>{var r;try{const y=((r=(await q.get(V.admin.paymentDetails(t))).data)==null?void 0:r.data)||{};Y({payment:y.payment,licenses:y.licenses||[]}),k(!0)}catch{d("Failed to load payment details",{variant:"error"})}},Bt=t=>{ne(t),me(!0)},Ht=()=>{d("User updated successfully",{variant:"success"}),me(!1),ne(null)},qt=()=>{ve(!0)},Vt=async()=>{ae(!0)},Kt=async t=>{var r,C,y;if(xe(c=>({...c,userId:t,subscriptionId:""})),t){const N=((y=(C=(r=(await q.get(V.admin.userDetails(t))).data)==null?void 0:r.data)==null?void 0:C.user)==null?void 0:y.subscriptions)||[];we(N.filter($=>$.status==="ACTIVE"))}else we([])},Yt=async()=>{var t,r;try{await q.post(V.admin.createLicense(),Q),d("License(s) created",{variant:"success"}),ae(!1);const y=((r=(t=(await q.get(V.admin.licenses())).data)==null?void 0:t.data)==null?void 0:r.licenses)??[];U(y.map(c=>{var N;return{id:c.id,key:c.key,userId:c.userId,userEmail:((N=c.user)==null?void 0:N.email)??"",tier:c.tier,status:(c.status||"").toLowerCase(),activatedAt:c.activatedAt||c.createdAt,expiresAt:c.expiresAt||c.createdAt,lastUsed:c.updatedAt||c.createdAt}}))}catch(C){d((C==null?void 0:C.message)||"Failed to create license",{variant:"error"})}},Ye=t=>{switch(t){case"active":return"success";case"pending":return"warning";case"suspended":return"error";default:return"default"}},Gt=t=>{switch(String(t||"").toUpperCase()){case"SUPERADMIN":return"secondary";case"ADMIN":return"primary";default:return"default"}},Ge=t=>{switch(String(t||"").toUpperCase()){case"ENTERPRISE":return"secondary";case"PRO":return"success";case"BASIC":return"default";default:return"default"}},Qe=t=>String(t||"").toUpperCase()==="BASIC"?"outlined":"filled",Qt=t=>{switch(t){case"healthy":return"success";case"warning":return"warning";case"error":return"error";default:return"default"}},Xt=t=>{switch(t){case"healthy":return e.jsx(xs,{});case"warning":return e.jsx(Ze,{});case"error":return e.jsx(ms,{});default:return e.jsx(Ze,{})}};return e.jsxs(e.Fragment,{children:[e.jsx(vs,{}),e.jsx(g,{sx:{pt:8,pb:4},children:e.jsxs(ts,{maxWidth:"xl",children:[e.jsxs(g,{sx:{opacity:0,transform:"translateY(20px)",animation:"fadeInUp 0.6s ease-out forwards","@keyframes fadeInUp":{"0%":{opacity:0,transform:"translateY(20px)"},"100%":{opacity:1,transform:"translateY(0)"}}},children:[e.jsxs(g,{sx:{display:"flex",alignItems:"center",gap:2,mb:4},children:[e.jsx(ss,{sx:{fontSize:32,color:"primary.main"}}),e.jsx(S,{variant:"h4",sx:{fontWeight:700},children:"Admin Dashboard"}),e.jsx(E,{icon:Xt(x.systemHealth),label:`System ${x.systemHealth}`,color:Qt(x.systemHealth),size:"small"})]}),e.jsxs(w,{container:!0,spacing:3,sx:{mb:4},children:[e.jsx(w,{item:!0,xs:12,sm:6,lg:3,children:e.jsx(g,{sx:{opacity:0,transform:"translateY(20px)",animation:"fadeInUp 0.6s ease-out 0.1s forwards"},children:e.jsx(ge,{sx:{background:"linear-gradient(135deg, rgba(0, 212, 255, 0.1) 0%, rgba(102, 126, 234, 0.1) 100%)",border:"1px solid rgba(0, 212, 255, 0.2)"},children:e.jsxs(je,{children:[e.jsxs(g,{sx:{display:"flex",alignItems:"center",gap:2,mb:2},children:[e.jsx(is,{sx:{color:"primary.main"}}),e.jsx(S,{variant:"h6",color:"text.secondary",children:"Total Users"})]}),e.jsx(S,{variant:"h3",sx:{fontWeight:700,color:"primary.main"},children:x.totalUsers.toLocaleString()})]})})})}),e.jsx(w,{item:!0,xs:12,sm:6,lg:3,children:e.jsx(g,{sx:{opacity:0,transform:"translateY(20px)",animation:"fadeInUp 0.6s ease-out 0.2s forwards"},children:e.jsx(ge,{sx:{background:"linear-gradient(135deg, rgba(255, 255, 255, 0.1) 0%, rgba(255, 255, 255, 0.05) 100%)",border:"1px solid rgba(255, 255, 255, 0.1)"},children:e.jsxs(je,{children:[e.jsxs(g,{sx:{display:"flex",alignItems:"center",gap:2,mb:2},children:[e.jsx(rs,{sx:{color:"secondary.main"}}),e.jsx(S,{variant:"h6",color:"text.secondary",children:"Active Subscriptions"})]}),e.jsx(S,{variant:"h3",sx:{fontWeight:700},children:x.activeSubscriptions.toLocaleString()})]})})})}),e.jsx(w,{item:!0,xs:12,sm:6,lg:3,children:e.jsx(g,{sx:{opacity:0,transform:"translateY(20px)",animation:"fadeInUp 0.6s ease-out 0.3s forwards"},children:e.jsx(ge,{sx:{background:"linear-gradient(135deg, rgba(76, 175, 80, 0.1) 0%, rgba(139, 195, 74, 0.1) 100%)",border:"1px solid rgba(76, 175, 80, 0.2)"},children:e.jsxs(je,{children:[e.jsxs(g,{sx:{display:"flex",alignItems:"center",gap:2,mb:2},children:[e.jsx(ns,{sx:{color:"success.main"}}),e.jsx(S,{variant:"h6",color:"text.secondary",children:"Total Revenue"})]}),e.jsxs(S,{variant:"h3",sx:{fontWeight:700,color:"success.main"},children:["$",x.totalRevenue.toLocaleString()]})]})})})}),e.jsx(w,{item:!0,xs:12,sm:6,lg:3,children:e.jsx(g,{sx:{opacity:0,transform:"translateY(20px)",animation:"fadeInUp 0.6s ease-out 0.4s forwards"},children:e.jsx(ge,{sx:{background:"linear-gradient(135deg, rgba(255, 152, 0, 0.1) 0%, rgba(255, 193, 7, 0.1) 100%)",border:"1px solid rgba(255, 152, 0, 0.2)"},children:e.jsxs(je,{children:[e.jsxs(g,{sx:{display:"flex",alignItems:"center",gap:2,mb:2},children:[e.jsx(Ze,{sx:{color:"warning.main"}}),e.jsx(S,{variant:"h6",color:"text.secondary",children:"Pending Approvals"})]}),e.jsx(S,{variant:"h3",sx:{fontWeight:700,color:"warning.main"},children:x.pendingApprovals})]})})})})]}),e.jsx(ue,{sx:{mb:3},children:e.jsxs(as,{value:n,onChange:(t,r)=>m(r),sx:{borderBottom:1,borderColor:"divider","& .MuiTab-root":{textTransform:"none",fontWeight:600}},children:[e.jsx(Ae,{label:"Users"}),e.jsx(Ae,{label:"Licenses"}),e.jsx(Ae,{label:"Invoices"}),e.jsx(Ae,{label:"System Health"})]})}),n===0&&e.jsxs(g,{sx:{opacity:0,transform:"translateY(20px)",animation:"fadeInUp 0.6s ease-out forwards"},children:[e.jsxs(g,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[e.jsx(B,{placeholder:"Search users by name, email, role, status, or subscription...",value:oe,onChange:t=>ot(t.target.value),size:"small",sx:{minWidth:400},InputProps:{startAdornment:e.jsx(pe,{position:"start",children:e.jsx(tt,{})}),endAdornment:oe&&e.jsx(pe,{position:"end",children:e.jsx(re,{size:"small",onClick:Ot,children:e.jsx(et,{})})})}}),e.jsx(M,{variant:"contained",onClick:Vt,children:"Add License"})]}),oe&&e.jsx(g,{sx:{mb:2},children:e.jsx(E,{label:`${ze.length} of ${D.length} users found`,color:"primary",variant:"outlined"})}),e.jsxs(Te,{component:ue,sx:{height:420},children:[e.jsx(Ce,{stickyHeader:!0,children:e.jsx(Re,{children:e.jsxs(J,{children:[e.jsx(u,{children:"User"}),e.jsx(u,{children:"Role"}),e.jsx(u,{children:"Status"}),e.jsx(u,{children:"Subscription"}),e.jsx(u,{children:"Last Login"}),e.jsx(u,{children:"Actions"})]})})}),e.jsx(Ss,{children:({height:t,width:r})=>e.jsx(Ce,{size:"small",style:{height:t,width:r},children:e.jsx(ke,{children:ze.length>0?e.jsx(As,{height:t,width:r,itemSize:56,itemCount:ze.length,overscanCount:10,children:({index:C,style:y})=>{const c=ze[C];return e.jsxs(J,{style:y,children:[e.jsx(u,{children:e.jsxs(g,{children:[e.jsxs(S,{variant:"subtitle2",children:[c.firstName," ",c.lastName]}),e.jsx(S,{variant:"body2",color:"text.secondary",children:c.email})]})}),e.jsx(u,{children:e.jsx(E,{label:c.role,size:"small",color:Gt(c.role)})}),e.jsx(u,{children:e.jsx(E,{label:c.status,size:"small",color:Ye(c.status)})}),e.jsx(u,{children:c.subscription&&e.jsx(E,{label:c.subscription,size:"small",color:Ge(c.subscription),variant:Qe(c.subscription)})}),e.jsx(u,{children:e.jsx(S,{variant:"body2",children:new Date(c.lastLogin).toLocaleDateString()})}),e.jsxs(u,{children:[e.jsx(re,{size:"small",onClick:()=>Bt(c),children:e.jsx(It,{})}),e.jsx(re,{size:"small",color:"error",children:e.jsx(ls,{})})]})]},c.id)}}):e.jsx(J,{children:e.jsx(u,{colSpan:6,align:"center",children:e.jsx(g,{sx:{py:4},children:e.jsx(S,{variant:"body1",color:"text.secondary",children:oe?"No users found matching your search criteria.":"No users available."})})})})})})})]})]}),n===1&&e.jsxs(g,{sx:{opacity:0,transform:"translateY(20px)",animation:"fadeInUp 0.6s ease-out forwards"},children:[e.jsxs(g,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[e.jsx(B,{placeholder:"Search licenses by key, user email, tier, status, or dates...",value:te,onChange:t=>ct(t.target.value),size:"small",sx:{minWidth:400},InputProps:{startAdornment:e.jsx(pe,{position:"start",children:e.jsx(tt,{})}),endAdornment:te&&e.jsx(pe,{position:"end",children:e.jsx(re,{size:"small",onClick:mt,children:e.jsx(et,{})})})}}),e.jsxs(g,{sx:{display:"flex",gap:1,alignItems:"center"},children:[e.jsxs(B,{select:!0,size:"small",label:"Tier",sx:{minWidth:140},value:R.tier||"",onChange:t=>W(r=>({...r,tier:t.target.value||void 0})),children:[e.jsx(L,{value:"",children:"All"}),e.jsx(L,{value:"BASIC",children:"BASIC"}),e.jsx(L,{value:"PRO",children:"PRO"}),e.jsx(L,{value:"ENTERPRISE",children:"ENTERPRISE"})]}),e.jsx(E,{size:"small",label:Be?"Showing users with 0 licenses":"Hiding users with 0 licenses",onClick:()=>Ut(t=>!t),variant:"outlined"}),e.jsxs(B,{select:!0,size:"small",label:"Status",sx:{minWidth:160},value:R.status||"",onChange:t=>W(r=>({...r,status:t.target.value||void 0})),children:[e.jsx(L,{value:"",children:"All"}),e.jsx(L,{value:"ACTIVE",children:"ACTIVE"}),e.jsx(L,{value:"PENDING",children:"PENDING"}),e.jsx(L,{value:"SUSPENDED",children:"SUSPENDED"}),e.jsx(L,{value:"EXPIRED",children:"EXPIRED"}),e.jsx(L,{value:"REVOKED",children:"REVOKED"})]}),e.jsx(M,{variant:"outlined",onClick:()=>Ke(),children:"Apply"}),e.jsx(M,{onClick:()=>{W({}),Ke().catch(()=>{})},children:"Clear"})]})]}),e.jsxs(g,{sx:{mb:2,display:"flex",gap:2,flexWrap:"wrap"},children:[e.jsx(E,{label:`${qe.length} Users with Licenses`,color:"primary",variant:"outlined"}),e.jsx(E,{label:`${He.length} Total Licenses`,color:"secondary",variant:"outlined"}),te&&e.jsx(E,{label:`Search: ${te}`,color:"info",variant:"outlined",onDelete:mt})]}),e.jsx(g,{sx:{display:"flex",flexDirection:"column",gap:2},children:qe.length>0?qe.map(t=>e.jsx(ge,{variant:"outlined",children:e.jsxs(je,{sx:{p:0},children:[e.jsx(g,{sx:{p:2,backgroundColor:"background.default",borderBottom:"1px solid",borderColor:"divider",cursor:"pointer","&:hover":{backgroundColor:"action.hover"}},onClick:()=>Wt(t.userEmail),children:e.jsxs(g,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs(g,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsx(os,{color:"primary"}),e.jsxs(g,{children:[e.jsx(S,{variant:"h6",component:"div",children:t.userEmail}),e.jsxs(g,{sx:{display:"flex",gap:1,mt:.5},children:[e.jsx(E,{size:"small",label:`${t.totalLicenses} Total Licenses`,color:"primary",variant:"outlined"}),e.jsx(E,{size:"small",label:`${t.activeLicenses} Active`,color:"success",variant:"outlined"})]})]})]}),e.jsx(g,{sx:{display:"flex",alignItems:"center",gap:1},children:e.jsx(cs,{sx:{transform:ht.has(t.userEmail)?"rotate(180deg)":"rotate(0deg)",transition:"transform 0.2s"}})})]})}),e.jsx(ds,{in:ht.has(t.userEmail),children:e.jsx(Te,{component:ue,sx:{borderRadius:0},children:e.jsxs(Ce,{size:"small",children:[e.jsx(Re,{children:e.jsxs(J,{children:[e.jsx(u,{children:"License Key"}),e.jsx(u,{children:"Tier"}),e.jsx(u,{children:"Status"}),e.jsx(u,{children:"Expires"}),e.jsx(u,{children:"Actions"})]})}),e.jsx(ke,{children:t.licenses.map(r=>e.jsxs(J,{children:[e.jsx(u,{children:e.jsx(S,{variant:"body2",fontFamily:"monospace",children:r.key})}),e.jsx(u,{children:e.jsx(E,{label:r.tier,size:"small",color:Ge(r.tier),variant:Qe(r.tier)})}),e.jsx(u,{children:e.jsx(E,{label:r.status,size:"small",color:Ye(String(r.status).toLowerCase())})}),e.jsx(u,{children:e.jsx(S,{variant:"body2",children:new Date(r.expiresAt).toLocaleDateString()})}),e.jsxs(u,{children:[e.jsx(re,{size:"small",onClick:()=>qt(),children:e.jsx(It,{})}),e.jsx(re,{size:"small",children:e.jsx(hs,{})}),e.jsx(re,{size:"small",children:e.jsx(us,{})})]})]},r.id))})]})})})]})},t.userEmail)):e.jsx(g,{sx:{py:4,textAlign:"center"},children:e.jsx(S,{variant:"body1",color:"text.secondary",children:te?"No licenses found matching your search criteria.":"No licenses available."})})})]}),n===2&&e.jsxs(g,{sx:{opacity:0,transform:"translateY(20px)",animation:"fadeInUp 0.6s ease-out forwards"},children:[e.jsxs(g,{sx:{display:"flex",flexDirection:"column",gap:2,mb:2},children:[e.jsxs(g,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsx(B,{placeholder:"Search payments by ID, email, tier, status, amount, or date...",value:ce,onChange:t=>dt(t.target.value),size:"small",sx:{minWidth:400},InputProps:{startAdornment:e.jsx(pe,{position:"start",children:e.jsx(tt,{})}),endAdornment:ce&&e.jsx(pe,{position:"end",children:e.jsx(re,{size:"small",onClick:Ft,children:e.jsx(et,{})})})}}),ce&&e.jsx(E,{label:`${Ve.length} of ${j.length} payments found`,color:"primary",variant:"outlined"})]}),e.jsxs(g,{sx:{display:"flex",gap:2,flexWrap:"wrap"},children:[e.jsx(B,{label:"Filter by Email",size:"small",value:v.email||"",onChange:t=>f(r=>({...r,email:t.target.value}))}),e.jsx(B,{label:"From",size:"small",type:"date",InputLabelProps:{shrink:!0},value:v.from||"",onChange:t=>f(r=>({...r,from:t.target.value}))}),e.jsx(B,{label:"To",size:"small",type:"date",InputLabelProps:{shrink:!0},value:v.to||"",onChange:t=>f(r=>({...r,to:t.target.value}))}),e.jsxs(B,{label:"Status",select:!0,size:"small",value:v.status||"",onChange:t=>f(r=>({...r,status:t.target.value||void 0})),sx:{minWidth:160},children:[e.jsx(L,{value:"",children:"All"}),e.jsx(L,{value:"SUCCEEDED",children:"SUCCEEDED"}),e.jsx(L,{value:"PENDING",children:"PENDING"}),e.jsx(L,{value:"FAILED",children:"FAILED"}),e.jsx(L,{value:"REFUNDED",children:"REFUNDED"})]}),e.jsx(M,{variant:"outlined",onClick:()=>xt(1),children:"Apply Filters"})]})]}),e.jsx(Te,{component:ue,children:e.jsxs(Ce,{children:[e.jsx(Re,{children:e.jsxs(J,{children:[e.jsx(u,{children:"Payment ID"}),e.jsx(u,{children:"User"}),e.jsx(u,{children:"Tier"}),e.jsx(u,{children:"Amount"}),e.jsx(u,{children:"Status"}),e.jsx(u,{children:"Date"}),e.jsx(u,{children:"Invoice"}),e.jsx(u,{children:"Details"})]})}),e.jsx(ke,{children:Ve.length>0?Ve.map(t=>{var r,C,y,c;return e.jsxs(J,{children:[e.jsx(u,{children:e.jsx(S,{variant:"body2",fontFamily:"monospace",children:t.id})}),e.jsx(u,{children:e.jsx(S,{variant:"body2",children:((r=t.user)==null?void 0:r.email)||"—"})}),e.jsx(u,{children:e.jsx(E,{size:"small",label:((C=t.subscription)==null?void 0:C.tier)||"—",color:Ge((y=t.subscription)==null?void 0:y.tier),variant:Qe((c=t.subscription)==null?void 0:c.tier)})}),e.jsx(u,{children:e.jsx(S,{variant:"body2",children:ut(t.amount)})}),e.jsx(u,{children:e.jsx(E,{size:"small",label:t.status,color:t.status==="SUCCEEDED"?"success":t.status==="FAILED"?"error":"default"})}),e.jsx(u,{children:e.jsx(S,{variant:"body2",children:Se(t.createdAt).toLocaleDateString()})}),e.jsx(u,{children:t.stripeInvoiceId?e.jsx(M,{size:"small",variant:"outlined",onClick:()=>{const N=localStorage.getItem("auth_token"),$=`/api/invoices/${t.stripeInvoiceId}/pdf${N?`?token=${encodeURIComponent(N)}`:""}`;window.open($,"_blank")},children:"View"}):t.receiptUrl?e.jsx(M,{size:"small",variant:"outlined",onClick:()=>window.open(t.receiptUrl,"_blank"),children:"View"}):e.jsx(S,{variant:"body2",color:"text.secondary",children:"N/A"})}),e.jsx(u,{children:e.jsx(M,{size:"small",onClick:()=>$t(t.id),children:"Open"})})]},t.id)}):e.jsx(J,{children:e.jsx(u,{colSpan:8,align:"center",children:e.jsx(g,{sx:{py:4},children:e.jsx(S,{variant:"body1",color:"text.secondary",children:ce?"No payments found matching your search criteria.":"No payments available."})})})})})]})}),e.jsxs(g,{sx:{display:"flex",gap:1,justifyContent:"flex-end",mt:2},children:[e.jsx(M,{disabled:l<=1,onClick:()=>a(t=>Math.max(1,t-1)),children:"Prev"}),e.jsx(E,{label:`Page ${l} of ${h}`}),e.jsx(M,{disabled:l>=h,onClick:()=>a(t=>Math.min(h,t+1)),children:"Next"})]})]}),n===3&&e.jsx(g,{sx:{opacity:0,transform:"translateY(20px)",animation:"fadeInUp 0.6s ease-out forwards"},children:e.jsxs(w,{container:!0,spacing:3,children:[e.jsx(w,{item:!0,xs:12,md:6,children:e.jsxs(ue,{sx:{p:3},children:[e.jsx(S,{variant:"h6",sx:{mb:2},children:"System Status"}),e.jsxs(g,{sx:{display:"flex",alignItems:"center",gap:1,mb:2},children:[e.jsx(E,{label:`Overall: ${((I==null?void 0:I.overall)||"unknown").toUpperCase()}`,color:(I==null?void 0:I.overall)==="healthy"?"success":(I==null?void 0:I.overall)==="degraded"?"warning":(I==null?void 0:I.overall)==="unhealthy"?"error":"default"}),e.jsx(M,{size:"small",onClick:Mt,disabled:ee,children:ee?"Refreshing…":"Refresh"})]}),e.jsxs(w,{container:!0,spacing:2,children:[e.jsx(w,{item:!0,xs:12,children:e.jsx(Fe,{title:"Database",data:I==null?void 0:I.database})}),e.jsx(w,{item:!0,xs:12,children:e.jsx(Fe,{title:"Email (SendGrid)",data:I==null?void 0:I.email})}),e.jsx(w,{item:!0,xs:12,children:e.jsx(Fe,{title:"Payments (Stripe)",data:I==null?void 0:I.payment})}),e.jsx(w,{item:!0,xs:12,children:e.jsx(Fe,{title:"Webhooks",data:I==null?void 0:I.webhooks})})]})]})}),e.jsx(w,{item:!0,xs:12,md:6,children:e.jsxs(ue,{sx:{p:3},children:[e.jsx(S,{variant:"h6",sx:{mb:2},children:"Recent Activity"}),e.jsxs(g,{sx:{display:"flex",flexDirection:"column",gap:1},children:[e.jsxs(S,{variant:"body2",color:"text.secondary",children:["Checked at: ",I!=null&&I.checkedAt?new Date(I.checkedAt).toLocaleString():"—"]}),(pt=I==null?void 0:I.webhooks)!=null&&pt.metrics?e.jsxs(e.Fragment,{children:[e.jsxs(S,{variant:"body2",children:["Recent webhooks (24h): ",I.webhooks.metrics.recentWebhooks]}),e.jsxs(S,{variant:"body2",children:["Failed webhooks: ",I.webhooks.metrics.failedWebhooks]})]}):e.jsx(S,{variant:"body2",color:"text.secondary",children:"No metrics available"})]})]})})]})})]}),e.jsxs(Ne,{open:We,onClose:()=>me(!1),maxWidth:"sm",fullWidth:!0,children:[e.jsx(Pe,{children:"Edit User"}),e.jsx(Ue,{children:G&&e.jsxs(w,{container:!0,spacing:3,sx:{mt:1},children:[e.jsx(w,{item:!0,xs:12,sm:6,children:e.jsx(B,{fullWidth:!0,label:"First Name",value:G.firstName})}),e.jsx(w,{item:!0,xs:12,sm:6,children:e.jsx(B,{fullWidth:!0,label:"Last Name",value:G.lastName})}),e.jsx(w,{item:!0,xs:12,children:e.jsx(B,{fullWidth:!0,label:"Email",value:G.email})}),e.jsx(w,{item:!0,xs:12,sm:6,children:e.jsxs(Ct,{fullWidth:!0,children:[e.jsx(wt,{children:"Role"}),e.jsxs(zt,{value:G.role,label:"Role",inputProps:{"aria-label":"Select user role",title:"Choose the user role"},children:[e.jsx(L,{value:"USER",children:"User"}),e.jsx(L,{value:"ADMIN",children:"Admin"})]})]})}),e.jsx(w,{item:!0,xs:12,sm:6,children:e.jsxs(Ct,{fullWidth:!0,children:[e.jsx(wt,{children:"Status"}),e.jsxs(zt,{value:G.status,label:"Status",inputProps:{"aria-label":"Select user status",title:"Choose the user status"},children:[e.jsx(L,{value:"active",children:"Active"}),e.jsx(L,{value:"suspended",children:"Suspended"}),e.jsx(L,{value:"pending",children:"Pending"})]})]})})]})}),e.jsxs(Oe,{children:[e.jsx(M,{onClick:()=>me(!1),children:"Cancel"}),e.jsx(M,{onClick:Ht,variant:"contained",children:"Save Changes"})]})]}),e.jsxs(Ne,{open:z,onClose:()=>k(!1),maxWidth:"md",fullWidth:!0,children:[e.jsx(Pe,{children:"Payment Details"}),e.jsx(Ue,{children:O.payment?e.jsxs(g,{sx:{display:"flex",flexDirection:"column",gap:2},children:[e.jsxs(g,{sx:{display:"flex",gap:2,flexWrap:"wrap"},children:[e.jsx(E,{label:`ID: ${O.payment.id}`}),e.jsx(E,{label:`User: ${((ft=O.payment.user)==null?void 0:ft.email)||"—"}`}),e.jsx(E,{label:`Amount: $${(O.payment.amount/100).toFixed(2)}`}),e.jsx(E,{label:`Status: ${O.payment.status}`}),e.jsx(E,{label:`Date: ${new Date(O.payment.createdAt).toLocaleString()}`}),O.payment.receiptUrl&&e.jsx(M,{size:"small",variant:"outlined",onClick:()=>window.open(O.payment.receiptUrl,"_blank"),children:"View Invoice"})]}),e.jsx(S,{variant:"subtitle2",children:"Related Licenses"}),e.jsx(Te,{component:ue,children:e.jsxs(Ce,{size:"small",children:[e.jsx(Re,{children:e.jsxs(J,{children:[e.jsx(u,{children:"License Key"}),e.jsx(u,{children:"Status"}),e.jsx(u,{children:"Activated"}),e.jsx(u,{children:"Expires"})]})}),e.jsx(ke,{children:(O.licenses||[]).map(t=>e.jsxs(J,{children:[e.jsx(u,{children:e.jsx(S,{variant:"body2",fontFamily:"monospace",children:t.key})}),e.jsx(u,{children:e.jsx(E,{size:"small",label:t.status,color:Ye(String(t.status).toLowerCase())})}),e.jsx(u,{children:t.activatedAt?new Date(t.activatedAt).toLocaleDateString():"—"}),e.jsx(u,{children:t.expiresAt?new Date(t.expiresAt).toLocaleDateString():"—"})]},t.id))})]})})]}):e.jsx(S,{variant:"body2",color:"text.secondary",children:"No details."})}),e.jsx(Oe,{children:e.jsx(M,{onClick:()=>k(!1),children:"Close"})})]}),e.jsxs(Ne,{open:Me,onClose:()=>ve(!1),maxWidth:"sm",fullWidth:!0,children:[e.jsx(Pe,{children:"Edit License"}),e.jsx(Ue,{children:e.jsx(S,{variant:"body2",color:"text.secondary",sx:{mb:2},children:"License management options will be available here."})}),e.jsx(Oe,{children:e.jsx(M,{onClick:()=>ve(!1),children:"Close"})})]}),e.jsxs(Ne,{open:$e,onClose:()=>ae(!1),maxWidth:"sm",fullWidth:!0,children:[e.jsx(Pe,{children:"Add License"}),e.jsx(Ue,{children:e.jsxs(w,{container:!0,spacing:2,sx:{mt:.5},children:[e.jsx(w,{item:!0,xs:12,children:e.jsx(B,{select:!0,fullWidth:!0,label:"User",value:Q.userId,onChange:t=>Kt(t.target.value),children:D.map(t=>e.jsx(L,{value:t.id,children:t.email},t.id))})}),e.jsx(w,{item:!0,xs:12,children:e.jsx(B,{select:!0,fullWidth:!0,label:"Subscription",value:Q.subscriptionId,onChange:t=>xe(r=>({...r,subscriptionId:t.target.value})),disabled:!ye.length,children:ye.map(t=>e.jsxs(L,{value:t.id,children:[t.tier," — seats ",t.seats]},t.id))})}),e.jsx(w,{item:!0,xs:6,children:e.jsxs(B,{select:!0,fullWidth:!0,label:"Tier",value:Q.tier,onChange:t=>xe(r=>({...r,tier:t.target.value})),children:[e.jsx(L,{value:"BASIC",children:"BASIC"}),e.jsx(L,{value:"PRO",children:"PRO"}),e.jsx(L,{value:"ENTERPRISE",children:"ENTERPRISE"})]})}),e.jsx(w,{item:!0,xs:6,children:e.jsx(B,{fullWidth:!0,type:"number",label:"Seats",inputProps:{min:1,max:1e3},value:Q.seats,onChange:t=>xe(r=>({...r,seats:Math.max(1,Math.min(1e3,parseInt(t.target.value)||1))}))})})]})}),e.jsxs(Oe,{children:[e.jsx(M,{onClick:()=>ae(!1),children:"Cancel"}),e.jsx(M,{variant:"contained",onClick:Yt,disabled:!Q.userId||!Q.subscriptionId,children:"Create"})]})]})]})}),e.jsx(ys,{})]})};export{Fs as default};
