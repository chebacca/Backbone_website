import{j as e,a as l,b as Is,an as Ds,T as n,h as m,G as c,k as G,l as V,au as As,bN as Ls,aa as Us,aQ as we,c as R,b9 as ks,ba as te,u as b,v as z,I as D,bO as Ie,az as De,d as p,aB as ae,aC as re,aD as ne,aE as v,aF as a,aG as ie,aK as qe,b1 as Es,y as Ps,aq as Rs,a4 as g,aM as le,aN as oe,aO as ce,aR as Qe,aS as He,aT as Je,aP as de,O as Ns,n as Ts,t as Ws}from"./mui-BmK9T4iY.js";import{u as zs,r as d}from"./vendor-DIxetjBo.js";import{u as Fs}from"./notistack.esm-Bg0Tn0tt.js";import{u as $s,c as S,e as C}from"./index-exLZo8Gt.js";import{N as Ms}from"./Navigation-BmvlTrBy.js";import{F as Os}from"./Footer-CFQhTI6x.js";import"./stripe-6nutOR1s.js";const xe=({title:N,data:r})=>{const w=(r==null?void 0:r.status)==="healthy"?"success":(r==null?void 0:r.status)==="degraded"?"warning":(r==null?void 0:r.status)==="unhealthy"?"error":"default";return e.jsx(G,{variant:"outlined",children:e.jsxs(V,{children:[e.jsxs(l,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mb:1},children:[e.jsx(n,{variant:"subtitle1",children:N}),e.jsx(m,{size:"small",label:((r==null?void 0:r.status)||"unknown").toUpperCase(),color:w})]}),e.jsxs(c,{container:!0,spacing:2,children:[e.jsx(c,{item:!0,xs:12,sm:6,children:e.jsxs(n,{variant:"body2",color:"text.secondary",children:["Response time: ",(r==null?void 0:r.responseTimeMs)!=null?`${r.responseTimeMs} ms`:"—"]})}),e.jsx(c,{item:!0,xs:12,sm:6,children:e.jsx(n,{variant:"body2",color:"text.secondary",children:(r==null?void 0:r.message)||""})}),(r==null?void 0:r.error)&&e.jsx(c,{item:!0,xs:12,children:e.jsx(Ws,{severity:"warning",children:r.error})})]})]})})},Js=()=>{var Fe,$e;const{enqueueSnackbar:N}=Fs(),{user:r}=$s();zs();const[w,Xe]=d.useState(0),[A,F]=d.useState({totalUsers:0,activeSubscriptions:0,totalRevenue:0,pendingApprovals:0,systemHealth:"healthy"}),[$,he]=d.useState([]),[K,q]=d.useState([]),[Ys,Ae]=d.useState([]),[Q,Ze]=d.useState([]),[M,ue]=d.useState(1),[me,es]=d.useState(1),[f,H]=d.useState({}),[ss,je]=d.useState(!1),[I,ts]=d.useState({}),[T,Le]=d.useState(null),[as,J]=d.useState(!1),[rs,pe]=d.useState(!1),[ns,X]=d.useState(!1),[L,Z]=d.useState({userId:"",subscriptionId:"",tier:"PRO",seats:1}),[Ue,ke]=d.useState([]),[i,ee]=d.useState(null),[Ee,Pe]=d.useState(!1),[U,Re]=d.useState(""),[k,Ne]=d.useState(""),[E,Te]=d.useState(""),ge=d.useMemo(()=>{if(!U.trim())return $;const s=U.toLowerCase();return $.filter(t=>t.firstName.toLowerCase().includes(s)||t.lastName.toLowerCase().includes(s)||t.email.toLowerCase().includes(s)||t.role.toLowerCase().includes(s)||t.status.toLowerCase().includes(s)||t.subscription&&t.subscription.toLowerCase().includes(s))},[$,U]),be=d.useMemo(()=>{if(!k.trim())return K;const s=k.toLowerCase();return K.filter(t=>t.key.toLowerCase().includes(s)||t.userEmail.toLowerCase().includes(s)||t.tier.toLowerCase().includes(s)||t.status.toLowerCase().includes(s)||new Date(t.expiresAt).toLocaleDateString().includes(s)||new Date(t.activatedAt).toLocaleDateString().includes(s))},[K,k]),O=s=>{if(!s)return new Date(NaN);if(typeof s=="string")return new Date(s);if(s instanceof Date)return s;if(typeof s=="object"&&s!==null){if(typeof s._seconds=="number")return new Date(s._seconds*1e3);if(typeof s.seconds=="number")return new Date(s.seconds*1e3);if(typeof s.toDate=="function")try{return s.toDate()}catch{}}return new Date(s)},We=s=>`$${((typeof s=="number"?s:0)/100).toFixed(2)}`,fe=d.useMemo(()=>{if(!E.trim())return Q;const s=E.toLowerCase();return Q.filter(t=>{var x,u;return t.id.toLowerCase().includes(s)||((x=t.user)==null?void 0:x.email)&&t.user.email.toLowerCase().includes(s)||((u=t.subscription)==null?void 0:u.tier)&&t.subscription.tier.toLowerCase().includes(s)||t.status.toLowerCase().includes(s)||O(t.createdAt).toLocaleDateString().toLowerCase().includes(s)||We(t.amount).toLowerCase().includes(s)})},[Q,E]),is=()=>Re(""),ls=()=>Ne(""),os=()=>Te("");d.useEffect(()=>{let s=!0;return(async()=>{var t,x,u,o,j,y,Y,B,Me;try{if(String((r==null?void 0:r.role)||"").toUpperCase()!=="SUPERADMIN"){he([]),q([]),F(h=>({...h,systemHealth:"warning"}));return}const[Ce,vs,Bs,Oe,Ss]=await Promise.all([S.get(`${C.admin.users()}?page=1&limit=100`),S.get(`${C.admin.licenses()}?page=1&limit=500`),S.get(C.admin.paymentAnalytics()),S.get(C.admin.systemHealth()),S.get(C.admin.dashboardStats())]),Ye=((x=(t=Ce.data)==null?void 0:t.data)==null?void 0:x.users)??[],Cs=((o=(u=vs.data)==null?void 0:u.data)==null?void 0:o.licenses)??[],W=((y=(j=Ss.data)==null?void 0:j.data)==null?void 0:y.stats)??{totalRevenue:0,activeSubscriptions:0},ws=(W==null?void 0:W.recentPayments)??[],P=((B=(Y=Oe.data)==null?void 0:Y.data)==null?void 0:B.health)||((Me=Oe.data)==null?void 0:Me.data),Be=(P==null?void 0:P.overall)||(P==null?void 0:P.status)||"healthy";if(!s)return;he(Ye.map(h=>{var _,_e,se,Ge,Ve,Ke;return{id:h.id,email:h.email,firstName:((_=h.name)==null?void 0:_.split(" ")[0])??"",lastName:((_e=h.name)==null?void 0:_e.split(" ").slice(1).join(" "))??"",role:h.role,status:((Ge=(se=h.status)==null?void 0:se.toLowerCase)==null?void 0:Ge.call(se))||"active",subscription:((Ke=(Ve=h.subscriptions)==null?void 0:Ve[0])==null?void 0:Ke.tier)??void 0,lastLogin:h.lastLoginAt||new Date().toISOString(),createdAt:h.createdAt||new Date().toISOString()}})),q(Cs.map(h=>{var _;return{id:h.id,key:h.key,userId:h.userId,userEmail:((_=h.user)==null?void 0:_.email)??"",tier:h.tier,status:String(h.status||"").toLowerCase(),activatedAt:new Date(O(h.activatedAt||h.createdAt)).toISOString(),expiresAt:new Date(O(h.expiresAt||h.createdAt)).toISOString(),lastUsed:new Date(O(h.updatedAt||h.createdAt)).toISOString()}})),F({totalUsers:Number(W.totalUsers||Ye.length)||0,activeSubscriptions:W.activeSubscriptions??0,totalRevenue:Math.round(W.totalRevenue??0)/100,pendingApprovals:0,systemHealth:Be==="healthy"?"healthy":Be==="degraded"?"warning":"error"}),ee(P||null),Ae(ws)}catch{if(!s)return;he([]),q([]),F(Ce=>({...Ce,systemHealth:"error"})),Ae([]),ee(null)}})(),()=>{s=!1}},[r==null?void 0:r.role]);const cs=async()=>{var s,t,x;try{Pe(!0);const u=await S.get(C.admin.systemHealth()),o=((t=(s=u.data)==null?void 0:s.data)==null?void 0:t.health)||((x=u.data)==null?void 0:x.data);ee(o||null);const j=(o==null?void 0:o.overall)||"healthy";F(y=>({...y,systemHealth:j==="healthy"?"healthy":j==="degraded"?"warning":"error"}))}catch{ee(null),F(u=>({...u,systemHealth:"error"}))}finally{Pe(!1)}},ze=async(s=1)=>{var j,y,Y,B;const t=new URLSearchParams;t.set("page",String(s)),t.set("limit","100"),f.status&&t.set("status",f.status),f.email&&t.set("email",f.email),f.from&&t.set("from",f.from),f.to&&t.set("to",f.to);const x=await S.get(`${C.admin.payments()}?${t.toString()}`),u=((y=(j=x.data)==null?void 0:j.data)==null?void 0:y.payments)??[],o=((B=(Y=x.data)==null?void 0:Y.data)==null?void 0:B.pagination)??{pages:1,page:1};Ze(u),ue(o.page||s),es(o.pages||1)};d.useEffect(()=>{String((r==null?void 0:r.role)||"").toUpperCase()==="SUPERADMIN"&&w===2&&ze(M).catch(()=>{})},[w,M,f,r==null?void 0:r.role]);const ds=async s=>{var t;try{const u=((t=(await S.get(C.admin.paymentDetails(s))).data)==null?void 0:t.data)||{};ts({payment:u.payment,licenses:u.licenses||[]}),je(!0)}catch{N("Failed to load payment details",{variant:"error"})}},xs=s=>{Le(s),J(!0)},hs=()=>{N("User updated successfully",{variant:"success"}),J(!1),Le(null)},us=()=>{pe(!0)},ms=async()=>{X(!0)},js=async s=>{var t,x,u;if(Z(o=>({...o,userId:s,subscriptionId:""})),s){const j=((u=(x=(t=(await S.get(C.admin.userDetails(s))).data)==null?void 0:t.data)==null?void 0:x.user)==null?void 0:u.subscriptions)||[];ke(j.filter(y=>y.status==="ACTIVE"))}else ke([])},ps=async()=>{var s,t;try{await S.post(C.admin.createLicense(),L),N("License(s) created",{variant:"success"}),X(!1);const u=((t=(s=(await S.get(C.admin.licenses())).data)==null?void 0:s.data)==null?void 0:t.licenses)??[];q(u.map(o=>{var j;return{id:o.id,key:o.key,userId:o.userId,userEmail:((j=o.user)==null?void 0:j.email)??"",tier:o.tier,status:(o.status||"").toLowerCase(),activatedAt:o.activatedAt||o.createdAt,expiresAt:o.expiresAt||o.createdAt,lastUsed:o.updatedAt||o.createdAt}}))}catch(x){N((x==null?void 0:x.message)||"Failed to create license",{variant:"error"})}},ye=s=>{switch(s){case"active":return"success";case"pending":return"warning";case"suspended":return"error";default:return"default"}},gs=s=>{switch(String(s||"").toUpperCase()){case"SUPERADMIN":return"secondary";case"ADMIN":return"primary";default:return"default"}},ve=s=>{switch(String(s||"").toUpperCase()){case"ENTERPRISE":return"secondary";case"PRO":return"success";case"BASIC":return"default";default:return"default"}},Se=s=>String(s||"").toUpperCase()==="BASIC"?"outlined":"filled",bs=s=>{switch(s){case"healthy":return"success";case"warning":return"warning";case"error":return"error";default:return"default"}},fs=s=>{switch(s){case"healthy":return e.jsx(Ts,{});case"warning":return e.jsx(we,{});case"error":return e.jsx(Ns,{});default:return e.jsx(we,{})}};return e.jsxs(e.Fragment,{children:[e.jsx(Ms,{}),e.jsx(l,{sx:{pt:8,pb:4},children:e.jsxs(Is,{maxWidth:"xl",children:[e.jsxs(l,{sx:{opacity:0,transform:"translateY(20px)",animation:"fadeInUp 0.6s ease-out forwards","@keyframes fadeInUp":{"0%":{opacity:0,transform:"translateY(20px)"},"100%":{opacity:1,transform:"translateY(0)"}}},children:[e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:2,mb:4},children:[e.jsx(Ds,{sx:{fontSize:32,color:"primary.main"}}),e.jsx(n,{variant:"h4",sx:{fontWeight:700},children:"Admin Dashboard"}),e.jsx(m,{icon:fs(A.systemHealth),label:`System ${A.systemHealth}`,color:bs(A.systemHealth),size:"small"})]}),e.jsxs(c,{container:!0,spacing:3,sx:{mb:4},children:[e.jsx(c,{item:!0,xs:12,sm:6,lg:3,children:e.jsx(l,{sx:{opacity:0,transform:"translateY(20px)",animation:"fadeInUp 0.6s ease-out 0.1s forwards"},children:e.jsx(G,{sx:{background:"linear-gradient(135deg, rgba(0, 212, 255, 0.1) 0%, rgba(102, 126, 234, 0.1) 100%)",border:"1px solid rgba(0, 212, 255, 0.2)"},children:e.jsxs(V,{children:[e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:2,mb:2},children:[e.jsx(As,{sx:{color:"primary.main"}}),e.jsx(n,{variant:"h6",color:"text.secondary",children:"Total Users"})]}),e.jsx(n,{variant:"h3",sx:{fontWeight:700,color:"primary.main"},children:A.totalUsers.toLocaleString()})]})})})}),e.jsx(c,{item:!0,xs:12,sm:6,lg:3,children:e.jsx(l,{sx:{opacity:0,transform:"translateY(20px)",animation:"fadeInUp 0.6s ease-out 0.2s forwards"},children:e.jsx(G,{sx:{background:"linear-gradient(135deg, rgba(255, 255, 255, 0.1) 0%, rgba(255, 255, 255, 0.05) 100%)",border:"1px solid rgba(255, 255, 255, 0.1)"},children:e.jsxs(V,{children:[e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:2,mb:2},children:[e.jsx(Ls,{sx:{color:"secondary.main"}}),e.jsx(n,{variant:"h6",color:"text.secondary",children:"Active Subscriptions"})]}),e.jsx(n,{variant:"h3",sx:{fontWeight:700},children:A.activeSubscriptions.toLocaleString()})]})})})}),e.jsx(c,{item:!0,xs:12,sm:6,lg:3,children:e.jsx(l,{sx:{opacity:0,transform:"translateY(20px)",animation:"fadeInUp 0.6s ease-out 0.3s forwards"},children:e.jsx(G,{sx:{background:"linear-gradient(135deg, rgba(76, 175, 80, 0.1) 0%, rgba(139, 195, 74, 0.1) 100%)",border:"1px solid rgba(76, 175, 80, 0.2)"},children:e.jsxs(V,{children:[e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:2,mb:2},children:[e.jsx(Us,{sx:{color:"success.main"}}),e.jsx(n,{variant:"h6",color:"text.secondary",children:"Total Revenue"})]}),e.jsxs(n,{variant:"h3",sx:{fontWeight:700,color:"success.main"},children:["$",A.totalRevenue.toLocaleString()]})]})})})}),e.jsx(c,{item:!0,xs:12,sm:6,lg:3,children:e.jsx(l,{sx:{opacity:0,transform:"translateY(20px)",animation:"fadeInUp 0.6s ease-out 0.4s forwards"},children:e.jsx(G,{sx:{background:"linear-gradient(135deg, rgba(255, 152, 0, 0.1) 0%, rgba(255, 193, 7, 0.1) 100%)",border:"1px solid rgba(255, 152, 0, 0.2)"},children:e.jsxs(V,{children:[e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:2,mb:2},children:[e.jsx(we,{sx:{color:"warning.main"}}),e.jsx(n,{variant:"h6",color:"text.secondary",children:"Pending Approvals"})]}),e.jsx(n,{variant:"h3",sx:{fontWeight:700,color:"warning.main"},children:A.pendingApprovals})]})})})})]}),e.jsx(R,{sx:{mb:3},children:e.jsxs(ks,{value:w,onChange:(s,t)=>Xe(t),sx:{borderBottom:1,borderColor:"divider","& .MuiTab-root":{textTransform:"none",fontWeight:600}},children:[e.jsx(te,{label:"Users"}),e.jsx(te,{label:"Licenses"}),e.jsx(te,{label:"Invoices"}),e.jsx(te,{label:"System Health"})]})}),w===0&&e.jsxs(l,{sx:{opacity:0,transform:"translateY(20px)",animation:"fadeInUp 0.6s ease-out forwards"},children:[e.jsxs(l,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[e.jsx(b,{placeholder:"Search users by name, email, role, status, or subscription...",value:U,onChange:s=>Re(s.target.value),size:"small",sx:{minWidth:400},InputProps:{startAdornment:e.jsx(z,{position:"start",children:e.jsx(De,{})}),endAdornment:U&&e.jsx(z,{position:"end",children:e.jsx(D,{size:"small",onClick:is,children:e.jsx(Ie,{})})})}}),e.jsx(p,{variant:"contained",onClick:ms,children:"Add License"})]}),U&&e.jsx(l,{sx:{mb:2},children:e.jsx(m,{label:`${ge.length} of ${$.length} users found`,color:"primary",variant:"outlined"})}),e.jsx(ae,{component:R,children:e.jsxs(re,{children:[e.jsx(ne,{children:e.jsxs(v,{children:[e.jsx(a,{children:"User"}),e.jsx(a,{children:"Role"}),e.jsx(a,{children:"Status"}),e.jsx(a,{children:"Subscription"}),e.jsx(a,{children:"Last Login"}),e.jsx(a,{children:"Actions"})]})}),e.jsx(ie,{children:ge.length>0?ge.map(s=>e.jsxs(v,{children:[e.jsx(a,{children:e.jsxs(l,{children:[e.jsxs(n,{variant:"subtitle2",children:[s.firstName," ",s.lastName]}),e.jsx(n,{variant:"body2",color:"text.secondary",children:s.email})]})}),e.jsx(a,{children:e.jsx(m,{label:s.role,size:"small",color:gs(s.role)})}),e.jsx(a,{children:e.jsx(m,{label:s.status,size:"small",color:ye(s.status)})}),e.jsx(a,{children:s.subscription&&e.jsx(m,{label:s.subscription,size:"small",color:ve(s.subscription),variant:Se(s.subscription)})}),e.jsx(a,{children:e.jsx(n,{variant:"body2",children:new Date(s.lastLogin).toLocaleDateString()})}),e.jsxs(a,{children:[e.jsx(D,{size:"small",onClick:()=>xs(s),children:e.jsx(qe,{})}),e.jsx(D,{size:"small",color:"error",children:e.jsx(Es,{})})]})]},s.id)):e.jsx(v,{children:e.jsx(a,{colSpan:6,align:"center",children:e.jsx(l,{sx:{py:4},children:e.jsx(n,{variant:"body1",color:"text.secondary",children:U?"No users found matching your search criteria.":"No users available."})})})})})]})})]}),w===1&&e.jsxs(l,{sx:{opacity:0,transform:"translateY(20px)",animation:"fadeInUp 0.6s ease-out forwards"},children:[e.jsx(l,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:e.jsx(b,{placeholder:"Search licenses by key, user email, tier, status, or dates...",value:k,onChange:s=>Ne(s.target.value),size:"small",sx:{minWidth:400},InputProps:{startAdornment:e.jsx(z,{position:"start",children:e.jsx(De,{})}),endAdornment:k&&e.jsx(z,{position:"end",children:e.jsx(D,{size:"small",onClick:ls,children:e.jsx(Ie,{})})})}})}),k&&e.jsx(l,{sx:{mb:2},children:e.jsx(m,{label:`${be.length} of ${K.length} licenses found`,color:"primary",variant:"outlined"})}),e.jsx(ae,{component:R,children:e.jsxs(re,{children:[e.jsx(ne,{children:e.jsxs(v,{children:[e.jsx(a,{children:"License Key"}),e.jsx(a,{children:"User"}),e.jsx(a,{children:"Tier"}),e.jsx(a,{children:"Status"}),e.jsx(a,{children:"Expires"}),e.jsx(a,{children:"Actions"})]})}),e.jsx(ie,{children:be.length>0?be.map(s=>e.jsxs(v,{children:[e.jsx(a,{children:e.jsx(n,{variant:"body2",fontFamily:"monospace",children:s.key})}),e.jsx(a,{children:e.jsx(n,{variant:"body2",children:s.userEmail})}),e.jsx(a,{children:e.jsx(m,{label:s.tier,size:"small",color:ve(s.tier),variant:Se(s.tier)})}),e.jsx(a,{children:e.jsx(m,{label:s.status,size:"small",color:ye(String(s.status).toLowerCase())})}),e.jsx(a,{children:e.jsx(n,{variant:"body2",children:new Date(s.expiresAt).toLocaleDateString()})}),e.jsxs(a,{children:[e.jsx(D,{size:"small",onClick:()=>us(),children:e.jsx(qe,{})}),e.jsx(D,{size:"small",children:e.jsx(Ps,{})}),e.jsx(D,{size:"small",children:e.jsx(Rs,{})})]})]},s.id)):e.jsx(v,{children:e.jsx(a,{colSpan:6,align:"center",children:e.jsx(l,{sx:{py:4},children:e.jsx(n,{variant:"body1",color:"text.secondary",children:k?"No licenses found matching your search criteria.":"No licenses available."})})})})})]})})]}),w===2&&e.jsxs(l,{sx:{opacity:0,transform:"translateY(20px)",animation:"fadeInUp 0.6s ease-out forwards"},children:[e.jsxs(l,{sx:{display:"flex",flexDirection:"column",gap:2,mb:2},children:[e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsx(b,{placeholder:"Search payments by ID, email, tier, status, amount, or date...",value:E,onChange:s=>Te(s.target.value),size:"small",sx:{minWidth:400},InputProps:{startAdornment:e.jsx(z,{position:"start",children:e.jsx(De,{})}),endAdornment:E&&e.jsx(z,{position:"end",children:e.jsx(D,{size:"small",onClick:os,children:e.jsx(Ie,{})})})}}),E&&e.jsx(m,{label:`${fe.length} of ${Q.length} payments found`,color:"primary",variant:"outlined"})]}),e.jsxs(l,{sx:{display:"flex",gap:2,flexWrap:"wrap"},children:[e.jsx(b,{label:"Filter by Email",size:"small",value:f.email||"",onChange:s=>H(t=>({...t,email:s.target.value}))}),e.jsx(b,{label:"From",size:"small",type:"date",InputLabelProps:{shrink:!0},value:f.from||"",onChange:s=>H(t=>({...t,from:s.target.value}))}),e.jsx(b,{label:"To",size:"small",type:"date",InputLabelProps:{shrink:!0},value:f.to||"",onChange:s=>H(t=>({...t,to:s.target.value}))}),e.jsxs(b,{label:"Status",select:!0,size:"small",value:f.status||"",onChange:s=>H(t=>({...t,status:s.target.value||void 0})),sx:{minWidth:160},children:[e.jsx(g,{value:"",children:"All"}),e.jsx(g,{value:"SUCCEEDED",children:"SUCCEEDED"}),e.jsx(g,{value:"PENDING",children:"PENDING"}),e.jsx(g,{value:"FAILED",children:"FAILED"}),e.jsx(g,{value:"REFUNDED",children:"REFUNDED"})]}),e.jsx(p,{variant:"outlined",onClick:()=>ze(1),children:"Apply Filters"})]})]}),e.jsx(ae,{component:R,children:e.jsxs(re,{children:[e.jsx(ne,{children:e.jsxs(v,{children:[e.jsx(a,{children:"Payment ID"}),e.jsx(a,{children:"User"}),e.jsx(a,{children:"Tier"}),e.jsx(a,{children:"Amount"}),e.jsx(a,{children:"Status"}),e.jsx(a,{children:"Date"}),e.jsx(a,{children:"Invoice"}),e.jsx(a,{children:"Details"})]})}),e.jsx(ie,{children:fe.length>0?fe.map(s=>{var t,x,u,o;return e.jsxs(v,{children:[e.jsx(a,{children:e.jsx(n,{variant:"body2",fontFamily:"monospace",children:s.id})}),e.jsx(a,{children:e.jsx(n,{variant:"body2",children:((t=s.user)==null?void 0:t.email)||"—"})}),e.jsx(a,{children:e.jsx(m,{size:"small",label:((x=s.subscription)==null?void 0:x.tier)||"—",color:ve((u=s.subscription)==null?void 0:u.tier),variant:Se((o=s.subscription)==null?void 0:o.tier)})}),e.jsx(a,{children:e.jsx(n,{variant:"body2",children:We(s.amount)})}),e.jsx(a,{children:e.jsx(m,{size:"small",label:s.status,color:s.status==="SUCCEEDED"?"success":s.status==="FAILED"?"error":"default"})}),e.jsx(a,{children:e.jsx(n,{variant:"body2",children:O(s.createdAt).toLocaleDateString()})}),e.jsx(a,{children:s.stripeInvoiceId?e.jsx(p,{size:"small",variant:"outlined",onClick:()=>{const j=localStorage.getItem("auth_token"),y=`/api/invoices/${s.stripeInvoiceId}/pdf${j?`?token=${encodeURIComponent(j)}`:""}`;window.open(y,"_blank")},children:"View"}):s.receiptUrl?e.jsx(p,{size:"small",variant:"outlined",onClick:()=>window.open(s.receiptUrl,"_blank"),children:"View"}):e.jsx(n,{variant:"body2",color:"text.secondary",children:"N/A"})}),e.jsx(a,{children:e.jsx(p,{size:"small",onClick:()=>ds(s.id),children:"Open"})})]},s.id)}):e.jsx(v,{children:e.jsx(a,{colSpan:8,align:"center",children:e.jsx(l,{sx:{py:4},children:e.jsx(n,{variant:"body1",color:"text.secondary",children:E?"No payments found matching your search criteria.":"No payments available."})})})})})]})}),e.jsxs(l,{sx:{display:"flex",gap:1,justifyContent:"flex-end",mt:2},children:[e.jsx(p,{disabled:M<=1,onClick:()=>ue(s=>Math.max(1,s-1)),children:"Prev"}),e.jsx(m,{label:`Page ${M} of ${me}`}),e.jsx(p,{disabled:M>=me,onClick:()=>ue(s=>Math.min(me,s+1)),children:"Next"})]})]}),w===3&&e.jsx(l,{sx:{opacity:0,transform:"translateY(20px)",animation:"fadeInUp 0.6s ease-out forwards"},children:e.jsxs(c,{container:!0,spacing:3,children:[e.jsx(c,{item:!0,xs:12,md:6,children:e.jsxs(R,{sx:{p:3},children:[e.jsx(n,{variant:"h6",sx:{mb:2},children:"System Status"}),e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:1,mb:2},children:[e.jsx(m,{label:`Overall: ${((i==null?void 0:i.overall)||"unknown").toUpperCase()}`,color:(i==null?void 0:i.overall)==="healthy"?"success":(i==null?void 0:i.overall)==="degraded"?"warning":(i==null?void 0:i.overall)==="unhealthy"?"error":"default"}),e.jsx(p,{size:"small",onClick:cs,disabled:Ee,children:Ee?"Refreshing…":"Refresh"})]}),e.jsxs(c,{container:!0,spacing:2,children:[e.jsx(c,{item:!0,xs:12,children:e.jsx(xe,{title:"Database",data:i==null?void 0:i.database})}),e.jsx(c,{item:!0,xs:12,children:e.jsx(xe,{title:"Email (SendGrid)",data:i==null?void 0:i.email})}),e.jsx(c,{item:!0,xs:12,children:e.jsx(xe,{title:"Payments (Stripe)",data:i==null?void 0:i.payment})}),e.jsx(c,{item:!0,xs:12,children:e.jsx(xe,{title:"Webhooks",data:i==null?void 0:i.webhooks})})]})]})}),e.jsx(c,{item:!0,xs:12,md:6,children:e.jsxs(R,{sx:{p:3},children:[e.jsx(n,{variant:"h6",sx:{mb:2},children:"Recent Activity"}),e.jsxs(l,{sx:{display:"flex",flexDirection:"column",gap:1},children:[e.jsxs(n,{variant:"body2",color:"text.secondary",children:["Checked at: ",i!=null&&i.checkedAt?new Date(i.checkedAt).toLocaleString():"—"]}),(Fe=i==null?void 0:i.webhooks)!=null&&Fe.metrics?e.jsxs(e.Fragment,{children:[e.jsxs(n,{variant:"body2",children:["Recent webhooks (24h): ",i.webhooks.metrics.recentWebhooks]}),e.jsxs(n,{variant:"body2",children:["Failed webhooks: ",i.webhooks.metrics.failedWebhooks]})]}):e.jsx(n,{variant:"body2",color:"text.secondary",children:"No metrics available"})]})]})})]})})]}),e.jsxs(le,{open:as,onClose:()=>J(!1),maxWidth:"sm",fullWidth:!0,children:[e.jsx(oe,{children:"Edit User"}),e.jsx(ce,{children:T&&e.jsxs(c,{container:!0,spacing:3,sx:{mt:1},children:[e.jsx(c,{item:!0,xs:12,sm:6,children:e.jsx(b,{fullWidth:!0,label:"First Name",value:T.firstName})}),e.jsx(c,{item:!0,xs:12,sm:6,children:e.jsx(b,{fullWidth:!0,label:"Last Name",value:T.lastName})}),e.jsx(c,{item:!0,xs:12,children:e.jsx(b,{fullWidth:!0,label:"Email",value:T.email})}),e.jsx(c,{item:!0,xs:12,sm:6,children:e.jsxs(Qe,{fullWidth:!0,children:[e.jsx(He,{children:"Role"}),e.jsxs(Je,{value:T.role,label:"Role",inputProps:{"aria-label":"Select user role",title:"Choose the user role"},children:[e.jsx(g,{value:"USER",children:"User"}),e.jsx(g,{value:"ADMIN",children:"Admin"})]})]})}),e.jsx(c,{item:!0,xs:12,sm:6,children:e.jsxs(Qe,{fullWidth:!0,children:[e.jsx(He,{children:"Status"}),e.jsxs(Je,{value:T.status,label:"Status",inputProps:{"aria-label":"Select user status",title:"Choose the user status"},children:[e.jsx(g,{value:"active",children:"Active"}),e.jsx(g,{value:"suspended",children:"Suspended"}),e.jsx(g,{value:"pending",children:"Pending"})]})]})})]})}),e.jsxs(de,{children:[e.jsx(p,{onClick:()=>J(!1),children:"Cancel"}),e.jsx(p,{onClick:hs,variant:"contained",children:"Save Changes"})]})]}),e.jsxs(le,{open:ss,onClose:()=>je(!1),maxWidth:"md",fullWidth:!0,children:[e.jsx(oe,{children:"Payment Details"}),e.jsx(ce,{children:I.payment?e.jsxs(l,{sx:{display:"flex",flexDirection:"column",gap:2},children:[e.jsxs(l,{sx:{display:"flex",gap:2,flexWrap:"wrap"},children:[e.jsx(m,{label:`ID: ${I.payment.id}`}),e.jsx(m,{label:`User: ${(($e=I.payment.user)==null?void 0:$e.email)||"—"}`}),e.jsx(m,{label:`Amount: $${(I.payment.amount/100).toFixed(2)}`}),e.jsx(m,{label:`Status: ${I.payment.status}`}),e.jsx(m,{label:`Date: ${new Date(I.payment.createdAt).toLocaleString()}`}),I.payment.receiptUrl&&e.jsx(p,{size:"small",variant:"outlined",onClick:()=>window.open(I.payment.receiptUrl,"_blank"),children:"View Invoice"})]}),e.jsx(n,{variant:"subtitle2",children:"Related Licenses"}),e.jsx(ae,{component:R,children:e.jsxs(re,{size:"small",children:[e.jsx(ne,{children:e.jsxs(v,{children:[e.jsx(a,{children:"License Key"}),e.jsx(a,{children:"Status"}),e.jsx(a,{children:"Activated"}),e.jsx(a,{children:"Expires"})]})}),e.jsx(ie,{children:(I.licenses||[]).map(s=>e.jsxs(v,{children:[e.jsx(a,{children:e.jsx(n,{variant:"body2",fontFamily:"monospace",children:s.key})}),e.jsx(a,{children:e.jsx(m,{size:"small",label:s.status,color:ye(String(s.status).toLowerCase())})}),e.jsx(a,{children:s.activatedAt?new Date(s.activatedAt).toLocaleDateString():"—"}),e.jsx(a,{children:s.expiresAt?new Date(s.expiresAt).toLocaleDateString():"—"})]},s.id))})]})})]}):e.jsx(n,{variant:"body2",color:"text.secondary",children:"No details."})}),e.jsx(de,{children:e.jsx(p,{onClick:()=>je(!1),children:"Close"})})]}),e.jsxs(le,{open:rs,onClose:()=>pe(!1),maxWidth:"sm",fullWidth:!0,children:[e.jsx(oe,{children:"Edit License"}),e.jsx(ce,{children:e.jsx(n,{variant:"body2",color:"text.secondary",sx:{mb:2},children:"License management options will be available here."})}),e.jsx(de,{children:e.jsx(p,{onClick:()=>pe(!1),children:"Close"})})]}),e.jsxs(le,{open:ns,onClose:()=>X(!1),maxWidth:"sm",fullWidth:!0,children:[e.jsx(oe,{children:"Add License"}),e.jsx(ce,{children:e.jsxs(c,{container:!0,spacing:2,sx:{mt:.5},children:[e.jsx(c,{item:!0,xs:12,children:e.jsx(b,{select:!0,fullWidth:!0,label:"User",value:L.userId,onChange:s=>js(s.target.value),children:$.map(s=>e.jsx(g,{value:s.id,children:s.email},s.id))})}),e.jsx(c,{item:!0,xs:12,children:e.jsx(b,{select:!0,fullWidth:!0,label:"Subscription",value:L.subscriptionId,onChange:s=>Z(t=>({...t,subscriptionId:s.target.value})),disabled:!Ue.length,children:Ue.map(s=>e.jsxs(g,{value:s.id,children:[s.tier," — seats ",s.seats]},s.id))})}),e.jsx(c,{item:!0,xs:6,children:e.jsxs(b,{select:!0,fullWidth:!0,label:"Tier",value:L.tier,onChange:s=>Z(t=>({...t,tier:s.target.value})),children:[e.jsx(g,{value:"BASIC",children:"BASIC"}),e.jsx(g,{value:"PRO",children:"PRO"}),e.jsx(g,{value:"ENTERPRISE",children:"ENTERPRISE"})]})}),e.jsx(c,{item:!0,xs:6,children:e.jsx(b,{fullWidth:!0,type:"number",label:"Seats",inputProps:{min:1,max:1e3},value:L.seats,onChange:s=>Z(t=>({...t,seats:Math.max(1,Math.min(1e3,parseInt(s.target.value)||1))}))})})]})}),e.jsxs(de,{children:[e.jsx(p,{onClick:()=>X(!1),children:"Cancel"}),e.jsx(p,{variant:"contained",onClick:ps,disabled:!L.userId||!L.subscriptionId,children:"Create"})]})]})]})}),e.jsx(Os,{})]})};export{Js as default};
