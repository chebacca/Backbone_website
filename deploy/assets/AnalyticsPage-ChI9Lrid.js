import{j as e,aN as ne,aO as z,aP as G,H as M,B as t,C as ie,T as n,d as B,ai as _,w as T,x as g,y as u,aj as oe,z as p,a as c,R as F,aC as le,aD as ce,aE as de,a5 as A,aQ as xe,G as o,ab as he,aR as me,t as L,v as I,ag as ge,i as O,D as $,aS as ue}from"./mui-Cr9U6iW2.js";import{r as j,b as N}from"./vendor-CjD1bmmO.js";import{b as pe,c as je,h as fe}from"./useStreamlinedData-D5FdChpV.js";import{M as d}from"./MetricCard-CCtxyf7i.js";import"./UnifiedDataService-CU6m8gCm.js";import"./index-THr23qJW.js";import"./stripe-ggaMUove.js";import"./index.esm-B4qVkIPL.js";import"./index.esm-DmQE6AXN.js";const Re=()=>{var k;const{data:x,loading:H,error:V}=pe(),{data:l,loading:Q,error:Y}=je(),{data:f,loading:q,error:J}=fe(),[v,K]=j.useState("7d"),[y,X]=j.useState("api_calls"),R=H||Q||q,Z=V||Y||J,s=j.useMemo(()=>{var w,P,E;if(!x||!l||!f)return{totalApiCalls:0,responseTime:0,activeDevices:0,dataTransfer:0,uptime:99.8,dailyUsage:[],topEndpoints:[],geographicData:[],usageMetrics:[]};const a=f.length,r=((P=(w=l.organization)==null?void 0:w.usage)==null?void 0:P.totalUsers)||1,i=a*r*150,h=r,m=a*r*2.5,ae=Array.from({length:7},(ve,se)=>{const D=new Date;D.setDate(D.getDate()-(6-se));const re=i/7,te=.8+Math.random()*.4;return{label:D.toLocaleDateString("en-US",{weekday:"short"}),value:Math.floor(re*te),change:Math.floor((Math.random()-.5)*20)}}),W=((E=x.role)==null?void 0:E.toLowerCase())||"member",C=W==="admin"||W==="superadmin";return{totalApiCalls:i,responseTime:98.7,activeDevices:h,dataTransfer:m,uptime:99.8,dailyUsage:ae,topEndpoints:[{name:"/api/projects",calls:Math.floor(i*.3),percentage:30},{name:"/api/team-members",calls:Math.floor(i*.25),percentage:25},{name:"/api/licenses",calls:Math.floor(i*.2),percentage:20},{name:"/api/analytics",calls:Math.floor(i*.15),percentage:15},{name:"/api/auth",calls:Math.floor(i*.1),percentage:10}],geographicData:[{region:"North America",users:Math.floor(r*.6)||1,percentage:60},{region:"Europe",users:Math.floor(r*.25)||1,percentage:25},{region:"Asia Pacific",users:Math.floor(r*.15)||1,percentage:15}],usageMetrics:[{name:"API Calls",value:i,limit:C?1e6:1e5,unit:"calls",icon:e.jsx(ne,{}),color:"#00d4ff"},{name:"Data Transfer",value:m,limit:C?1e3:100,unit:"GB",icon:e.jsx(z,{}),color:"#667eea"},{name:"Active Devices",value:h,limit:C?500:50,unit:"devices",icon:e.jsx(G,{}),color:"#f093fb"},{name:"Uptime",value:99.8,limit:100,unit:"%",icon:e.jsx(M,{}),color:"#4facfe"}]}},[x,l,f,v]),ee=a=>{K(a.target.value)},b=a=>{X(a)},U=()=>{window.location.reload()},S=j.useMemo(()=>s.dailyUsage.length?s.dailyUsage.reduce((a,r)=>a+(r.change||0),0)/s.dailyUsage.length:0,[s.dailyUsage]);return R?e.jsx(t,{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"400px",children:e.jsxs(t,{textAlign:"center",children:[e.jsx(ie,{size:60}),e.jsx(n,{variant:"h6",sx:{mt:2},children:"Loading Analytics Data..."}),e.jsx(n,{variant:"body2",color:"text.secondary",children:"Calculating usage metrics and performance data"})]})}):Z?e.jsx(t,{sx:{p:3},children:e.jsxs(B,{severity:"error",children:[e.jsx(_,{children:"Unable to Load Analytics Data"}),e.jsx(n,{variant:"body2",sx:{mb:2},children:"We encountered an issue loading your analytics information. This could be due to:"}),e.jsxs(T,{dense:!0,children:[e.jsxs(g,{children:[e.jsx(u,{children:e.jsx(oe,{fontSize:"small"})}),e.jsx(p,{primary:"Network connectivity issues"})]}),e.jsxs(g,{children:[e.jsx(u,{children:e.jsx(M,{fontSize:"small"})}),e.jsx(p,{primary:"Authentication token expired"})]})]}),e.jsx(t,{sx:{mt:2},children:e.jsx(c,{variant:"contained",onClick:U,startIcon:e.jsx(F,{}),children:"Retry"})})]})}):!x||!l?e.jsx(t,{sx:{p:3},children:e.jsxs(B,{severity:"info",children:[e.jsx(_,{children:"Setting Up Analytics"}),e.jsx(n,{variant:"body2",children:"We're preparing your analytics dashboard. This may take a moment for new accounts."})]})}):e.jsxs(t,{children:[e.jsxs(t,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:4},children:[e.jsxs(t,{children:[e.jsx(n,{variant:"h4",sx:{fontWeight:700,mb:1},children:"Usage Analytics"}),e.jsxs(n,{variant:"h6",color:"text.secondary",sx:{mb:4},children:["Monitor your ",((k=l.organization)==null?void 0:k.name)||"Organization"," usage patterns and performance"]})]}),e.jsxs(t,{sx:{display:"flex",gap:2,alignItems:"center"},children:[e.jsxs(le,{size:"small",sx:{minWidth:120},children:[e.jsx(ce,{children:"Time Range"}),e.jsxs(de,{value:v,label:"Time Range",onChange:ee,disabled:R,children:[e.jsx(A,{value:"7d",children:"Last 7 days"}),e.jsx(A,{value:"30d",children:"Last 30 days"}),e.jsx(A,{value:"90d",children:"Last 90 days"})]})]}),e.jsxs(xe,{variant:"outlined",size:"small",children:[e.jsx(c,{variant:y==="api_calls"?"contained":"outlined",onClick:()=>b("api_calls"),children:"API Calls"}),e.jsx(c,{variant:y==="data_transfer"?"contained":"outlined",onClick:()=>b("data_transfer"),children:"Data Transfer"}),e.jsx(c,{variant:y==="devices"?"contained":"outlined",onClick:()=>b("devices"),children:"Devices"})]}),e.jsx(c,{variant:"outlined",onClick:U,startIcon:e.jsx(F,{}),children:"Refresh"})]})]}),e.jsxs(o,{container:!0,spacing:3,sx:{mb:4},children:[e.jsx(o,{item:!0,xs:12,sm:6,lg:3,children:e.jsx(d,{title:"Total API Calls",value:s.totalApiCalls.toLocaleString(),icon:e.jsx(he,{}),trend:{value:S,direction:S>=0?"up":"down"},color:"primary"})}),e.jsx(o,{item:!0,xs:12,sm:6,lg:3,children:e.jsx(d,{title:"Response Time",value:`${s.responseTime}%`,icon:e.jsx(me,{}),trend:{value:2.3,direction:"up"},color:"secondary"})}),e.jsx(o,{item:!0,xs:12,sm:6,lg:3,children:e.jsx(d,{title:"Active Devices",value:s.activeDevices.toString(),icon:e.jsx(G,{}),trend:{value:12,direction:"up"},color:"warning"})}),e.jsx(o,{item:!0,xs:12,sm:6,lg:3,children:e.jsx(d,{title:"Data Transfer",value:`${s.dataTransfer.toFixed(1)} GB`,icon:e.jsx(z,{}),trend:{value:.2,direction:"down"},color:"error"})}),e.jsx(o,{item:!0,xs:12,sm:6,lg:3,children:e.jsx(d,{title:"Uptime",value:`${s.uptime}%`,icon:e.jsx(M,{}),trend:{value:.1,direction:"up"},color:"success"})})]}),e.jsxs(o,{container:!0,spacing:3,children:[e.jsx(o,{item:!0,xs:12,lg:12,children:e.jsx(L,{sx:{mb:3},children:e.jsxs(I,{children:[e.jsxs(n,{variant:"h6",sx:{fontWeight:600,mb:3},children:["Usage Trends - ",v.replace("d"," Days")]}),e.jsx(t,{sx:{height:200,display:"flex",alignItems:"end",gap:1,px:2},children:s.dailyUsage.map((a,r)=>{const i=Math.max(...s.dailyUsage.map(m=>m.value)),h=i>0?a.value/i*160:0;return e.jsxs(t,{sx:{flex:1,display:"flex",flexDirection:"column",alignItems:"center"},children:[e.jsx(t,{sx:{width:"100%",height:`${h}px`,backgroundColor:"primary.main",borderRadius:"4px 4px 0 0",mb:1,transition:"all 0.3s ease","&:hover":{backgroundColor:"primary.dark",transform:"translateY(-2px)"}}}),e.jsx(n,{variant:"caption",color:"text.secondary",children:a.label}),e.jsx(n,{variant:"caption",sx:{fontWeight:600},children:a.value.toLocaleString()})]},r)})})]})})}),e.jsx(o,{item:!0,xs:12,md:6,children:e.jsx(L,{children:e.jsxs(I,{children:[e.jsx(n,{variant:"h6",sx:{fontWeight:600,mb:3},children:"Top API Endpoints"}),e.jsx(T,{dense:!0,children:s.topEndpoints.map((a,r)=>e.jsxs(N.Fragment,{children:[e.jsxs(g,{sx:{px:0},children:[e.jsx(u,{sx:{minWidth:40},children:e.jsx(ge,{sx:{width:32,height:32,bgcolor:"primary.main",fontSize:"0.875rem",fontWeight:600},children:r+1})}),e.jsx(p,{primary:a.name,secondary:e.jsxs(t,{sx:{display:"flex",alignItems:"center",gap:1,mt:.5},children:[e.jsx(O,{variant:"determinate",value:a.percentage,sx:{flex:1,height:4,borderRadius:2,backgroundColor:"rgba(255,255,255,0.1)","& .MuiLinearProgress-bar":{borderRadius:2,background:"linear-gradient(90deg, #00d4ff 0%, #667eea 100%)"}}}),e.jsxs(n,{variant:"caption",sx:{minWidth:60},children:[a.calls.toLocaleString()," calls"]})]}),primaryTypographyProps:{variant:"body2",fontWeight:500,sx:{fontFamily:"monospace"}}})]}),r<s.topEndpoints.length-1&&e.jsx($,{})]},a.name))})]})})}),e.jsx(o,{item:!0,xs:12,md:6,children:e.jsx(L,{children:e.jsxs(I,{children:[e.jsx(n,{variant:"h6",sx:{fontWeight:600,mb:3},children:"Geographic Distribution"}),e.jsx(T,{dense:!0,children:s.geographicData.map((a,r)=>e.jsxs(N.Fragment,{children:[e.jsxs(g,{sx:{px:0},children:[e.jsx(u,{sx:{minWidth:40},children:e.jsx(ue,{sx:{color:"primary.main"}})}),e.jsx(p,{primary:a.region,secondary:e.jsxs(t,{sx:{display:"flex",alignItems:"center",gap:1,mt:.5},children:[e.jsx(O,{variant:"determinate",value:a.percentage,sx:{flex:1,height:4,borderRadius:2,backgroundColor:"rgba(255,255,255,0.1)","& .MuiLinearProgress-bar":{borderRadius:2,background:"linear-gradient(90deg, #f093fb 0%, #f5576c 100%)"}}}),e.jsxs(n,{variant:"caption",sx:{minWidth:60},children:[a.users," users"]})]}),primaryTypographyProps:{variant:"body2",fontWeight:500}})]}),r<s.geographicData.length-1&&e.jsx($,{})]},a.region))})]})})})]})]})};export{Re as default};
