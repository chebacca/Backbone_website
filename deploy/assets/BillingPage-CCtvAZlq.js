import{j as e,a as r,T as s,d as l,m as S,k as G,l as V,G as a,h as j,c as m,az as _,U as Q,W as q,X as J,at as X,a5 as K,Y as Z,I as ee,aI as te,aL as ae,a$ as se,p as re,aC as ne,aD as ie,aE as le,aF as P,aG as n,aH as oe,ar as ce,aN as v,aO as D,aP as I,t as de,u as h,aQ as k,aS as xe,aT as ue,aU as he,a4 as d,D as pe,ak as je,n as W,aR as me,ax as ge}from"./mui-DiYnqcGn.js";import{r as c,b as ye}from"./vendor-DIxetjBo.js";import{u as be}from"./notistack.esm-Bg0Tn0tt.js";import{p as fe}from"./paymentService-DzsXQ2GY.js";import"./index-hKV-t7kj.js";import"./stripe-CQkQ71Kl.js";const Ce=[{id:"1",type:"card",last4:"4242",brand:"Visa",expiryMonth:12,expiryYear:2025,isDefault:!0},{id:"2",type:"card",last4:"5555",brand:"Mastercard",expiryMonth:8,expiryYear:2026,isDefault:!1}],Se={id:"1",plan:"PRO",status:"active",currentPeriodStart:"2024-01-15",currentPeriodEnd:"2024-02-15",seats:3,amount:29700,nextPaymentDate:"2024-02-15"},g=o=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(o/100),w=o=>{switch(o){case"paid":case"active":return"success";case"pending":return"warning";case"failed":case"past_due":return"error";case"canceled":return"default";default:return"default"}},U=o=>{switch(o){case"paid":case"active":return e.jsx(W,{});case"pending":return e.jsx(ge,{});case"failed":case"past_due":return e.jsx(me,{});default:return e.jsx(W,{})}},Ae=()=>{const{enqueueSnackbar:o}=be(),[A]=c.useState(Ce),[i]=c.useState(Se),[E,M]=c.useState([]),[Pe,y]=c.useState(!1),[T,p]=c.useState(!1),[R,x]=c.useState(!1),[b,B]=c.useState("PRO"),[f,L]=c.useState(3),[C,u]=c.useState(null),N=()=>{o("Payment method added successfully",{variant:"success"}),p(!1)},F=()=>{o("Subscription updated successfully",{variant:"success"}),x(!1)},O=t=>{t.receiptUrl?window.open(t.receiptUrl,"_blank"):o("No receipt available for this payment",{variant:"info"})};c.useEffect(()=>{(async()=>{try{y(!0);const t=await fe.getPaymentHistory({limit:25});M(t.payments||[])}catch(t){o((t==null?void 0:t.message)||"Failed to load billing history",{variant:"error"})}finally{y(!1)}})()},[]);const Y=()=>({BASIC:2900,PRO:9900,ENTERPRISE:19900})[b]*f,z=g(i.amount),$=Math.ceil((new Date(i.nextPaymentDate).getTime()-new Date().getTime())/(1e3*60*60*24));return e.jsxs(r,{children:[e.jsx(r,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.6},children:e.jsxs(r,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:4},children:[e.jsxs(r,{children:[e.jsx(s,{variant:"h4",sx:{fontWeight:700,mb:1},children:"Billing & Payments"}),e.jsx(s,{variant:"body1",color:"text.secondary",children:"Manage your subscription, payment methods, and billing history"})]}),e.jsx(l,{variant:"contained",startIcon:e.jsx(S,{}),onClick:()=>x(!0),sx:{background:"linear-gradient(135deg, #00d4ff 0%, #667eea 100%)",color:"#000",fontWeight:600},children:"Upgrade Plan"})]})}),e.jsx(r,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.1},children:e.jsx(G,{sx:{mb:4,background:"linear-gradient(135deg, rgba(0, 212, 255, 0.1) 0%, rgba(102, 126, 234, 0.1) 100%)",border:"1px solid rgba(0, 212, 255, 0.2)"},children:e.jsx(V,{sx:{p:4},children:e.jsxs(a,{container:!0,spacing:4,alignItems:"center",children:[e.jsxs(a,{item:!0,xs:12,md:8,children:[e.jsxs(r,{sx:{display:"flex",alignItems:"center",gap:2,mb:2},children:[e.jsx(j,{label:i.plan,color:"primary",sx:{fontWeight:600,fontSize:"1rem",px:2,py:1}}),e.jsx(j,{icon:U(i.status),label:i.status.toUpperCase(),color:w(i.status),sx:{fontWeight:500}})]}),e.jsxs(s,{variant:"h5",sx:{fontWeight:600,mb:1},children:[g(i.amount)," / month"]}),e.jsxs(s,{variant:"body1",color:"text.secondary",sx:{mb:2},children:[i.seats," seats • Next payment in ",$," days"]}),e.jsxs(s,{variant:"body2",color:"text.secondary",children:["Current period: ",new Date(i.currentPeriodStart).toLocaleDateString()," - ",new Date(i.currentPeriodEnd).toLocaleDateString()]})]}),e.jsx(a,{item:!0,xs:12,md:4,children:e.jsxs(r,{sx:{textAlign:{xs:"left",md:"right"}},children:[e.jsx(s,{variant:"body2",color:"text.secondary",sx:{mb:1},children:"Next Payment"}),e.jsx(s,{variant:"h4",sx:{fontWeight:700,color:"primary.main",mb:2},children:z}),e.jsxs(s,{variant:"body2",color:"text.secondary",children:["on ",new Date(i.nextPaymentDate).toLocaleDateString()]})]})})]})})})}),e.jsxs(a,{container:!0,spacing:4,children:[e.jsx(a,{item:!0,xs:12,lg:6,children:e.jsx(r,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.6,delay:.2},children:e.jsxs(m,{sx:{p:3,background:"linear-gradient(135deg, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0.05) 100%)",backdropFilter:"blur(20px)",border:"1px solid rgba(255,255,255,0.1)",mb:3},children:[e.jsxs(r,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:[e.jsx(s,{variant:"h6",sx:{fontWeight:600},children:"Payment Methods"}),e.jsx(l,{variant:"outlined",startIcon:e.jsx(_,{}),onClick:()=>p(!0),size:"small",children:"Add Method"})]}),e.jsx(Q,{children:A.map((t,ve)=>e.jsx(ye.Fragment,{children:e.jsxs(q,{sx:{px:0,border:t.isDefault?"1px solid rgba(0, 212, 255, 0.3)":"1px solid rgba(255,255,255,0.1)",borderRadius:2,mb:1,backgroundColor:t.isDefault?"rgba(0, 212, 255, 0.05)":"rgba(255,255,255,0.02)"},children:[e.jsx(J,{sx:{ml:2},children:e.jsx(X,{sx:{bgcolor:"primary.main",width:40,height:40},children:e.jsx(K,{})})}),e.jsx(Z,{primary:e.jsxs(r,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsxs(s,{variant:"body1",sx:{fontWeight:500},children:[t.brand," •••• ",t.last4]}),t.isDefault&&e.jsx(j,{label:"Default",size:"small",color:"primary"})]}),secondary:`Expires ${t.expiryMonth}/${t.expiryYear}`,sx:{ml:1}}),e.jsx(ee,{onClick:H=>u(H.currentTarget),sx:{mr:2},children:e.jsx(te,{})})]})},t.id))})]})})}),e.jsx(a,{item:!0,xs:12,lg:6,children:e.jsx(r,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{duration:.6,delay:.3},children:e.jsxs(m,{sx:{p:3,background:"linear-gradient(135deg, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0.05) 100%)",backdropFilter:"blur(20px)",border:"1px solid rgba(255,255,255,0.1)",mb:3},children:[e.jsx(s,{variant:"h6",sx:{fontWeight:600,mb:3},children:"Quick Actions"}),e.jsxs(a,{container:!0,spacing:2,children:[e.jsx(a,{item:!0,xs:12,children:e.jsx(l,{variant:"outlined",startIcon:e.jsx(S,{}),fullWidth:!0,onClick:()=>x(!0),sx:{justifyContent:"flex-start",py:1.5},children:"Upgrade Plan"})}),e.jsx(a,{item:!0,xs:12,children:e.jsx(l,{variant:"outlined",startIcon:e.jsx(ae,{}),fullWidth:!0,sx:{justifyContent:"flex-start",py:1.5},children:"Update Billing Info"})}),e.jsx(a,{item:!0,xs:12,children:e.jsx(l,{variant:"outlined",startIcon:e.jsx(se,{}),fullWidth:!0,sx:{justifyContent:"flex-start",py:1.5},children:"Download All Invoices"})}),e.jsx(a,{item:!0,xs:12,children:e.jsx(l,{variant:"outlined",startIcon:e.jsx(re,{}),fullWidth:!0,sx:{justifyContent:"flex-start",py:1.5},children:"Billing Security Settings"})})]})]})})}),e.jsx(a,{item:!0,xs:12,children:e.jsx(r,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.4},children:e.jsxs(m,{sx:{p:3,background:"linear-gradient(135deg, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0.05) 100%)",backdropFilter:"blur(20px)",border:"1px solid rgba(255,255,255,0.1)"},children:[e.jsx(s,{variant:"h6",sx:{fontWeight:600,mb:3},children:"Billing History"}),e.jsx(ne,{children:e.jsxs(ie,{children:[e.jsx(le,{children:e.jsxs(P,{children:[e.jsx(n,{sx:{fontWeight:600},children:"Invoice"}),e.jsx(n,{sx:{fontWeight:600},children:"Date"}),e.jsx(n,{sx:{fontWeight:600},children:"Description"}),e.jsx(n,{sx:{fontWeight:600},children:"Amount"}),e.jsx(n,{sx:{fontWeight:600},children:"Status"}),e.jsx(n,{sx:{fontWeight:600},children:"Actions"})]})}),e.jsx(oe,{children:E.map(t=>e.jsxs(P,{hover:!0,children:[e.jsx(n,{children:e.jsx(s,{variant:"body2",sx:{fontWeight:500,fontFamily:"monospace"},children:t.id})}),e.jsx(n,{children:e.jsx(s,{variant:"body2",children:new Date(t.createdAt).toLocaleDateString()})}),e.jsx(n,{children:e.jsx(s,{variant:"body2",children:t.description})}),e.jsx(n,{children:e.jsx(s,{variant:"body2",sx:{fontWeight:500},children:new Intl.NumberFormat("en-US",{style:"currency",currency:(t.currency||"USD").toUpperCase()}).format((t.amount||0)/100)})}),e.jsx(n,{children:e.jsx(j,{icon:U(String(t.status).toLowerCase()),label:String(t.status).toUpperCase(),color:w(String(t.status).toLowerCase()),size:"small"})}),e.jsx(n,{children:e.jsx(l,{variant:"outlined",size:"small",startIcon:e.jsx(ce,{}),onClick:()=>O(t),children:"Receipt"})})]},t.id))})]})})]})})})]}),e.jsxs(v,{open:T,onClose:()=>p(!1),maxWidth:"sm",fullWidth:!0,PaperProps:{sx:{backgroundColor:"background.paper",border:"1px solid rgba(255, 255, 255, 0.1)"}},children:[e.jsx(D,{children:"Add Payment Method"}),e.jsxs(I,{children:[e.jsx(de,{severity:"info",sx:{mb:3},children:"Your payment information is securely processed by Stripe and never stored on our servers."}),e.jsxs(a,{container:!0,spacing:3,children:[e.jsx(a,{item:!0,xs:12,children:e.jsx(h,{fullWidth:!0,label:"Card Number",placeholder:"1234 5678 9012 3456",sx:{mt:1}})}),e.jsx(a,{item:!0,xs:6,children:e.jsx(h,{fullWidth:!0,label:"Expiry Date",placeholder:"MM/YY"})}),e.jsx(a,{item:!0,xs:6,children:e.jsx(h,{fullWidth:!0,label:"CVC",placeholder:"123"})}),e.jsx(a,{item:!0,xs:12,children:e.jsx(h,{fullWidth:!0,label:"Cardholder Name",placeholder:"John Doe"})})]})]}),e.jsxs(k,{children:[e.jsx(l,{onClick:()=>p(!1),children:"Cancel"}),e.jsx(l,{onClick:N,variant:"contained",children:"Add Payment Method"})]})]}),e.jsxs(v,{open:R,onClose:()=>x(!1),maxWidth:"md",fullWidth:!0,PaperProps:{sx:{backgroundColor:"background.paper",border:"1px solid rgba(255, 255, 255, 0.1)"}},children:[e.jsx(D,{children:"Upgrade Your Plan"}),e.jsx(I,{children:e.jsxs(a,{container:!0,spacing:3,children:[e.jsx(a,{item:!0,xs:12,sm:6,children:e.jsxs(xe,{fullWidth:!0,children:[e.jsx(ue,{children:"Select Plan"}),e.jsxs(he,{value:b,label:"Select Plan",onChange:t=>B(t.target.value),inputProps:{"aria-label":"Select subscription plan",title:"Choose your subscription plan"},children:[e.jsx(d,{value:"BASIC",children:"Basic - $29/month"}),e.jsx(d,{value:"PRO",children:"Pro - $99/month"}),e.jsx(d,{value:"ENTERPRISE",children:"Enterprise - $199/month"})]})]})}),e.jsx(a,{item:!0,xs:12,sm:6,children:e.jsx(h,{fullWidth:!0,label:"Number of Seats",type:"number",value:f,onChange:t=>L(parseInt(t.target.value)),inputProps:{min:1,max:100}})}),e.jsxs(a,{item:!0,xs:12,children:[e.jsx(pe,{sx:{my:2}}),e.jsx(r,{sx:{display:"flex",justifyContent:"between",alignItems:"center"},children:e.jsxs(s,{variant:"h6",children:["Total: ",g(Y())," / month"]})})]})]})}),e.jsxs(k,{children:[e.jsx(l,{onClick:()=>x(!1),children:"Cancel"}),e.jsx(l,{onClick:F,variant:"contained",children:"Upgrade Now"})]})]}),e.jsxs(je,{anchorEl:C,open:!!C,onClose:()=>u(null),PaperProps:{sx:{backgroundColor:"background.paper",border:"1px solid rgba(255, 255, 255, 0.1)"}},children:[e.jsx(d,{onClick:()=>u(null),children:"Set as Default"}),e.jsx(d,{onClick:()=>u(null),children:"Edit"}),e.jsx(d,{onClick:()=>u(null),sx:{color:"error.main"},children:"Remove"})]})]})};export{Ae as default};
