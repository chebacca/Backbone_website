import{j as e,B as a,T as t,c as B,F as H,r as $,s as xe,G as l,t as me,u as ne,v as ue,w as G,x as A,y as T,m as L,z as I,a as q,e as P,f as O,X,W as oe,D as M,a5 as W,N as pe,O as he,Q as be,U as ge,k as V,l as Z,aV as ye,d as J,H as fe,S as je,b as ee,A as re,bZ as Ce,b_ as ve,b$ as Se,q as Pe,cg as Ae,aa as se,p as Ie}from"./mui-D_3t3Wff.js";import{b as le,L as _,r as k,u as ke,e as we}from"./vendor-CjD1bmmO.js";import{c as R,e as N,u as Ee,a as We}from"./index-BxMGX29a.js";import{u as Te}from"./notistack.esm-Ca-E78ev.js";import{N as ie}from"./Navigation-BiAxmS2L.js";import{u as Re,C as v}from"./index.esm-VL_aqrbB.js";import{u as Ne,a as Le,C as ae,b as Be,c as Fe}from"./stripe-DQqYxQf-.js";const Y={async getPricingTiers(){const r=await R.get(N.payments.pricing());if(r.data.success)return r.data.data.pricingTiers;throw new Error(r.data.message||"Failed to get pricing")},async calculateTax(r){const i=await R.post(N.payments.calculateTax(),r);if(i.data.success)return i.data.data.taxCalculation;throw new Error(i.data.message||"Failed to calculate tax")},async createSubscription(r){const i=await R.post(N.payments.createSubscription(),r);if(i.data.success)return i.data.data;throw new Error(i.data.message||"Failed to create subscription")},async getPaymentHistory(r={}){const i=new URLSearchParams;r.page&&i.append("page",r.page.toString()),r.limit&&i.append("limit",r.limit.toString());const o=await R.get(`${N.payments.history()}?${i}`);if(o.data.success)return o.data.data;throw new Error(o.data.message||"Failed to get payment history")},async getUserInvoices(r={}){const i=new URLSearchParams;r.page&&i.append("page",r.page.toString()),r.limit&&i.append("limit",r.limit.toString());const o=await R.get(`${N.invoices.list()}?${i}`);if(o.data.success)return o.data.data;throw new Error(o.data.message||"Failed to get invoices")},async getPaymentDetails(r){const i=await R.get(N.payments.details(r));if(i.data.success)return i.data.data.payment;throw new Error(i.data.message||"Failed to get payment details")},async cancelSubscription(r,i={}){const o=await R.post(N.payments.cancelSubscription(r),i);if(o.data.success)return o.data.data;throw new Error(o.data.message||"Failed to cancel subscription")},async updatePaymentMethod(r,i){const o=await R.put(N.payments.updatePaymentMethod(r),{paymentMethodId:i});if(o.data.success)return o.data.data;throw new Error(o.data.message||"Failed to update payment method")},validateBillingAddress(r){var o,g,j,y,d,f,c,s;const i=[];return(o=r.firstName)!=null&&o.trim()||i.push("First name is required"),(g=r.lastName)!=null&&g.trim()||i.push("Last name is required"),(j=r.addressLine1)!=null&&j.trim()||i.push("Address is required"),(y=r.city)!=null&&y.trim()||i.push("City is required"),(d=r.postalCode)!=null&&d.trim()||i.push("Postal code is required"),(!((f=r.country)!=null&&f.trim())||r.country.length!==2)&&i.push("Valid country code is required"),r.country==="US"&&!((c=r.state)!=null&&c.trim())&&i.push("State is required for US addresses"),r.country==="CA"&&!((s=r.state)!=null&&s.trim())&&i.push("Province is required for Canadian addresses"),{valid:i.length===0,errors:i}},formatCurrency(r,i="USD"){return new Intl.NumberFormat("en-US",{style:"currency",currency:i}).format(r/100)},formatTaxRate(r){return`${(r*100).toFixed(2)}%`},getPaymentStatusInfo(r){switch(r.toLowerCase()){case"succeeded":return{color:"success",label:"Successful"};case"pending":return{color:"warning",label:"Pending"};case"failed":return{color:"error",label:"Failed"};case"canceled":return{color:"default",label:"Canceled"};case"requires_action":return{color:"info",label:"Action Required"};default:return{color:"default",label:r}}},calculateSubscriptionPricing(r,i,o=0,g=!1){let j=r*i;const y=g?Math.round(j*2/12):0,d=j-y,f=Math.round(d*o),c=d+f;return{subtotal:j,discount:y,taxAmount:f,total:c}},validatePaymentForm(r){const i={};r.tier||(i.tier="Please select a plan"),(!r.seats||r.seats<1)&&(i.seats="At least 1 seat is required"),r.tier==="BASIC"&&r.seats>1&&(i.seats="Basic plan is limited to 1 seat"),r.tier==="PRO"&&r.seats>50&&(i.seats="Pro plan is limited to 50 seats"),r.tier==="ENTERPRISE"&&r.seats<10&&(i.seats="Enterprise plan requires minimum 10 seats");const o=this.validateBillingAddress(r.billingAddress);return o.valid||(i.billingAddress=o.errors.join(", ")),r.acceptTerms||(i.acceptTerms="You must accept the Terms of Service"),r.acceptPrivacy||(i.acceptPrivacy="You must accept the Privacy Policy"),{valid:Object.keys(i).length===0,errors:i}}},qe=({pricingTiers:r,selectedTier:i,seats:o,isYearly:g,onUpdate:j})=>{const y=s=>{const b=r.find(C=>C.id===s);if(!b)return;let x=o;b.id==="BASIC"&&o>1?x=1:b.id==="ENTERPRISE"&&o<10&&(x=10),j({tier:s,seats:x})},d=s=>{const b=r.find(x=>x.id===i);b&&(b.id==="BASIC"&&s>1||b.id==="PRO"&&s>50||b.id==="ENTERPRISE"&&s<10||s<1||j({seats:s}))},f=s=>{switch(s){case"BASIC":return e.jsx(O,{});case"PRO":return e.jsx(oe,{});case"ENTERPRISE":return e.jsx(X,{});default:return e.jsx(O,{})}},c=s=>s.price?`$${g?s.price*10:s.price}`:"Custom";return e.jsxs(a,{children:[e.jsx(t,{variant:"h5",sx:{mb:1,fontWeight:600},children:"Choose Your Plan"}),e.jsx(t,{variant:"body1",color:"text.secondary",sx:{mb:4},children:"Select the plan that best fits your needs. You can change or cancel anytime."}),e.jsx(a,{sx:{display:"flex",justifyContent:"center",mb:4},children:e.jsx(B,{elevation:2,sx:{display:"inline-flex",p:.5,backgroundColor:"background.paper",borderRadius:4},children:e.jsx(H,{control:e.jsx(xe,{checked:g,onChange:s=>j({isYearly:s.target.checked}),color:"primary"}),label:e.jsxs(a,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(t,{variant:"body2",children:"Annual billing"}),e.jsx($,{label:"Save 17%",size:"small",color:"primary",variant:"outlined"})]}),sx:{m:1}})})}),e.jsx(l,{container:!0,spacing:3,sx:{mb:4},children:r.map(s=>e.jsx(l,{item:!0,xs:12,md:4,children:e.jsx(a,{children:e.jsxs(me,{sx:{height:"100%",position:"relative",backgroundColor:s.id===i?"primary.dark":"background.paper",border:s.id===i?"2px solid":"1px solid rgba(255, 255, 255, 0.1)",borderColor:s.id===i?"primary.main":void 0,cursor:"pointer",transition:"all 0.3s ease"},onClick:()=>y(s.id),children:[s.popular&&e.jsx(a,{sx:{position:"absolute",top:-12,left:"50%",transform:"translateX(-50%)"},children:e.jsx($,{icon:e.jsx(ne,{}),label:"Most Popular",color:"primary",sx:{fontWeight:600,color:"#000"}})}),e.jsxs(ue,{sx:{p:3,height:"100%",display:"flex",flexDirection:"column"},children:[e.jsxs(a,{sx:{textAlign:"center",mb:3},children:[e.jsx(a,{sx:{width:48,height:48,borderRadius:2,backgroundColor:s.id===i?"rgba(0, 212, 255, 0.2)":"rgba(0, 212, 255, 0.1)",display:"flex",alignItems:"center",justifyContent:"center",mx:"auto",mb:2,color:"primary.main"},children:f(s.id)}),e.jsx(t,{variant:"h6",sx:{fontWeight:600,mb:1},children:s.name}),e.jsx(t,{variant:"body2",color:"text.secondary",sx:{mb:2},children:s.description}),e.jsxs(a,{sx:{mb:2},children:[e.jsx(t,{variant:"h4",sx:{fontWeight:700},children:c(s)}),e.jsx(t,{variant:"body2",color:"text.secondary",children:s.price?g?"/year":"/month":"Contact Sales"})]}),s.maxSeats&&e.jsxs(t,{variant:"body2",color:"text.secondary",children:["Up to ",s.maxSeats," ",s.maxSeats===1?"user":"users"]})]}),e.jsx(G,{dense:!0,sx:{p:0,flexGrow:1},children:s.features.slice(0,6).map((b,x)=>e.jsxs(A,{sx:{px:0,py:.25},children:[e.jsx(T,{sx:{minWidth:20},children:e.jsx(L,{sx:{fontSize:14,color:"success.main"}})}),e.jsx(I,{primary:b,primaryTypographyProps:{variant:"body2",sx:{fontSize:"0.8rem"}}})]},x))}),s.id===i&&e.jsx(q,{variant:"contained",fullWidth:!0,sx:{mt:2,background:"linear-gradient(135deg, #00d4ff 0%, #667eea 100%)",color:"#000"},children:"Selected"})]})]})})},s.id))}),i&&e.jsxs(a,{children:[e.jsx(t,{variant:"h6",sx:{mb:2,fontWeight:600},children:"Number of Seats"}),e.jsxs(l,{container:!0,spacing:2,alignItems:"center",children:[e.jsx(l,{item:!0,xs:12,sm:6,md:4,children:e.jsx(P,{fullWidth:!0,label:"Number of seats",type:"number",value:o,onChange:s=>d(parseInt(s.target.value)||1),inputProps:{min:i==="ENTERPRISE"?10:1,max:i==="BASIC"?1:i==="PRO"?50:1e3},helperText:i==="BASIC"?"Basic plan includes 1 seat only":i==="PRO"?"Pro plan supports up to 50 seats":"Enterprise plan minimum 10 seats"})}),e.jsx(l,{item:!0,xs:12,sm:6,md:8,children:e.jsx(t,{variant:"body2",color:"text.secondary",children:"Each seat allows one user to access BackboneLogic, Inc."})})]})]})]})},Oe=[{code:"US",name:"United States"},{code:"CA",name:"Canada"},{code:"GB",name:"United Kingdom"},{code:"DE",name:"Germany"},{code:"FR",name:"France"},{code:"AU",name:"Australia"},{code:"JP",name:"Japan"}],Me=[{code:"AL",name:"Alabama"},{code:"CA",name:"California"},{code:"FL",name:"Florida"},{code:"NY",name:"New York"},{code:"TX",name:"Texas"}],ze=({billingAddress:r,taxInformation:i,businessProfile:o,acceptTerms:g,acceptPrivacy:j,onUpdate:y})=>{var C,w,F;const{control:d,watch:f,formState:{errors:c}}=Re({defaultValues:{billingAddress:r,taxInformation:i,businessProfile:o,acceptTerms:g,acceptPrivacy:j}}),s=f(),b=(C=s.billingAddress)==null?void 0:C.country,x=c;return le.useEffect(()=>{y(s)},[s,y]),e.jsxs(a,{children:[e.jsx(t,{variant:"h5",sx:{mb:1,fontWeight:600},children:"Billing Information"}),e.jsx(t,{variant:"body1",color:"text.secondary",sx:{mb:4},children:"Please provide your billing details for invoicing and compliance."}),e.jsxs(l,{container:!0,spacing:3,children:[e.jsx(l,{item:!0,xs:12,children:e.jsxs(t,{variant:"h6",sx:{mb:2,fontWeight:600,display:"flex",alignItems:"center",gap:1},children:[e.jsx(O,{})," Contact Information"]})}),e.jsx(l,{item:!0,xs:12,sm:6,children:e.jsx(v,{name:"billingAddress.firstName",control:d,rules:{required:"First name is required"},render:({field:m})=>{var p,n,u;return e.jsx(P,{...m,fullWidth:!0,label:"First Name",error:!!((p=x.billingAddress)!=null&&p.firstName),helperText:(u=(n=x.billingAddress)==null?void 0:n.firstName)==null?void 0:u.message})}})}),e.jsx(l,{item:!0,xs:12,sm:6,children:e.jsx(v,{name:"billingAddress.lastName",control:d,rules:{required:"Last name is required"},render:({field:m})=>{var p,n,u;return e.jsx(P,{...m,fullWidth:!0,label:"Last Name",error:!!((p=x.billingAddress)!=null&&p.lastName),helperText:(u=(n=x.billingAddress)==null?void 0:n.lastName)==null?void 0:u.message})}})}),e.jsx(l,{item:!0,xs:12,children:e.jsx(v,{name:"billingAddress.company",control:d,render:({field:m})=>e.jsx(P,{...m,fullWidth:!0,label:"Company (Optional)",helperText:"If purchasing for a business"})})}),e.jsxs(l,{item:!0,xs:12,children:[e.jsx(M,{sx:{my:2}}),e.jsx(t,{variant:"h6",sx:{mb:2,fontWeight:600},children:"Billing Address"})]}),e.jsx(l,{item:!0,xs:12,children:e.jsx(v,{name:"billingAddress.addressLine1",control:d,rules:{required:"Address is required"},render:({field:m})=>{var p,n,u;return e.jsx(P,{...m,fullWidth:!0,label:"Address Line 1",error:!!((p=x.billingAddress)!=null&&p.addressLine1),helperText:(u=(n=x.billingAddress)==null?void 0:n.addressLine1)==null?void 0:u.message})}})}),e.jsx(l,{item:!0,xs:12,children:e.jsx(v,{name:"billingAddress.addressLine2",control:d,render:({field:m})=>e.jsx(P,{...m,fullWidth:!0,label:"Address Line 2 (Optional)"})})}),e.jsx(l,{item:!0,xs:12,sm:6,children:e.jsx(v,{name:"billingAddress.city",control:d,rules:{required:"City is required"},render:({field:m})=>{var p,n,u;return e.jsx(P,{...m,fullWidth:!0,label:"City",error:!!((p=x.billingAddress)!=null&&p.city),helperText:(u=(n=x.billingAddress)==null?void 0:n.city)==null?void 0:u.message})}})}),e.jsx(l,{item:!0,xs:12,sm:6,children:e.jsx(v,{name:"billingAddress.postalCode",control:d,rules:{required:"Postal code is required"},render:({field:m})=>{var p,n,u;return e.jsx(P,{...m,fullWidth:!0,label:"Postal Code",error:!!((p=x.billingAddress)!=null&&p.postalCode),helperText:(u=(n=x.billingAddress)==null?void 0:n.postalCode)==null?void 0:u.message})}})}),e.jsx(l,{item:!0,xs:12,sm:6,children:e.jsx(v,{name:"billingAddress.country",control:d,rules:{required:"Country is required"},render:({field:m})=>{var p,n,u;return e.jsx(P,{...m,fullWidth:!0,select:!0,label:"Country",error:!!((p=x.billingAddress)!=null&&p.country),helperText:(u=(n=x.billingAddress)==null?void 0:n.country)==null?void 0:u.message,children:Oe.map(S=>e.jsx(W,{value:S.code,children:S.name},S.code))})}})}),(b==="US"||b==="CA")&&e.jsx(l,{item:!0,xs:12,sm:6,children:e.jsx(v,{name:"billingAddress.state",control:d,rules:{required:"State/Province is required"},render:({field:m})=>{var p,n,u;return e.jsx(P,{...m,fullWidth:!0,select:!0,label:b==="US"?"State":"Province",error:!!((p=x.billingAddress)!=null&&p.state),helperText:(u=(n=x.billingAddress)==null?void 0:n.state)==null?void 0:u.message,children:Me.map(S=>e.jsx(W,{value:S.code,children:S.name},S.code))})}})}),e.jsx(l,{item:!0,xs:12,children:e.jsxs(pe,{children:[e.jsx(he,{expandIcon:e.jsx(be,{}),children:e.jsxs(a,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(X,{}),e.jsx(t,{variant:"h6",sx:{fontWeight:600},children:"Business Information (Optional)"})]})}),e.jsx(ge,{children:e.jsxs(l,{container:!0,spacing:3,children:[e.jsx(l,{item:!0,xs:12,children:e.jsx(v,{name:"businessProfile.companyName",control:d,render:({field:m})=>e.jsx(P,{...m,fullWidth:!0,label:"Company Name",helperText:"Required for business purchases and volume discounts"})})}),e.jsx(l,{item:!0,xs:12,sm:6,children:e.jsx(v,{name:"businessProfile.companyType",control:d,render:({field:m})=>e.jsxs(P,{...m,fullWidth:!0,select:!0,label:"Company Type",children:[e.jsx(W,{value:"SOLE_PROPRIETORSHIP",children:"Sole Proprietorship"}),e.jsx(W,{value:"PARTNERSHIP",children:"Partnership"}),e.jsx(W,{value:"LLC",children:"LLC"}),e.jsx(W,{value:"CORPORATION",children:"Corporation"}),e.jsx(W,{value:"NON_PROFIT",children:"Non-Profit"}),e.jsx(W,{value:"GOVERNMENT",children:"Government"}),e.jsx(W,{value:"OTHER",children:"Other"})]})})}),e.jsx(l,{item:!0,xs:12,sm:6,children:e.jsx(v,{name:"taxInformation.taxId",control:d,render:({field:m})=>e.jsx(P,{...m,fullWidth:!0,label:"Tax ID / VAT Number",helperText:"For tax exemption and business verification"})})}),e.jsx(l,{item:!0,xs:12,children:e.jsx(v,{name:"businessProfile.businessDescription",control:d,render:({field:m})=>e.jsx(P,{...m,fullWidth:!0,multiline:!0,rows:3,label:"Business Description",helperText:"Brief description of your business (optional)"})})})]})})]})}),e.jsxs(l,{item:!0,xs:12,children:[e.jsx(M,{sx:{my:2}}),e.jsx(t,{variant:"h6",sx:{mb:2,fontWeight:600},children:"Legal Agreements"})]}),e.jsx(l,{item:!0,xs:12,children:e.jsx(v,{name:"acceptTerms",control:d,rules:{required:"You must accept the Terms of Service"},render:({field:{value:m,onChange:p}})=>e.jsx(H,{control:e.jsx(Z,{checked:m,onChange:p,color:"primary",icon:e.jsx(a,{sx:{width:20,height:20,border:"2px solid",borderColor:"rgba(255,255,255,0.3)",borderRadius:.5}}),checkedIcon:e.jsx(a,{sx:{width:20,height:20,backgroundColor:"primary.main",color:"#000",borderRadius:.5,display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(L,{sx:{fontSize:14}})})}),label:e.jsxs(t,{variant:"body2",children:["I agree to the"," ",e.jsx(V,{component:_,to:"/terms",target:"_blank",sx:{color:"primary.main"},children:"Terms of Service"})," ","and"," ",e.jsx(V,{component:_,to:"/sla",target:"_blank",sx:{color:"primary.main"},children:"Service Level Agreement"})]}),sx:{alignItems:"flex-start",...c.acceptTerms&&{color:"error.main"}}})})}),e.jsx(l,{item:!0,xs:12,children:e.jsx(v,{name:"acceptPrivacy",control:d,rules:{required:"You must accept the Privacy Policy"},render:({field:{value:m,onChange:p}})=>e.jsx(H,{control:e.jsx(Z,{checked:m,onChange:p,color:"primary",icon:e.jsx(a,{sx:{width:20,height:20,border:"2px solid",borderColor:"rgba(255,255,255,0.3)",borderRadius:.5}}),checkedIcon:e.jsx(a,{sx:{width:20,height:20,backgroundColor:"primary.main",color:"#000",borderRadius:.5,display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(L,{sx:{fontSize:14}})})}),label:e.jsxs(t,{variant:"body2",children:["I agree to the"," ",e.jsx(V,{component:_,to:"/privacy",target:"_blank",sx:{color:"primary.main"},children:"Privacy Policy"})," ","and consent to data processing for billing and service delivery"]}),sx:{alignItems:"flex-start",...c.acceptPrivacy&&{color:"error.main"}}})})}),(c.acceptTerms||c.acceptPrivacy)&&e.jsx(l,{item:!0,xs:12,children:e.jsx(t,{variant:"caption",color:"error.main",children:((w=c.acceptTerms)==null?void 0:w.message)||((F=c.acceptPrivacy)==null?void 0:F.message)})})]}),e.jsxs(a,{sx:{mt:4,p:3,backgroundColor:"rgba(255, 255, 255, 0.02)",borderRadius:2,border:"1px solid rgba(255, 255, 255, 0.1)"},children:[e.jsx(t,{variant:"body2",color:"text.secondary",sx:{mb:1},children:e.jsx("strong",{children:"Privacy & Compliance Notice"})}),e.jsx(t,{variant:"caption",color:"text.secondary",children:"Your information is collected in accordance with GDPR, CCPA, and other applicable privacy laws. We use industry-standard encryption and security measures to protect your data. Tax information is used solely for compliance and billing purposes."})]})]})},Ue=({checkoutData:r,taxCalculation:i,onComplete:o})=>{const g=Ne(),j=Le(),[y,d]=k.useState(!1),[f,c]=k.useState(null),[s,b]=k.useState({cardNumber:!1,cardExpiry:!1,cardCvc:!1}),x=le.useMemo(()=>({BASIC:{name:"Basic",price:2900},PRO:{name:"Pro",price:9900},ENTERPRISE:{name:"Enterprise",price:null}})[r.tier],[r.tier]),C=()=>{if(!(x!=null&&x.price))return 0;const n=x.price*r.seats,u=(i==null?void 0:i.taxAmount)||0;return n+u},w=n=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(n/100),F=async n=>{if(n.preventDefault(),!g||!j){c("Stripe has not loaded yet. Please try again.");return}const u=j.getElement(ae);if(!u){c("Card element not found. Please refresh and try again.");return}d(!0),c(null);try{const{error:S,paymentMethod:z}=await g.createPaymentMethod({type:"card",card:u,billing_details:{name:`${r.billingAddress.firstName} ${r.billingAddress.lastName}`,email:"user@example.com",address:{line1:r.billingAddress.addressLine1,line2:r.billingAddress.addressLine2,city:r.billingAddress.city,state:r.billingAddress.state,postal_code:r.billingAddress.postalCode,country:r.billingAddress.country}}});if(S){c(S.message||"Payment method creation failed");return}if(!z){c("Failed to create payment method");return}await o(z.id)}catch(S){c(S.message||"Payment processing failed")}finally{d(!1)}},m=Object.values(s).every(Boolean)&&r.acceptTerms&&r.acceptPrivacy,p={style:{base:{fontSize:"16px",color:"#ffffff",backgroundColor:"rgba(255, 255, 255, 0.05)","::placeholder":{color:"rgba(255, 255, 255, 0.5)"}},invalid:{color:"#f44336",iconColor:"#f44336"}}};return e.jsxs(a,{children:[e.jsx(t,{variant:"h5",sx:{mb:1,fontWeight:600},children:"Payment Method"}),e.jsx(t,{variant:"body1",color:"text.secondary",sx:{mb:4},children:"Complete your purchase with secure payment processing by Stripe."}),e.jsxs(l,{container:!0,spacing:4,children:[e.jsx(l,{item:!0,xs:12,lg:8,children:e.jsxs(B,{elevation:2,sx:{p:4,backgroundColor:"background.paper",border:"1px solid rgba(255, 255, 255, 0.1)"},children:[e.jsxs(a,{sx:{display:"flex",alignItems:"center",gap:2,mb:3},children:[e.jsx(ye,{sx:{color:"primary.main"}}),e.jsx(t,{variant:"h6",sx:{fontWeight:600},children:"Credit Card Information"})]}),f&&e.jsx(J,{severity:"error",sx:{mb:3},children:f}),e.jsx(a,{component:"form",onSubmit:F,children:e.jsxs(l,{container:!0,spacing:3,children:[e.jsxs(l,{item:!0,xs:12,children:[e.jsx(t,{variant:"body2",sx:{mb:1,fontWeight:500},children:"Card Number"}),e.jsx(a,{sx:{p:2,border:"1px solid rgba(255, 255, 255, 0.2)",borderRadius:1,backgroundColor:"rgba(255, 255, 255, 0.05)","&:focus-within":{borderColor:"primary.main",boxShadow:"0 0 0 2px rgba(0, 212, 255, 0.2)"}},children:e.jsx(ae,{options:p,onChange:n=>{b(u=>({...u,cardNumber:n.complete})),n.error?c(n.error.message):c(null)}})})]}),e.jsxs(l,{item:!0,xs:12,sm:6,children:[e.jsx(t,{variant:"body2",sx:{mb:1,fontWeight:500},children:"Expiry Date"}),e.jsx(a,{sx:{p:2,border:"1px solid rgba(255, 255, 255, 0.2)",borderRadius:1,backgroundColor:"rgba(255, 255, 255, 0.05)","&:focus-within":{borderColor:"primary.main",boxShadow:"0 0 0 2px rgba(0, 212, 255, 0.2)"}},children:e.jsx(Be,{options:p,onChange:n=>{b(u=>({...u,cardExpiry:n.complete})),n.error?c(n.error.message):f&&n.complete&&c(null)}})})]}),e.jsxs(l,{item:!0,xs:12,sm:6,children:[e.jsx(t,{variant:"body2",sx:{mb:1,fontWeight:500},children:"CVC"}),e.jsx(a,{sx:{p:2,border:"1px solid rgba(255, 255, 255, 0.2)",borderRadius:1,backgroundColor:"rgba(255, 255, 255, 0.05)","&:focus-within":{borderColor:"primary.main",boxShadow:"0 0 0 2px rgba(0, 212, 255, 0.2)"}},children:e.jsx(Fe,{options:p,onChange:n=>{b(u=>({...u,cardCvc:n.complete})),n.error?c(n.error.message):f&&n.complete&&c(null)}})})]}),e.jsxs(l,{item:!0,xs:12,children:[e.jsx(M,{sx:{my:2}}),e.jsx(q,{type:"submit",variant:"contained",size:"large",fullWidth:!0,disabled:!m||y||!g,sx:{py:1.5,fontSize:"1.1rem",fontWeight:600,background:"linear-gradient(135deg, #00d4ff 0%, #667eea 100%)",color:"#000","&:disabled":{background:"rgba(255, 255, 255, 0.1)",color:"rgba(255, 255, 255, 0.5)"}},children:y?"Processing Payment...":`Complete Purchase - ${w(C())}`})]})]})})]})}),e.jsx(l,{item:!0,xs:12,lg:4,children:e.jsxs(a,{children:[e.jsxs(B,{elevation:2,sx:{p:3,backgroundColor:"background.paper",border:"1px solid rgba(255, 255, 255, 0.1)"},children:[e.jsxs(a,{sx:{display:"flex",alignItems:"center",gap:2,mb:3},children:[e.jsx(fe,{sx:{color:"success.main"}}),e.jsx(t,{variant:"h6",sx:{fontWeight:600},children:"Secure Payment"})]}),e.jsxs(G,{dense:!0,children:[e.jsxs(A,{sx:{px:0},children:[e.jsx(T,{sx:{minWidth:32},children:e.jsx(L,{sx:{fontSize:18,color:"success.main"}})}),e.jsx(I,{primary:"256-bit SSL Encryption",primaryTypographyProps:{variant:"body2"}})]}),e.jsxs(A,{sx:{px:0},children:[e.jsx(T,{sx:{minWidth:32},children:e.jsx(L,{sx:{fontSize:18,color:"success.main"}})}),e.jsx(I,{primary:"PCI DSS Compliant",primaryTypographyProps:{variant:"body2"}})]}),e.jsxs(A,{sx:{px:0},children:[e.jsx(T,{sx:{minWidth:32},children:e.jsx(L,{sx:{fontSize:18,color:"success.main"}})}),e.jsx(I,{primary:"SOC 2 Type II Certified",primaryTypographyProps:{variant:"body2"}})]}),e.jsxs(A,{sx:{px:0},children:[e.jsx(T,{sx:{minWidth:32},children:e.jsx(L,{sx:{fontSize:18,color:"success.main"}})}),e.jsx(I,{primary:"14-Day Money Back Guarantee",primaryTypographyProps:{variant:"body2"}})]})]}),e.jsx(M,{sx:{my:2}}),e.jsxs(a,{sx:{textAlign:"center"},children:[e.jsx(t,{variant:"body2",color:"text.secondary",sx:{mb:2},children:"Powered by Stripe"}),e.jsx(a,{sx:{display:"flex",justifyContent:"center",gap:1,mb:2},children:["Visa","Mastercard","American Express","Discover"].map(n=>e.jsx(a,{sx:{px:1,py:.5,backgroundColor:"rgba(255, 255, 255, 0.1)",borderRadius:1,fontSize:"0.75rem"},children:n},n))}),e.jsx(t,{variant:"caption",color:"text.secondary",children:"Your payment information is never stored on our servers"})]})]}),e.jsxs(B,{elevation:2,sx:{p:3,mt:3,backgroundColor:"background.paper",border:"1px solid rgba(255, 255, 255, 0.1)"},children:[e.jsx(t,{variant:"h6",sx:{mb:2,fontWeight:600},children:"What Happens Next?"}),e.jsxs(G,{dense:!0,children:[e.jsxs(A,{sx:{px:0,alignItems:"flex-start"},children:[e.jsx(T,{sx:{minWidth:32,mt:.5},children:e.jsx(a,{sx:{width:20,height:20,borderRadius:"50%",backgroundColor:"primary.main",color:"#000",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"0.75rem",fontWeight:600},children:"1"})}),e.jsx(I,{primary:"Instant License Generation",secondary:"Your license keys are generated immediately upon payment",primaryTypographyProps:{variant:"body2",fontWeight:500},secondaryTypographyProps:{variant:"caption"}})]}),e.jsxs(A,{sx:{px:0,alignItems:"flex-start"},children:[e.jsx(T,{sx:{minWidth:32,mt:.5},children:e.jsx(a,{sx:{width:20,height:20,borderRadius:"50%",backgroundColor:"primary.main",color:"#000",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"0.75rem",fontWeight:600},children:"2"})}),e.jsx(I,{primary:"Email Confirmation",secondary:"Receipt and license details sent to your email",primaryTypographyProps:{variant:"body2",fontWeight:500},secondaryTypographyProps:{variant:"caption"}})]}),e.jsxs(A,{sx:{px:0,alignItems:"flex-start"},children:[e.jsx(T,{sx:{minWidth:32,mt:.5},children:e.jsx(a,{sx:{width:20,height:20,borderRadius:"50%",backgroundColor:"primary.main",color:"#000",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"0.75rem",fontWeight:600},children:"3"})}),e.jsx(I,{primary:"Dashboard Access",secondary:"Manage your licenses and team from your dashboard",primaryTypographyProps:{variant:"body2",fontWeight:500},secondaryTypographyProps:{variant:"caption"}})]})]})]})]})})]})]})},De=({selectedTier:r,seats:i,isYearly:o=!1,taxCalculation:g})=>{if(!r)return e.jsxs(B,{elevation:3,sx:{p:4,backgroundColor:"background.paper",border:"1px solid rgba(255, 255, 255, 0.1)",position:"sticky",top:100},children:[e.jsx(t,{variant:"h6",sx:{mb:3},children:"Order Summary"}),e.jsx(t,{variant:"body2",color:"text.secondary",children:"Please select a plan to see pricing details."})]});const j=()=>{switch(r.id){case"BASIC":return e.jsx(O,{});case"PRO":return e.jsx(oe,{});case"ENTERPRISE":return e.jsx(X,{});default:return e.jsx(O,{})}},d=(()=>{if(!r.price)return{subtotal:0,discount:0,total:0};const c=r.price*i;let s=c,b=0;o&&(s=c*12,b=c*2);const x=s-b,C=(g==null?void 0:g.taxAmount)||0,w=x+C;return{subtotal:s,discount:b,discountedSubtotal:x,taxAmount:C,total:w}})(),f=c=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(c/100);return e.jsx(a,{children:e.jsxs(B,{elevation:3,sx:{backgroundColor:"background.paper",border:"1px solid rgba(255, 255, 255, 0.1)",position:"sticky",top:100},children:[e.jsxs(a,{sx:{p:3,background:r.popular?"linear-gradient(135deg, rgba(0, 212, 255, 0.1) 0%, rgba(102, 126, 234, 0.1) 100%)":"rgba(255, 255, 255, 0.05)",borderBottom:"1px solid rgba(255, 255, 255, 0.1)"},children:[e.jsxs(a,{sx:{display:"flex",alignItems:"center",gap:2,mb:2},children:[e.jsx(a,{sx:{width:48,height:48,borderRadius:2,backgroundColor:r.popular?"rgba(0, 212, 255, 0.2)":"rgba(0, 212, 255, 0.1)",display:"flex",alignItems:"center",justifyContent:"center",color:"primary.main"},children:j()}),e.jsxs(a,{sx:{flexGrow:1},children:[e.jsxs(a,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(t,{variant:"h6",sx:{fontWeight:600},children:r.name}),r.popular&&e.jsx($,{size:"small",icon:e.jsx(ne,{}),label:"Popular",color:"primary",sx:{color:"#000"}})]}),e.jsx(t,{variant:"body2",color:"text.secondary",children:r.description})]})]}),e.jsxs(a,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsxs(t,{variant:"body2",color:"text.secondary",children:[i," ",i===1?"seat":"seats"]}),o&&e.jsx($,{size:"small",label:"Annual Billing",variant:"outlined",color:"success"})]})]}),e.jsxs(a,{sx:{p:3},children:[e.jsx(t,{variant:"h6",sx:{mb:3},children:"Order Summary"}),e.jsxs(je,{spacing:2,sx:{mb:3},children:[e.jsxs(a,{sx:{display:"flex",justifyContent:"space-between"},children:[e.jsxs(t,{variant:"body2",children:[r.name," Ã— ",i," seat",i!==1?"s":"",o&&" (12 months)"]}),e.jsx(t,{variant:"body2",children:f(d.subtotal)})]}),d.discount>0&&e.jsxs(a,{sx:{display:"flex",justifyContent:"space-between"},children:[e.jsx(t,{variant:"body2",color:"success.main",children:"Annual discount (2 months free)"}),e.jsxs(t,{variant:"body2",color:"success.main",children:["-",f(d.discount)]})]}),g&&e.jsxs(a,{sx:{display:"flex",justifyContent:"space-between"},children:[e.jsxs(t,{variant:"body2",children:["Tax (",g.taxJurisdiction,")"]}),e.jsx(t,{variant:"body2",children:f(g.taxAmount)})]})]}),e.jsx(M,{sx:{mb:2,borderColor:"rgba(255, 255, 255, 0.1)"}}),e.jsxs(a,{sx:{display:"flex",justifyContent:"space-between",mb:3},children:[e.jsxs(t,{variant:"h6",children:["Total ",o?"(Annual)":"(Monthly)"]}),e.jsx(t,{variant:"h6",color:"primary.main",children:f(d.total)})]}),o&&e.jsx(t,{variant:"body2",color:"text.secondary",sx:{mb:3},children:"Billed annually. Cancel anytime."}),e.jsx(t,{variant:"subtitle2",sx:{mb:2,fontWeight:600},children:"What's included:"}),e.jsxs(G,{dense:!0,sx:{p:0},children:[r.features.slice(0,5).map((c,s)=>e.jsxs(A,{sx:{px:0,py:.5},children:[e.jsx(T,{sx:{minWidth:24},children:e.jsx(L,{sx:{fontSize:16,color:"success.main"}})}),e.jsx(I,{primary:c,primaryTypographyProps:{variant:"body2",sx:{fontSize:"0.875rem"}}})]},s)),r.features.length>5&&e.jsx(A,{sx:{px:0,py:.5},children:e.jsx(I,{primary:`+ ${r.features.length-5} more features`,primaryTypographyProps:{variant:"body2",color:"primary.main",sx:{fontSize:"0.875rem",fontWeight:500}}})})]})]}),e.jsx(a,{sx:{p:3,backgroundColor:"rgba(255, 255, 255, 0.02)",borderTop:"1px solid rgba(255, 255, 255, 0.1)"},children:e.jsxs(t,{variant:"caption",color:"text.secondary",sx:{display:"block",textAlign:"center"},children:["ðŸ”’ Secured by 256-bit SSL encryption",e.jsx("br",{}),"ðŸ’³ PCI DSS compliant payment processing",e.jsx("br",{}),"ðŸ”„ 14-day money-back guarantee"]})})]})})},te=[{label:"Select Plan",icon:e.jsx(Ae,{})},{label:"Billing Details",icon:e.jsx(se,{})},{label:"Payment Method",icon:e.jsx(se,{})},{label:"Confirmation",icon:e.jsx(Ie,{})}],Xe=()=>{var K,Q;const r=ke(),i=we(),{user:o}=Ee(),{setLoading:g}=We(),{enqueueSnackbar:j}=Te(),[y,d]=k.useState(0),[f,c]=k.useState([]),[s,b]=k.useState({tier:((K=i.state)==null?void 0:K.tier)||"PRO",seats:1,isYearly:((Q=i.state)==null?void 0:Q.isYearly)||!1,billingAddress:{},taxInformation:{},businessProfile:{},acceptTerms:!1,acceptPrivacy:!1}),[x,C]=k.useState(null),[w,F]=k.useState(null);k.useEffect(()=>{m()},[]);const m=async()=>{try{const h=await Y.getPricingTiers();c(h)}catch(h){j(h.message||"Failed to load pricing",{variant:"error"})}},p=h=>{b(E=>({...E,...h}))},n=async()=>{if(s.billingAddress.country)try{const h=f.find(D=>D.id===s.tier);if(!h||!h.price)return;const E=h.price*s.seats,U=await Y.calculateTax({amount:E,billingAddress:s.billingAddress,userType:s.businessProfile.companyName?"business":"individual"});F(U)}catch(h){console.warn("Tax calculation failed:",h.message)}};k.useEffect(()=>{y>=1&&n()},[s.billingAddress,s.tier,s.seats,y]);const u=()=>{switch(C(null),y){case 0:if(!s.tier){C("Please select a plan");return}break;case 1:const h=Y.validateBillingAddress(s.billingAddress);if(!h.valid){C(h.errors.join(", "));return}break}d(h=>h+1)},S=()=>{C(null),d(h=>h-1)},z=async h=>{try{g(!0),C(null);const E=await Y.createSubscription({tier:s.tier,seats:s.seats,paymentMethodId:h,billingAddress:s.billingAddress,taxInformation:s.taxInformation,businessProfile:s.businessProfile});j("Subscription created successfully!",{variant:"success"}),r("/dashboard",{state:{subscriptionCreated:!0,subscription:E.subscription}})}catch(E){C(E.message||"Payment failed. Please try again."),j(E.message||"Payment failed",{variant:"error"})}finally{g(!1)}},ce=f.find(h=>h.id===s.tier),de=()=>{switch(y){case 0:return e.jsx(qe,{pricingTiers:f,selectedTier:s.tier,seats:s.seats,isYearly:s.isYearly,onUpdate:p});case 1:return e.jsx(ze,{billingAddress:s.billingAddress,taxInformation:s.taxInformation,businessProfile:s.businessProfile,acceptTerms:s.acceptTerms,acceptPrivacy:s.acceptPrivacy,onUpdate:p});case 2:return e.jsx(Ue,{checkoutData:s,taxCalculation:w,onComplete:z});default:return null}};return o?e.jsxs(a,{sx:{minHeight:"100vh",backgroundColor:"background.default"},children:[e.jsx(ie,{}),e.jsx(ee,{maxWidth:"lg",sx:{pt:{xs:10,md:12},pb:8},children:e.jsxs(a,{children:[e.jsx(a,{sx:{mb:4},children:e.jsx(q,{startIcon:e.jsx(re,{}),onClick:()=>r("/pricing"),sx:{color:"text.secondary","&:hover":{color:"primary.main",backgroundColor:"rgba(0, 212, 255, 0.1)"}},children:"Back to Pricing"})}),e.jsxs(a,{sx:{textAlign:"center",mb:6},children:[e.jsx(t,{variant:"h3",sx:{fontWeight:600,mb:2,background:"linear-gradient(135deg, #ffffff 0%, #00d4ff 100%)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",backgroundClip:"text"},children:"Complete Your Purchase"}),e.jsx(t,{variant:"h6",color:"text.secondary",sx:{mb:4,maxWidth:600,mx:"auto"},children:"Join thousands of professionals using BackboneLogic, Inc."})]}),e.jsxs(l,{container:!0,spacing:4,children:[e.jsx(l,{item:!0,xs:12,lg:8,children:e.jsxs(B,{elevation:3,sx:{p:4,backgroundColor:"background.paper",border:"1px solid rgba(255, 255, 255, 0.1)"},children:[e.jsx(Ce,{activeStep:y,sx:{mb:4,"& .MuiStepLabel-root":{color:"text.secondary"},"& .MuiStepLabel-label.Mui-active":{color:"primary.main"},"& .MuiStepLabel-label.Mui-completed":{color:"success.main"}},children:te.map((h,E)=>e.jsx(ve,{children:e.jsx(Se,{StepIconComponent:({active:U,completed:D})=>e.jsx(a,{sx:{width:40,height:40,borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:D?"success.main":U?"primary.main":"rgba(255, 255, 255, 0.1)",color:D||U?"#000":"text.secondary"},children:h.icon}),children:h.label})},h.label))}),x&&e.jsx(J,{severity:"error",sx:{mb:3},children:x}),e.jsx(a,{sx:{mb:4},children:de()}),y<2&&e.jsxs(a,{sx:{display:"flex",justifyContent:"space-between"},children:[e.jsx(q,{onClick:S,disabled:y===0,startIcon:e.jsx(re,{}),children:"Back"}),e.jsx(q,{variant:"contained",onClick:u,endIcon:e.jsx(Pe,{}),sx:{background:"linear-gradient(135deg, #00d4ff 0%, #667eea 100%)",color:"#000"},children:y===te.length-1?"Complete Order":"Continue"})]})]})}),e.jsx(l,{item:!0,xs:12,lg:4,children:e.jsx(De,{selectedTier:ce,seats:s.seats,isYearly:s.isYearly,taxCalculation:w})})]})]})})]}):e.jsxs(a,{sx:{minHeight:"100vh",backgroundColor:"background.default"},children:[e.jsx(ie,{}),e.jsx(ee,{maxWidth:"md",sx:{pt:12,pb:8},children:e.jsx(J,{severity:"warning",children:"Please sign in to continue with checkout."})})]})};export{Xe as default};
