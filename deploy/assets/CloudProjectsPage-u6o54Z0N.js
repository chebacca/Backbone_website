import{bR as i,j as e,a as j,T as o,d as q,ba as z,bb as _,U as R,W as L,X as T,Y as H,h as C,I as $}from"./mui-FYkpJWXT.js";import{r as s}from"./vendor-OeuszDaU.js";import{r as c}from"./createSvgIcon-fWI9GbzL.js";import{d as O,c as l}from"./index-C4y0-4BL.js";import"./stripe-C592TbGO.js";var x={},F=i;Object.defineProperty(x,"__esModule",{value:!0});var I=x.default=void 0,V=F(c()),G=e;I=x.default=(0,V.default)((0,G.jsx)("path",{d:"M19.35 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96"}),"Cloud");var h={},U=i;Object.defineProperty(h,"__esModule",{value:!0});var w=h.default=void 0,W=U(c()),N=e;w=h.default=(0,W.default)((0,N.jsx)("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6zM19 4h-3.5l-1-1h-5l-1 1H5v2h14z"}),"Delete");var p={},X=i;Object.defineProperty(p,"__esModule",{value:!0});var P=p.default=void 0,Y=X(c()),J=e;P=p.default=(0,Y.default)((0,J.jsx)("path",{d:"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9m-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8z"}),"Restore");var f={},K=i;Object.defineProperty(f,"__esModule",{value:!0});var S=f.default=void 0,Q=K(c()),Z=e;S=f.default=(0,Q.default)((0,Z.jsx)("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6z"}),"Add");const le=()=>{const[m,D]=s.useState(0),[ee,A]=s.useState(!1),[d,M]=s.useState([]),[n,B]=s.useState([]),[y,r]=s.useState(null),u=async()=>{try{r(null);const t=await O.withLoading(()=>l.get("projects"),A);M(Array.isArray(t)?t:[])}catch(t){r((t==null?void 0:t.message)||"Failed to load projects")}},v=async()=>{var t;try{r(null);const g=((t=(await l.get("projects/archived/list")).data)==null?void 0:t.data)||[];B(Array.isArray(g)?g:[])}catch(a){r((a==null?void 0:a.message)||"Failed to load archived projects")}};s.useEffect(()=>{u(),v()},[]);const E=async t=>{try{await l.delete(`projects/${t}`),await Promise.all([u(),v()])}catch(a){r((a==null?void 0:a.message)||"Delete failed")}},k=async t=>{try{await l.post(`projects/${t}/restore`,{}),await Promise.all([u(),v()])}catch(a){r((a==null?void 0:a.message)||"Restore failed")}},b=(t,a)=>e.jsxs(L,{sx:{border:"1px solid",borderColor:"divider",borderRadius:1,mb:1},children:[e.jsx(T,{children:e.jsx(I,{color:a?"disabled":"primary"})}),e.jsx(H,{primary:e.jsxs(j,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(o,{variant:"subtitle2",sx:{flexGrow:1},children:t.name}),t.storageBackend&&e.jsx(C,{size:"small",variant:"outlined",label:t.storageBackend==="gcs"?"GCS":"Firestore",color:t.storageBackend==="gcs"?"secondary":"primary"}),e.jsx(C,{size:"small",variant:"outlined",label:t.visibility})]}),secondary:t.description||""}),a?e.jsx($,{onClick:()=>k(t.id),"aria-label":"Restore project",children:e.jsx(P,{})}):e.jsx($,{onClick:()=>E(t.id),"aria-label":"Delete project",children:e.jsx(w,{})})]},t.id);return e.jsxs(j,{children:[e.jsxs(j,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[e.jsx(o,{variant:"h5",sx:{fontWeight:700},children:"Cloud Projects"}),e.jsx(q,{variant:"contained",startIcon:e.jsx(S,{}),onClick:()=>window.dispatchEvent(new CustomEvent("open-create-project-dialog")),children:"Create Project"})]}),e.jsxs(z,{value:m,onChange:(t,a)=>D(a),sx:{mb:2},children:[e.jsx(_,{label:`Active (${d.length})`}),e.jsx(_,{label:`Recycle Bin (${n.length})`})]}),y&&e.jsx(o,{color:"error",sx:{mb:2},children:y}),m===0?e.jsx(R,{children:d.length===0?e.jsx(o,{variant:"body2",color:"text.secondary",children:"No projects yet."}):d.map(t=>b(t,!1))}):e.jsx(R,{children:n.length===0?e.jsx(o,{variant:"body2",color:"text.secondary",children:"Recycle Bin is empty."}):n.map(t=>b(t,!0))})]})};export{le as default};
