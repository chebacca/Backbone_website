var pe=Object.defineProperty;var je=(f,t,r)=>t in f?pe(f,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):f[t]=r;var S=(f,t,r)=>je(f,typeof t!="symbol"?t+"":t,r);import{j as e,az as de,aA as ue,T as n,I as he,aB as me,aC as xe,t as V,a as d,a6 as fe,a7 as be,a8 as we,aD as ye,H as ke,aE as ge,d as w,M as Se,G as g,k as W,l as z,h as C,aF as J,aG as B,aH as E,D as ve,aI as Ce,aJ as ae,J as y,Q as N,u as k,aK as oe,aL as Pe,aM as Ie,aN as Z,Z as H,aO as Ae,a4 as se,b as Me,aP as ne,aQ as Te,aR as ie,ak as Le,aS as Ne,aT as Be,U as Ee,W as O,X as $,Y as G}from"./mui-D5kihkEV.js";import{r as m}from"./vendor-OeuszDaU.js";import{_ as Fe}from"./index-BZkk_nnT.js";import{m as Re}from"./proxy-L_Rx7esv.js";import"./stripe-CzcFqipZ.js";const Y=class Y{constructor(){S(this,"listeners",[]);S(this,"state",{currentStep:"mode_selection",selectedMode:null,storageMode:"local",isAuthenticated:!1,user:null,selectedProjectId:null,error:null,isLoading:!1});this.initialize()}static getInstance(){return this.instance||(this.instance=new Y),this.instance}async initialize(){try{const t=this.checkExistingAuthentication(),r=localStorage.getItem("preferredApplicationMode"),o=localStorage.getItem("preferredStorageMode");if(sessionStorage.getItem("startup_reset")==="true"){sessionStorage.removeItem("startup_reset"),this.updateState({currentStep:"mode_selection",selectedMode:null,storageMode:o||"local",isAuthenticated:!1});return}if(t.isValid&&r){this.updateState({isAuthenticated:!0,user:t.user,selectedMode:r,storageMode:o||"local"});const l=localStorage.getItem("lastProjectId");l&&this.validateProjectAccess(l,r)?await this.completeStartup(l):this.updateState({currentStep:"project_selection"})}else this.updateState({currentStep:"mode_selection",storageMode:o||"local"})}catch(t){console.error("Startup initialization error:",t),this.updateState({error:"Failed to initialize application",currentStep:"mode_selection"})}}subscribe(t){return this.listeners.push(t),t(this.state),()=>{const r=this.listeners.indexOf(t);r>-1&&this.listeners.splice(r,1)}}getState(){return{...this.state}}async selectMode(t,r="local"){try{this.updateState({isLoading:!0,error:null}),localStorage.setItem("preferredApplicationMode",t),localStorage.setItem("preferredStorageMode",r),this.updateState({selectedMode:t,storageMode:r}),this.requiresAuthentication(t,r)?this.state.isAuthenticated?this.updateState({currentStep:"project_selection",isLoading:!1}):this.updateState({currentStep:"authentication",isLoading:!1}):this.updateState({currentStep:"project_selection",isLoading:!1})}catch(o){console.error("Mode selection error:",o),this.updateState({error:"Failed to select mode",isLoading:!1})}}async onAuthenticationSuccess(t){try{this.updateState({isAuthenticated:!0,user:t,currentStep:"project_selection",error:null}),localStorage.setItem("currentUser",JSON.stringify(t)),localStorage.setItem("lastAuthTime",Date.now().toString())}catch(r){console.error("Authentication success handling error:",r),this.updateState({error:"Failed to complete authentication"})}}async selectProject(t){try{if(this.updateState({isLoading:!0,error:null}),!this.validateProjectAccess(t,this.state.selectedMode))throw new Error("Invalid project access");await this.completeStartup(t)}catch(r){console.error("Project selection error:",r),this.updateState({error:"Failed to select project",isLoading:!1})}}async createProject(t){try{this.updateState({isLoading:!0,error:null}),this.validateProjectCreationOptions(t);const r=await this.executeProjectCreation(t);return await this.completeStartup(r),r}catch(r){throw console.error("Project creation error:",r),this.updateState({error:`Failed to create project: ${r instanceof Error?r.message:"Unknown error"}`,isLoading:!1}),r}}async reset(){sessionStorage.clear(),localStorage.removeItem("currentUser"),localStorage.removeItem("lastAuthTime"),localStorage.removeItem("lastProjectId"),sessionStorage.setItem("startup_reset","true"),this.updateState({currentStep:"mode_selection",selectedMode:null,isAuthenticated:!1,user:null,selectedProjectId:null,error:null,isLoading:!1})}async switchMode(t,r="local"){this.state.selectedProjectId&&localStorage.setItem("lastProjectId",this.state.selectedProjectId),await this.selectMode(t,r)}updateState(t){this.state={...this.state,...t},this.listeners.forEach(r=>{try{r(this.state)}catch(o){console.error("Startup listener error:",o)}})}checkExistingAuthentication(){try{const t=localStorage.getItem("currentUser"),r=localStorage.getItem("lastAuthTime");if(!t||!r)return{isValid:!1,user:null};const o=parseInt(r),c=Date.now(),l=24*60*60*1e3;return c-o>l?{isValid:!1,user:null}:{isValid:!0,user:JSON.parse(t)}}catch{return{isValid:!1,user:null}}}requiresAuthentication(t,r){return t==="shared_network"||t==="standalone"&&r==="cloud"||r==="hybrid"}validateProjectAccess(t,r){return!(!t||!r)}validateProjectCreationOptions(t){var r,o,c,l;if(!((r=t.name)!=null&&r.trim()))throw new Error("Project name is required");if((o=t.localNetworkConfig)!=null&&o.enabled){const{port:a,address:u,maxUsers:p}=t.localNetworkConfig;if(!a||a<1024||a>65535)throw new Error("Invalid port number (must be between 1024-65535)");if(!(u!=null&&u.trim()))throw new Error("Network address is required for local network deployment");if(!p||p<1||p>100)throw new Error("Max users must be between 1-100")}if(t.storageMode==="cloud"&&((c=t.cloudConfig)==null?void 0:c.provider)==="gcs"&&!((l=t.cloudConfig.bucket)!=null&&l.trim()))throw new Error("GCS bucket is required for cloud storage")}async executeProjectCreation(t){if(this.requiresCloudIntegration()){const{cloudProjectIntegration:o}=await Fe(async()=>{const{cloudProjectIntegration:l}=await Promise.resolve().then(()=>_e);return{cloudProjectIntegration:l}},void 0),c=localStorage.getItem("auth_token");return c&&o.setAuthToken(c),await o.createCloudProject(t)}else return await this.createLocalProject(t)}requiresCloudIntegration(){return this.state.selectedMode==="shared_network"||this.state.storageMode==="cloud"||this.state.storageMode==="hybrid"}async createLocalProject(t){var l;const r={name:t.name,description:t.description,mode:this.state.selectedMode,storageMode:this.state.storageMode,createdBy:((l=this.state.user)==null?void 0:l.id)||"local-user",createdAt:new Date().toISOString(),localNetworkConfig:t.localNetworkConfig,collaborationSettings:t.collaborationSettings},o=`local_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,c=JSON.parse(localStorage.getItem("localProjects")||"[]");return c.push({id:o,...r}),localStorage.setItem("localProjects",JSON.stringify(c)),console.log("Created local project:",o,r),o}async completeStartup(t){localStorage.setItem("lastProjectId",t),this.updateState({currentStep:"complete",selectedProjectId:t,isLoading:!1,error:null}),window.dispatchEvent(new CustomEvent("startup:complete",{detail:{mode:this.state.selectedMode,storageMode:this.state.storageMode,projectId:t,user:this.state.user}}))}isComplete(){return this.state.currentStep==="complete"&&this.state.selectedMode!==null&&this.state.selectedProjectId!==null}requiresAuthentication(){return this.requiresAuthentication(this.state.selectedMode,this.state.storageMode)}getSelectedMode(){return this.state.selectedMode}getStorageMode(){return this.state.storageMode}getCurrentUser(){return this.state.user}getSelectedProjectId(){return this.state.selectedProjectId}};S(Y,"instance");let ee=Y;const F=ee.getInstance();typeof window<"u"&&(window.simplifiedStartupSequencer=F);const Q=class Q{constructor(){S(this,"baseURL");S(this,"authToken",null);this.baseURL=this.getBaseURL(),this.initializeAuth()}static getInstance(){return this.instance||(this.instance=new Q),this.instance}initializeAuth(){this.authToken=localStorage.getItem("auth_token")}getBaseURL(){return window.location.hostname!=="localhost"&&window.location.hostname!=="127.0.0.1"&&!window.location.hostname.includes("localhost"),"/api"}async apiRequest(t,r="GET",o){const c=`${this.baseURL}/${t}`,l={"Content-Type":"application/json"};this.authToken&&(l.Authorization=`Bearer ${this.authToken}`);const a={method:r,headers:l,...o&&{body:JSON.stringify(o)}};try{const u=await fetch(c,a);if(!u.ok)throw u.status===401?(await this.handleAuthError(),new Error("Authentication required")):new Error(`API request failed: ${u.statusText}`);const p=await u.json();if(!p.success)throw new Error(p.error||p.message||"API request failed");return p.data}catch(u){throw console.error("API request error:",u),u}}async handleAuthError(){var t,r;try{const o=localStorage.getItem("refresh_token");if(!o)throw new Error("No refresh token available");const c=await fetch(`${this.baseURL}/auth/refresh`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refreshToken:o})});if(c.ok){const l=await c.json();if(l.success&&((r=(t=l.data)==null?void 0:t.tokens)!=null&&r.accessToken)){this.authToken=l.data.tokens.accessToken,localStorage.setItem("auth_token",this.authToken),l.data.tokens.refreshToken&&localStorage.setItem("refresh_token",l.data.tokens.refreshToken);return}}}catch(o){console.error("Token refresh failed:",o)}localStorage.removeItem("auth_token"),localStorage.removeItem("refresh_token"),this.authToken=null,await F.reset()}setAuthToken(t){this.authToken=t,localStorage.setItem("auth_token",t)}async createCloudProject(t){try{const r=this.mapToCloudProjectPayload(t),o=await this.apiRequest("projects","POST",r);return console.log("Cloud project created:",o),await this.setupProjectResources(o.id,t),o.id}catch(r){throw console.error("Failed to create cloud project:",r),new Error(`Failed to create cloud project: ${r.message}`)}}mapToCloudProjectPayload(t){const r=F.getState(),o={name:t.name,description:t.description,type:this.mapApplicationModeToType(r.selectedMode),applicationMode:r.selectedMode,visibility:"private",storageBackend:this.mapStorageModeToBackend(r.storageMode)};return t.cloudConfig&&(t.cloudConfig.provider==="gcs"?(o.storageBackend="gcs",o.gcsBucket=t.cloudConfig.bucket,o.gcsPrefix=t.cloudConfig.prefix):o.storageBackend="firestore"),t.collaborationSettings&&r.selectedMode==="shared_network"&&(o.allowCollaboration=!0,o.maxCollaborators=t.collaborationSettings.maxCollaborators,o.realTimeEnabled=t.collaborationSettings.enableRealTime,o.enableComments=t.collaborationSettings.enableComments,o.enableActivityLog=!0,o.enablePresenceIndicators=!0),r.selectedMode==="standalone"&&(o.autoSave=!0,o.backupEnabled=!0,o.offlineMode=r.storageMode==="local"),o}mapApplicationModeToType(t){switch(t){case"standalone":return"standalone";case"shared_network":return"networked";default:return"networked"}}mapStorageModeToBackend(t){switch(t){case"cloud":return"firestore";case"hybrid":return"firestore";case"local":return"firestore";default:return"firestore"}}async setupProjectResources(t,r){var o,c;(o=r.localNetworkConfig)!=null&&o.enabled&&await this.setupLocalNetworkDeployment(t,r.localNetworkConfig),((c=r.cloudConfig)==null?void 0:c.provider)==="gcs"&&await this.validateGCSConfiguration(t,r.cloudConfig),await this.initializeProjectWorkspace(t,r)}async setupLocalNetworkDeployment(t,r){try{console.log("Setting up local network deployment:",{projectId:t,port:r.port,address:r.address,maxUsers:r.maxUsers}),await this.apiRequest(`projects/${t}`,"PATCH",{metadata:{localNetwork:{enabled:!0,port:r.port,address:r.address,maxUsers:r.maxUsers,deployedAt:new Date().toISOString()}}})}catch(o){console.error("Failed to setup local network deployment:",o)}}async validateGCSConfiguration(t,r){try{await this.apiRequest(`projects/${t}/storage/signed-url`,"POST",{filename:"test-validation.txt",operation:"upload"}),console.log("GCS configuration validated for project:",t)}catch(o){throw console.error("GCS configuration validation failed:",o),new Error("GCS storage configuration is invalid")}}async initializeProjectWorkspace(t,r){try{console.log("Initializing project workspace for:",t)}catch(o){console.error("Failed to initialize project workspace:",o)}}async getUserProjects(){try{const t=this.authToken?"projects":"projects/public";return await this.apiRequest(t)}catch(t){return console.error("Failed to fetch user projects:",t),[]}}async getProject(t){try{return await this.apiRequest(`projects/${t}`)}catch(r){return console.error("Failed to fetch project:",r),null}}async validateProjectAccess(t){try{return await this.getProject(t)!==null}catch{return!1}}async generateSignedUrl(t,r,o="upload",c){try{const l=await this.apiRequest(`projects/${t}/storage/signed-url`,"POST",{filename:r,operation:o,contentType:c});return{url:l.url,method:l.method,headers:l.headers}}catch(l){throw console.error("Failed to generate signed URL:",l),l}}async updateProject(t,r){try{return await this.apiRequest(`projects/${t}`,"PATCH",r)}catch(o){throw console.error("Failed to update project:",o),o}}async archiveProject(t){try{await this.apiRequest(`projects/${t}`,"DELETE")}catch(r){throw console.error("Failed to archive project:",r),r}}};S(Q,"instance");let te=Q;const re=te.getInstance();typeof window<"u"&&(window.cloudProjectIntegration=re);const _e=Object.freeze(Object.defineProperty({__proto__:null,cloudProjectIntegration:re},Symbol.toStringTag,{value:"Module"})),le={name:"",description:"",storageMode:"local",cloudProvider:"firestore",gcsBucket:"",gcsPrefix:"",enableLocalNetwork:!1,networkPort:3e3,networkAddress:"localhost",maxNetworkUsers:10,networkPassword:"",maxCollaborators:10,enableRealTime:!0,enableComments:!0,enableFileSharing:!0,enableVersionControl:!0,enableEncryption:!1,autoBackup:!0,backupInterval:30,enableAuditLog:!1},ce=["Basic Information","Storage Configuration","Network Settings","Collaboration Options","Review & Create"],De=({open:f,onClose:t,mode:r,onSuccess:o})=>{const[c,l]=m.useState(0),[a,u]=m.useState(le),[p,R]=m.useState(!1),[v,_]=m.useState(null),[b,j]=m.useState({});m.useEffect(()=>{f&&(u({...le,enableLocalNetwork:r==="standalone",maxCollaborators:r==="shared_network"?25:5,enableRealTime:r==="shared_network"}),l(0),_(null),j({}))},[f,r]);const h=s=>{u(L=>({...L,...s}));const x={...b};Object.keys(s).forEach(L=>{delete x[L]}),j(x)},P=s=>{const x={};switch(s){case 0:a.name.trim()||(x.name="Project name is required"),a.name.length>100&&(x.name="Project name must be less than 100 characters");break;case 1:a.storageMode==="cloud"&&a.cloudProvider==="gcs"&&(a.gcsBucket.trim()||(x.gcsBucket="GCS bucket name is required"));break;case 2:a.enableLocalNetwork&&((a.networkPort<1024||a.networkPort>65535)&&(x.networkPort="Port must be between 1024 and 65535"),a.networkAddress.trim()||(x.networkAddress="Network address is required"),(a.maxNetworkUsers<1||a.maxNetworkUsers>100)&&(x.maxNetworkUsers="Max users must be between 1 and 100"));break;case 3:(a.maxCollaborators<1||a.maxCollaborators>100)&&(x.maxCollaborators="Max collaborators must be between 1 and 100");break}return j(x),Object.keys(x).length===0},I=()=>{P(c)&&l(s=>s+1)},D=()=>{l(s=>s-1)},X=async()=>{if(P(c)){R(!0),_(null);try{const s={name:a.name,description:a.description,storageMode:a.storageMode,localNetworkConfig:a.enableLocalNetwork?{enabled:!0,port:a.networkPort,address:a.networkAddress,maxUsers:a.maxNetworkUsers}:void 0,cloudConfig:a.storageMode==="cloud"?{provider:a.cloudProvider,bucket:a.gcsBucket,prefix:a.gcsPrefix}:void 0,collaborationSettings:{maxCollaborators:a.maxCollaborators,enableRealTime:a.enableRealTime,enableComments:a.enableComments,enableFileSharing:a.enableFileSharing}},x=await F.createProject(s);o==null||o(x),t()}catch(s){_(s instanceof Error?s.message:"Failed to create project")}finally{R(!1)}}},U=s=>{switch(s){case 0:return A();case 1:return K();case 2:return M();case 3:return T();case 4:return i();default:return null}},A=()=>e.jsxs(d,{sx:{py:2},children:[e.jsx(n,{variant:"h6",gutterBottom:!0,children:"Project Information"}),e.jsx(n,{variant:"body2",color:"text.secondary",paragraph:!0,children:"Provide basic information about your project. This can be changed later."}),e.jsxs(g,{container:!0,spacing:3,children:[e.jsx(g,{item:!0,xs:12,children:e.jsx(k,{fullWidth:!0,label:"Project Name",value:a.name,onChange:s=>h({name:s.target.value}),error:!!b.name,helperText:b.name,required:!0,placeholder:"My Awesome Project"})}),e.jsx(g,{item:!0,xs:12,children:e.jsx(k,{fullWidth:!0,label:"Description",value:a.description,onChange:s=>h({description:s.target.value}),multiline:!0,rows:3,placeholder:"Describe what this project is about..."})})]})]}),K=()=>e.jsxs(d,{sx:{py:2},children:[e.jsx(n,{variant:"h6",gutterBottom:!0,children:"Storage Configuration"}),e.jsx(n,{variant:"body2",color:"text.secondary",paragraph:!0,children:"Choose how your project data will be stored and accessed."}),e.jsxs(oe,{component:"fieldset",fullWidth:!0,sx:{mb:3},children:[e.jsx(Pe,{component:"legend",children:"Storage Mode"}),e.jsxs(Ie,{value:a.storageMode,onChange:s=>h({storageMode:s.target.value}),children:[e.jsx(y,{value:"local",control:e.jsx(Z,{}),label:e.jsxs(d,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(J,{}),e.jsxs(d,{children:[e.jsx(n,{variant:"body1",children:"Local Storage"}),e.jsx(n,{variant:"body2",color:"text.secondary",children:"Store project files on your local machine"})]})]})}),e.jsx(y,{value:"cloud",control:e.jsx(Z,{}),label:e.jsxs(d,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(H,{}),e.jsxs(d,{children:[e.jsx(n,{variant:"body1",children:"Cloud Storage"}),e.jsx(n,{variant:"body2",color:"text.secondary",children:"Store project data in the cloud for sharing and backup"})]})]})}),e.jsx(y,{value:"hybrid",control:e.jsx(Z,{}),label:e.jsxs(d,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(E,{}),e.jsxs(d,{children:[e.jsx(n,{variant:"body1",children:"Hybrid Storage"}),e.jsx(n,{variant:"body2",color:"text.secondary",children:"Combine local and cloud storage for optimal performance"})]})]})})]})]}),a.storageMode==="cloud"&&e.jsx(W,{variant:"outlined",sx:{mb:2},children:e.jsxs(z,{children:[e.jsx(n,{variant:"subtitle1",gutterBottom:!0,children:"Cloud Provider Settings"}),e.jsxs(g,{container:!0,spacing:2,children:[e.jsx(g,{item:!0,xs:12,children:e.jsx(oe,{fullWidth:!0,children:e.jsxs(Ae,{value:a.cloudProvider,onChange:s=>h({cloudProvider:s.target.value}),children:[e.jsx(se,{value:"firestore",children:e.jsxs(d,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(H,{}),e.jsxs(d,{children:[e.jsx(n,{children:"Firestore"}),e.jsx(n,{variant:"body2",color:"text.secondary",children:"Real-time NoSQL database"})]})]})}),e.jsx(se,{value:"gcs",children:e.jsxs(d,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(E,{}),e.jsxs(d,{children:[e.jsx(n,{children:"Google Cloud Storage"}),e.jsx(n,{variant:"body2",color:"text.secondary",children:"Object storage with metadata"})]})]})})]})})}),a.cloudProvider==="gcs"&&e.jsxs(e.Fragment,{children:[e.jsx(g,{item:!0,xs:12,sm:6,children:e.jsx(k,{fullWidth:!0,label:"GCS Bucket",value:a.gcsBucket,onChange:s=>h({gcsBucket:s.target.value}),error:!!b.gcsBucket,helperText:b.gcsBucket,placeholder:"my-project-bucket"})}),e.jsx(g,{item:!0,xs:12,sm:6,children:e.jsx(k,{fullWidth:!0,label:"Prefix (Optional)",value:a.gcsPrefix,onChange:s=>h({gcsPrefix:s.target.value}),placeholder:"projects/"})})]})]})]})})]}),M=()=>e.jsxs(d,{sx:{py:2},children:[e.jsx(n,{variant:"h6",gutterBottom:!0,children:"Network Configuration"}),e.jsx(n,{variant:"body2",color:"text.secondary",paragraph:!0,children:"Configure local network deployment for team collaboration."}),e.jsx(ae,{sx:{mb:3},children:e.jsx(y,{control:e.jsx(N,{checked:a.enableLocalNetwork,onChange:s=>h({enableLocalNetwork:s.target.checked})}),label:e.jsxs(d,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(B,{}),e.jsxs(d,{children:[e.jsx(n,{children:"Enable Local Network Deployment"}),e.jsx(n,{variant:"body2",color:"text.secondary",children:"Allow team members to connect to your local instance"})]})]})})}),a.enableLocalNetwork&&e.jsx(Re.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},children:e.jsx(W,{variant:"outlined",children:e.jsxs(z,{children:[e.jsx(n,{variant:"subtitle1",gutterBottom:!0,children:"Network Deployment Settings"}),e.jsxs(g,{container:!0,spacing:3,children:[e.jsx(g,{item:!0,xs:12,sm:6,children:e.jsx(k,{fullWidth:!0,label:"Network Address",value:a.networkAddress,onChange:s=>h({networkAddress:s.target.value}),error:!!b.networkAddress,helperText:b.networkAddress||"IP address or hostname",placeholder:"192.168.1.100"})}),e.jsx(g,{item:!0,xs:12,sm:6,children:e.jsx(k,{fullWidth:!0,label:"Port",type:"number",value:a.networkPort,onChange:s=>h({networkPort:parseInt(s.target.value)||3e3}),error:!!b.networkPort,helperText:b.networkPort||"Port 1024-65535",InputProps:{inputProps:{min:1024,max:65535}}})}),e.jsx(g,{item:!0,xs:12,sm:6,children:e.jsx(k,{fullWidth:!0,label:"Max Network Users",type:"number",value:a.maxNetworkUsers,onChange:s=>h({maxNetworkUsers:parseInt(s.target.value)||10}),error:!!b.maxNetworkUsers,helperText:b.maxNetworkUsers,InputProps:{inputProps:{min:1,max:100}}})}),e.jsx(g,{item:!0,xs:12,sm:6,children:e.jsx(k,{fullWidth:!0,label:"Network Password (Optional)",type:"password",value:a.networkPassword,onChange:s=>h({networkPassword:s.target.value}),helperText:"Leave empty for no password protection"})})]}),e.jsx(V,{severity:"info",sx:{mt:2},children:e.jsxs(n,{variant:"body2",children:["Your local instance will be accessible at"," ",e.jsxs("strong",{children:["http://",a.networkAddress,":",a.networkPort]})]})})]})})})]}),T=()=>e.jsxs(d,{sx:{py:2},children:[e.jsx(n,{variant:"h6",gutterBottom:!0,children:"Collaboration Settings"}),e.jsx(n,{variant:"body2",color:"text.secondary",paragraph:!0,children:"Configure how team members can collaborate on this project."}),e.jsxs(g,{container:!0,spacing:3,children:[e.jsxs(g,{item:!0,xs:12,children:[e.jsxs(n,{gutterBottom:!0,children:["Max Collaborators: ",a.maxCollaborators]}),e.jsx(Ce,{value:a.maxCollaborators,onChange:(s,x)=>h({maxCollaborators:x}),min:1,max:100,marks:[{value:1,label:"1"},{value:25,label:"25"},{value:50,label:"50"},{value:100,label:"100"}],valueLabelDisplay:"auto"})]}),e.jsxs(g,{item:!0,xs:12,children:[e.jsx(n,{variant:"subtitle1",gutterBottom:!0,children:"Collaboration Features"}),e.jsxs(ae,{children:[e.jsx(y,{control:e.jsx(N,{checked:a.enableRealTime,onChange:s=>h({enableRealTime:s.target.checked})}),label:"Real-time Editing"}),e.jsx(y,{control:e.jsx(N,{checked:a.enableComments,onChange:s=>h({enableComments:s.target.checked})}),label:"Comments & Annotations"}),e.jsx(y,{control:e.jsx(N,{checked:a.enableFileSharing,onChange:s=>h({enableFileSharing:s.target.checked})}),label:"File Sharing"}),e.jsx(y,{control:e.jsx(N,{checked:a.enableVersionControl,onChange:s=>h({enableVersionControl:s.target.checked})}),label:"Version Control"})]})]})]})]}),i=()=>e.jsxs(d,{sx:{py:2},children:[e.jsx(n,{variant:"h6",gutterBottom:!0,children:"Review & Create"}),e.jsx(n,{variant:"body2",color:"text.secondary",paragraph:!0,children:"Review your project configuration before creating."}),e.jsx(g,{container:!0,spacing:2,children:e.jsx(g,{item:!0,xs:12,children:e.jsx(W,{variant:"outlined",children:e.jsxs(z,{children:[e.jsx(n,{variant:"h6",gutterBottom:!0,children:a.name}),a.description&&e.jsx(n,{variant:"body2",color:"text.secondary",paragraph:!0,children:a.description}),e.jsxs(d,{sx:{display:"flex",gap:1,flexWrap:"wrap",mb:2},children:[e.jsx(C,{icon:r==="standalone"?e.jsx(J,{}):e.jsx(B,{}),label:r==="standalone"?"Standalone Mode":"Network Mode",color:"primary"}),e.jsx(C,{icon:e.jsx(E,{}),label:`${a.storageMode} storage`,variant:"outlined"}),a.enableLocalNetwork&&e.jsx(C,{icon:e.jsx(B,{}),label:`Network: ${a.networkAddress}:${a.networkPort}`,variant:"outlined"})]}),e.jsx(ve,{sx:{my:2}}),e.jsx(n,{variant:"subtitle2",gutterBottom:!0,children:"Configuration Summary:"}),e.jsxs(d,{component:"ul",sx:{pl:2,m:0},children:[e.jsxs(n,{component:"li",variant:"body2",children:["Storage: ",a.storageMode,a.storageMode==="cloud"&&` (${a.cloudProvider})`]}),e.jsxs(n,{component:"li",variant:"body2",children:["Max Collaborators: ",a.maxCollaborators]}),a.enableLocalNetwork&&e.jsxs(n,{component:"li",variant:"body2",children:["Local Network: ",a.networkAddress,":",a.networkPort,"(max ",a.maxNetworkUsers," users)"]}),e.jsxs(n,{component:"li",variant:"body2",children:["Features: ",[a.enableRealTime&&"Real-time",a.enableComments&&"Comments",a.enableFileSharing&&"File Sharing",a.enableVersionControl&&"Version Control"].filter(Boolean).join(", ")]})]})]})})})})]});return e.jsxs(de,{open:f,onClose:t,maxWidth:"md",fullWidth:!0,PaperProps:{sx:{minHeight:"70vh"}},children:[e.jsxs(ue,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs(n,{variant:"h6",children:["Create New ",r==="standalone"?"Standalone":"Network"," Project"]}),e.jsx(he,{onClick:t,size:"small",children:e.jsx(me,{})})]}),e.jsxs(xe,{children:[v&&e.jsx(V,{severity:"error",sx:{mb:2},children:v}),e.jsx(d,{sx:{width:"100%"},children:e.jsx(fe,{activeStep:c,orientation:"vertical",children:ce.map((s,x)=>e.jsxs(be,{children:[e.jsx(we,{children:s}),e.jsx(ye,{children:U(x)})]},s))})}),p&&e.jsx(ke,{sx:{mt:2}})]}),e.jsxs(ge,{sx:{px:3,pb:2},children:[e.jsx(w,{onClick:t,disabled:p,children:"Cancel"}),c>0&&e.jsx(w,{onClick:D,disabled:p,children:"Back"}),c<ce.length-1?e.jsx(w,{onClick:I,variant:"contained",disabled:p,children:"Next"}):e.jsx(w,{onClick:X,variant:"contained",disabled:p,startIcon:e.jsx(Se,{}),children:p?"Creating...":"Create Project"})]})]})},ze=({onProjectLaunch:f})=>{const[t,r]=m.useState([]),[o,c]=m.useState(!0),[l,a]=m.useState(null),[u,p]=m.useState(0),[R,v]=m.useState(!1),[_,b]=m.useState(!1),[j,h]=m.useState(null);m.useEffect(()=>{P()},[]);const P=async()=>{try{a(null),c(!0);const i=await re.getUserProjects();r(i)}catch(i){a((i==null?void 0:i.message)||"Failed to load projects")}finally{c(!1)}},I=async i=>{try{await F.selectProject(i.id),f==null||f(i.id)}catch(s){console.error("Failed to launch project:",s),a("Failed to launch project")}},D=()=>{v(!0)},X=async i=>{v(!1),await P();const s=t.find(x=>x.id===i);s&&I(s)},U=i=>{switch(i){case"firestore":return e.jsx(H,{});case"gcs":return e.jsx(E,{});default:return e.jsx(J,{})}},A=i=>i==="standalone"?e.jsx(J,{}):e.jsx(B,{}),K=i=>{const s=new Date(i),L=new Date().getTime()-s.getTime(),q=Math.floor(L/(1e3*60*60*24));return q===0?"Today":q===1?"Yesterday":q<7?`${q} days ago`:s.toLocaleDateString()},M=t.filter(i=>i.isActive),T=t.filter(i=>!i.isActive);return e.jsxs(Me,{maxWidth:"lg",sx:{py:4},children:[e.jsxs(d,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:[e.jsxs(d,{children:[e.jsx(n,{variant:"h4",component:"h1",fontWeight:"bold",gutterBottom:!0,children:"Cloud Projects"}),e.jsx(n,{variant:"body1",color:"text.secondary",children:"Manage your projects with Firebase and Google Cloud Storage integration"})]}),e.jsx(w,{variant:"contained",startIcon:e.jsx(ne,{}),onClick:D,size:"large",children:"Create Project"})]}),e.jsx(V,{severity:"info",sx:{mb:3},children:e.jsxs(n,{variant:"body2",children:[e.jsx("strong",{children:"Integrated Startup System:"})," Projects created here will automatically integrate with the unified startup flow and support both standalone and network modes with Firebase/GCS storage options."]})}),l&&e.jsx(V,{severity:"error",sx:{mb:3},onClose:()=>a(null),children:l}),e.jsxs(Te,{value:u,onChange:(i,s)=>p(s),sx:{borderBottom:1,borderColor:"divider",mb:3},children:[e.jsx(ie,{label:`Active Projects (${M.length})`}),e.jsx(ie,{label:`Archived (${T.length})`})]}),e.jsxs(d,{children:[o?e.jsx(d,{sx:{textAlign:"center",py:4},children:e.jsx(n,{children:"Loading projects..."})}):e.jsx(g,{container:!0,spacing:3,children:(u===0?M:T).map(i=>e.jsx(g,{item:!0,xs:12,sm:6,md:4,children:e.jsxs(W,{sx:{height:"100%",display:"flex",flexDirection:"column",transition:"all 0.2s ease","&:hover":{transform:"translateY(-2px)",boxShadow:s=>s.shadows[4]}},children:[e.jsxs(z,{sx:{flexGrow:1},children:[e.jsxs(d,{sx:{display:"flex",alignItems:"center",mb:2},children:[A(i.applicationMode),e.jsx(n,{variant:"h6",component:"h3",sx:{ml:1,flexGrow:1},children:i.name}),e.jsx(he,{size:"small",onClick:()=>h(i),children:e.jsx(Le,{})})]}),i.description&&e.jsx(n,{variant:"body2",color:"text.secondary",paragraph:!0,children:i.description}),e.jsxs(d,{sx:{display:"flex",flexWrap:"wrap",gap:.5,mb:2},children:[e.jsx(C,{size:"small",icon:A(i.applicationMode),label:i.applicationMode==="standalone"?"Standalone":"Network",color:"primary",variant:"outlined"}),e.jsx(C,{size:"small",icon:U(i.storageBackend),label:i.storageBackend,variant:"outlined"}),i.allowCollaboration&&e.jsx(C,{size:"small",label:`${i.maxCollaborators} users`,variant:"outlined"})]}),e.jsxs(n,{variant:"caption",color:"text.secondary",children:["Last accessed: ",K(i.lastAccessedAt)]})]}),e.jsx(d,{sx:{p:2,pt:0},children:e.jsx(w,{fullWidth:!0,variant:"contained",startIcon:e.jsx(Ne,{}),onClick:()=>I(i),disabled:!i.isActive,children:i.isActive?"Launch Project":"Archived"})})]})},i.id))}),!o&&(u===0?M:T).length===0&&e.jsxs(d,{sx:{textAlign:"center",py:8},children:[e.jsx(H,{sx:{fontSize:64,color:"text.secondary",mb:2}}),e.jsx(n,{variant:"h6",color:"text.secondary",gutterBottom:!0,children:u===0?"No active projects yet":"No archived projects"}),e.jsx(n,{variant:"body2",color:"text.secondary",paragraph:!0,children:u===0?"Create your first cloud project to get started with Firebase and GCS integration":"Archived projects will appear here"}),u===0&&e.jsx(w,{variant:"contained",startIcon:e.jsx(ne,{}),onClick:D,size:"large",children:"Create Your First Project"})]})]}),e.jsx(De,{open:R,onClose:()=>v(!1),mode:"shared_network",onSuccess:X}),e.jsxs(de,{open:!!j,onClose:()=>h(null),maxWidth:"sm",fullWidth:!0,children:[e.jsx(ue,{children:e.jsxs(d,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(Be,{}),"Project Details"]})}),e.jsx(xe,{children:j&&e.jsxs(Ee,{children:[e.jsxs(O,{children:[e.jsx($,{children:A(j.applicationMode)}),e.jsx(G,{primary:"Mode",secondary:j.applicationMode==="standalone"?"Standalone":"Network"})]}),e.jsxs(O,{children:[e.jsx($,{children:U(j.storageBackend)}),e.jsx(G,{primary:"Storage Backend",secondary:j.storageBackend})]}),j.gcsBucket&&e.jsxs(O,{children:[e.jsx($,{children:e.jsx(E,{})}),e.jsx(G,{primary:"GCS Bucket",secondary:j.gcsBucket})]}),j.allowCollaboration&&e.jsxs(O,{children:[e.jsx($,{children:e.jsx(B,{})}),e.jsx(G,{primary:"Collaboration",secondary:`Up to ${j.maxCollaborators} users`})]})]})}),e.jsxs(ge,{children:[e.jsx(w,{onClick:()=>h(null),children:"Close"}),j&&e.jsx(w,{variant:"contained",onClick:()=>{I(j),h(null)},children:"Launch Project"})]})]})]})};export{ze as DashboardCloudProjectsBridge,ze as default};
