import{j as e,b as ee,a as n,T as o,d as i,az as G,t as N,aA as te,aB as W,G as E,k as se,l as ae,I as re,ak as ne,h as I,aC as oe,Z as U,aD as ie,aE as le,aF as ce,aG as de,U as $,W as d,X as p,Y as x,aH as Y,aI as R,aJ as xe,aK as _}from"./mui-T5zcPaKR.js";import{r}from"./vendor-OeuszDaU.js";import{cloudProjectIntegration as c}from"./CloudProjectIntegration-BRpl8GTi.js";import{U as he,s as je}from"./UnifiedProjectCreationDialog-ngZ63iLL.js";import"./index-SVkrna6U.js";import"./stripe-Bd-xCkZF.js";import"./proxy-Bigtmpzy.js";const we=({onProjectLaunch:y})=>{const[f,q]=r.useState([]),[P,k]=r.useState(!0),[A,h]=r.useState(null),[l,H]=r.useState(0),[J,b]=r.useState(!1),[ue,ge]=r.useState(!1),[s,j]=r.useState(null),[B,C]=r.useState([]),[K,L]=r.useState(!1),[X,Z]=r.useState([]),[u,F]=r.useState("");r.useEffect(()=>{z()},[]);const z=async()=>{try{h(null),k(!0);const t=await c.getUserProjects();q(t)}catch(t){h((t==null?void 0:t.message)||"Failed to load projects")}finally{k(!1)}},v=async t=>{try{await je.selectProject(t.id),y==null||y(t.id)}catch(a){console.error("Failed to launch project:",a),h("Failed to launch project")}},T=()=>{b(!0)},O=async t=>{b(!1),await z();const a=f.find(g=>g.id===t);a&&v(a)},M=t=>{switch(t){case"firestore":return e.jsx(U,{});case"gcs":return e.jsx(Y,{});default:return e.jsx(_,{})}},w=t=>t==="standalone"?e.jsx(_,{}):e.jsx(R,{}),Q=t=>{const a=new Date(t),V=new Date().getTime()-a.getTime(),m=Math.floor(V/(1e3*60*60*24));return m===0?"Today":m===1?"Yesterday":m<7?`${m} days ago`:a.toLocaleDateString()},S=f.filter(t=>t.isActive),D=f.filter(t=>!t.isActive);return e.jsxs(ee,{maxWidth:"lg",sx:{py:4},children:[e.jsxs(n,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:[e.jsxs(n,{children:[e.jsx(o,{variant:"h4",component:"h1",fontWeight:"bold",gutterBottom:!0,children:"Cloud Projects"}),e.jsx(o,{variant:"body1",color:"text.secondary",children:"Manage your projects with Firebase and Google Cloud Storage integration"})]}),e.jsx(i,{variant:"contained",startIcon:e.jsx(G,{}),onClick:T,size:"large",children:"Create Project"})]}),e.jsx(N,{severity:"info",sx:{mb:3},children:e.jsxs(o,{variant:"body2",children:[e.jsx("strong",{children:"Integrated Startup System:"})," Projects created here will automatically integrate with the unified startup flow and support both standalone and network modes with Firebase/GCS storage options."]})}),A&&e.jsx(N,{severity:"error",sx:{mb:3},onClose:()=>h(null),children:A}),e.jsxs(te,{value:l,onChange:(t,a)=>H(a),sx:{borderBottom:1,borderColor:"divider",mb:3},children:[e.jsx(W,{label:`Active Projects (${S.length})`}),e.jsx(W,{label:`Archived (${D.length})`})]}),e.jsxs(n,{children:[P?e.jsx(n,{sx:{textAlign:"center",py:4},children:e.jsx(o,{children:"Loading projects..."})}):e.jsx(E,{container:!0,spacing:3,children:(l===0?S:D).map(t=>e.jsx(E,{item:!0,xs:12,sm:6,md:4,children:e.jsxs(se,{sx:{height:"100%",display:"flex",flexDirection:"column",transition:"all 0.2s ease","&:hover":{transform:"translateY(-2px)",boxShadow:a=>a.shadows[4]}},children:[e.jsxs(ae,{sx:{flexGrow:1},children:[e.jsxs(n,{sx:{display:"flex",alignItems:"center",mb:2},children:[w(t.applicationMode),e.jsx(o,{variant:"h6",component:"h3",sx:{ml:1,flexGrow:1},children:t.name}),e.jsx(re,{size:"small",onClick:()=>j(t),children:e.jsx(ne,{})})]}),t.description&&e.jsx(o,{variant:"body2",color:"text.secondary",paragraph:!0,children:t.description}),e.jsxs(n,{sx:{display:"flex",flexWrap:"wrap",gap:.5,mb:2},children:[e.jsx(I,{size:"small",icon:w(t.applicationMode),label:t.applicationMode==="standalone"?"Standalone":"Network",color:"primary",variant:"outlined"}),e.jsx(I,{size:"small",icon:M(t.storageBackend),label:t.storageBackend,variant:"outlined"}),t.allowCollaboration&&e.jsx(I,{size:"small",label:`${t.maxCollaborators} users`,variant:"outlined"})]}),e.jsxs(o,{variant:"caption",color:"text.secondary",children:["Last accessed: ",Q(t.lastAccessedAt)]})]}),e.jsx(n,{sx:{p:2,pt:0},children:e.jsx(i,{fullWidth:!0,variant:"contained",startIcon:e.jsx(oe,{}),onClick:()=>v(t),disabled:!t.isActive,children:t.isActive?"Launch Project":"Archived"})})]})},t.id))}),!P&&(l===0?S:D).length===0&&e.jsxs(n,{sx:{textAlign:"center",py:8},children:[e.jsx(U,{sx:{fontSize:64,color:"text.secondary",mb:2}}),e.jsx(o,{variant:"h6",color:"text.secondary",gutterBottom:!0,children:l===0?"No active projects yet":"No archived projects"}),e.jsx(o,{variant:"body2",color:"text.secondary",paragraph:!0,children:l===0?"Create your first cloud project to get started with Firebase and GCS integration":"Archived projects will appear here"}),l===0&&e.jsx(i,{variant:"contained",startIcon:e.jsx(G,{}),onClick:T,size:"large",children:"Create Your First Project"})]})]}),e.jsx(he,{open:J,onClose:()=>b(!1),mode:"shared_network",onSuccess:O}),e.jsxs(ie,{open:!!s,onClose:()=>j(null),maxWidth:"sm",fullWidth:!0,children:[e.jsx(le,{children:e.jsxs(n,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(ce,{}),"Project Details"]})}),e.jsxs(de,{children:[s&&e.jsxs($,{children:[e.jsxs(d,{children:[e.jsx(p,{children:w(s.applicationMode)}),e.jsx(x,{primary:"Mode",secondary:s.applicationMode==="standalone"?"Standalone":"Network"})]}),e.jsxs(d,{children:[e.jsx(p,{children:M(s.storageBackend)}),e.jsx(x,{primary:"Storage Backend",secondary:s.storageBackend})]}),s.gcsBucket&&e.jsxs(d,{children:[e.jsx(p,{children:e.jsx(Y,{})}),e.jsx(x,{primary:"GCS Bucket",secondary:s.gcsBucket})]}),s.allowCollaboration&&e.jsxs(d,{children:[e.jsx(p,{children:e.jsx(R,{})}),e.jsx(x,{primary:"Collaboration",secondary:`Up to ${s.maxCollaborators} users`})]})]}),s&&e.jsxs(n,{sx:{mt:2},children:[e.jsx(o,{variant:"subtitle1",sx:{mb:1},children:"Assigned Datasets"}),e.jsx(i,{size:"small",variant:"outlined",onClick:async()=>{if(s)try{L(!0);const t=await c.getProjectDatasets(s.id);C(t);const a=await c.listDatasets();Z(a)}catch(t){console.error("Failed to load datasets",t)}finally{L(!1)}},sx:{mb:1},children:K?"Loading...":"Refresh"}),e.jsxs(n,{sx:{display:"flex",gap:1,alignItems:"center",mb:1},children:[e.jsx("label",{htmlFor:"dataset-select",className:"visually-hidden",children:"Select dataset"}),e.jsxs("select",{id:"dataset-select","aria-label":"Select dataset",value:u,onChange:t=>F(t.target.value),className:"dataset-select-input",children:[e.jsx("option",{value:"",children:"Select datasetâ€¦"}),X.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]}),e.jsx(i,{size:"small",variant:"contained",disabled:!u,onClick:async()=>{if(!(!s||!u))try{await c.assignDatasetToProject(s.id,u);const t=await c.getProjectDatasets(s.id);C(t),F("")}catch(t){console.error("Failed to assign dataset",t)}},children:"Assign"})]}),B.length===0?e.jsx(o,{variant:"body2",color:"text.secondary",children:"No datasets assigned"}):e.jsx($,{children:B.map(t=>e.jsx(d,{secondaryAction:e.jsx(i,{size:"small",color:"error",onClick:async()=>{try{await c.unassignDatasetFromProject(s.id,t.id),C(a=>a.filter(g=>g.id!==t.id))}catch(a){console.error("Failed to unassign dataset",a)}},children:"Remove"}),children:e.jsx(x,{primary:t.name,secondary:t.description})},t.id))})]})]}),e.jsxs(xe,{children:[e.jsx(i,{onClick:()=>j(null),children:"Close"}),s&&e.jsx(i,{variant:"contained",onClick:()=>{v(s),j(null)},children:"Launch Project"})]})]})]})};export{we as DashboardCloudProjectsBridge,we as default};
