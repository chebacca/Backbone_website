import{j as e,b as _e,a as o,T as l,d as g,az as ce,t as Y,aA as Ee,aB as de,G as b,k as Ge,l as Ue,I as Oe,ak as he,h as k,aC as xe,Z as ge,aD as ue,aE as be,aF as pe,aG as fe,aH as Ne,R as Ye,aI as q,aJ as je,aK as me,aL as ve,a4 as j,u as w,aM as qe,aN as Ce,F as He,Q as Je,aj as Ke,aO as we,aP as Qe}from"./mui-BChHEy9L.js";import{r as n}from"./vendor-OeuszDaU.js";import{d as u,s as A}from"./index-BQVmslXt.js";import{U as Xe}from"./UnifiedProjectCreationDialog-CrqkgGHo.js";import"./stripe-D5_9WE-2.js";const xt=({onProjectLaunch:B})=>{const[L,ye]=n.useState([]),[H,J]=n.useState(!0),[K,C]=n.useState(null),[m,ke]=n.useState(0),[Se,$]=n.useState(!1),[Ze,Ve]=n.useState(!1),[s,S]=n.useState(null),[T,I]=n.useState([]),[et,D]=n.useState(!1),[Ie,z]=n.useState([]),[Q,De]=n.useState(""),[f,X]=n.useState("all"),[_,Pe]=n.useState(""),[Z,V]=n.useState(null),[x,ee]=n.useState(null),[te,E]=n.useState({}),[Fe,G]=n.useState({}),[tt,at]=n.useState(!1),[rt,ot]=n.useState(null),[st,nt]=n.useState(0),[Me,P]=n.useState(!1),[U,ae]=n.useState(!1),[re,oe]=n.useState(null),[se,We]=n.useState(!0),[c,v]=n.useState({name:"",description:"",backend:"firestore",gcsBucket:"",gcsPrefix:""}),Re=async t=>{try{D(!0);const r=await u.getProjectDatasets(t.id);I(r),E(p=>({...p,[t.id]:r.length}));const a=f==="all"?t.storageBackend:f;f==="all"&&X(a);const h=(await u.listDatasets({backend:a,query:_||void 0})).map(p=>{var i;return{...p,__label:`${p.name} ${((i=p.storage)==null?void 0:i.backend)==="gcs"?"(GCS)":"(Firestore)"}`}});z(h)}catch(r){console.error("Failed to load datasets for project",r)}finally{D(!1)}};n.useEffect(()=>{s&&(Re(s),v(t=>({...t,backend:s.storageBackend||"firestore",gcsBucket:s.gcsBucket||"",gcsPrefix:s.gcsPrefix||""})))},[s]),n.useEffect(()=>{F();const t=r=>{F()};return window.addEventListener("project:created",t),()=>window.removeEventListener("project:created",t)},[]);const F=async()=>{try{C(null),J(!0);const t=await u.getUserProjects();ye(t);const r={};for(const a of t){const d=`launch_pref_${a.id}`,h=localStorage.getItem(d)||"web";r[a.id]=h}G(r)}catch(t){C((t==null?void 0:t.message)||"Failed to load projects")}finally{J(!1)}},ne=async t=>{try{await A.selectMode(t.applicationMode,"cloud"),await A.selectProject(t.id),B==null||B(t.id)}catch(r){console.error("Failed to launch project:",r),C("Failed to launch project")}},Ae=(t,r)=>{V(t.currentTarget),ee(r)},O=()=>{V(null),ee(null)},Be=async()=>{var t,r;if(x){try{localStorage.setItem(`launch_pref_${x.id}`,"web"),G(i=>({...i,[x.id]:"web"}));let a="";try{const i=(r=(t=x.settings)==null?void 0:t.preferredPorts)==null?void 0:r.website,y=localStorage.getItem("preferred_website_port"),R=y?Number(y):0,ze=["localhost","127.0.0.1"].includes(window.location.hostname);i&&i>=1024&&i<=65535?a=`http://localhost:${i}`:R&&R>=1024&&R<=65535?a=`http://localhost:${R}`:ze?a="http://localhost:3002":a=window.location.origin}catch{a=window.location.origin}a=String(a).replace(/\/$/,"");const h=/^http:\/\/localhost:\d+$/i.test(a)?`${a}/#/?projectId=${encodeURIComponent(x.id)}&mode=${encodeURIComponent(x.applicationMode)}`:`${a}/?projectId=${encodeURIComponent(x.id)}&mode=${encodeURIComponent(x.applicationMode)}`;let p=!1;try{const i=document.createElement("a");i.href=h,i.target="_blank",i.rel="noopener noreferrer",document.body.appendChild(i),i.click(),document.body.removeChild(i),p=!0}catch{}p||(window.location.href=h),(async()=>{try{await A.selectMode(x.applicationMode,"cloud"),await A.selectProject(x.id)}catch{}})()}catch{}O()}},Le=()=>{if(x)try{localStorage.setItem(`launch_pref_${x.id}`,"desktop"),G(d=>({...d,[x.id]:"desktop"}));const a=`dashboardv14://open-project?id=${encodeURIComponent(x.id)}`;window.location.href=a}catch(t){console.error("Failed to open desktop deep link",t),C("Unable to open Desktop app. Please ensure it is installed.")}finally{O()}},ie=()=>{$(!0)},$e=async t=>{$(!1),await F(),setTimeout(()=>{const r=(m===0?M:W).find(a=>a.id===t)||L.find(a=>a.id===t);r&&ne(r)},0)},le=t=>{switch(t){case"firestore":return e.jsx(ge,{});case"gcs":return e.jsx(Qe,{});default:return e.jsx(we,{})}},N=t=>t==="standalone"?e.jsx(we,{}):e.jsx(fe,{}),Te=t=>{const r=new Date(t),d=new Date().getTime()-r.getTime(),h=Math.floor(d/(1e3*60*60*24));return h===0?"Today":h===1?"Yesterday":h<7?`${h} days ago`:r.toLocaleDateString()},M=L.filter(t=>t.isActive),W=L.filter(t=>!t.isActive);return e.jsxs(_e,{maxWidth:"lg",sx:{py:4},children:[e.jsxs(o,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:[e.jsxs(o,{children:[e.jsx(l,{variant:"h4",component:"h1",fontWeight:"bold",gutterBottom:!0,children:"Cloud Projects"}),e.jsx(l,{variant:"body1",color:"text.secondary",children:"Manage your projects with Firebase and Google Cloud Storage integration"})]}),e.jsx(g,{variant:"contained",startIcon:e.jsx(ce,{}),onClick:ie,size:"large",children:"Create Project"})]}),e.jsx(Y,{severity:"info",sx:{mb:3},children:e.jsxs(l,{variant:"body2",children:[e.jsx("strong",{children:"Integrated Startup System:"})," Projects created here will automatically integrate with the unified startup flow and support both standalone and network modes with Firebase/GCS storage options."]})}),K&&e.jsx(Y,{severity:"error",sx:{mb:3},onClose:()=>C(null),children:K}),e.jsxs(Ee,{value:m,onChange:(t,r)=>ke(r),sx:{borderBottom:1,borderColor:"divider",mb:3},children:[e.jsx(de,{label:`Active Projects (${M.length})`}),e.jsx(de,{label:`Archived (${W.length})`})]}),e.jsxs(o,{children:[H?e.jsx(o,{sx:{textAlign:"center",py:4},children:e.jsx(l,{children:"Loading projects..."})}):e.jsx(b,{container:!0,spacing:3,children:(m===0?M:W).map(t=>e.jsx(b,{item:!0,xs:12,sm:6,md:4,children:e.jsxs(Ge,{sx:{height:"100%",display:"flex",flexDirection:"column",transition:"all 0.2s ease","&:hover":{transform:"translateY(-2px)",boxShadow:r=>r.shadows[4]}},children:[e.jsxs(Ue,{sx:{flexGrow:1},children:[e.jsxs(o,{sx:{display:"flex",alignItems:"center",mb:2},children:[N(t.applicationMode),e.jsx(l,{variant:"h6",component:"h3",sx:{ml:1,flexGrow:1},children:t.name}),e.jsx(Oe,{size:"small",onClick:()=>S(t),children:e.jsx(he,{})})]}),t.description&&e.jsx(l,{variant:"body2",color:"text.secondary",paragraph:!0,children:t.description}),e.jsxs(o,{sx:{display:"flex",flexWrap:"wrap",gap:.5,mb:2},children:[e.jsx(k,{size:"small",icon:N(t.applicationMode),label:t.applicationMode==="standalone"?"Standalone":"Network",color:"primary",variant:"outlined"}),e.jsx(k,{size:"small",icon:le(t.storageBackend),label:t.storageBackend,variant:"outlined"}),typeof te[t.id]=="number"&&e.jsx(k,{size:"small",label:`Datasets: ${te[t.id]}`,variant:"outlined"}),e.jsx(k,{size:"small",label:`Launch: ${(Fe[t.id]||"web")==="desktop"?"Desktop":"Web"}`,variant:"outlined"}),t.allowCollaboration&&e.jsx(k,{size:"small",label:`${t.maxCollaborators} users`,variant:"outlined"})]}),e.jsxs(l,{variant:"caption",color:"text.secondary",children:["Last accessed: ",Te(t.lastAccessedAt)]})]}),e.jsxs(o,{sx:{p:2,pt:0,display:"flex",gap:1},children:[e.jsx(g,{fullWidth:!0,variant:"contained",startIcon:e.jsx(xe,{}),onClick:r=>Ae(r,t),disabled:!t.isActive,children:t.isActive?"Launch":"Archived"}),e.jsx(g,{fullWidth:!0,variant:"outlined",color:t.isActive?"warning":"success",onClick:async()=>{try{t.isActive?await u.archiveProject(t.id):await u.restoreProject(t.id),await F()}catch(r){console.error("Failed to toggle archive",r),C("Failed to update project")}},children:t.isActive?"Archive":"Restore"})]})]})},t.id))}),!H&&(m===0?M:W).length===0&&e.jsxs(o,{sx:{textAlign:"center",py:8},children:[e.jsx(ge,{sx:{fontSize:64,color:"text.secondary",mb:2}}),e.jsx(l,{variant:"h6",color:"text.secondary",gutterBottom:!0,children:m===0?"No active projects yet":"No archived projects"}),e.jsx(l,{variant:"body2",color:"text.secondary",paragraph:!0,children:m===0?"Create your first cloud project to get started with Firebase and GCS integration":"Archived projects will appear here"}),m===0&&e.jsx(g,{variant:"contained",startIcon:e.jsx(ce,{}),onClick:ie,size:"large",children:"Create Your First Project"})]})]}),e.jsx(Xe,{open:Se,onClose:()=>$(!1),mode:"shared_network",onSuccess:$e,onCreate:async t=>{var a,d;try{const h=localStorage.getItem("auth_token");h&&((d=(a=window.cloudProjectIntegration)==null?void 0:a.setAuthToken)==null||d.call(a,h))}catch{}return await u.createCloudProject(t)}}),e.jsxs(ue,{open:!!s,onClose:()=>S(null),maxWidth:"md",fullWidth:!0,PaperProps:{sx:{borderRadius:3,background:"linear-gradient(135deg, #1a1a2e 0%, #16213e 100%)",border:"1px solid rgba(255, 255, 255, 0.1)",boxShadow:"0 20px 40px rgba(0, 0, 0, 0.3)",overflow:"hidden"}},children:[e.jsx(be,{sx:{background:"linear-gradient(135deg, #0f3460 0%, #16213e 100%)",borderBottom:"1px solid rgba(255, 255, 255, 0.1)",p:3,position:"relative","&::after":{content:'""',position:"absolute",bottom:0,left:0,right:0,height:"2px",background:"linear-gradient(90deg, #4f46e5, #06b6d4, #3b82f6)",borderRadius:"1px"}},children:e.jsxs(o,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsx(o,{sx:{width:48,height:48,borderRadius:"50%",background:"linear-gradient(135deg, #4f46e5, #06b6d4)",display:"flex",alignItems:"center",justifyContent:"center",boxShadow:"0 8px 16px rgba(79, 70, 229, 0.3)"},children:e.jsx(he,{sx:{color:"white",fontSize:24}})}),e.jsxs(o,{children:[e.jsx(l,{variant:"h5",sx:{color:"white",fontWeight:700,textShadow:"0 2px 4px rgba(0, 0, 0, 0.3)"},children:"Project Details"}),e.jsx(l,{variant:"body2",sx:{color:"rgba(255, 255, 255, 0.7)"},children:(s==null?void 0:s.name)||"Project Configuration"})]})]})}),e.jsx(pe,{sx:{p:0,background:"transparent"},children:s&&e.jsxs(o,{sx:{p:3},children:[e.jsxs(o,{sx:{mb:4},children:[e.jsxs(l,{variant:"h6",sx:{color:"white",mb:3,fontWeight:600,display:"flex",alignItems:"center",gap:1},children:[e.jsx(o,{sx:{width:8,height:8,borderRadius:"50%",background:"linear-gradient(135deg, #10b981, #06b6d4)",boxShadow:"0 0 8px rgba(16, 185, 129, 0.5)"}}),"Project Information"]}),e.jsxs(b,{container:!0,spacing:3,children:[e.jsx(b,{item:!0,xs:12,sm:4,children:e.jsxs(o,{sx:{p:3,borderRadius:2,background:"rgba(255, 255, 255, 0.05)",border:"1px solid rgba(255, 255, 255, 0.1)",backdropFilter:"blur(10px)",transition:"all 0.3s ease","&:hover":{transform:"translateY(-2px)",boxShadow:"0 8px 25px rgba(0, 0, 0, 0.2)",borderColor:"rgba(79, 70, 229, 0.3)"}},children:[e.jsxs(o,{sx:{display:"flex",alignItems:"center",gap:2,mb:2},children:[e.jsx(o,{sx:{width:40,height:40,borderRadius:"50%",background:"linear-gradient(135deg, #4f46e5, #7c3aed)",display:"flex",alignItems:"center",justifyContent:"center"},children:N(s.applicationMode)}),e.jsx(l,{variant:"body2",sx:{color:"rgba(255, 255, 255, 0.6)"},children:"Mode"})]}),e.jsx(l,{variant:"h6",sx:{color:"white",fontWeight:600},children:s.applicationMode==="standalone"?"Standalone":"Network"})]})}),e.jsx(b,{item:!0,xs:12,sm:4,children:e.jsxs(o,{sx:{p:3,borderRadius:2,background:"rgba(255, 255, 255, 0.05)",border:"1px solid rgba(255, 255, 255, 0.1)",backdropFilter:"blur(10px)",transition:"all 0.3s ease","&:hover":{transform:"translateY(-2px)",boxShadow:"0 8px 25px rgba(0, 0, 0, 0.2)",borderColor:"rgba(6, 182, 212, 0.3)"}},children:[e.jsxs(o,{sx:{display:"flex",alignItems:"center",gap:2,mb:2},children:[e.jsx(o,{sx:{width:40,height:40,borderRadius:"50%",background:"linear-gradient(135deg, #06b6d4, #0891b2)",display:"flex",alignItems:"center",justifyContent:"center"},children:le(s.storageBackend)}),e.jsx(l,{variant:"body2",sx:{color:"rgba(255, 255, 255, 0.6)"},children:"Storage Backend"})]}),e.jsx(l,{variant:"h6",sx:{color:"white",fontWeight:600},children:s.storageBackend})]})}),e.jsx(b,{item:!0,xs:12,sm:4,children:e.jsxs(o,{sx:{p:3,borderRadius:2,background:"rgba(255, 255, 255, 0.05)",border:"1px solid rgba(255, 255, 255, 0.1)",backdropFilter:"blur(10px)",transition:"all 0.3s ease","&:hover":{transform:"translateY(-2px)",boxShadow:"0 8px 25px rgba(0, 0, 0, 0.2)",borderColor:"rgba(16, 185, 129, 0.3)"}},children:[e.jsxs(o,{sx:{display:"flex",alignItems:"center",gap:2,mb:2},children:[e.jsx(o,{sx:{width:40,height:40,borderRadius:"50%",background:"linear-gradient(135deg, #10b981, #059669)",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(fe,{sx:{color:"white"}})}),e.jsx(l,{variant:"body2",sx:{color:"rgba(255, 255, 255, 0.6)"},children:"Collaboration"})]}),e.jsxs(l,{variant:"h6",sx:{color:"white",fontWeight:600},children:["Up to ",s.maxCollaborators||10," users"]})]})})]})]}),e.jsxs(o,{children:[e.jsxs(l,{variant:"h6",sx:{color:"white",mb:3,fontWeight:600,display:"flex",alignItems:"center",gap:1},children:[e.jsx(o,{sx:{width:8,height:8,borderRadius:"50%",background:"linear-gradient(135deg, #f59e0b, #f97316)",boxShadow:"0 0 8px rgba(245, 158, 11, 0.5)"}}),"Assigned Datasets"]}),e.jsxs(o,{sx:{p:3,borderRadius:2,background:"rgba(255, 255, 255, 0.05)",border:"1px solid rgba(255, 255, 255, 0.1)",backdropFilter:"blur(10px)"},children:[e.jsxs(o,{sx:{display:"flex",gap:2,mb:3,flexWrap:"wrap"},children:[e.jsx(g,{variant:"contained",startIcon:e.jsx(Ne,{}),sx:{background:"linear-gradient(135deg, #4f46e5, #7c3aed)",color:"white",borderRadius:2,px:3,py:1,textTransform:"none",fontWeight:600,boxShadow:"0 4px 12px rgba(79, 70, 229, 0.3)","&:hover":{background:"linear-gradient(135deg, #4338ca, #6d28d9)",boxShadow:"0 6px 20px rgba(79, 70, 229, 0.4)",transform:"translateY(-1px)"}},children:"Upload File"}),e.jsx(g,{variant:"outlined",startIcon:e.jsx(Ye,{}),sx:{borderColor:"rgba(79, 70, 229, 0.5)",color:"#4f46e5",borderRadius:2,px:3,py:1,textTransform:"none",fontWeight:600,"&:hover":{borderColor:"#4f46e5",backgroundColor:"rgba(79, 70, 229, 0.1)"}},children:"Refresh"}),e.jsx(g,{variant:"outlined",startIcon:e.jsx(q,{}),sx:{borderColor:"rgba(6, 182, 212, 0.5)",color:"#06b6d4",borderRadius:2,px:3,py:1,textTransform:"none",fontWeight:600,"&:hover":{borderColor:"#06b6d4",backgroundColor:"rgba(6, 182, 212, 0.1)"}},children:"New Dataset"})]}),e.jsxs(b,{container:!0,spacing:2,sx:{mb:3},children:[e.jsx(b,{item:!0,xs:12,sm:3,children:e.jsxs(je,{fullWidth:!0,size:"small",children:[e.jsx(me,{sx:{color:"rgba(255, 255, 255, 0.7)"},children:"Backend"}),e.jsxs(ve,{value:f==="all"?"firestore":f,onChange:t=>X(t.target.value),sx:{"& .MuiOutlinedInput-notchedOutline":{borderColor:"rgba(255, 255, 255, 0.2)"},"&:hover .MuiOutlinedInput-notchedOutline":{borderColor:"rgba(79, 70, 229, 0.5)"},"& .MuiSelect-icon":{color:"rgba(255, 255, 255, 0.7)"},color:"white","& .MuiMenuItem-root":{color:"black"}},children:[e.jsx(j,{value:"firestore",children:"Firestore"}),e.jsx(j,{value:"gcs",children:"Google Cloud Storage"})]})]})}),e.jsx(b,{item:!0,xs:12,sm:4,children:e.jsx(w,{fullWidth:!0,size:"small",placeholder:"Search datasets...",value:_,onChange:t=>Pe(t.target.value),sx:{"& .MuiOutlinedInput-root":{color:"white","& fieldset":{borderColor:"rgba(255, 255, 255, 0.2)"},"&:hover fieldset":{borderColor:"rgba(79, 70, 229, 0.5)"},"& input::placeholder":{color:"rgba(255, 255, 255, 0.5)",opacity:1}}}})}),e.jsx(b,{item:!0,xs:12,sm:3,children:e.jsxs(je,{fullWidth:!0,size:"small",children:[e.jsx(me,{sx:{color:"rgba(255, 255, 255, 0.7)"},children:"Select dataset"}),e.jsxs(ve,{value:Q,onChange:t=>De(t.target.value),sx:{"& .MuiOutlinedInput-notchedOutline":{borderColor:"rgba(255, 255, 255, 0.2)"},"&:hover .MuiOutlinedInput-notchedOutline":{borderColor:"rgba(79, 70, 229, 0.5)"},"& .MuiSelect-icon":{color:"rgba(255, 255, 255, 0.7)"},color:"white","& .MuiMenuItem-root":{color:"black"}},children:[e.jsx(j,{value:"",children:"Select dataset..."}),Ie.map(t=>e.jsx(j,{value:t.id,children:t.__label||t.name},t.id))]})]})}),e.jsx(b,{item:!0,xs:12,sm:2,children:e.jsxs(o,{sx:{display:"flex",gap:1},children:[e.jsx(g,{variant:"contained",size:"small",disabled:!Q,sx:{background:"linear-gradient(135deg, #10b981, #059669)",color:"white",borderRadius:2,textTransform:"none",fontWeight:600,boxShadow:"0 4px 12px rgba(16, 185, 129, 0.3)","&:hover":{background:"linear-gradient(135deg, #059669, #047857)",boxShadow:"0 6px 20px rgba(16, 185, 129, 0.4)"},"&:disabled":{background:"rgba(255, 255, 255, 0.1)",color:"rgba(255, 255, 255, 0.3)"}},children:"Assign"}),e.jsx(g,{variant:"outlined",size:"small",onClick:async()=>{if(s)try{D(!0);const t=await u.getProjectDatasets(s.id);I(t);const a=(await u.listDatasets({backend:f==="all"?void 0:f,query:_||void 0})).map(d=>{var h;return{...d,__label:`${d.name} ${((h=d.storage)==null?void 0:h.backend)==="gcs"?"(GCS)":"(Firestore)"}`}});z(a)}catch(t){console.error("Failed to load datasets",t)}finally{D(!1)}},sx:{borderColor:"rgba(79, 70, 229, 0.5)",color:"#4f46e5",borderRadius:2,textTransform:"none",fontWeight:600,"&:hover":{borderColor:"#4f46e5",backgroundColor:"rgba(79, 70, 229, 0.1)"}},children:"Apply Filters"})]})})]}),e.jsxs(o,{children:[e.jsx(l,{variant:"body2",sx:{color:"rgba(255, 255, 255, 0.7)",mb:2,fontWeight:500},children:"Currently Assigned Datasets"}),T.length===0?e.jsxs(o,{sx:{p:4,textAlign:"center",borderRadius:2,background:"rgba(255, 255, 255, 0.02)",border:"1px dashed rgba(255, 255, 255, 0.1)"},children:[e.jsx(q,{sx:{fontSize:48,color:"rgba(255, 255, 255, 0.3)",mb:2}}),e.jsx(l,{variant:"body2",sx:{color:"rgba(255, 255, 255, 0.5)"},children:"No datasets assigned to this project"})]}):e.jsx(o,{sx:{borderRadius:2,overflow:"hidden",border:"1px solid rgba(255, 255, 255, 0.1)"},children:T.map((t,r)=>e.jsxs(o,{sx:{p:2,background:r%2===0?"rgba(255, 255, 255, 0.02)":"rgba(255, 255, 255, 0.05)",borderBottom:r<T.length-1?"1px solid rgba(255, 255, 255, 0.1)":"none",display:"flex",alignItems:"center",justifyContent:"space-between",transition:"all 0.2s ease","&:hover":{background:"rgba(79, 70, 229, 0.1)",transform:"translateX(4px)"}},children:[e.jsxs(o,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsx(o,{sx:{width:32,height:32,borderRadius:"50%",background:"linear-gradient(135deg, #f59e0b, #f97316)",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(q,{sx:{color:"white",fontSize:16}})}),e.jsxs(o,{children:[e.jsx(l,{variant:"body1",sx:{color:"white",fontWeight:500},children:t.name}),t.description&&e.jsx(l,{variant:"body2",sx:{color:"rgba(255, 255, 255, 0.6)"},children:t.description})]})]}),e.jsx(g,{variant:"outlined",size:"small",startIcon:e.jsx(qe,{}),onClick:async()=>{try{await u.unassignDatasetFromProject(s.id,t.id),I(a=>a.filter(d=>d.id!==t.id)),E(a=>({...a,[s.id]:Math.max(0,(a[s.id]||1)-1)}))}catch(a){console.error("Failed to unassign dataset",a)}},sx:{borderColor:"rgba(239, 68, 68, 0.5)",color:"#ef4444",borderRadius:2,textTransform:"none",fontWeight:600,"&:hover":{borderColor:"#ef4444",backgroundColor:"rgba(239, 68, 68, 0.1)",transform:"scale(1.05)"}},children:"Remove"})]},t.id))})]})]})]})]})}),e.jsxs(Ce,{sx:{p:3,background:"rgba(255, 255, 255, 0.02)",borderTop:"1px solid rgba(255, 255, 255, 0.1)",display:"flex",justifyContent:"space-between"},children:[e.jsx(g,{onClick:()=>S(null),variant:"outlined",sx:{borderColor:"rgba(255, 255, 255, 0.3)",color:"rgba(255, 255, 255, 0.8)",borderRadius:2,px:4,py:1.5,textTransform:"none",fontWeight:600,"&:hover":{borderColor:"rgba(255, 255, 255, 0.5)",backgroundColor:"rgba(255, 255, 255, 0.05)"}},children:"Close"}),s&&e.jsx(g,{variant:"contained",onClick:()=>{ne(s),S(null)},startIcon:e.jsx(xe,{}),sx:{background:"linear-gradient(135deg, #4f46e5, #7c3aed)",color:"white",borderRadius:2,px:4,py:1.5,textTransform:"none",fontWeight:600,boxShadow:"0 6px 20px rgba(79, 70, 229, 0.4)","&:hover":{background:"linear-gradient(135deg, #4338ca, #6d28d9)",boxShadow:"0 8px 25px rgba(79, 70, 229, 0.5)",transform:"translateY(-2px)"}},children:"Launch Project"})]})]}),e.jsxs(ue,{open:Me,onClose:()=>P(!1),maxWidth:"sm",fullWidth:!0,children:[e.jsx(be,{children:"Create Dataset"}),e.jsxs(pe,{children:[re&&e.jsx(Y,{severity:"error",sx:{mb:2},children:re}),e.jsxs(o,{sx:{display:"flex",flexDirection:"column",gap:2,mt:1},children:[e.jsx(w,{label:"Name",value:c.name,onChange:t=>v({...c,name:t.target.value}),required:!0,fullWidth:!0}),e.jsx(w,{label:"Description",value:c.description,onChange:t=>v({...c,description:t.target.value}),multiline:!0,minRows:2,fullWidth:!0}),e.jsxs(w,{select:!0,label:"Storage Backend",value:c.backend,onChange:t=>v({...c,backend:t.target.value}),fullWidth:!0,children:[e.jsx(j,{value:"firestore",children:"Firestore"}),e.jsx(j,{value:"gcs",children:"Google Cloud Storage (GCS)"})]}),c.backend==="gcs"&&e.jsxs(e.Fragment,{children:[e.jsx(w,{label:"GCS Bucket",placeholder:"my-bucket",value:c.gcsBucket,onChange:t=>v({...c,gcsBucket:t.target.value}),fullWidth:!0}),e.jsx(w,{label:"GCS Prefix (optional)",placeholder:"datasets/project-123/",value:c.gcsPrefix,onChange:t=>v({...c,gcsPrefix:t.target.value}),fullWidth:!0})]}),e.jsx(He,{control:e.jsx(Je,{checked:se,onChange:(t,r)=>We(r)}),label:"Assign to this project after creation"})]})]}),e.jsxs(Ce,{children:[e.jsx(g,{onClick:()=>P(!1),disabled:U,children:"Cancel"}),e.jsx(g,{variant:"contained",disabled:U||!c.name.trim(),onClick:async()=>{if(!s){P(!1);return}oe(null),ae(!0);try{const t={backend:c.backend};c.backend==="gcs"&&(c.gcsBucket&&(t.gcsBucket=c.gcsBucket),c.gcsPrefix&&(t.gcsPrefix=c.gcsPrefix));const r=await u.createDataset({name:c.name.trim(),description:c.description.trim()||void 0,visibility:"private",organizationId:null,tags:[],schema:{},storage:t});se&&await u.assignDatasetToProject(s.id,r.id);const a=await u.getProjectDatasets(s.id);I(a),E(i=>({...i,[s.id]:a.length}));const d=f==="all"?s.storageBackend:f,p=(await u.listDatasets({backend:d})).map(i=>{var y;return{...i,__label:`${i.name} ${((y=i.storage)==null?void 0:y.backend)==="gcs"?"(GCS)":"(Firestore)"}`}});z(p),P(!1),v(i=>({...i,name:"",description:""}))}catch(t){oe((t==null?void 0:t.message)||"Failed to create dataset")}finally{ae(!1)}},children:U?"Creating…":"Create Dataset"})]})]}),e.jsxs(Ke,{anchorEl:Z,open:!!Z,onClose:O,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},children:[e.jsx(j,{onClick:Be,children:"Launch (Web)"}),e.jsx(j,{onClick:Le,children:"Launch (Desktop)"})]})]})};export{xt as DashboardCloudProjectsBridge,xt as default};
