import{j as e,B as r,C as ie,T as s,d as N,ai as O,w as C,x as c,y as l,aj as ae,z as d,H as G,K as oe,a as j,ak as ce,al as S,am as le,G as h,t as m,v as u,ag as f,ae as V,i as de,an as w,ao as xe,q as z,D as A,aa as je,r as L,p as he,u as me}from"./mui-Bfdt1nAh.js";import{u as ue,r as W,b as ge}from"./vendor-CjD1bmmO.js";import{u as pe,a as be,b as ye}from"./useStreamlinedData-C9wmCkdL.js";import"./index-DCOUUOPk.js";import"./stripe-DHYO8zYT.js";import"./index.esm-ClhtutUx.js";import"./index.esm-COtph9ny.js";const Se=()=>{var k,P;const o=ue(),{data:x,loading:Y,error:H}=pe(),{data:t,loading:q,error:K}=be(),{data:i,loading:Q,error:J}=ye(),X=Y||q||Q,Z=H||K||J,n=W.useMemo(()=>{var D,T,B,M,R,F;if(!x||!t||!i)return{activeLicenses:0,totalLicenses:0,monthlyUsage:0,totalDownloads:0,currentPlan:"Unknown",daysUntilRenewal:"N/A",hasEnterpriseFeatures:!1,projectCount:0,teamMemberCount:0,licenseUtilization:0};const a=((D=x.license)==null?void 0:D.status)==="ACTIVE"?1:0,g=1,_=a/g*100,ee=i.reduce((y,v)=>{var p;return y+(((p=v.teamAssignments)==null?void 0:p.length)||0)*100},0),se=i.reduce((y,v)=>{var p;return y+(((p=v.teamAssignments)==null?void 0:p.length)||0)*50},0),re=((B=(T=t.organization)==null?void 0:T.usage)==null?void 0:B.totalUsers)||0,ne=i.length,I=((R=(M=t.subscription)==null?void 0:M.plan)==null?void 0:R.tier)||"BASIC",te=I==="ENTERPRISE";let E="N/A";if((F=t.subscription)!=null&&F.currentPeriodEnd){const y=new Date(t.subscription.currentPeriodEnd),v=new Date,p=y.getTime()-v.getTime(),$=Math.ceil(p/(1e3*60*60*24));E=$>0?`${$} days`:"Expired"}return{activeLicenses:a,totalLicenses:g,monthlyUsage:ee,totalDownloads:se,currentPlan:I,daysUntilRenewal:E,hasEnterpriseFeatures:te,projectCount:ne,teamMemberCount:re,licenseUtilization:_}},[x,t,i]),b=W.useMemo(()=>{var a,g;return x?x.role?x.role.toLowerCase():(g=(a=t==null?void 0:t.organization)==null?void 0:a.usage)!=null&&g.totalUsers&&t.organization.usage.totalUsers===1?"admin":"member":"unknown"},[x,t]),U=b==="admin"||b==="superadmin";return X?e.jsx(r,{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"400px",children:e.jsxs(r,{textAlign:"center",children:[e.jsx(ie,{size:60}),e.jsx(s,{variant:"h6",sx:{mt:2},children:"Loading Dashboard Data..."}),e.jsx(s,{variant:"body2",color:"text.secondary",children:"Fetching your organization and project information"})]})}):Z?e.jsx(r,{sx:{p:3},children:e.jsxs(N,{severity:"error",children:[e.jsx(O,{children:"Unable to Load Dashboard Data"}),e.jsx(s,{variant:"body2",sx:{mb:2},children:"We encountered an issue loading your dashboard information. This could be due to:"}),e.jsxs(C,{dense:!0,children:[e.jsxs(c,{children:[e.jsx(l,{children:e.jsx(ae,{fontSize:"small"})}),e.jsx(d,{primary:"Network connectivity issues"})]}),e.jsxs(c,{children:[e.jsx(l,{children:e.jsx(G,{fontSize:"small"})}),e.jsx(d,{primary:"Authentication token expired"})]}),e.jsxs(c,{children:[e.jsx(l,{children:e.jsx(oe,{fontSize:"small"})}),e.jsx(d,{primary:"Firebase service temporarily unavailable"})]})]}),e.jsxs(r,{sx:{mt:2},children:[e.jsx(j,{variant:"contained",onClick:()=>window.location.reload(),sx:{mr:2},children:"Retry"}),e.jsx(j,{variant:"outlined",onClick:()=>o("/dashboard/support"),children:"Contact Support"})]})]})}):!x||!t?e.jsx(r,{sx:{p:3},children:e.jsxs(N,{severity:"info",children:[e.jsx(O,{children:"Setting Up Your Dashboard"}),e.jsx(s,{variant:"body2",sx:{mb:2},children:"We're preparing your dashboard. This usually happens when:"}),e.jsxs(C,{dense:!0,children:[e.jsxs(c,{children:[e.jsx(l,{children:e.jsx(ce,{fontSize:"small"})}),e.jsx(d,{primary:"Your account is being set up for the first time"})]}),e.jsxs(c,{children:[e.jsx(l,{children:e.jsx(S,{fontSize:"small"})}),e.jsx(d,{primary:"You're being added to an organization"})]}),e.jsxs(c,{children:[e.jsx(l,{children:e.jsx(le,{fontSize:"small"})}),e.jsx(d,{primary:"Data synchronization is in progress"})]})]}),e.jsxs(r,{sx:{mt:2},children:[e.jsx(j,{variant:"contained",onClick:()=>window.location.reload(),sx:{mr:2},children:"Refresh"}),e.jsx(j,{variant:"outlined",onClick:()=>o("/dashboard/team"),children:"Check Team Status"})]})]})}):e.jsxs(r,{sx:{flexGrow:1,p:3},children:[e.jsxs(r,{sx:{mb:4},children:[e.jsxs(s,{variant:"h4",component:"h1",gutterBottom:!0,children:["Welcome back, ",x.name||x.email]}),e.jsxs(s,{variant:"subtitle1",color:"text.secondary",children:[((k=t.organization)==null?void 0:k.name)||"Organization"," • ",n.currentPlan," Plan • ",b.charAt(0).toUpperCase()+b.slice(1)]})]}),e.jsxs(h,{container:!0,spacing:3,sx:{mb:4},children:[e.jsx(h,{item:!0,xs:12,sm:6,md:3,children:e.jsx(m,{children:e.jsxs(u,{children:[e.jsxs(r,{display:"flex",alignItems:"center",justifyContent:"space-between",children:[e.jsxs(r,{children:[e.jsx(s,{color:"textSecondary",gutterBottom:!0,variant:"body2",children:"Active Licenses"}),e.jsx(s,{variant:"h4",children:n.activeLicenses}),e.jsxs(s,{variant:"body2",color:"text.secondary",children:["of ",n.totalLicenses," total"]})]}),e.jsx(f,{sx:{bgcolor:"primary.main"},children:e.jsx(V,{})})]}),n.totalLicenses>0&&e.jsxs(r,{sx:{mt:2},children:[e.jsx(de,{variant:"determinate",value:n.licenseUtilization,sx:{height:8,borderRadius:4}}),e.jsxs(s,{variant:"caption",color:"text.secondary",sx:{mt:1,display:"block"},children:[n.licenseUtilization.toFixed(1),"% utilization"]})]})]})})}),e.jsx(h,{item:!0,xs:12,sm:6,md:3,children:e.jsx(m,{children:e.jsx(u,{children:e.jsxs(r,{display:"flex",alignItems:"center",justifyContent:"space-between",children:[e.jsxs(r,{children:[e.jsx(s,{color:"textSecondary",gutterBottom:!0,variant:"body2",children:"Projects"}),e.jsx(s,{variant:"h4",children:n.projectCount}),e.jsx(s,{variant:"body2",color:"text.secondary",children:"active projects"})]}),e.jsx(f,{sx:{bgcolor:"success.main"},children:e.jsx(w,{})})]})})})}),e.jsx(h,{item:!0,xs:12,sm:6,md:3,children:e.jsx(m,{children:e.jsx(u,{children:e.jsxs(r,{display:"flex",alignItems:"center",justifyContent:"space-between",children:[e.jsxs(r,{children:[e.jsx(s,{color:"textSecondary",gutterBottom:!0,variant:"body2",children:"Team Members"}),e.jsx(s,{variant:"h4",children:n.teamMemberCount}),e.jsx(s,{variant:"body2",color:"text.secondary",children:"in organization"})]}),e.jsx(f,{sx:{bgcolor:"info.main"},children:e.jsx(S,{})})]})})})}),e.jsx(h,{item:!0,xs:12,sm:6,md:3,children:e.jsx(m,{children:e.jsx(u,{children:e.jsxs(r,{display:"flex",alignItems:"center",justifyContent:"space-between",children:[e.jsxs(r,{children:[e.jsx(s,{color:"textSecondary",gutterBottom:!0,variant:"body2",children:"Monthly Usage"}),e.jsx(s,{variant:"h4",children:n.monthlyUsage.toLocaleString()}),e.jsx(s,{variant:"body2",color:"text.secondary",children:"API calls"})]}),e.jsx(f,{sx:{bgcolor:"warning.main"},children:e.jsx(xe,{})})]})})})})]}),e.jsxs(h,{container:!0,spacing:3,sx:{mb:4},children:[e.jsx(h,{item:!0,xs:12,md:6,children:e.jsx(m,{children:e.jsxs(u,{children:[e.jsx(s,{variant:"h6",gutterBottom:!0,children:"Quick Actions"}),e.jsxs(C,{children:[e.jsxs(c,{button:!0,onClick:()=>o("/dashboard/projects"),children:[e.jsx(l,{children:e.jsx(w,{})}),e.jsx(d,{primary:"Manage Projects",secondary:`${n.projectCount} active projects`}),e.jsx(z,{})]}),e.jsx(A,{}),e.jsxs(c,{button:!0,onClick:()=>o("/dashboard/team"),children:[e.jsx(l,{children:e.jsx(S,{})}),e.jsx(d,{primary:"Team Management",secondary:`${n.teamMemberCount} team members`}),e.jsx(z,{})]}),e.jsx(A,{}),e.jsxs(c,{button:!0,onClick:()=>o("/dashboard/licenses"),children:[e.jsx(l,{children:e.jsx(V,{})}),e.jsx(d,{primary:"License Management",secondary:`${n.activeLicenses} active licenses`}),e.jsx(z,{})]}),U&&e.jsxs(e.Fragment,{children:[e.jsx(A,{}),e.jsxs(c,{button:!0,onClick:()=>o("/dashboard/billing"),children:[e.jsx(l,{children:e.jsx(je,{})}),e.jsx(d,{primary:"Billing & Subscription",secondary:`${n.currentPlan} plan • Renews ${n.daysUntilRenewal}`}),e.jsx(z,{})]})]})]})]})})}),e.jsx(h,{item:!0,xs:12,md:6,children:e.jsx(m,{children:e.jsxs(u,{children:[e.jsx(s,{variant:"h6",gutterBottom:!0,children:"Account Status"}),e.jsxs(r,{sx:{mb:2},children:[e.jsx(L,{icon:e.jsx(he,{}),label:`${n.currentPlan} Plan`,color:"primary",sx:{mr:1,mb:1}}),e.jsx(L,{icon:e.jsx(G,{}),label:b.charAt(0).toUpperCase()+b.slice(1),color:"secondary",sx:{mr:1,mb:1}}),n.hasEnterpriseFeatures&&e.jsx(L,{icon:e.jsx(me,{}),label:"Enterprise",color:"warning",sx:{mr:1,mb:1}})]}),e.jsxs(s,{variant:"body2",color:"text.secondary",sx:{mb:2},children:["Organization: ",((P=t.organization)==null?void 0:P.name)||"Organization"]}),t.subscription&&e.jsxs(s,{variant:"body2",color:"text.secondary",sx:{mb:2},children:["Next renewal: ",n.daysUntilRenewal]}),e.jsxs(r,{sx:{mt:2},children:[e.jsx(j,{variant:"outlined",size:"small",onClick:()=>o("/dashboard/settings"),sx:{mr:1},children:"Account Settings"}),U&&e.jsx(j,{variant:"outlined",size:"small",onClick:()=>o("/dashboard/billing"),children:"Manage Billing"})]})]})})})]}),i&&i.length>0&&e.jsx(m,{children:e.jsxs(u,{children:[e.jsx(s,{variant:"h6",gutterBottom:!0,children:"Recent Projects"}),e.jsx(C,{children:i.slice(0,5).map((a,g)=>e.jsxs(ge.Fragment,{children:[e.jsxs(c,{button:!0,onClick:()=>o(`/dashboard/projects/${a.id}`),children:[e.jsx(l,{children:e.jsx(w,{})}),e.jsx(d,{primary:a.name,secondary:`Created ${new Date(a.createdAt).toLocaleDateString()}`}),e.jsx(L,{label:a.status||"ACTIVE",size:"small",color:a.status==="ACTIVE"?"success":"default"})]}),g<Math.min(i.length-1,4)&&e.jsx(A,{})]},a.id))}),i.length>5&&e.jsx(r,{sx:{mt:2,textAlign:"center"},children:e.jsxs(j,{variant:"outlined",onClick:()=>o("/dashboard/projects"),children:["View All Projects (",i.length,")"]})})]})}),i&&i.length===0&&e.jsx(m,{children:e.jsxs(u,{sx:{textAlign:"center",py:4},children:[e.jsx(w,{sx:{fontSize:64,color:"text.secondary",mb:2}}),e.jsx(s,{variant:"h6",gutterBottom:!0,children:"No Projects Yet"}),e.jsx(s,{variant:"body2",color:"text.secondary",sx:{mb:3},children:"Get started by creating your first project"}),e.jsx(j,{variant:"contained",onClick:()=>o("/dashboard/projects"),children:"Create Project"})]})})]})};export{Se as default};
