import{j as e,B as r,C as re,T as s,d as R,ai as E,w as v,x as c,y as l,aj as ne,z as d,H as F,K as te,a as j,ak as ie,al as z,am as ae,G as h,t as m,v as u,ag as f,ae as $,i as oe,an as C,ao as ce,q as w,D as L,aa as le,r as k,p as de,u as xe}from"./mui-C0ZDli_l.js";import{u as je,r as N,b as he}from"./vendor-CjD1bmmO.js";import{u as me,a as ue,b as be}from"./useStreamlinedData-C9NVZ4f3.js";import"./index-Bq4VIwtE.js";import"./stripe-BUwd9CCU.js";import"./index.esm-ClhtutUx.js";import"./index.esm-COtph9ny.js";const Le=()=>{const o=je(),{data:x,loading:G,error:W}=me(),{data:n,loading:Y,error:O}=ue(),{data:i,loading:H,error:q}=be(),K=G||Y||H,Q=W||O||q,t=N.useMemo(()=>{var D,P,I,M,B;if(!x||!n||!i)return{activeLicenses:0,totalLicenses:0,monthlyUsage:0,totalDownloads:0,currentPlan:"Unknown",daysUntilRenewal:"N/A",hasEnterpriseFeatures:!1,projectCount:0,teamMemberCount:0,licenseUtilization:0};const a=((D=n.licenses)==null?void 0:D.filter(p=>p.status==="active").length)||0,b=((P=n.licenses)==null?void 0:P.length)||0,V=b>0?a/b*100:0,J=i.reduce((p,g)=>p+(g.monthlyUsage||0),0),X=i.reduce((p,g)=>p+(g.totalDownloads||0),0),Z=((I=n.members)==null?void 0:I.length)||0,_=i.length,S=((M=n.subscription)==null?void 0:M.plan)||"Free",ee=S.toLowerCase().includes("enterprise");let U="N/A";if((B=n.subscription)!=null&&B.renewalDate){const p=new Date(n.subscription.renewalDate),g=new Date,se=p.getTime()-g.getTime(),T=Math.ceil(se/(1e3*60*60*24));U=T>0?`${T} days`:"Expired"}return{activeLicenses:a,totalLicenses:b,monthlyUsage:J,totalDownloads:X,currentPlan:S,daysUntilRenewal:U,hasEnterpriseFeatures:ee,projectCount:_,teamMemberCount:Z,licenseUtilization:V}},[x,n,i]),y=N.useMemo(()=>{if(!x)return"unknown";if(x.role)return x.role.toLowerCase();if(n!=null&&n.members){const a=n.members.find(b=>b.userId===x.id);if(a)return a.role.toLowerCase()}return"member"},[x,n]),A=y==="admin"||y==="superadmin";return K?e.jsx(r,{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"400px",children:e.jsxs(r,{textAlign:"center",children:[e.jsx(re,{size:60}),e.jsx(s,{variant:"h6",sx:{mt:2},children:"Loading Dashboard Data..."}),e.jsx(s,{variant:"body2",color:"text.secondary",children:"Fetching your organization and project information"})]})}):Q?e.jsx(r,{sx:{p:3},children:e.jsxs(R,{severity:"error",children:[e.jsx(E,{children:"Unable to Load Dashboard Data"}),e.jsx(s,{variant:"body2",sx:{mb:2},children:"We encountered an issue loading your dashboard information. This could be due to:"}),e.jsxs(v,{dense:!0,children:[e.jsxs(c,{children:[e.jsx(l,{children:e.jsx(ne,{fontSize:"small"})}),e.jsx(d,{primary:"Network connectivity issues"})]}),e.jsxs(c,{children:[e.jsx(l,{children:e.jsx(F,{fontSize:"small"})}),e.jsx(d,{primary:"Authentication token expired"})]}),e.jsxs(c,{children:[e.jsx(l,{children:e.jsx(te,{fontSize:"small"})}),e.jsx(d,{primary:"Firebase service temporarily unavailable"})]})]}),e.jsxs(r,{sx:{mt:2},children:[e.jsx(j,{variant:"contained",onClick:()=>window.location.reload(),sx:{mr:2},children:"Retry"}),e.jsx(j,{variant:"outlined",onClick:()=>o("/dashboard/support"),children:"Contact Support"})]})]})}):!x||!n?e.jsx(r,{sx:{p:3},children:e.jsxs(R,{severity:"info",children:[e.jsx(E,{children:"Setting Up Your Dashboard"}),e.jsx(s,{variant:"body2",sx:{mb:2},children:"We're preparing your dashboard. This usually happens when:"}),e.jsxs(v,{dense:!0,children:[e.jsxs(c,{children:[e.jsx(l,{children:e.jsx(ie,{fontSize:"small"})}),e.jsx(d,{primary:"Your account is being set up for the first time"})]}),e.jsxs(c,{children:[e.jsx(l,{children:e.jsx(z,{fontSize:"small"})}),e.jsx(d,{primary:"You're being added to an organization"})]}),e.jsxs(c,{children:[e.jsx(l,{children:e.jsx(ae,{fontSize:"small"})}),e.jsx(d,{primary:"Data synchronization is in progress"})]})]}),e.jsxs(r,{sx:{mt:2},children:[e.jsx(j,{variant:"contained",onClick:()=>window.location.reload(),sx:{mr:2},children:"Refresh"}),e.jsx(j,{variant:"outlined",onClick:()=>o("/dashboard/team"),children:"Check Team Status"})]})]})}):e.jsxs(r,{sx:{flexGrow:1,p:3},children:[e.jsxs(r,{sx:{mb:4},children:[e.jsxs(s,{variant:"h4",component:"h1",gutterBottom:!0,children:["Welcome back, ",x.displayName||x.email]}),e.jsxs(s,{variant:"subtitle1",color:"text.secondary",children:[n.name," • ",t.currentPlan," Plan • ",y.charAt(0).toUpperCase()+y.slice(1)]})]}),e.jsxs(h,{container:!0,spacing:3,sx:{mb:4},children:[e.jsx(h,{item:!0,xs:12,sm:6,md:3,children:e.jsx(m,{children:e.jsxs(u,{children:[e.jsxs(r,{display:"flex",alignItems:"center",justifyContent:"space-between",children:[e.jsxs(r,{children:[e.jsx(s,{color:"textSecondary",gutterBottom:!0,variant:"body2",children:"Active Licenses"}),e.jsx(s,{variant:"h4",children:t.activeLicenses}),e.jsxs(s,{variant:"body2",color:"text.secondary",children:["of ",t.totalLicenses," total"]})]}),e.jsx(f,{sx:{bgcolor:"primary.main"},children:e.jsx($,{})})]}),t.totalLicenses>0&&e.jsxs(r,{sx:{mt:2},children:[e.jsx(oe,{variant:"determinate",value:t.licenseUtilization,sx:{height:8,borderRadius:4}}),e.jsxs(s,{variant:"caption",color:"text.secondary",sx:{mt:1,display:"block"},children:[t.licenseUtilization.toFixed(1),"% utilization"]})]})]})})}),e.jsx(h,{item:!0,xs:12,sm:6,md:3,children:e.jsx(m,{children:e.jsx(u,{children:e.jsxs(r,{display:"flex",alignItems:"center",justifyContent:"space-between",children:[e.jsxs(r,{children:[e.jsx(s,{color:"textSecondary",gutterBottom:!0,variant:"body2",children:"Projects"}),e.jsx(s,{variant:"h4",children:t.projectCount}),e.jsx(s,{variant:"body2",color:"text.secondary",children:"active projects"})]}),e.jsx(f,{sx:{bgcolor:"success.main"},children:e.jsx(C,{})})]})})})}),e.jsx(h,{item:!0,xs:12,sm:6,md:3,children:e.jsx(m,{children:e.jsx(u,{children:e.jsxs(r,{display:"flex",alignItems:"center",justifyContent:"space-between",children:[e.jsxs(r,{children:[e.jsx(s,{color:"textSecondary",gutterBottom:!0,variant:"body2",children:"Team Members"}),e.jsx(s,{variant:"h4",children:t.teamMemberCount}),e.jsx(s,{variant:"body2",color:"text.secondary",children:"in organization"})]}),e.jsx(f,{sx:{bgcolor:"info.main"},children:e.jsx(z,{})})]})})})}),e.jsx(h,{item:!0,xs:12,sm:6,md:3,children:e.jsx(m,{children:e.jsx(u,{children:e.jsxs(r,{display:"flex",alignItems:"center",justifyContent:"space-between",children:[e.jsxs(r,{children:[e.jsx(s,{color:"textSecondary",gutterBottom:!0,variant:"body2",children:"Monthly Usage"}),e.jsx(s,{variant:"h4",children:t.monthlyUsage.toLocaleString()}),e.jsx(s,{variant:"body2",color:"text.secondary",children:"API calls"})]}),e.jsx(f,{sx:{bgcolor:"warning.main"},children:e.jsx(ce,{})})]})})})})]}),e.jsxs(h,{container:!0,spacing:3,sx:{mb:4},children:[e.jsx(h,{item:!0,xs:12,md:6,children:e.jsx(m,{children:e.jsxs(u,{children:[e.jsx(s,{variant:"h6",gutterBottom:!0,children:"Quick Actions"}),e.jsxs(v,{children:[e.jsxs(c,{button:!0,onClick:()=>o("/dashboard/projects"),children:[e.jsx(l,{children:e.jsx(C,{})}),e.jsx(d,{primary:"Manage Projects",secondary:`${t.projectCount} active projects`}),e.jsx(w,{})]}),e.jsx(L,{}),e.jsxs(c,{button:!0,onClick:()=>o("/dashboard/team"),children:[e.jsx(l,{children:e.jsx(z,{})}),e.jsx(d,{primary:"Team Management",secondary:`${t.teamMemberCount} team members`}),e.jsx(w,{})]}),e.jsx(L,{}),e.jsxs(c,{button:!0,onClick:()=>o("/dashboard/licenses"),children:[e.jsx(l,{children:e.jsx($,{})}),e.jsx(d,{primary:"License Management",secondary:`${t.activeLicenses} active licenses`}),e.jsx(w,{})]}),A&&e.jsxs(e.Fragment,{children:[e.jsx(L,{}),e.jsxs(c,{button:!0,onClick:()=>o("/dashboard/billing"),children:[e.jsx(l,{children:e.jsx(le,{})}),e.jsx(d,{primary:"Billing & Subscription",secondary:`${t.currentPlan} plan • Renews ${t.daysUntilRenewal}`}),e.jsx(w,{})]})]})]})]})})}),e.jsx(h,{item:!0,xs:12,md:6,children:e.jsx(m,{children:e.jsxs(u,{children:[e.jsx(s,{variant:"h6",gutterBottom:!0,children:"Account Status"}),e.jsxs(r,{sx:{mb:2},children:[e.jsx(k,{icon:e.jsx(de,{}),label:`${t.currentPlan} Plan`,color:"primary",sx:{mr:1,mb:1}}),e.jsx(k,{icon:e.jsx(F,{}),label:y.charAt(0).toUpperCase()+y.slice(1),color:"secondary",sx:{mr:1,mb:1}}),t.hasEnterpriseFeatures&&e.jsx(k,{icon:e.jsx(xe,{}),label:"Enterprise",color:"warning",sx:{mr:1,mb:1}})]}),e.jsxs(s,{variant:"body2",color:"text.secondary",sx:{mb:2},children:["Organization: ",n.name]}),n.subscription&&e.jsxs(s,{variant:"body2",color:"text.secondary",sx:{mb:2},children:["Next renewal: ",t.daysUntilRenewal]}),e.jsxs(r,{sx:{mt:2},children:[e.jsx(j,{variant:"outlined",size:"small",onClick:()=>o("/dashboard/settings"),sx:{mr:1},children:"Account Settings"}),A&&e.jsx(j,{variant:"outlined",size:"small",onClick:()=>o("/dashboard/billing"),children:"Manage Billing"})]})]})})})]}),i&&i.length>0&&e.jsx(m,{children:e.jsxs(u,{children:[e.jsx(s,{variant:"h6",gutterBottom:!0,children:"Recent Projects"}),e.jsx(v,{children:i.slice(0,5).map((a,b)=>e.jsxs(he.Fragment,{children:[e.jsxs(c,{button:!0,onClick:()=>o(`/dashboard/projects/${a.id}`),children:[e.jsx(l,{children:e.jsx(C,{})}),e.jsx(d,{primary:a.name,secondary:`Created ${new Date(a.createdAt).toLocaleDateString()}`}),e.jsx(k,{label:a.status||"Active",size:"small",color:a.status==="active"?"success":"default"})]}),b<Math.min(i.length-1,4)&&e.jsx(L,{})]},a.id))}),i.length>5&&e.jsx(r,{sx:{mt:2,textAlign:"center"},children:e.jsxs(j,{variant:"outlined",onClick:()=>o("/dashboard/projects"),children:["View All Projects (",i.length,")"]})})]})}),i&&i.length===0&&e.jsx(m,{children:e.jsxs(u,{sx:{textAlign:"center",py:4},children:[e.jsx(C,{sx:{fontSize:64,color:"text.secondary",mb:2}}),e.jsx(s,{variant:"h6",gutterBottom:!0,children:"No Projects Yet"}),e.jsx(s,{variant:"body2",color:"text.secondary",sx:{mb:3},children:"Get started by creating your first project"}),e.jsx(j,{variant:"contained",onClick:()=>o("/dashboard/projects"),children:"Create Project"})]})})]})};export{Le as default};
