import{j as e,B as i,b as V,c as W,T as r,d as m,E as I,S as p,a as o,R as C,o as P,p as z,q as B,C as F}from"./mui-bHvDBUJA.js";import{u as L,f as Y,e as D,r as f}from"./vendor-CjD1bmmO.js";import{u as U,a as q,b as E}from"./index-B1Qck6KP.js";import{u as G}from"./notistack.esm-Ca-E78ev.js";import"./stripe-6YKC861V.js";const O=()=>{var j;const a=L(),{token:g}=Y(),S=D(),{user:s,refreshUser:w}=U(),{setLoading:H}=q(),{enqueueSnackbar:c}=G(),[b,u]=f.useState("pending"),[h,l]=f.useState(null),[d,y]=f.useState(!1),n=(j=S.state)==null?void 0:j.selectedTier;f.useEffect(()=>{const x=new URLSearchParams(window.location.search).get("token"),k=g||x||"";k&&R(k)},[g]);const R=async t=>{try{u("verifying"),l(null),await E.verifyEmail(t),await w(),u("success"),c("Email verified successfully!",{variant:"success"}),setTimeout(()=>{n?a("/checkout",{state:{tier:n}}):a("/dashboard")},3e3)}catch(x){u("error"),l(x.message||"Email verification failed"),c(x.message||"Email verification failed",{variant:"error"})}},v=async()=>{try{y(!0),l(null),await E.resendVerification(),c("Verification email sent! Please check your inbox.",{variant:"success"})}catch(t){l(t.message||"Failed to resend verification email"),c(t.message||"Failed to resend verification email",{variant:"error"})}finally{y(!1)}},T=()=>{n?a("/checkout",{state:{tier:n}}):a("/dashboard")},A=()=>{switch(b){case"verifying":return e.jsxs(i,{sx:{textAlign:"center"},children:[e.jsx(F,{size:60,sx:{mb:3,color:"primary.main"}}),e.jsx(r,{variant:"h5",sx:{fontWeight:600,mb:2},children:"Verifying Your Email"}),e.jsx(r,{variant:"body1",color:"text.secondary",children:"Please wait while we verify your email address..."})]});case"success":return e.jsxs(i,{sx:{textAlign:"center"},children:[e.jsx(z,{sx:{fontSize:80,color:"success.main",mb:3}}),e.jsx(r,{variant:"h5",sx:{fontWeight:600,mb:2},children:"Email Verified Successfully!"}),e.jsx(r,{variant:"body1",color:"text.secondary",sx:{mb:4,textAlign:"center"},children:"Your email has been verified. You can now access all features of BackboneLogic, Inc."}),n&&e.jsxs(m,{severity:"info",sx:{mb:3},children:["Redirecting to checkout for your selected ",n," plan..."]}),e.jsx(o,{variant:"contained",size:"large",endIcon:e.jsx(B,{}),onClick:T,sx:{background:"linear-gradient(135deg, #00d4ff 0%, #667eea 100%)",color:"#000"},children:n?"Continue to Checkout":"Go to Dashboard"})]});case"error":return e.jsxs(i,{sx:{textAlign:"center"},children:[e.jsx(P,{sx:{fontSize:80,color:"error.main",mb:3}}),e.jsx(r,{variant:"h5",sx:{fontWeight:600,mb:2},children:"Verification Failed"}),e.jsx(r,{variant:"body1",color:"text.secondary",sx:{mb:4},children:h||"The verification link is invalid or has expired."}),e.jsxs(p,{spacing:2,direction:{xs:"column",sm:"row"},justifyContent:"center",children:[e.jsx(o,{variant:"contained",startIcon:e.jsx(C,{}),onClick:v,disabled:d,sx:{background:"linear-gradient(135deg, #00d4ff 0%, #667eea 100%)",color:"#000"},children:d?"Sending...":"Resend Verification"}),e.jsx(o,{variant:"outlined",onClick:()=>a("/login"),children:"Back to Login"})]})]});default:return e.jsxs(i,{sx:{textAlign:"center"},children:[e.jsx(I,{sx:{fontSize:80,color:"primary.main",mb:3}}),e.jsx(r,{variant:"h5",sx:{fontWeight:600,mb:2},children:"Check Your Email"}),e.jsx(r,{variant:"body1",color:"text.secondary",sx:{mb:2},children:"We've sent a verification link to:"}),e.jsx(r,{variant:"body1",sx:{fontWeight:600,mb:4,color:"primary.main"},children:s==null?void 0:s.email}),e.jsx(r,{variant:"body2",color:"text.secondary",sx:{mb:4},children:"Click the link in your email to verify your account. The link will expire in 24 hours."}),n&&e.jsxs(m,{severity:"info",sx:{mb:4},children:["After verifying your email, you'll be redirected to checkout for your selected ",n," plan."]}),e.jsxs(p,{spacing:2,children:[e.jsx(o,{variant:"contained",size:"large",startIcon:e.jsx(C,{}),onClick:v,disabled:d,sx:{background:"linear-gradient(135deg, #00d4ff 0%, #667eea 100%)",color:"#000"},children:d?"Sending...":"Resend Verification Email"}),e.jsx(o,{variant:"text",onClick:()=>a("/login"),sx:{color:"text.secondary"},children:"Use a different email address"})]}),e.jsxs(i,{sx:{mt:4,p:2,backgroundColor:"rgba(255, 255, 255, 0.05)",borderRadius:2},children:[e.jsx(r,{variant:"body2",color:"text.secondary",sx:{mb:1},children:e.jsx("strong",{children:"Didn't receive the email?"})}),e.jsxs(r,{variant:"caption",color:"text.secondary",children:["â€¢ Check your spam/junk folder",e.jsx("br",{}),"â€¢ Make sure ",s==null?void 0:s.email," is correct",e.jsx("br",{}),"â€¢ Try resending the verification email"]})]})]})}};return e.jsx(i,{sx:{minHeight:"100vh",background:"linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%)",display:"flex",alignItems:"center",py:{xs:4,md:0}},children:e.jsx(V,{maxWidth:"sm",children:e.jsx(i,{children:e.jsxs(W,{elevation:10,sx:{p:{xs:4,md:6},backgroundColor:"background.paper",borderRadius:3,border:"1px solid rgba(255, 255, 255, 0.1)"},children:[e.jsxs(i,{sx:{textAlign:"center",mb:4},children:[e.jsx(i,{sx:{width:60,height:60,borderRadius:2,background:"linear-gradient(135deg, #00d4ff 0%, #667eea 100%)",display:"flex",alignItems:"center",justifyContent:"center",mx:"auto",mb:3},children:e.jsx(r,{variant:"h4",sx:{fontWeight:700,color:"#000"},children:"D"})}),e.jsx(r,{variant:"h4",sx:{fontWeight:600,mb:1,background:"linear-gradient(135deg, #ffffff 0%, #00d4ff 100%)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",backgroundClip:"text"},children:"Email Verification"})]}),h&&b!=="error"&&e.jsx(m,{severity:"error",sx:{mb:3},children:h}),A(),e.jsx(i,{sx:{mt:4,pt:3,borderTop:"1px solid rgba(255, 255, 255, 0.1)",textAlign:"center"},children:e.jsx(r,{variant:"caption",color:"text.secondary",children:"ðŸ”’ Your account security is our top priority"})})]})})})})};export{O as default};
