import{j as e,a as i,b as V,c as W,T as r,A as m,Z as I,S as p,d as o,R as C,a4 as P,w as z,a5 as F,C as L}from"./mui-CWufCee_.js";import{u as B,i as Y,h as D,r as f}from"./vendor-OeuszDaU.js";import{u as U,a as q,b as w}from"./index-BBr4cJSs.js";import{u as G}from"./notistack.esm-CcFOI6Un.js";import"./stripe-DjIiidKe.js";const K=()=>{var j;const n=B(),{token:g}=Y(),E=D(),{user:s,refreshUser:S}=U(),{setLoading:H}=q(),{enqueueSnackbar:c}=G(),[b,u]=f.useState("pending"),[h,l]=f.useState(null),[d,y]=f.useState(!1),a=(j=E.state)==null?void 0:j.selectedTier;f.useEffect(()=>{const x=new URLSearchParams(window.location.search).get("token"),k=g||x||"";k&&A(k)},[g]);const A=async t=>{try{u("verifying"),l(null),await w.verifyEmail(t),await S(),u("success"),c("Email verified successfully!",{variant:"success"}),setTimeout(()=>{a?n("/checkout",{state:{tier:a}}):n("/dashboard")},3e3)}catch(x){u("error"),l(x.message||"Email verification failed"),c(x.message||"Email verification failed",{variant:"error"})}},v=async()=>{try{y(!0),l(null),await w.resendVerification(),c("Verification email sent! Please check your inbox.",{variant:"success"})}catch(t){l(t.message||"Failed to resend verification email"),c(t.message||"Failed to resend verification email",{variant:"error"})}finally{y(!1)}},R=()=>{a?n("/checkout",{state:{tier:a}}):n("/dashboard")},T=()=>{switch(b){case"verifying":return e.jsxs(i,{sx:{textAlign:"center"},children:[e.jsx(L,{size:60,sx:{mb:3,color:"primary.main"}}),e.jsx(r,{variant:"h5",sx:{fontWeight:600,mb:2},children:"Verifying Your Email"}),e.jsx(r,{variant:"body1",color:"text.secondary",children:"Please wait while we verify your email address..."})]});case"success":return e.jsxs(i,{sx:{textAlign:"center"},children:[e.jsx(z,{sx:{fontSize:80,color:"success.main",mb:3}}),e.jsx(r,{variant:"h5",sx:{fontWeight:600,mb:2},children:"Email Verified Successfully!"}),e.jsx(r,{variant:"body1",color:"text.secondary",sx:{mb:4,textAlign:"center"},children:"Your email has been verified. You can now access all features of BackboneLogic, Inc."}),a&&e.jsxs(m,{severity:"info",sx:{mb:3},children:["Redirecting to checkout for your selected ",a," plan..."]}),e.jsx(o,{variant:"contained",size:"large",endIcon:e.jsx(F,{}),onClick:R,sx:{background:"linear-gradient(135deg, #00d4ff 0%, #667eea 100%)",color:"#000"},children:a?"Continue to Checkout":"Go to Dashboard"})]});case"error":return e.jsxs(i,{sx:{textAlign:"center"},children:[e.jsx(P,{sx:{fontSize:80,color:"error.main",mb:3}}),e.jsx(r,{variant:"h5",sx:{fontWeight:600,mb:2},children:"Verification Failed"}),e.jsx(r,{variant:"body1",color:"text.secondary",sx:{mb:4},children:h||"The verification link is invalid or has expired."}),e.jsxs(p,{spacing:2,direction:{xs:"column",sm:"row"},justifyContent:"center",children:[e.jsx(o,{variant:"contained",startIcon:e.jsx(C,{}),onClick:v,disabled:d,sx:{background:"linear-gradient(135deg, #00d4ff 0%, #667eea 100%)",color:"#000"},children:d?"Sending...":"Resend Verification"}),e.jsx(o,{variant:"outlined",onClick:()=>n("/login"),children:"Back to Login"})]})]});default:return e.jsxs(i,{sx:{textAlign:"center"},children:[e.jsx(I,{sx:{fontSize:80,color:"primary.main",mb:3}}),e.jsx(r,{variant:"h5",sx:{fontWeight:600,mb:2},children:"Check Your Email"}),e.jsx(r,{variant:"body1",color:"text.secondary",sx:{mb:2},children:"We've sent a verification link to:"}),e.jsx(r,{variant:"body1",sx:{fontWeight:600,mb:4,color:"primary.main"},children:s==null?void 0:s.email}),e.jsx(r,{variant:"body2",color:"text.secondary",sx:{mb:4},children:"Click the link in your email to verify your account. The link will expire in 24 hours."}),a&&e.jsxs(m,{severity:"info",sx:{mb:4},children:["After verifying your email, you'll be redirected to checkout for your selected ",a," plan."]}),e.jsxs(p,{spacing:2,children:[e.jsx(o,{variant:"contained",size:"large",startIcon:e.jsx(C,{}),onClick:v,disabled:d,sx:{background:"linear-gradient(135deg, #00d4ff 0%, #667eea 100%)",color:"#000"},children:d?"Sending...":"Resend Verification Email"}),e.jsx(o,{variant:"text",onClick:()=>n("/login"),sx:{color:"text.secondary"},children:"Use a different email address"})]}),e.jsxs(i,{sx:{mt:4,p:2,backgroundColor:"rgba(255, 255, 255, 0.05)",borderRadius:2},children:[e.jsx(r,{variant:"body2",color:"text.secondary",sx:{mb:1},children:e.jsx("strong",{children:"Didn't receive the email?"})}),e.jsxs(r,{variant:"caption",color:"text.secondary",children:["â€¢ Check your spam/junk folder",e.jsx("br",{}),"â€¢ Make sure ",s==null?void 0:s.email," is correct",e.jsx("br",{}),"â€¢ Try resending the verification email"]})]})]})}};return e.jsx(i,{sx:{minHeight:"100vh",background:"linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%)",display:"flex",alignItems:"center",py:{xs:4,md:0}},children:e.jsx(V,{maxWidth:"sm",children:e.jsx(i,{children:e.jsxs(W,{elevation:10,sx:{p:{xs:4,md:6},backgroundColor:"background.paper",borderRadius:3,border:"1px solid rgba(255, 255, 255, 0.1)"},children:[e.jsxs(i,{sx:{textAlign:"center",mb:4},children:[e.jsx(i,{sx:{width:60,height:60,borderRadius:2,background:"linear-gradient(135deg, #00d4ff 0%, #667eea 100%)",display:"flex",alignItems:"center",justifyContent:"center",mx:"auto",mb:3},children:e.jsx(r,{variant:"h4",sx:{fontWeight:700,color:"#000"},children:"D"})}),e.jsx(r,{variant:"h4",sx:{fontWeight:600,mb:1,background:"linear-gradient(135deg, #ffffff 0%, #00d4ff 100%)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",backgroundClip:"text"},children:"Email Verification"})]}),h&&b!=="error"&&e.jsx(m,{severity:"error",sx:{mb:3},children:h}),T(),e.jsx(i,{sx:{mt:4,pt:3,borderTop:"1px solid rgba(255, 255, 255, 0.1)",textAlign:"center"},children:e.jsx(r,{variant:"caption",color:"text.secondary",children:"ðŸ”’ Your account security is our top priority"})})]})})})})};export{K as default};
