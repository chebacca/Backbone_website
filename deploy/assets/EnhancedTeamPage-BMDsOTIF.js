var rs=Object.defineProperty;var ls=(m,a,t)=>a in m?rs(m,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):m[a]=t;var F=(m,a,t)=>ls(m,typeof a!="symbol"?a+"":a,t);import{j as e,B as A,T as g,G as y,aR as os,d as De,ai as Me,a as S,cd as cs,ce as ds,c7 as us,al as dt,p as hs,am as ms,bP as ps,t as ne,aU as gs,aV as ce,ab as fs,aW as xs,a6 as js,cf as ke,e as P,I as vs,be as ys,cg as ws,bC as bs,bD as ze,ch as Cs,ci as Ss,cj as As,ck as Ts,v as de,ar as z,as as V,at as _,M as w,aB as Ve,c as _e,aC as We,aD as Ue,aE as ie,aF as v,l as ut,aG as $e,af as Is,r as B,g as Ds,aH as Ms,cl as ks,C as Ls,i as ht,b8 as mt,cm as Ps,R as Os,h as Es,bO as pt,aO as gt,aI as G,aJ as H,aK as Q,cn as Bs,aL as J,w as Rs,x as Fs,z as Ns,a5 as zs,y as ue,E as Vs,u as _s,L as Ws,D as Us}from"./mui-DoW6Yw-n.js";import{r as h}from"./vendor-CjD1bmmO.js";import{u as $s}from"./notistack.esm-Ca-E78ev.js";import{b as Gs,c as Hs,a as Qs,u as Js,d as Ys,i as Ks,j as Xs,k as Zs,g as qs,h as ea,l as ta}from"./useStreamlinedData-Bmi6W4Yo.js";import{M as Le}from"./MetricCard-DiCbyu6H.js";import"./UnifiedDataService-nwdpPGwS.js";import"./index-CvLmnh-t.js";import"./stripe-8p04StgX.js";import"./index.esm-DdZh2hq1.js";import"./index.esm-Dkmm1Qng.js";import"./FirestoreCollectionManager-C-4GJc9C.js";import"./firebase-B80IXrtU.js";import"./index.esm-e-DuI42t.js";const Y=class Y{static getInstance(){return Y.instance||(Y.instance=new Y),Y.instance}async exportTeamMembers(a,t={}){const{includeInactive:i=!1,includePassword:n=!1,includeAuditInfo:r=!1,customFields:l=[]}=t;let d=a;i||(d=a.filter(c=>c.status==="active"));const p=["Email","First Name","Last Name","Role","Status","Department","Position","Phone","License Type","Organization ID","Created At","Last Active"];n&&p.splice(4,0,"Password"),r&&p.push("Created By","Updated At","Updated By"),l.forEach(c=>{p.includes(c)||p.push(c)});const o=d.map(c=>{const b=[c.email||"",c.firstName||"",c.lastName||"",c.role||"",c.status||"",c.department||"",c.position||"",c.phone||"",c.licenseType||"",c.organizationId||"",c.createdAt?new Date(c.createdAt).toISOString():"",c.lastActive?new Date(c.lastActive).toISOString():""];return n&&b.splice(4,0,c.password||""),r&&b.push(c.createdBy||"",c.updatedAt?new Date(c.updatedAt).toISOString():"",c.updatedBy||""),l.forEach(O=>{const k=c[O];b.push(typeof k=="string"?k:k?String(k):"")}),b});return[p.join(","),...o.map(c=>c.map(b=>typeof b=="string"&&b.includes(",")?`"${b.replace(/"/g,'""')}"`:b).join(","))].join(`
`)}async importTeamMembers(a,t,i){const n=a.split(`
`).filter(c=>c.trim());if(n.length<2)return{success:!1,totalRows:0,successfulImports:0,failedImports:0,errors:[{row:0,field:"general",value:"",error:"CSV file is empty or invalid"}],importedMembers:[]};const r=this.parseCSVLine(n[0]),l=n.slice(1),d=[],p=[],f=["Email","First Name","Last Name","Role"].filter(c=>!r.includes(c));if(f.length>0)return{success:!1,totalRows:l.length,successfulImports:0,failedImports:l.length,errors:[{row:0,field:"headers",value:f.join(", "),error:`Missing required headers: ${f.join(", ")}`}],importedMembers:[]};for(let c=0;c<l.length;c++){const b=l[c],O=this.parseCSVLine(b);i&&i(Math.round((c+1)/l.length*100));try{const k=this.validateAndCreateTeamMember(O,r,t,c+2);k&&p.push(k)}catch(k){d.push({row:c+2,field:"general",value:b,error:k instanceof Error?k.message:"Unknown error"})}}return{success:d.length===0,totalRows:l.length,successfulImports:p.length,failedImports:d.length,errors:d,importedMembers:p}}parseCSVLine(a){const t=[];let i="",n=!1;for(let r=0;r<a.length;r++){const l=a[r];l==='"'?n&&a[r+1]==='"'?(i+='"',r++):n=!n:l===","&&!n?(t.push(i.trim()),i=""):i+=l}return t.push(i.trim()),t}validateAndCreateTeamMember(a,t,i,n){var b,O,k,re,me,Oe,Ee,Be;const r=[],l={};t.forEach((pe,Xe)=>{l[pe.toLowerCase()]=a[Xe]||""});const d=(b=l.email)==null?void 0:b.trim(),p=(O=l["first name"])==null?void 0:O.trim(),o=(k=l["last name"])==null?void 0:k.trim(),f=(re=l.role)==null?void 0:re.trim();if(d?this.isValidEmail(d)||r.push({row:n,field:"email",value:d,error:"Invalid email format"}):r.push({row:n,field:"email",value:"",error:"Email is required"}),p||r.push({row:n,field:"first name",value:"",error:"First name is required"}),o||r.push({row:n,field:"last name",value:"",error:"Last name is required"}),f?["admin","member","viewer","owner"].includes(f.toLowerCase())||r.push({row:n,field:"role",value:f,error:"Invalid role. Must be admin, member, viewer, or owner"}):r.push({row:n,field:"role",value:"",error:"Role is required"}),r.length>0)throw new Error(`Validation errors: ${r.map(pe=>pe.error).join(", ")}`);return{id:"",email:d.toLowerCase(),firstName:p,lastName:o,role:f.toLowerCase(),status:"pending",organization:{id:i,name:"",tier:"BASIC"},organizationId:i,department:((me=l.department)==null?void 0:me.trim())||"",position:((Oe=l.position)==null?void 0:Oe.trim())||"",phone:((Ee=l.phone)==null?void 0:Ee.trim())||"",licenseType:((Be=l["license type"])==null?void 0:Be.trim())||"BASIC",assignedProjects:[],joinedAt:new Date,createdAt:new Date,updatedAt:new Date,lastActive:l["last active"]?new Date(l["last active"]):void 0}}isValidEmail(a){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(a)}downloadCSV(a,t="team-members.csv"){const i=new Blob([a],{type:"text/csv;charset=utf-8;"}),n=document.createElement("a"),r=URL.createObjectURL(i);n.setAttribute("href",r),n.setAttribute("download",t),n.style.visibility="hidden",document.body.appendChild(n),n.click(),document.body.removeChild(n)}generateTemplate(){const a=["Email","First Name","Last Name","Role","Status","Department","Position","Phone","License Type"],t=["john.doe@example.com","John","Doe","member","active","Engineering","Software Developer","+1-555-0123","PROFESSIONAL"];return[a.join(","),t.join(",")].join(`
`)}};F(Y,"instance");let He=Y;const Ge=He.getInstance(),K=class K{static getInstance(){return K.instance||(K.instance=new K),K.instance}filterTeamMembers(a,t,i,n){let r=[...a];t.search&&(r=this.applySearchFilter(r,t.search)),t.role&&t.role.length>0&&(r=r.filter(c=>t.role.includes(c.role))),t.status&&t.status.length>0&&(r=r.filter(c=>t.status.includes(c.status))),t.department&&t.department.length>0&&(r=r.filter(c=>c.department&&t.department.includes(c.department))),t.licenseType&&t.licenseType.length>0&&(r=r.filter(c=>c.licenseType&&t.licenseType.includes(c.licenseType))),t.dateRange&&(r=this.applyDateRangeFilter(r,t.dateRange)),t.hasLicense!==void 0&&(r=r.filter(c=>t.hasLicense?!!c.licenseType:!c.licenseType)),t.isActive!==void 0&&(r=r.filter(c=>t.isActive?c.status==="active":c.status!=="active")),t.customFields&&(r=this.applyCustomFieldFilters(r,t.customFields)),i&&(r=this.applySorting(r,i));const l=a.length,d=r.length;let p=r,o=!1,f={currentPage:1,totalPages:1,pageSize:d,totalItems:d};if(n){const c=(n.page-1)*n.pageSize,b=c+n.pageSize;p=r.slice(c,b),o=b<d,f={currentPage:n.page,totalPages:Math.ceil(d/n.pageSize),pageSize:n.pageSize,totalItems:d}}return{filteredMembers:p,totalCount:l,filteredCount:d,hasMore:o,pageInfo:f}}applySearchFilter(a,t){const i=t.toLowerCase();return a.filter(n=>[n.email,n.firstName,n.lastName,n.department,n.position,n.phone,n.role,n.status,n.licenseType].some(l=>l&&l.toLowerCase().includes(i)))}applyDateRangeFilter(a,t){return t?a.filter(i=>{const n=i[t.field];if(!n)return!1;const r=new Date(n),l=t.start?new Date(t.start):null,d=t.end?new Date(t.end):null;return!(l&&r<l||d&&r>d)}):a}applyCustomFieldFilters(a,t){return a.filter(i=>Object.entries(t).every(([n,r])=>{const l=i[n];return r==null?l===r:typeof r=="string"?l&&String(l).toLowerCase().includes(r.toLowerCase()):l===r}))}applySorting(a,t){return a.sort((i,n)=>{const r=i[t.field],l=n[t.field];if(r===void 0&&l===void 0)return 0;if(r===void 0)return t.direction==="asc"?1:-1;if(l===void 0)return t.direction==="asc"?-1:1;let d=0;return typeof r=="string"&&typeof l=="string"?d=r.localeCompare(l):r instanceof Date&&l instanceof Date?d=r.getTime()-l.getTime():typeof r=="number"&&typeof l=="number"?d=r-l:d=String(r).localeCompare(String(l)),t.direction==="asc"?d:-d})}getFilterOptions(a){const t=[...new Set(a.map(l=>l.role))].sort(),i=[...new Set(a.map(l=>l.status))].sort(),n=[...new Set(a.map(l=>l.department).filter(Boolean))].sort(),r=[...new Set(a.map(l=>l.licenseType).filter(Boolean))].sort();return{roles:t,statuses:i,departments:n,licenseTypes:r,totalMembers:a.length,activeMembers:a.filter(l=>l.status==="active").length,pendingMembers:a.filter(l=>l.status==="pending").length,licensedMembers:a.filter(l=>l.licenseType).length}}getQuickFilters(){return{all:{label:"All Members",criteria:{}},active:{label:"Active Members",criteria:{isActive:!0}},pending:{label:"Pending Invites",criteria:{status:["pending"]}},admins:{label:"Administrators",criteria:{role:["admin","owner"]}},licensed:{label:"Licensed Members",criteria:{hasLicense:!0}},recent:{label:"Recently Added",criteria:{dateRange:{field:"createdAt",start:new Date(Date.now()-30*24*60*60*1e3)}}}}}};F(K,"instance");let Qe=K;const sa=Qe.getInstance(),X=class X{static getInstance(){return X.instance||(X.instance=new X),X.instance}generateAnalytics(a){return{overview:this.calculateOverviewStats(a),trends:this.calculateTrends(a),departmentBreakdown:this.calculateDepartmentStats(a),roleDistribution:this.calculateRoleDistribution(a),licenseUtilization:this.calculateLicenseStats(a),activityMetrics:this.calculateActivityMetrics(a),growthMetrics:this.calculateGrowthMetrics(a),topPerformers:this.identifyTopPerformers(a),recommendations:this.generateRecommendations(a)}}calculateOverviewStats(a){const t=a.length,i=a.filter(c=>c.status==="active").length,n=a.filter(c=>c.status==="pending").length,r=a.filter(c=>c.status==="suspended").length,l=a.filter(c=>c.licenseType&&c.licenseType!=="BASIC").length,d=t-l,p=a.map(c=>this.calculateActivityScore(c)),o=p.reduce((c,b)=>c+b,0)/p.length,f=this.calculateRetentionRate(a);return{totalMembers:t,activeMembers:i,pendingMembers:n,suspendedMembers:r,licensedMembers:l,unlicensedMembers:d,averageActivityScore:Math.round(o*100)/100,memberRetentionRate:Math.round(f*100)/100}}calculateTrends(a){const t=[],i=new Date;for(let n=11;n>=0;n--){const r=new Date(i.getFullYear(),i.getMonth()-n,1),l=new Date(i.getFullYear(),i.getMonth()-n+1,1),d=a.filter(f=>{const c=new Date(f.createdAt);return c>=r&&c<l}),p=a.filter(f=>{const c=f.lastActive?new Date(f.lastActive):null;return c&&c>=r&&c<l}),o=a.filter(f=>f.licenseType&&f.licenseType!=="BASIC"&&new Date(f.createdAt)<=l);t.push({period:r.toLocaleDateString("en-US",{month:"short",year:"numeric"}),membersAdded:d.length,membersRemoved:0,netGrowth:d.length,activeMembers:p.length,licenseUtilization:o.length})}return t}calculateDepartmentStats(a){const t=new Map;return a.forEach(i=>{const n=i.department||"Unassigned";t.has(n)||t.set(n,[]),t.get(n).push(i)}),Array.from(t.entries()).map(([i,n])=>{const r=n.filter(o=>o.status==="active").length,l=n.map(o=>this.calculateActivityScore(o)),d=l.reduce((o,f)=>o+f,0)/l.length,p=n.filter(o=>o.licenseType&&o.licenseType!=="BASIC").length;return{department:i,memberCount:n.length,activeMembers:r,averageActivityScore:Math.round(d*100)/100,licenseUtilization:Math.round(p/n.length*100),growthRate:0}}).sort((i,n)=>n.memberCount-i.memberCount)}calculateRoleDistribution(a){const t=new Map;a.forEach(n=>{t.has(n.role)||t.set(n.role,[]),t.get(n.role).push(n)});const i=a.length;return Array.from(t.entries()).map(([n,r])=>{const l=r.map(o=>this.calculateActivityScore(o)),d=l.reduce((o,f)=>o+f,0)/l.length,p=r.filter(o=>o.licenseType&&o.licenseType!=="BASIC").length;return{role:n,count:r.length,percentage:Math.round(r.length/i*100),averageActivityScore:Math.round(d*100)/100,licenseUtilization:Math.round(p/r.length*100)}}).sort((n,r)=>r.count-n.count)}calculateLicenseStats(a){const t=a.length,i=a.filter(d=>d.licenseType&&d.licenseType!=="BASIC").length,n=t-i,r=Math.round(i/t*100),l={};return a.forEach(d=>{d.licenseType&&(l[d.licenseType]=(l[d.licenseType]||0)+1)}),{totalLicenses:t,assignedLicenses:i,availableLicenses:n,utilizationRate:r,byType:l,projectedNeeds:Math.max(0,Math.ceil(t*.1))}}calculateActivityMetrics(a){const i=a.filter(o=>o.lastActive).map(o=>new Date(o.lastActive)),n=i.length>0?new Date(i.reduce((o,f)=>o+f.getTime(),0)/i.length):new Date,r=a.map(o=>({member:o,score:this.calculateActivityScore(o)})),l=r.sort((o,f)=>f.score-o.score).slice(0,5).map(o=>`${o.member.firstName} ${o.member.lastName}`),d=r.filter(o=>o.score<.3).map(o=>`${o.member.firstName} ${o.member.lastName}`),p={"High (0.8-1.0)":r.filter(o=>o.score>=.8).length,"Medium (0.5-0.8)":r.filter(o=>o.score>=.5&&o.score<.8).length,"Low (0.3-0.5)":r.filter(o=>o.score>=.3&&o.score<.5).length,"Inactive (0.0-0.3)":r.filter(o=>o.score<.3).length};return{averageLastActive:n,mostActiveMembers:l,inactiveMembers:d,activityScoreDistribution:p}}calculateGrowthMetrics(a){const t=new Date,i=new Date(t.getTime()-30*24*60*60*1e3);new Date(t.getTime()-90*24*60*60*1e3),new Date(t.getTime()-365*24*60*60*1e3);const n=a.filter(d=>new Date(d.createdAt)>=i).length,r=a.filter(d=>{const p=new Date(d.createdAt);return p>=new Date(i.getTime()-30*24*60*60*1e3)&&p<i}).length,l=r>0?(n-r)/r*100:0;return{monthlyGrowthRate:Math.round(l*100)/100,quarterlyGrowthRate:0,yearlyGrowthRate:0,projectedGrowth:Math.round(a.length*(l/100)),churnRate:0}}identifyTopPerformers(a){return a.map(t=>({memberId:t.id,name:`${t.firstName} ${t.lastName}`,email:t.email,score:this.calculateActivityScore(t),metrics:{activityScore:this.calculateActivityScore(t),projectCount:0,licenseUtilization:t.licenseType&&t.licenseType!=="BASIC"?1:0}})).sort((t,i)=>i.score-t.score).slice(0,10)}generateRecommendations(a){const t=[],i=this.calculateOverviewStats(a),n=Math.round(i.licensedMembers/i.totalMembers*100);return n<50&&t.push({type:"license",priority:"high",title:"Low License Utilization",description:`Only ${n}% of team members have licenses assigned.`,action:"Review license assignments and consider upgrading more members.",impact:"Improved productivity and feature access for team members."}),i.averageActivityScore<.5&&t.push({type:"activity",priority:"medium",title:"Low Team Activity",description:`Average activity score is ${i.averageActivityScore.toFixed(2)}.`,action:"Engage with inactive members and provide training.",impact:"Increased team engagement and productivity."}),i.totalMembers<10&&t.push({type:"growth",priority:"low",title:"Small Team Size",description:`Team has ${i.totalMembers} members. Consider expanding.`,action:"Invite more team members to scale operations.",impact:"Better resource distribution and team resilience."}),t}calculateActivityScore(a){let t=0;if(a.status==="active"&&(t+=.3),a.lastActive){const i=(Date.now()-new Date(a.lastActive).getTime())/864e5;i<7?t+=.4:i<30?t+=.2:i<90&&(t+=.1)}return a.licenseType&&a.licenseType!=="BASIC"&&(t+=.2),a.department&&a.position&&(t+=.1),Math.min(t,1)}calculateRetentionRate(a){const t=a.filter(n=>n.status==="active").length,i=a.length;return i>0?t/i:0}};F(X,"instance");let Je=X;const aa=Je.getInstance(),Z=class Z{constructor(){F(this,"auditLogs",[])}static getInstance(){return Z.instance||(Z.instance=new Z),Z.instance}logAction(a,t,i,n,r,l,d,p){const o={id:this.generateAuditId(),timestamp:new Date,action:a,actorId:t,actorEmail:i,targetMemberId:n,targetMemberEmail:r,changes:l,metadata:{...d,additionalContext:{...d.additionalContext,...p}}};this.auditLogs.push(o),console.log("ðŸ” [Audit] Team member action logged:",o)}logMemberCreation(a,t,i,n){const r=[{field:"email",oldValue:null,newValue:i.email,changeType:"added"},{field:"firstName",oldValue:null,newValue:i.firstName,changeType:"added"},{field:"lastName",oldValue:null,newValue:i.lastName,changeType:"added"},{field:"role",oldValue:null,newValue:i.role,changeType:"added"},{field:"status",oldValue:null,newValue:i.status,changeType:"added"}];this.logAction("member_created",a,t,i.id,i.email,r,n)}logMemberUpdate(a,t,i,n,r,l,d){const p=[];["firstName","lastName","email","role","status","department","position","phone","licenseType"].forEach(f=>{const c=r[f],b=l[f];c!==b&&p.push({field:f,oldValue:c,newValue:b,changeType:c===void 0?"added":b===void 0?"removed":"modified"})}),p.length>0&&this.logAction("member_updated",a,t,i,n,p,d)}logMemberDeletion(a,t,i,n){const r=[{field:"status",oldValue:i.status,newValue:"deleted",changeType:"modified"}];this.logAction("member_deleted",a,t,i.id,i.email,r,n)}logPasswordReset(a,t,i,n,r){const l=[{field:"password",oldValue:"[REDACTED]",newValue:"[RESET]",changeType:"modified"}];this.logAction("member_password_reset",a,t,i,n,l,r)}logLicenseAssignment(a,t,i,n,r,l,d){const p=[{field:"licenseType",oldValue:r||"BASIC",newValue:l,changeType:"modified"}];this.logAction("member_license_assigned",a,t,i,n,p,d)}logBulkOperation(a,t,i,n,r,l){const d=[{field:"bulk_operation",oldValue:null,newValue:i,changeType:"added"},{field:"affected_members",oldValue:null,newValue:n.length,changeType:"added"},...r];this.logAction("bulk_operation",a,t,n[0]||"multiple","multiple",d,l)}queryAuditLogs(a){let t=[...this.auditLogs];return a.memberId&&(t=t.filter(i=>i.targetMemberId===a.memberId)),a.actorId&&(t=t.filter(i=>i.actorId===a.actorId)),a.action&&(t=t.filter(i=>i.action===a.action)),a.startDate&&(t=t.filter(i=>i.timestamp>=a.startDate)),a.endDate&&(t=t.filter(i=>i.timestamp<=a.endDate)),a.organizationId&&(t=t.filter(i=>i.metadata.organizationId===a.organizationId)),t.sort((i,n)=>n.timestamp.getTime()-i.timestamp.getTime()),a.offset&&(t=t.slice(a.offset)),a.limit&&(t=t.slice(0,a.limit)),t}getAuditSummary(a,t=30){const i=new Date(Date.now()-t*24*60*60*1e3),n=this.auditLogs.filter(o=>o.metadata.organizationId===a&&o.timestamp>=i),r={};n.forEach(o=>{r[o.action]=(r[o.action]||0)+1});const l={};n.forEach(o=>{l[o.actorId]||(l[o.actorId]={actorEmail:o.actorEmail,count:0}),l[o.actorId].count++});const d=Object.entries(l).map(([o,f])=>({actorId:o,actorEmail:f.actorEmail,actionCount:f.count})).sort((o,f)=>f.actionCount-o.actionCount).slice(0,5),p=this.calculateComplianceScore(n);return{totalActions:n.length,actionsByType:r,recentActivity:n.slice(0,10),topActors:d,complianceScore:p}}calculateComplianceScore(a){if(a.length===0)return 100;let t=100;const i=a.filter(r=>r.action==="member_deleted"||r.action==="member_suspended"||r.action==="member_password_reset");t-=i.length*5;const n=a.filter(r=>r.action==="bulk_operation");return t-=n.length*2,Math.max(0,t)}generateAuditId(){return`audit_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}exportAuditLogs(a){const t=this.queryAuditLogs(a),i=["Timestamp","Action","Actor ID","Actor Email","Target Member ID","Target Member Email","Changes","Organization ID"],n=t.map(l=>[l.timestamp.toISOString(),l.action,l.actorId,l.actorEmail,l.targetMemberId,l.targetMemberEmail,JSON.stringify(l.changes),l.metadata.organizationId]);return[i.join(","),...n.map(l=>l.map(d=>typeof d=="string"&&d.includes(",")?`"${d.replace(/"/g,'""')}"`:d).join(","))].join(`
`)}};F(Z,"instance");let Ye=Z;const na=Ye.getInstance(),W=class W{constructor(){F(this,"templates",[]);F(this,"bulkOperations",[{id:"sample_1",name:"Update All Members to Professional License",description:"Upgrade all team members to Professional license type",operation:"assign_license",criteria:{roles:["member","admin"],statuses:["active"]},affectedMembers:[],status:"completed",progress:100,results:{totalProcessed:15,successful:15,failed:0,errors:[],details:{}},createdBy:"system",createdAt:new Date(Date.now()-2*24*60*60*1e3),completedAt:new Date(Date.now()-2*24*60*60*1e3)},{id:"sample_2",name:"Bulk Role Update - Engineering Team",description:"Update all engineering team members to admin role",operation:"update_role",criteria:{departments:["Engineering"],statuses:["active"]},affectedMembers:[],status:"pending",progress:0,results:{totalProcessed:0,successful:0,failed:0,errors:[],details:{}},createdBy:"system",createdAt:new Date(Date.now()-1*24*60*60*1e3)},{id:"sample_3",name:"Activate Pending Members",description:"Activate all pending team member invitations",operation:"change_status",criteria:{statuses:["pending"]},affectedMembers:[],status:"running",progress:60,results:{totalProcessed:5,successful:3,failed:0,errors:[],details:{}},createdBy:"system",createdAt:new Date(Date.now()-6*60*60*1e3)}])}static getInstance(){return W.instance||(W.instance=new W,W.instance.initializeDefaultTemplates()),W.instance}initializeDefaultTemplates(){this.templates=[{id:"executive_admin",name:"Executive Administrator",description:"Full administrative access with all permissions",category:"executive",industry:["all"],role:"admin",permissions:["manage_team","manage_licenses","manage_projects","view_analytics","manage_organization","audit_access"],defaultSettings:{department:"Executive",position:"Administrator",licenseType:"ENTERPRISE",status:"active"},isDefault:!0,isCustom:!1,createdAt:new Date,updatedAt:new Date},{id:"project_manager",name:"Project Manager",description:"Project management role with team coordination permissions",category:"management",industry:["all"],role:"member",permissions:["manage_projects","assign_team_members","view_analytics","manage_tasks"],defaultSettings:{department:"Project Management",position:"Project Manager",licenseType:"PROFESSIONAL",status:"active"},isDefault:!0,isCustom:!1,createdAt:new Date,updatedAt:new Date},{id:"software_developer",name:"Software Developer",description:"Technical role for software development teams",category:"technical",industry:["technology","software","it"],role:"member",permissions:["access_projects","manage_tasks","view_documentation"],defaultSettings:{department:"Engineering",position:"Software Developer",licenseType:"PROFESSIONAL",status:"active"},isDefault:!0,isCustom:!1,createdAt:new Date,updatedAt:new Date},{id:"creative_director",name:"Creative Director",description:"Creative leadership role for design and content teams",category:"creative",industry:["media","advertising","design","entertainment"],role:"member",permissions:["manage_creative_projects","approve_content","manage_assets","view_analytics"],defaultSettings:{department:"Creative",position:"Creative Director",licenseType:"PROFESSIONAL",status:"active"},isDefault:!0,isCustom:!1,createdAt:new Date,updatedAt:new Date},{id:"sales_representative",name:"Sales Representative",description:"Sales role with client management permissions",category:"sales",industry:["all"],role:"member",permissions:["manage_clients","view_sales_analytics","manage_opportunities"],defaultSettings:{department:"Sales",position:"Sales Representative",licenseType:"BASIC",status:"active"},isDefault:!0,isCustom:!1,createdAt:new Date,updatedAt:new Date},{id:"support_specialist",name:"Support Specialist",description:"Customer support role with limited access",category:"support",industry:["all"],role:"viewer",permissions:["view_tickets","manage_support_cases","view_documentation"],defaultSettings:{department:"Support",position:"Support Specialist",licenseType:"BASIC",status:"active"},isDefault:!0,isCustom:!1,createdAt:new Date,updatedAt:new Date}]}getTemplates(a,t){let i=[...this.templates];return a&&(i=i.filter(n=>n.category===a)),t&&(i=i.filter(n=>n.industry.includes("all")||n.industry.includes(t))),i.sort((n,r)=>n.name.localeCompare(r.name))}getTemplate(a){return this.templates.find(t=>t.id===a)}createTemplate(a,t){const i={...a,id:`custom_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,isDefault:!1,isCustom:!0,createdBy:t,createdAt:new Date,updatedAt:new Date};return this.templates.push(i),i}updateTemplate(a,t){const i=this.templates.findIndex(n=>n.id===a);return i===-1?!1:(this.templates[i]={...this.templates[i],...t,updatedAt:new Date},!0)}deleteTemplate(a){const t=this.templates.findIndex(i=>i.id===a);return t===-1||this.templates[t].isDefault?!1:(this.templates.splice(t,1),!0)}createMemberFromTemplate(a,t,i){const n=this.getTemplate(a);if(!n)throw new Error("Template not found");return{id:"",email:t.email||"",firstName:t.firstName||"",lastName:t.lastName||"",role:n.role,status:n.defaultSettings.status,organization:{id:i,name:"",tier:"BASIC"},organizationId:i,department:n.defaultSettings.department||t.department||"",position:n.defaultSettings.position||t.position||"",phone:t.phone||"",licenseType:n.defaultSettings.licenseType,assignedProjects:[],joinedAt:new Date,createdAt:new Date,updatedAt:new Date,...t,...n.defaultSettings.customFields}}createBulkOperation(a,t,i,n,r,l){const d={id:`bulk_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,name:a,description:t,operation:i,template:l?this.getTemplate(l):void 0,criteria:n,affectedMembers:[],status:"pending",progress:0,results:{totalProcessed:0,successful:0,failed:0,errors:[],details:{}},createdBy:r,createdAt:new Date};return this.bulkOperations.push(d),d}async executeBulkOperation(a,t,i){const n=this.bulkOperations.find(d=>d.id===a);if(!n)throw new Error("Bulk operation not found");n.status="running",n.progress=0;const r={totalProcessed:0,successful:0,failed:0,errors:[],details:{}},l=this.filterMembersByCriteria(t,n.criteria);n.affectedMembers=l.map(d=>d.id),r.totalProcessed=l.length;for(let d=0;d<l.length;d++){const p=l[d];try{switch(n.operation){case"create":r.details[p.id]="Created successfully",r.successful++;break;case"update":r.details[p.id]="Updated successfully",r.successful++;break;case"delete":r.details[p.id]="Deleted successfully",r.successful++;break;case"assign_license":r.details[p.id]="License assigned successfully",r.successful++;break;case"change_role":r.details[p.id]="Role changed successfully",r.successful++;break}}catch(o){r.failed++,r.errors.push({memberId:p.id,error:o instanceof Error?o.message:"Unknown error"}),r.details[p.id]="Failed"}n.progress=Math.round((d+1)/l.length*100),i&&i(n.progress)}return n.results=r,n.status=r.failed===0?"completed":"failed",n.completedAt=new Date,r}filterMembersByCriteria(a,t){let i=[...a];return t.memberIds&&t.memberIds.length>0&&(i=i.filter(n=>t.memberIds.includes(n.id))),t.roles&&t.roles.length>0&&(i=i.filter(n=>t.roles.includes(n.role))),t.departments&&t.departments.length>0&&(i=i.filter(n=>n.department&&t.departments.includes(n.department))),t.statuses&&t.statuses.length>0&&(i=i.filter(n=>t.statuses.includes(n.status))),t.licenseTypes&&t.licenseTypes.length>0&&(i=i.filter(n=>n.licenseType&&t.licenseTypes.includes(n.licenseType))),i}getBulkOperations(a){let t=[...this.bulkOperations];return a&&(t=t.filter(i=>i.createdBy===a)),t.sort((i,n)=>n.createdAt.getTime()-i.createdAt.getTime())}getBulkOperation(a){return this.bulkOperations.find(t=>t.id===a)}getCategories(){return["executive","management","technical","creative","support","sales","marketing","operations","custom"]}getIndustries(){return["technology","software","it","media","advertising","design","entertainment","finance","healthcare","education","retail","manufacturing","consulting","nonprofit","government","all"]}};F(W,"instance");let Ke=W;const Pe=Ke.getInstance();function he(m){const{children:a,value:t,index:i,...n}=m;return e.jsx("div",{role:"tabpanel",hidden:t!==i,id:`team-tabpanel-${i}`,"aria-labelledby":`team-tab-${i}`,...n,children:t===i&&e.jsx(A,{sx:{p:3},children:a})})}const Ca=()=>{var lt,ot,ct;const{enqueueSnackbar:m}=$s(),[a,t]=h.useState(0),[i,n]=h.useState([]),[r,l]=h.useState({}),[d,p]=h.useState({field:"createdAt",direction:"desc"}),[o,f]=h.useState({page:1,pageSize:25}),[c,b]=h.useState("table"),[O,k]=h.useState(""),[re,me]=h.useState(!1),[Oe,Ee]=h.useState(!1),[Be,pe]=h.useState(!1),[Xe,ia]=h.useState(!1),[ft,le]=h.useState(!1),[xt,Re]=h.useState(!1),[ra,la]=h.useState(!1),[jt,vt]=h.useState(null),[Ze,yt]=h.useState([]),[wt,bt]=h.useState([]),[qe,N]=h.useState([]),[q,Ct]=h.useState(null),[oa,ge]=h.useState(!1),[St,fe]=h.useState(!1),[C,At]=h.useState(null),[Tt,Fe]=h.useState(new Set),[et,tt]=h.useState(null),[x,ee]=h.useState(null),[It,xe]=h.useState(!1),[Dt,je]=h.useState(!1),[Mt,ve]=h.useState(!1),[kt,ye]=h.useState(!1),[D,R]=h.useState({firstName:"",lastName:"",email:"",role:"member",status:"active",department:"",position:"",phone:""}),[L,Ne]=h.useState({newPassword:"",confirmPassword:""}),[oe,st]=h.useState(""),{loading:Lt,error:at}=Gs(),{data:I,loading:Pt,error:nt}=Hs(),{data:M,loading:Ot,error:it,refetch:E}=Qs(),{data:U}=Js();Ys();const rt=Ks(),we=Xs(),be=Zs(),Ce=qs();ea();const Se=ta(),te=h.useMemo(()=>{if(!M)return[];const s={...r,search:O||void 0};return sa.filterTeamMembers(M,s,d,o).filteredMembers},[M,r,O,d,o]),Ae=h.useMemo(()=>{if(!M)return{totalMembers:0,activeMembers:0,pendingInvites:0,availableLicenses:0,totalLicenses:0,assignedLicenses:0};const s=M.length,u=M.filter(ae=>ae.status==="active").length,j=M.filter(ae=>ae.status==="pending").length,T=M.filter(ae=>ae.licenseType&&ae.licenseType!=="BASIC").length,$=(U==null?void 0:U.length)||0,is=$-T;return{totalMembers:s,activeMembers:u,pendingInvites:j,availableLicenses:is,totalLicenses:$,assignedLicenses:T}},[M,U]),Et=h.useCallback(async()=>{if(M){ge(!0);try{const s=aa.generateAnalytics(M);vt(s)}catch(s){console.error("Failed to load analytics:",s),m("Failed to load analytics",{variant:"error"})}finally{ge(!1)}}},[M,m]),Bt=h.useCallback(async()=>{var s;if((s=I==null?void 0:I.organization)!=null&&s.id){ge(!0);try{const u={organizationId:I.organization.id,limit:100},j=na.queryAuditLogs(u);yt(j)}catch(u){console.error("Failed to load audit logs:",u),m("Failed to load audit logs",{variant:"error"})}finally{ge(!1)}}},[(lt=I==null?void 0:I.organization)==null?void 0:lt.id,m]),Rt=h.useCallback(async()=>{try{const s=Pe.getTemplates();bt(s)}catch(s){console.error("Failed to load templates:",s),m("Failed to load templates",{variant:"error"})}},[m]),Ft=h.useCallback(async()=>{try{const s=Pe.getBulkOperations();N(s)}catch(s){console.error("Failed to load bulk operations:",s),m("Failed to load bulk operations",{variant:"error"})}},[m]),Nt=h.useCallback(async()=>{if(M)try{const s=await Ge.exportTeamMembers(M,{includeInactive:!0,includeAuditInfo:!0});Ge.downloadCSV(s,`team-members-${new Date().toISOString().split("T")[0]}.csv`),m("Team members exported successfully",{variant:"success"})}catch(s){console.error("Failed to export CSV:",s),m("Failed to export CSV",{variant:"error"})}},[M,m]),zt=h.useCallback(async s=>{var u;if((u=I==null?void 0:I.organization)!=null&&u.id)try{const j=await s.text(),T=await Ge.importTeamMembers(j,I.organization.id,$=>{});Ct(T),T.success?(m(`Successfully imported ${T.successfulImports} team members`,{variant:"success"}),E()):m(`Import completed with ${T.failedImports} errors`,{variant:"warning"})}catch(j){console.error("Failed to import CSV:",j),m("Failed to import CSV",{variant:"error"})}},[(ot=I==null?void 0:I.organization)==null?void 0:ot.id,m,E]),Te=h.useCallback(async s=>{if(M){Fe(u=>new Set([...u,s.id]));try{const u=await Pe.executeBulkOperation(s.id,M,j=>{N(T=>T.map($=>$.id===s.id?{...$,progress:j}:$))});N(j=>j.map(T=>T.id===s.id?{...T,status:u.failed===0?"completed":"failed",progress:100,results:u,completedAt:new Date}:T)),m(`Bulk operation completed: ${u.successful} successful, ${u.failed} failed`,{variant:u.failed===0?"success":"warning"}),E()}catch(u){console.error("Failed to execute bulk operation:",u),N(j=>j.map(T=>T.id===s.id?{...T,status:"failed",progress:0}:T)),m("Failed to execute bulk operation",{variant:"error"})}finally{Fe(u=>{const j=new Set(u);return j.delete(s.id),j})}}},[M,m,E]),Vt=h.useCallback(s=>{At(s),fe(!0)},[]),_t=h.useCallback(s=>{m("Edit functionality coming soon",{variant:"info"})},[m]),Wt=h.useCallback(s=>{N(u=>u.filter(j=>j.id!==s.id)),m("Operation deleted successfully",{variant:"success"})},[m]),Ut=h.useCallback(s=>{N(u=>u.map(j=>j.id===s.id?{...j,status:"pending",progress:0,results:{totalProcessed:0,successful:0,failed:0,errors:[],details:{}}}:j)),Te(s)},[Te]),$t=h.useCallback(s=>{N(u=>u.map(j=>j.id===s.id?{...j,status:"failed",progress:0}:j)),Fe(u=>{const j=new Set(u);return j.delete(s.id),j}),m("Operation stopped",{variant:"info"})},[m]),Gt=h.useCallback((s,u)=>{tt(s.currentTarget),ee(u)},[]),se=h.useCallback(()=>{tt(null),ee(null)},[]),Ht=h.useCallback(s=>{ee(s),R({firstName:s.firstName||"",lastName:s.lastName||"",email:s.email||"",role:s.role||"member",status:s.status||"active",department:s.department||"",position:s.position||"",phone:s.phone||""}),se(),xe(!0)},[]),Qt=h.useCallback(s=>{ee(s),se(),ye(!0)},[]),Jt=h.useCallback(s=>{ee(s),st(""),se(),je(!0)},[]),Yt=h.useCallback(s=>{ee(s),Ne({newPassword:"",confirmPassword:""}),se(),ve(!0)},[]),Kt=h.useCallback(async s=>{var u,j;try{rt.mutate({email:s.email,firstName:s.firstName||"",lastName:s.lastName||"",role:s.role||"member",status:s.status||"pending",department:s.department||"",position:s.position||"",phone:s.phone||"",organization:s.organization||{id:((u=I==null?void 0:I.organization)==null?void 0:u.id)||"",name:((j=I==null?void 0:I.organization)==null?void 0:j.name)||"",tier:"professional"},assignedProjects:s.assignedProjects||[]}),se(),m("Invitation resent successfully",{variant:"success"})}catch(T){console.error("Failed to resend invite:",T),m("Failed to resend invitation",{variant:"error"})}},[rt,m,I]),Xt=h.useCallback(async()=>{if(x)try{we.mutate({memberId:x.id,updates:D}),xe(!1),m("Team member updated successfully",{variant:"success"}),E()}catch(s){console.error("Failed to update team member:",s),m("Failed to update team member",{variant:"error"})}},[x,D,we,m,E]),Zt=h.useCallback(async()=>{if(x)try{be.mutate({memberId:x.id}),ye(!1),m("Team member removed successfully",{variant:"success"}),E()}catch(s){console.error("Failed to remove team member:",s),m("Failed to remove team member",{variant:"error"})}},[x,be,m,E]),qt=h.useCallback(async()=>{if(!(!x||!oe))try{Ce.mutate({licenseId:oe,userId:x.id}),je(!1),m("License assigned successfully",{variant:"success"}),E()}catch(s){console.error("Failed to assign license:",s),m("Failed to assign license",{variant:"error"})}},[x,oe,Ce,m,E]),es=h.useCallback(async()=>{if(!(!x||!L.newPassword)){if(L.newPassword!==L.confirmPassword){m("Passwords do not match",{variant:"error"});return}if(L.newPassword.length<8){m("Password must be at least 8 characters long",{variant:"error"});return}try{Se.mutate({memberId:x.id,newPassword:L.newPassword}),ve(!1),m("Password changed successfully",{variant:"success"})}catch(s){console.error("Failed to change password:",s),m("Failed to change password",{variant:"error"})}}},[x,L,Se,m]),ts=(s,u)=>{switch(t(u),u){case 1:Et();break;case 2:Bt();break;case 3:Rt();break;case 4:Ft();break}},ss=(s,u)=>{n(u?j=>[...j,s]:j=>j.filter(T=>T!==s))},as=s=>{n(s?te.map(u=>u.id):[])},Ie=s=>{l(s),f(u=>({...u,page:1}))},ns=s=>{f(s)};return Lt||Pt||Ot?e.jsxs(A,{sx:{p:3},children:[e.jsx(g,{variant:"h4",gutterBottom:!0,children:"Team Management"}),e.jsx(y,{container:!0,spacing:3,children:[1,2,3,4].map(s=>e.jsx(y,{item:!0,xs:12,sm:6,md:3,children:e.jsx(os,{variant:"rectangular",height:120})},s))})]}):at||nt||it?e.jsx(A,{sx:{p:3},children:e.jsxs(De,{severity:"error",children:[e.jsx(Me,{children:"Error Loading Team Data"}),at||nt||it||"Unknown error occurred"]})}):e.jsxs(A,{sx:{p:3},children:[e.jsxs(A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:[e.jsx(g,{variant:"h4",component:"h1",children:"Team Management"}),e.jsxs(A,{sx:{display:"flex",gap:1},children:[e.jsx(S,{variant:"outlined",startIcon:e.jsx(cs,{}),onClick:Nt,children:"Export CSV"}),e.jsx(S,{variant:"outlined",startIcon:e.jsx(ds,{}),onClick:()=>Re(!0),children:"Import CSV"}),e.jsx(S,{variant:"contained",startIcon:e.jsx(us,{}),onClick:()=>{},children:"Invite Member"})]})]}),e.jsxs(y,{container:!0,spacing:3,sx:{mb:3},children:[e.jsx(y,{item:!0,xs:12,sm:6,md:3,children:e.jsx(Le,{title:"Total Members",value:Ae.totalMembers,icon:e.jsx(dt,{}),color:"primary"})}),e.jsx(y,{item:!0,xs:12,sm:6,md:3,children:e.jsx(Le,{title:"Active Members",value:Ae.activeMembers,icon:e.jsx(hs,{}),color:"success"})}),e.jsx(y,{item:!0,xs:12,sm:6,md:3,children:e.jsx(Le,{title:"Pending Invites",value:Ae.pendingInvites,icon:e.jsx(ms,{}),color:"warning"})}),e.jsx(y,{item:!0,xs:12,sm:6,md:3,children:e.jsx(Le,{title:"Available Licenses",value:Ae.availableLicenses,icon:e.jsx(ps,{}),color:"primary"})})]}),e.jsxs(ne,{children:[e.jsx(A,{sx:{borderBottom:1,borderColor:"divider"},children:e.jsxs(gs,{value:a,onChange:ts,"aria-label":"team management tabs",children:[e.jsx(ce,{label:"Team Members",icon:e.jsx(dt,{})}),e.jsx(ce,{label:"Analytics",icon:e.jsx(fs,{})}),e.jsx(ce,{label:"Audit Trail",icon:e.jsx(xs,{})}),e.jsx(ce,{label:"Templates",icon:e.jsx(js,{})}),e.jsx(ce,{label:"Bulk Operations",icon:e.jsx(ke,{})})]})}),e.jsxs(he,{value:a,index:0,children:[e.jsxs(A,{sx:{display:"flex",gap:2,mb:3,alignItems:"center"},children:[e.jsx(P,{fullWidth:!0,placeholder:"Search team members...",value:O,onChange:s=>k(s.target.value),InputProps:{startAdornment:e.jsx(vs,{position:"start",children:e.jsx(ys,{})})}}),e.jsx(S,{variant:"outlined",startIcon:e.jsx(ws,{}),onClick:()=>me(!re),children:"Filters"}),e.jsxs(bs,{value:c,exclusive:!0,onChange:(s,u)=>u&&b(u),size:"small",children:[e.jsx(ze,{value:"table",children:e.jsx(Cs,{})}),e.jsx(ze,{value:"grid",children:e.jsx(Ss,{})}),e.jsx(ze,{value:"list",children:e.jsx(As,{})})]})]}),re&&e.jsxs(ne,{sx:{mb:3},children:[e.jsx(Ts,{title:"Advanced Filters"}),e.jsx(de,{children:e.jsxs(y,{container:!0,spacing:2,children:[e.jsx(y,{item:!0,xs:12,sm:6,md:3,children:e.jsxs(z,{fullWidth:!0,children:[e.jsx(V,{children:"Role"}),e.jsxs(_,{multiple:!0,value:r.role||[],onChange:s=>Ie({...r,role:s.target.value}),children:[e.jsx(w,{value:"admin",children:"Admin"}),e.jsx(w,{value:"member",children:"Member"}),e.jsx(w,{value:"viewer",children:"Viewer"}),e.jsx(w,{value:"owner",children:"Owner"})]})]})}),e.jsx(y,{item:!0,xs:12,sm:6,md:3,children:e.jsxs(z,{fullWidth:!0,children:[e.jsx(V,{children:"Status"}),e.jsxs(_,{multiple:!0,value:r.status||[],onChange:s=>Ie({...r,status:s.target.value}),children:[e.jsx(w,{value:"active",children:"Active"}),e.jsx(w,{value:"pending",children:"Pending"}),e.jsx(w,{value:"suspended",children:"Suspended"})]})]})}),e.jsx(y,{item:!0,xs:12,sm:6,md:3,children:e.jsxs(z,{fullWidth:!0,children:[e.jsx(V,{children:"Department"}),e.jsx(_,{multiple:!0,value:r.department||[],onChange:s=>Ie({...r,department:s.target.value})})]})}),e.jsx(y,{item:!0,xs:12,sm:6,md:3,children:e.jsxs(z,{fullWidth:!0,children:[e.jsx(V,{children:"License Type"}),e.jsxs(_,{multiple:!0,value:r.licenseType||[],onChange:s=>Ie({...r,licenseType:s.target.value}),children:[e.jsx(w,{value:"BASIC",children:"Basic"}),e.jsx(w,{value:"PROFESSIONAL",children:"Professional"}),e.jsx(w,{value:"ENTERPRISE",children:"Enterprise"})]})]})})]})})]}),e.jsx(Ve,{component:_e,children:e.jsxs(We,{children:[e.jsx(Ue,{children:e.jsxs(ie,{children:[e.jsx(v,{padding:"checkbox",children:e.jsx(ut,{indeterminate:i.length>0&&i.length<te.length,checked:te.length>0&&i.length===te.length,onChange:s=>as(s.target.checked)})}),e.jsx(v,{children:"Member"}),e.jsx(v,{children:"Role"}),e.jsx(v,{children:"Status"}),e.jsx(v,{children:"Department"}),e.jsx(v,{children:"License"}),e.jsx(v,{children:"Last Active"}),e.jsx(v,{children:"Actions"})]})}),e.jsx($e,{children:te.map(s=>{var u,j;return e.jsxs(ie,{children:[e.jsx(v,{padding:"checkbox",children:e.jsx(ut,{checked:i.includes(s.id),onChange:T=>ss(s.id,T.target.checked)})}),e.jsx(v,{children:e.jsxs(A,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsxs(Is,{children:[(u=s.firstName)==null?void 0:u[0],(j=s.lastName)==null?void 0:j[0]]}),e.jsxs(A,{children:[e.jsxs(g,{variant:"subtitle2",children:[s.firstName," ",s.lastName]}),e.jsx(g,{variant:"body2",color:"text.secondary",children:s.email})]})]})}),e.jsx(v,{children:e.jsx(B,{label:s.role,color:s.role==="admin"?"primary":"default",size:"small"})}),e.jsx(v,{children:e.jsx(B,{label:s.status,color:s.status==="active"?"success":"default",size:"small"})}),e.jsx(v,{children:s.department||"-"}),e.jsx(v,{children:s.licenseType?e.jsx(B,{label:s.licenseType,color:"info",size:"small"}):"-"}),e.jsx(v,{children:s.lastActive?new Date(s.lastActive).toLocaleDateString():"-"}),e.jsx(v,{children:e.jsx(Ds,{size:"small",onClick:T=>Gt(T,s),children:e.jsx(Ms,{})})})]},s.id)})})]})}),e.jsx(A,{sx:{display:"flex",justifyContent:"center",mt:3},children:e.jsx(ks,{count:Math.ceil(te.length/o.pageSize),page:o.page,onChange:(s,u)=>ns({...o,page:u}),color:"primary"})})]}),e.jsx(he,{value:a,index:1,children:jt?e.jsxs(A,{children:[e.jsx(g,{variant:"h5",gutterBottom:!0,children:"Team Analytics"}),e.jsx(g,{children:"Analytics dashboard coming soon..."})]}):e.jsxs(A,{sx:{textAlign:"center",py:4},children:[e.jsx(Ls,{}),e.jsx(g,{variant:"body1",sx:{mt:2},children:"Loading analytics..."})]})}),e.jsxs(he,{value:a,index:2,children:[e.jsx(g,{variant:"h5",gutterBottom:!0,children:"Audit Trail"}),Ze.length>0?e.jsx(Ve,{component:_e,children:e.jsxs(We,{children:[e.jsx(Ue,{children:e.jsxs(ie,{children:[e.jsx(v,{children:"Timestamp"}),e.jsx(v,{children:"Action"}),e.jsx(v,{children:"Actor"}),e.jsx(v,{children:"Target"}),e.jsx(v,{children:"Changes"})]})}),e.jsx($e,{children:Ze.map(s=>e.jsxs(ie,{children:[e.jsx(v,{children:s.timestamp.toLocaleString()}),e.jsx(v,{children:e.jsx(B,{label:s.action,size:"small"})}),e.jsx(v,{children:s.actorEmail}),e.jsx(v,{children:s.targetMemberEmail}),e.jsxs(v,{children:[s.changes.length," changes"]})]},s.id))})]})}):e.jsx(g,{children:"No audit logs found."})]}),e.jsxs(he,{value:a,index:3,children:[e.jsx(g,{variant:"h5",gutterBottom:!0,children:"Team Member Templates"}),e.jsx(y,{container:!0,spacing:2,children:wt.map(s=>e.jsx(y,{item:!0,xs:12,sm:6,md:4,children:e.jsx(ne,{children:e.jsxs(de,{children:[e.jsx(g,{variant:"h6",children:s.name}),e.jsx(g,{variant:"body2",color:"text.secondary",children:s.description}),e.jsxs(A,{sx:{mt:2},children:[e.jsx(B,{label:s.role,size:"small"}),e.jsx(B,{label:s.category,size:"small",sx:{ml:1}})]})]})})},s.id))})]}),e.jsxs(he,{value:a,index:4,children:[e.jsxs(A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:[e.jsx(g,{variant:"h5",children:"Bulk Operations"}),e.jsx(S,{variant:"contained",startIcon:e.jsx(ke,{}),onClick:()=>le(!0),children:"Create New Operation"})]}),qe.length>0?e.jsx(Ve,{component:_e,children:e.jsxs(We,{children:[e.jsx(Ue,{children:e.jsxs(ie,{children:[e.jsx(v,{children:"Name"}),e.jsx(v,{children:"Description"}),e.jsx(v,{children:"Operation"}),e.jsx(v,{children:"Status"}),e.jsx(v,{children:"Progress"}),e.jsx(v,{children:"Created"}),e.jsx(v,{children:"Actions"})]})}),e.jsx($e,{children:qe.map(s=>e.jsxs(ie,{children:[e.jsx(v,{children:e.jsx(g,{variant:"subtitle2",fontWeight:"medium",children:s.name})}),e.jsx(v,{children:e.jsx(g,{variant:"body2",color:"text.secondary",children:s.description})}),e.jsx(v,{children:e.jsx(B,{label:s.operation.replace("_"," "),size:"small",color:"primary",variant:"outlined"})}),e.jsx(v,{children:e.jsx(B,{label:s.status,color:s.status==="completed"?"success":s.status==="running"?"warning":s.status==="failed"?"error":"default",size:"small"})}),e.jsx(v,{children:e.jsxs(A,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(ht,{variant:"determinate",value:s.progress,sx:{width:100},color:s.status==="completed"?"success":s.status==="failed"?"error":"primary"}),e.jsxs(g,{variant:"body2",children:[s.progress,"%"]})]})}),e.jsxs(v,{children:[e.jsx(g,{variant:"body2",children:s.createdAt.toLocaleDateString()}),e.jsx(g,{variant:"caption",color:"text.secondary",children:s.createdAt.toLocaleTimeString()})]}),e.jsx(v,{children:e.jsxs(A,{sx:{display:"flex",gap:.5,flexWrap:"wrap"},children:[s.status==="pending"&&e.jsx(S,{size:"small",variant:"contained",color:"primary",onClick:()=>Te(s),startIcon:e.jsx(mt,{}),disabled:Tt.has(s.id),children:"Execute"}),s.status==="running"&&e.jsx(S,{size:"small",variant:"outlined",color:"warning",onClick:()=>$t(s),startIcon:e.jsx(Ps,{}),children:"Stop"}),s.status==="failed"&&e.jsx(S,{size:"small",variant:"outlined",color:"primary",onClick:()=>Ut(s),startIcon:e.jsx(Os,{}),children:"Retry"}),e.jsx(S,{size:"small",variant:"outlined",onClick:()=>Vt(s),startIcon:e.jsx(Es,{}),children:"Details"}),s.status==="pending"&&e.jsx(S,{size:"small",variant:"text",onClick:()=>_t(s),startIcon:e.jsx(pt,{}),children:"Edit"}),(s.status==="completed"||s.status==="failed")&&e.jsx(S,{size:"small",variant:"text",color:"error",onClick:()=>Wt(s),startIcon:e.jsx(gt,{}),children:"Delete"})]})})]},s.id))})]})}):e.jsx(ne,{children:e.jsxs(de,{sx:{textAlign:"center",py:6},children:[e.jsx(ke,{sx:{fontSize:64,color:"text.secondary",mb:2}}),e.jsx(g,{variant:"h6",gutterBottom:!0,children:"No Bulk Operations Found"}),e.jsx(g,{variant:"body2",color:"text.secondary",sx:{mb:3},children:"Create your first bulk operation to manage multiple team members at once."}),e.jsx(S,{variant:"contained",startIcon:e.jsx(ke,{}),onClick:()=>le(!0),children:"Create New Operation"})]})})]})]}),e.jsxs(G,{open:xt,onClose:()=>Re(!1),maxWidth:"md",fullWidth:!0,children:[e.jsx(H,{children:"Import Team Members from CSV"}),e.jsxs(Q,{children:[e.jsx(A,{sx:{mb:3},children:e.jsxs(S,{variant:"outlined",component:"label",startIcon:e.jsx(Bs,{}),fullWidth:!0,children:["Choose CSV File",e.jsx("input",{type:"file",accept:".csv",hidden:!0,onChange:s=>{var j;const u=(j=s.target.files)==null?void 0:j[0];u&&zt(u)}})]})}),q&&e.jsxs(De,{severity:q.success?"success":"warning",children:[e.jsxs(Me,{children:["Import ",q.success?"Successful":"Completed with Errors"]}),e.jsxs(g,{children:["Processed: ",q.totalRows," rows"]}),e.jsxs(g,{children:["Successful: ",q.successfulImports]}),e.jsxs(g,{children:["Failed: ",q.failedImports]})]})]}),e.jsx(J,{children:e.jsx(S,{onClick:()=>Re(!1),children:"Close"})})]}),e.jsxs(G,{open:ft,onClose:()=>le(!1),maxWidth:"md",fullWidth:!0,children:[e.jsx(H,{children:"Create Bulk Operation"}),e.jsx(Q,{children:e.jsxs(A,{sx:{mt:2},children:[e.jsx(P,{fullWidth:!0,label:"Operation Name",placeholder:"e.g., Update Engineering Team Roles",sx:{mb:2}}),e.jsx(P,{fullWidth:!0,label:"Description",placeholder:"Describe what this operation will do",multiline:!0,rows:3,sx:{mb:2}}),e.jsxs(z,{fullWidth:!0,sx:{mb:2},children:[e.jsx(V,{children:"Operation Type"}),e.jsxs(_,{label:"Operation Type",children:[e.jsx(w,{value:"update_role",children:"Update Roles"}),e.jsx(w,{value:"assign_license",children:"Assign Licenses"}),e.jsx(w,{value:"change_status",children:"Change Status"}),e.jsx(w,{value:"bulk_invite",children:"Bulk Invite"})]})]}),e.jsxs(De,{severity:"info",sx:{mt:2},children:[e.jsx(Me,{children:"Bulk Operation Preview"}),"This operation will affect ",i.length," selected team members."]})]})}),e.jsxs(J,{children:[e.jsx(S,{onClick:()=>le(!1),children:"Cancel"}),e.jsx(S,{variant:"contained",onClick:()=>{const s=Pe.createBulkOperation("Sample Bulk Operation","This is a sample bulk operation created from the UI","update_role",{roles:["member"]},"current-user");N(u=>[s,...u]),le(!1),m("Bulk operation created successfully",{variant:"success"})},children:"Create Operation"})]})]}),e.jsxs(G,{open:St,onClose:()=>fe(!1),maxWidth:"md",fullWidth:!0,children:[e.jsx(H,{children:"Operation Details"}),e.jsx(Q,{children:C&&e.jsx(A,{sx:{mt:2},children:e.jsxs(y,{container:!0,spacing:3,children:[e.jsxs(y,{item:!0,xs:12,children:[e.jsx(g,{variant:"h6",gutterBottom:!0,children:C.name}),e.jsx(g,{variant:"body2",color:"text.secondary",sx:{mb:2},children:C.description})]}),e.jsxs(y,{item:!0,xs:12,md:6,children:[e.jsx(g,{variant:"subtitle2",gutterBottom:!0,children:"Operation Type"}),e.jsx(B,{label:C.operation.replace("_"," "),color:"primary",variant:"outlined"})]}),e.jsxs(y,{item:!0,xs:12,md:6,children:[e.jsx(g,{variant:"subtitle2",gutterBottom:!0,children:"Status"}),e.jsx(B,{label:C.status,color:C.status==="completed"?"success":C.status==="running"?"warning":C.status==="failed"?"error":"default"})]}),e.jsxs(y,{item:!0,xs:12,md:6,children:[e.jsx(g,{variant:"subtitle2",gutterBottom:!0,children:"Progress"}),e.jsxs(A,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(ht,{variant:"determinate",value:C.progress,sx:{flex:1},color:C.status==="completed"?"success":C.status==="failed"?"error":"primary"}),e.jsxs(g,{variant:"body2",children:[C.progress,"%"]})]})]}),e.jsxs(y,{item:!0,xs:12,md:6,children:[e.jsx(g,{variant:"subtitle2",gutterBottom:!0,children:"Created"}),e.jsx(g,{variant:"body2",children:C.createdAt.toLocaleString()})]}),C.completedAt&&e.jsxs(y,{item:!0,xs:12,md:6,children:[e.jsx(g,{variant:"subtitle2",gutterBottom:!0,children:"Completed"}),e.jsx(g,{variant:"body2",children:C.completedAt.toLocaleString()})]}),e.jsxs(y,{item:!0,xs:12,md:6,children:[e.jsx(g,{variant:"subtitle2",gutterBottom:!0,children:"Created By"}),e.jsx(g,{variant:"body2",children:C.createdBy})]}),C.results&&e.jsxs(y,{item:!0,xs:12,children:[e.jsx(g,{variant:"subtitle2",gutterBottom:!0,children:"Results"}),e.jsx(ne,{variant:"outlined",children:e.jsxs(de,{children:[e.jsxs(y,{container:!0,spacing:2,children:[e.jsxs(y,{item:!0,xs:4,children:[e.jsx(g,{variant:"h6",color:"primary",children:C.results.totalProcessed}),e.jsx(g,{variant:"caption",children:"Total Processed"})]}),e.jsxs(y,{item:!0,xs:4,children:[e.jsx(g,{variant:"h6",color:"success.main",children:C.results.successful}),e.jsx(g,{variant:"caption",children:"Successful"})]}),e.jsxs(y,{item:!0,xs:4,children:[e.jsx(g,{variant:"h6",color:"error.main",children:C.results.failed}),e.jsx(g,{variant:"caption",children:"Failed"})]})]}),C.results.errors.length>0&&e.jsxs(A,{sx:{mt:2},children:[e.jsx(g,{variant:"subtitle2",gutterBottom:!0,children:"Errors"}),e.jsx(Rs,{dense:!0,children:C.results.errors.map((s,u)=>e.jsx(Fs,{children:e.jsx(Ns,{primary:s.memberId,secondary:s.error})},u))})]})]})})]}),e.jsxs(y,{item:!0,xs:12,children:[e.jsx(g,{variant:"subtitle2",gutterBottom:!0,children:"Criteria"}),e.jsx(ne,{variant:"outlined",children:e.jsx(de,{children:e.jsx("pre",{style:{margin:0,fontSize:"0.875rem"},children:JSON.stringify(C.criteria,null,2)})})})]})]})})}),e.jsxs(J,{children:[e.jsx(S,{onClick:()=>fe(!1),children:"Close"}),C&&C.status==="pending"&&e.jsx(S,{variant:"contained",onClick:()=>{fe(!1),Te(C)},startIcon:e.jsx(mt,{}),children:"Execute Now"})]})]}),e.jsxs(zs,{anchorEl:et,open:!!et,onClose:se,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},children:[e.jsxs(w,{onClick:()=>x&&Ht(x),children:[e.jsx(ue,{children:e.jsx(pt,{})}),"Edit Member"]}),((ct=x==null?void 0:x.status)==null?void 0:ct.toLowerCase())==="pending"&&e.jsxs(w,{onClick:()=>x&&Kt(x),children:[e.jsx(ue,{children:e.jsx(Vs,{})}),"Resend Invite"]}),e.jsxs(w,{onClick:()=>x&&Jt(x),children:[e.jsx(ue,{children:e.jsx(_s,{})}),"Assign License"]}),e.jsxs(w,{onClick:()=>x&&Yt(x),children:[e.jsx(ue,{children:e.jsx(Ws,{})}),"Change Password"]}),e.jsx(Us,{}),e.jsxs(w,{onClick:()=>x&&Qt(x),sx:{color:"error.main"},children:[e.jsx(ue,{children:e.jsx(gt,{sx:{color:"error.main"}})}),"Remove Member"]})]}),e.jsxs(G,{open:It,onClose:()=>xe(!1),maxWidth:"sm",fullWidth:!0,children:[e.jsx(H,{children:"Edit Team Member"}),e.jsx(Q,{children:e.jsxs(A,{sx:{display:"flex",flexDirection:"column",gap:2,mt:1},children:[e.jsx(P,{label:"First Name",value:D.firstName,onChange:s=>R({...D,firstName:s.target.value}),fullWidth:!0}),e.jsx(P,{label:"Last Name",value:D.lastName,onChange:s=>R({...D,lastName:s.target.value}),fullWidth:!0}),e.jsx(P,{label:"Email",type:"email",value:D.email,onChange:s=>R({...D,email:s.target.value}),fullWidth:!0}),e.jsxs(z,{fullWidth:!0,children:[e.jsx(V,{children:"Role"}),e.jsxs(_,{value:D.role,onChange:s=>R({...D,role:s.target.value}),children:[e.jsx(w,{value:"admin",children:"Admin"}),e.jsx(w,{value:"member",children:"Member"}),e.jsx(w,{value:"viewer",children:"Viewer"}),e.jsx(w,{value:"owner",children:"Owner"})]})]}),e.jsxs(z,{fullWidth:!0,children:[e.jsx(V,{children:"Status"}),e.jsxs(_,{value:D.status,onChange:s=>R({...D,status:s.target.value}),children:[e.jsx(w,{value:"active",children:"Active"}),e.jsx(w,{value:"pending",children:"Pending"}),e.jsx(w,{value:"suspended",children:"Suspended"}),e.jsx(w,{value:"removed",children:"Removed"})]})]}),e.jsx(P,{label:"Department",value:D.department,onChange:s=>R({...D,department:s.target.value}),fullWidth:!0}),e.jsx(P,{label:"Position",value:D.position,onChange:s=>R({...D,position:s.target.value}),fullWidth:!0}),e.jsx(P,{label:"Phone",value:D.phone,onChange:s=>R({...D,phone:s.target.value}),fullWidth:!0})]})}),e.jsxs(J,{children:[e.jsx(S,{onClick:()=>xe(!1),children:"Cancel"}),e.jsx(S,{onClick:Xt,variant:"contained",disabled:we.loading,children:we.loading?"Saving...":"Save Changes"})]})]}),e.jsxs(G,{open:Dt,onClose:()=>je(!1),maxWidth:"sm",fullWidth:!0,children:[e.jsx(H,{children:"Assign License"}),e.jsx(Q,{children:e.jsxs(A,{sx:{mt:2},children:[e.jsxs(g,{variant:"body2",color:"text.secondary",sx:{mb:2},children:["Assign a license to ",x==null?void 0:x.firstName," ",x==null?void 0:x.lastName]}),e.jsxs(z,{fullWidth:!0,children:[e.jsx(V,{children:"Select License"}),e.jsx(_,{value:oe,onChange:s=>st(s.target.value),children:U==null?void 0:U.filter(s=>!s.assignedTo).map(s=>e.jsxs(w,{value:s.id,children:[s.tier," - ",s.key]},s.id))})]})]})}),e.jsxs(J,{children:[e.jsx(S,{onClick:()=>je(!1),children:"Cancel"}),e.jsx(S,{onClick:qt,variant:"contained",disabled:!oe||Ce.loading,children:Ce.loading?"Assigning...":"Assign License"})]})]}),e.jsxs(G,{open:Mt,onClose:()=>ve(!1),maxWidth:"sm",fullWidth:!0,children:[e.jsx(H,{children:"Change Password"}),e.jsx(Q,{children:e.jsxs(A,{sx:{display:"flex",flexDirection:"column",gap:2,mt:1},children:[e.jsxs(g,{variant:"body2",color:"text.secondary",children:["Change password for ",x==null?void 0:x.firstName," ",x==null?void 0:x.lastName]}),e.jsx(P,{label:"New Password",type:"password",value:L.newPassword,onChange:s=>Ne({...L,newPassword:s.target.value}),fullWidth:!0,helperText:"Password must be at least 8 characters long"}),e.jsx(P,{label:"Confirm Password",type:"password",value:L.confirmPassword,onChange:s=>Ne({...L,confirmPassword:s.target.value}),fullWidth:!0})]})}),e.jsxs(J,{children:[e.jsx(S,{onClick:()=>ve(!1),children:"Cancel"}),e.jsx(S,{onClick:es,variant:"contained",disabled:!L.newPassword||!L.confirmPassword||Se.loading,children:Se.loading?"Changing...":"Change Password"})]})]}),e.jsxs(G,{open:kt,onClose:()=>ye(!1),maxWidth:"sm",fullWidth:!0,children:[e.jsx(H,{children:"Remove Team Member"}),e.jsx(Q,{children:e.jsxs(A,{sx:{mt:2},children:[e.jsxs(De,{severity:"warning",sx:{mb:2},children:[e.jsx(Me,{children:"Warning"}),"This action cannot be undone. The team member will be permanently removed from your organization."]}),e.jsxs(g,{variant:"body2",children:["Are you sure you want to remove ",e.jsxs("strong",{children:[x==null?void 0:x.firstName," ",x==null?void 0:x.lastName]})," from the team?"]})]})}),e.jsxs(J,{children:[e.jsx(S,{onClick:()=>ye(!1),children:"Cancel"}),e.jsx(S,{onClick:Zt,variant:"contained",color:"error",disabled:be.loading,children:be.loading?"Removing...":"Remove Member"})]})]})]})};export{Ca as default};
