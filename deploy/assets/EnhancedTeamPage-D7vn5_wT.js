var St=Object.defineProperty;var bt=(j,s,t)=>s in j?St(j,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):j[s]=t;var L=(j,s,t)=>bt(j,typeof s!="symbol"?s+"":s,t);import{j as e,B as S,T as p,G as v,aR as At,d as ge,ai as fe,a as C,cd as Ct,ce as Tt,c7 as It,al as Ue,p as Mt,am as Dt,bP as kt,t as U,aU as Lt,aV as H,ab as Ot,aW as Bt,a6 as Et,cf as le,e as xe,I as Rt,be as Pt,cg as Ft,bC as zt,bD as je,ch as Vt,ci as Nt,cj as _t,ck as Ut,v as Q,ar as J,as as Y,at as K,M,aB as ve,c as ye,aC as we,aD as Se,aE as $,aF as g,l as $e,aG as be,af as $t,r as k,g as Wt,aH as Gt,cl as Ht,C as Qt,i as We,b8 as Ge,cm as Jt,R as Yt,h as Kt,bO as Xt,aO as Zt,aI as Ae,aJ as Ce,aK as Te,cn as qt,aL as Ie,w as es,x as ts,z as ss}from"./mui-DoW6Yw-n.js";import{r as x}from"./vendor-CjD1bmmO.js";import{u as as}from"./notistack.esm-Ca-E78ev.js";import{b as is,c as ns,a as rs,u as ls,d as cs,i as os,j as ds,k as us,g as hs,h as ps,l as ms}from"./useStreamlinedData-D6flZoBm.js";import{M as ce}from"./MetricCard-DiCbyu6H.js";import"./UnifiedDataService-DBjMzp7r.js";import"./index-z26n9biq.js";import"./stripe-8p04StgX.js";import"./index.esm-DdZh2hq1.js";import"./index.esm-Dkmm1Qng.js";import"./FirestoreCollectionManager-Dtt1i-9P.js";import"./firebase-DtgnD-ky.js";import"./index.esm-e-DuI42t.js";const R=class R{static getInstance(){return R.instance||(R.instance=new R),R.instance}async exportTeamMembers(s,t={}){const{includeInactive:i=!1,includePassword:a=!1,includeAuditInfo:n=!1,customFields:l=[]}=t;let d=s;i||(d=s.filter(o=>o.status==="active"));const h=["Email","First Name","Last Name","Role","Status","Department","Position","Phone","License Type","Organization ID","Created At","Last Active"];a&&h.splice(4,0,"Password"),n&&h.push("Created By","Updated At","Updated By"),l.forEach(o=>{h.includes(o)||h.push(o)});const c=d.map(o=>{const y=[o.email||"",o.firstName||"",o.lastName||"",o.role||"",o.status||"",o.department||"",o.position||"",o.phone||"",o.licenseType||"",o.organizationId||"",o.createdAt?new Date(o.createdAt).toISOString():"",o.lastActive?new Date(o.lastActive).toISOString():""];return a&&y.splice(4,0,o.password||""),n&&y.push(o.createdBy||"",o.updatedAt?new Date(o.updatedAt).toISOString():"",o.updatedBy||""),l.forEach(D=>{const T=o[D];y.push(typeof T=="string"?T:T?String(T):"")}),y});return[h.join(","),...c.map(o=>o.map(y=>typeof y=="string"&&y.includes(",")?`"${y.replace(/"/g,'""')}"`:y).join(","))].join(`
`)}async importTeamMembers(s,t,i){const a=s.split(`
`).filter(o=>o.trim());if(a.length<2)return{success:!1,totalRows:0,successfulImports:0,failedImports:0,errors:[{row:0,field:"general",value:"",error:"CSV file is empty or invalid"}],importedMembers:[]};const n=this.parseCSVLine(a[0]),l=a.slice(1),d=[],h=[],m=["Email","First Name","Last Name","Role"].filter(o=>!n.includes(o));if(m.length>0)return{success:!1,totalRows:l.length,successfulImports:0,failedImports:l.length,errors:[{row:0,field:"headers",value:m.join(", "),error:`Missing required headers: ${m.join(", ")}`}],importedMembers:[]};for(let o=0;o<l.length;o++){const y=l[o],D=this.parseCSVLine(y);i&&i(Math.round((o+1)/l.length*100));try{const T=this.validateAndCreateTeamMember(D,n,t,o+2);T&&h.push(T)}catch(T){d.push({row:o+2,field:"general",value:y,error:T instanceof Error?T.message:"Unknown error"})}}return{success:d.length===0,totalRows:l.length,successfulImports:h.length,failedImports:d.length,errors:d,importedMembers:h}}parseCSVLine(s){const t=[];let i="",a=!1;for(let n=0;n<s.length;n++){const l=s[n];l==='"'?a&&s[n+1]==='"'?(i+='"',n++):a=!a:l===","&&!a?(t.push(i.trim()),i=""):i+=l}return t.push(i.trim()),t}validateAndCreateTeamMember(s,t,i,a){var y,D,T,W,Z,de,ue,he;const n=[],l={};t.forEach((q,Ee)=>{l[q.toLowerCase()]=s[Ee]||""});const d=(y=l.email)==null?void 0:y.trim(),h=(D=l["first name"])==null?void 0:D.trim(),c=(T=l["last name"])==null?void 0:T.trim(),m=(W=l.role)==null?void 0:W.trim();if(d?this.isValidEmail(d)||n.push({row:a,field:"email",value:d,error:"Invalid email format"}):n.push({row:a,field:"email",value:"",error:"Email is required"}),h||n.push({row:a,field:"first name",value:"",error:"First name is required"}),c||n.push({row:a,field:"last name",value:"",error:"Last name is required"}),m?["admin","member","viewer","owner"].includes(m.toLowerCase())||n.push({row:a,field:"role",value:m,error:"Invalid role. Must be admin, member, viewer, or owner"}):n.push({row:a,field:"role",value:"",error:"Role is required"}),n.length>0)throw new Error(`Validation errors: ${n.map(q=>q.error).join(", ")}`);return{id:"",email:d.toLowerCase(),firstName:h,lastName:c,role:m.toLowerCase(),status:"pending",organization:{id:i,name:"",tier:"BASIC"},organizationId:i,department:((Z=l.department)==null?void 0:Z.trim())||"",position:((de=l.position)==null?void 0:de.trim())||"",phone:((ue=l.phone)==null?void 0:ue.trim())||"",licenseType:((he=l["license type"])==null?void 0:he.trim())||"BASIC",assignedProjects:[],joinedAt:new Date,createdAt:new Date,updatedAt:new Date,lastActive:l["last active"]?new Date(l["last active"]):void 0}}isValidEmail(s){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(s)}downloadCSV(s,t="team-members.csv"){const i=new Blob([s],{type:"text/csv;charset=utf-8;"}),a=document.createElement("a"),n=URL.createObjectURL(i);a.setAttribute("href",n),a.setAttribute("download",t),a.style.visibility="hidden",document.body.appendChild(a),a.click(),document.body.removeChild(a)}generateTemplate(){const s=["Email","First Name","Last Name","Role","Status","Department","Position","Phone","License Type"],t=["john.doe@example.com","John","Doe","member","active","Engineering","Software Developer","+1-555-0123","PROFESSIONAL"];return[s.join(","),t.join(",")].join(`
`)}};L(R,"instance");let De=R;const Me=De.getInstance(),P=class P{static getInstance(){return P.instance||(P.instance=new P),P.instance}filterTeamMembers(s,t,i,a){let n=[...s];t.search&&(n=this.applySearchFilter(n,t.search)),t.role&&t.role.length>0&&(n=n.filter(o=>t.role.includes(o.role))),t.status&&t.status.length>0&&(n=n.filter(o=>t.status.includes(o.status))),t.department&&t.department.length>0&&(n=n.filter(o=>o.department&&t.department.includes(o.department))),t.licenseType&&t.licenseType.length>0&&(n=n.filter(o=>o.licenseType&&t.licenseType.includes(o.licenseType))),t.dateRange&&(n=this.applyDateRangeFilter(n,t.dateRange)),t.hasLicense!==void 0&&(n=n.filter(o=>t.hasLicense?!!o.licenseType:!o.licenseType)),t.isActive!==void 0&&(n=n.filter(o=>t.isActive?o.status==="active":o.status!=="active")),t.customFields&&(n=this.applyCustomFieldFilters(n,t.customFields)),i&&(n=this.applySorting(n,i));const l=s.length,d=n.length;let h=n,c=!1,m={currentPage:1,totalPages:1,pageSize:d,totalItems:d};if(a){const o=(a.page-1)*a.pageSize,y=o+a.pageSize;h=n.slice(o,y),c=y<d,m={currentPage:a.page,totalPages:Math.ceil(d/a.pageSize),pageSize:a.pageSize,totalItems:d}}return{filteredMembers:h,totalCount:l,filteredCount:d,hasMore:c,pageInfo:m}}applySearchFilter(s,t){const i=t.toLowerCase();return s.filter(a=>[a.email,a.firstName,a.lastName,a.department,a.position,a.phone,a.role,a.status,a.licenseType].some(l=>l&&l.toLowerCase().includes(i)))}applyDateRangeFilter(s,t){return t?s.filter(i=>{const a=i[t.field];if(!a)return!1;const n=new Date(a),l=t.start?new Date(t.start):null,d=t.end?new Date(t.end):null;return!(l&&n<l||d&&n>d)}):s}applyCustomFieldFilters(s,t){return s.filter(i=>Object.entries(t).every(([a,n])=>{const l=i[a];return n==null?l===n:typeof n=="string"?l&&String(l).toLowerCase().includes(n.toLowerCase()):l===n}))}applySorting(s,t){return s.sort((i,a)=>{const n=i[t.field],l=a[t.field];if(n===void 0&&l===void 0)return 0;if(n===void 0)return t.direction==="asc"?1:-1;if(l===void 0)return t.direction==="asc"?-1:1;let d=0;return typeof n=="string"&&typeof l=="string"?d=n.localeCompare(l):n instanceof Date&&l instanceof Date?d=n.getTime()-l.getTime():typeof n=="number"&&typeof l=="number"?d=n-l:d=String(n).localeCompare(String(l)),t.direction==="asc"?d:-d})}getFilterOptions(s){const t=[...new Set(s.map(l=>l.role))].sort(),i=[...new Set(s.map(l=>l.status))].sort(),a=[...new Set(s.map(l=>l.department).filter(Boolean))].sort(),n=[...new Set(s.map(l=>l.licenseType).filter(Boolean))].sort();return{roles:t,statuses:i,departments:a,licenseTypes:n,totalMembers:s.length,activeMembers:s.filter(l=>l.status==="active").length,pendingMembers:s.filter(l=>l.status==="pending").length,licensedMembers:s.filter(l=>l.licenseType).length}}getQuickFilters(){return{all:{label:"All Members",criteria:{}},active:{label:"Active Members",criteria:{isActive:!0}},pending:{label:"Pending Invites",criteria:{status:["pending"]}},admins:{label:"Administrators",criteria:{role:["admin","owner"]}},licensed:{label:"Licensed Members",criteria:{hasLicense:!0}},recent:{label:"Recently Added",criteria:{dateRange:{field:"createdAt",start:new Date(Date.now()-30*24*60*60*1e3)}}}}}};L(P,"instance");let ke=P;const gs=ke.getInstance(),F=class F{static getInstance(){return F.instance||(F.instance=new F),F.instance}generateAnalytics(s){return{overview:this.calculateOverviewStats(s),trends:this.calculateTrends(s),departmentBreakdown:this.calculateDepartmentStats(s),roleDistribution:this.calculateRoleDistribution(s),licenseUtilization:this.calculateLicenseStats(s),activityMetrics:this.calculateActivityMetrics(s),growthMetrics:this.calculateGrowthMetrics(s),topPerformers:this.identifyTopPerformers(s),recommendations:this.generateRecommendations(s)}}calculateOverviewStats(s){const t=s.length,i=s.filter(o=>o.status==="active").length,a=s.filter(o=>o.status==="pending").length,n=s.filter(o=>o.status==="suspended").length,l=s.filter(o=>o.licenseType&&o.licenseType!=="BASIC").length,d=t-l,h=s.map(o=>this.calculateActivityScore(o)),c=h.reduce((o,y)=>o+y,0)/h.length,m=this.calculateRetentionRate(s);return{totalMembers:t,activeMembers:i,pendingMembers:a,suspendedMembers:n,licensedMembers:l,unlicensedMembers:d,averageActivityScore:Math.round(c*100)/100,memberRetentionRate:Math.round(m*100)/100}}calculateTrends(s){const t=[],i=new Date;for(let a=11;a>=0;a--){const n=new Date(i.getFullYear(),i.getMonth()-a,1),l=new Date(i.getFullYear(),i.getMonth()-a+1,1),d=s.filter(m=>{const o=new Date(m.createdAt);return o>=n&&o<l}),h=s.filter(m=>{const o=m.lastActive?new Date(m.lastActive):null;return o&&o>=n&&o<l}),c=s.filter(m=>m.licenseType&&m.licenseType!=="BASIC"&&new Date(m.createdAt)<=l);t.push({period:n.toLocaleDateString("en-US",{month:"short",year:"numeric"}),membersAdded:d.length,membersRemoved:0,netGrowth:d.length,activeMembers:h.length,licenseUtilization:c.length})}return t}calculateDepartmentStats(s){const t=new Map;return s.forEach(i=>{const a=i.department||"Unassigned";t.has(a)||t.set(a,[]),t.get(a).push(i)}),Array.from(t.entries()).map(([i,a])=>{const n=a.filter(c=>c.status==="active").length,l=a.map(c=>this.calculateActivityScore(c)),d=l.reduce((c,m)=>c+m,0)/l.length,h=a.filter(c=>c.licenseType&&c.licenseType!=="BASIC").length;return{department:i,memberCount:a.length,activeMembers:n,averageActivityScore:Math.round(d*100)/100,licenseUtilization:Math.round(h/a.length*100),growthRate:0}}).sort((i,a)=>a.memberCount-i.memberCount)}calculateRoleDistribution(s){const t=new Map;s.forEach(a=>{t.has(a.role)||t.set(a.role,[]),t.get(a.role).push(a)});const i=s.length;return Array.from(t.entries()).map(([a,n])=>{const l=n.map(c=>this.calculateActivityScore(c)),d=l.reduce((c,m)=>c+m,0)/l.length,h=n.filter(c=>c.licenseType&&c.licenseType!=="BASIC").length;return{role:a,count:n.length,percentage:Math.round(n.length/i*100),averageActivityScore:Math.round(d*100)/100,licenseUtilization:Math.round(h/n.length*100)}}).sort((a,n)=>n.count-a.count)}calculateLicenseStats(s){const t=s.length,i=s.filter(d=>d.licenseType&&d.licenseType!=="BASIC").length,a=t-i,n=Math.round(i/t*100),l={};return s.forEach(d=>{d.licenseType&&(l[d.licenseType]=(l[d.licenseType]||0)+1)}),{totalLicenses:t,assignedLicenses:i,availableLicenses:a,utilizationRate:n,byType:l,projectedNeeds:Math.max(0,Math.ceil(t*.1))}}calculateActivityMetrics(s){const i=s.filter(c=>c.lastActive).map(c=>new Date(c.lastActive)),a=i.length>0?new Date(i.reduce((c,m)=>c+m.getTime(),0)/i.length):new Date,n=s.map(c=>({member:c,score:this.calculateActivityScore(c)})),l=n.sort((c,m)=>m.score-c.score).slice(0,5).map(c=>`${c.member.firstName} ${c.member.lastName}`),d=n.filter(c=>c.score<.3).map(c=>`${c.member.firstName} ${c.member.lastName}`),h={"High (0.8-1.0)":n.filter(c=>c.score>=.8).length,"Medium (0.5-0.8)":n.filter(c=>c.score>=.5&&c.score<.8).length,"Low (0.3-0.5)":n.filter(c=>c.score>=.3&&c.score<.5).length,"Inactive (0.0-0.3)":n.filter(c=>c.score<.3).length};return{averageLastActive:a,mostActiveMembers:l,inactiveMembers:d,activityScoreDistribution:h}}calculateGrowthMetrics(s){const t=new Date,i=new Date(t.getTime()-30*24*60*60*1e3);new Date(t.getTime()-90*24*60*60*1e3),new Date(t.getTime()-365*24*60*60*1e3);const a=s.filter(d=>new Date(d.createdAt)>=i).length,n=s.filter(d=>{const h=new Date(d.createdAt);return h>=new Date(i.getTime()-30*24*60*60*1e3)&&h<i}).length,l=n>0?(a-n)/n*100:0;return{monthlyGrowthRate:Math.round(l*100)/100,quarterlyGrowthRate:0,yearlyGrowthRate:0,projectedGrowth:Math.round(s.length*(l/100)),churnRate:0}}identifyTopPerformers(s){return s.map(t=>({memberId:t.id,name:`${t.firstName} ${t.lastName}`,email:t.email,score:this.calculateActivityScore(t),metrics:{activityScore:this.calculateActivityScore(t),projectCount:0,licenseUtilization:t.licenseType&&t.licenseType!=="BASIC"?1:0}})).sort((t,i)=>i.score-t.score).slice(0,10)}generateRecommendations(s){const t=[],i=this.calculateOverviewStats(s),a=Math.round(i.licensedMembers/i.totalMembers*100);return a<50&&t.push({type:"license",priority:"high",title:"Low License Utilization",description:`Only ${a}% of team members have licenses assigned.`,action:"Review license assignments and consider upgrading more members.",impact:"Improved productivity and feature access for team members."}),i.averageActivityScore<.5&&t.push({type:"activity",priority:"medium",title:"Low Team Activity",description:`Average activity score is ${i.averageActivityScore.toFixed(2)}.`,action:"Engage with inactive members and provide training.",impact:"Increased team engagement and productivity."}),i.totalMembers<10&&t.push({type:"growth",priority:"low",title:"Small Team Size",description:`Team has ${i.totalMembers} members. Consider expanding.`,action:"Invite more team members to scale operations.",impact:"Better resource distribution and team resilience."}),t}calculateActivityScore(s){let t=0;if(s.status==="active"&&(t+=.3),s.lastActive){const i=(Date.now()-new Date(s.lastActive).getTime())/864e5;i<7?t+=.4:i<30?t+=.2:i<90&&(t+=.1)}return s.licenseType&&s.licenseType!=="BASIC"&&(t+=.2),s.department&&s.position&&(t+=.1),Math.min(t,1)}calculateRetentionRate(s){const t=s.filter(a=>a.status==="active").length,i=s.length;return i>0?t/i:0}};L(F,"instance");let Le=F;const fs=Le.getInstance(),z=class z{constructor(){L(this,"auditLogs",[])}static getInstance(){return z.instance||(z.instance=new z),z.instance}logAction(s,t,i,a,n,l,d,h){const c={id:this.generateAuditId(),timestamp:new Date,action:s,actorId:t,actorEmail:i,targetMemberId:a,targetMemberEmail:n,changes:l,metadata:{...d,additionalContext:{...d.additionalContext,...h}}};this.auditLogs.push(c),console.log("🔍 [Audit] Team member action logged:",c)}logMemberCreation(s,t,i,a){const n=[{field:"email",oldValue:null,newValue:i.email,changeType:"added"},{field:"firstName",oldValue:null,newValue:i.firstName,changeType:"added"},{field:"lastName",oldValue:null,newValue:i.lastName,changeType:"added"},{field:"role",oldValue:null,newValue:i.role,changeType:"added"},{field:"status",oldValue:null,newValue:i.status,changeType:"added"}];this.logAction("member_created",s,t,i.id,i.email,n,a)}logMemberUpdate(s,t,i,a,n,l,d){const h=[];["firstName","lastName","email","role","status","department","position","phone","licenseType"].forEach(m=>{const o=n[m],y=l[m];o!==y&&h.push({field:m,oldValue:o,newValue:y,changeType:o===void 0?"added":y===void 0?"removed":"modified"})}),h.length>0&&this.logAction("member_updated",s,t,i,a,h,d)}logMemberDeletion(s,t,i,a){const n=[{field:"status",oldValue:i.status,newValue:"deleted",changeType:"modified"}];this.logAction("member_deleted",s,t,i.id,i.email,n,a)}logPasswordReset(s,t,i,a,n){const l=[{field:"password",oldValue:"[REDACTED]",newValue:"[RESET]",changeType:"modified"}];this.logAction("member_password_reset",s,t,i,a,l,n)}logLicenseAssignment(s,t,i,a,n,l,d){const h=[{field:"licenseType",oldValue:n||"BASIC",newValue:l,changeType:"modified"}];this.logAction("member_license_assigned",s,t,i,a,h,d)}logBulkOperation(s,t,i,a,n,l){const d=[{field:"bulk_operation",oldValue:null,newValue:i,changeType:"added"},{field:"affected_members",oldValue:null,newValue:a.length,changeType:"added"},...n];this.logAction("bulk_operation",s,t,a[0]||"multiple","multiple",d,l)}queryAuditLogs(s){let t=[...this.auditLogs];return s.memberId&&(t=t.filter(i=>i.targetMemberId===s.memberId)),s.actorId&&(t=t.filter(i=>i.actorId===s.actorId)),s.action&&(t=t.filter(i=>i.action===s.action)),s.startDate&&(t=t.filter(i=>i.timestamp>=s.startDate)),s.endDate&&(t=t.filter(i=>i.timestamp<=s.endDate)),s.organizationId&&(t=t.filter(i=>i.metadata.organizationId===s.organizationId)),t.sort((i,a)=>a.timestamp.getTime()-i.timestamp.getTime()),s.offset&&(t=t.slice(s.offset)),s.limit&&(t=t.slice(0,s.limit)),t}getAuditSummary(s,t=30){const i=new Date(Date.now()-t*24*60*60*1e3),a=this.auditLogs.filter(c=>c.metadata.organizationId===s&&c.timestamp>=i),n={};a.forEach(c=>{n[c.action]=(n[c.action]||0)+1});const l={};a.forEach(c=>{l[c.actorId]||(l[c.actorId]={actorEmail:c.actorEmail,count:0}),l[c.actorId].count++});const d=Object.entries(l).map(([c,m])=>({actorId:c,actorEmail:m.actorEmail,actionCount:m.count})).sort((c,m)=>m.actionCount-c.actionCount).slice(0,5),h=this.calculateComplianceScore(a);return{totalActions:a.length,actionsByType:n,recentActivity:a.slice(0,10),topActors:d,complianceScore:h}}calculateComplianceScore(s){if(s.length===0)return 100;let t=100;const i=s.filter(n=>n.action==="member_deleted"||n.action==="member_suspended"||n.action==="member_password_reset");t-=i.length*5;const a=s.filter(n=>n.action==="bulk_operation");return t-=a.length*2,Math.max(0,t)}generateAuditId(){return`audit_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}exportAuditLogs(s){const t=this.queryAuditLogs(s),i=["Timestamp","Action","Actor ID","Actor Email","Target Member ID","Target Member Email","Changes","Organization ID"],a=t.map(l=>[l.timestamp.toISOString(),l.action,l.actorId,l.actorEmail,l.targetMemberId,l.targetMemberEmail,JSON.stringify(l.changes),l.metadata.organizationId]);return[i.join(","),...a.map(l=>l.map(d=>typeof d=="string"&&d.includes(",")?`"${d.replace(/"/g,'""')}"`:d).join(","))].join(`
`)}};L(z,"instance");let Oe=z;const xs=Oe.getInstance(),B=class B{constructor(){L(this,"templates",[]);L(this,"bulkOperations",[{id:"sample_1",name:"Update All Members to Professional License",description:"Upgrade all team members to Professional license type",operation:"assign_license",criteria:{roles:["member","admin"],statuses:["active"]},affectedMembers:[],status:"completed",progress:100,results:{totalProcessed:15,successful:15,failed:0,errors:[],details:{}},createdBy:"system",createdAt:new Date(Date.now()-2*24*60*60*1e3),completedAt:new Date(Date.now()-2*24*60*60*1e3)},{id:"sample_2",name:"Bulk Role Update - Engineering Team",description:"Update all engineering team members to admin role",operation:"update_role",criteria:{departments:["Engineering"],statuses:["active"]},affectedMembers:[],status:"pending",progress:0,results:{totalProcessed:0,successful:0,failed:0,errors:[],details:{}},createdBy:"system",createdAt:new Date(Date.now()-1*24*60*60*1e3)},{id:"sample_3",name:"Activate Pending Members",description:"Activate all pending team member invitations",operation:"change_status",criteria:{statuses:["pending"]},affectedMembers:[],status:"running",progress:60,results:{totalProcessed:5,successful:3,failed:0,errors:[],details:{}},createdBy:"system",createdAt:new Date(Date.now()-6*60*60*1e3)}])}static getInstance(){return B.instance||(B.instance=new B,B.instance.initializeDefaultTemplates()),B.instance}initializeDefaultTemplates(){this.templates=[{id:"executive_admin",name:"Executive Administrator",description:"Full administrative access with all permissions",category:"executive",industry:["all"],role:"admin",permissions:["manage_team","manage_licenses","manage_projects","view_analytics","manage_organization","audit_access"],defaultSettings:{department:"Executive",position:"Administrator",licenseType:"ENTERPRISE",status:"active"},isDefault:!0,isCustom:!1,createdAt:new Date,updatedAt:new Date},{id:"project_manager",name:"Project Manager",description:"Project management role with team coordination permissions",category:"management",industry:["all"],role:"member",permissions:["manage_projects","assign_team_members","view_analytics","manage_tasks"],defaultSettings:{department:"Project Management",position:"Project Manager",licenseType:"PROFESSIONAL",status:"active"},isDefault:!0,isCustom:!1,createdAt:new Date,updatedAt:new Date},{id:"software_developer",name:"Software Developer",description:"Technical role for software development teams",category:"technical",industry:["technology","software","it"],role:"member",permissions:["access_projects","manage_tasks","view_documentation"],defaultSettings:{department:"Engineering",position:"Software Developer",licenseType:"PROFESSIONAL",status:"active"},isDefault:!0,isCustom:!1,createdAt:new Date,updatedAt:new Date},{id:"creative_director",name:"Creative Director",description:"Creative leadership role for design and content teams",category:"creative",industry:["media","advertising","design","entertainment"],role:"member",permissions:["manage_creative_projects","approve_content","manage_assets","view_analytics"],defaultSettings:{department:"Creative",position:"Creative Director",licenseType:"PROFESSIONAL",status:"active"},isDefault:!0,isCustom:!1,createdAt:new Date,updatedAt:new Date},{id:"sales_representative",name:"Sales Representative",description:"Sales role with client management permissions",category:"sales",industry:["all"],role:"member",permissions:["manage_clients","view_sales_analytics","manage_opportunities"],defaultSettings:{department:"Sales",position:"Sales Representative",licenseType:"BASIC",status:"active"},isDefault:!0,isCustom:!1,createdAt:new Date,updatedAt:new Date},{id:"support_specialist",name:"Support Specialist",description:"Customer support role with limited access",category:"support",industry:["all"],role:"viewer",permissions:["view_tickets","manage_support_cases","view_documentation"],defaultSettings:{department:"Support",position:"Support Specialist",licenseType:"BASIC",status:"active"},isDefault:!0,isCustom:!1,createdAt:new Date,updatedAt:new Date}]}getTemplates(s,t){let i=[...this.templates];return s&&(i=i.filter(a=>a.category===s)),t&&(i=i.filter(a=>a.industry.includes("all")||a.industry.includes(t))),i.sort((a,n)=>a.name.localeCompare(n.name))}getTemplate(s){return this.templates.find(t=>t.id===s)}createTemplate(s,t){const i={...s,id:`custom_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,isDefault:!1,isCustom:!0,createdBy:t,createdAt:new Date,updatedAt:new Date};return this.templates.push(i),i}updateTemplate(s,t){const i=this.templates.findIndex(a=>a.id===s);return i===-1?!1:(this.templates[i]={...this.templates[i],...t,updatedAt:new Date},!0)}deleteTemplate(s){const t=this.templates.findIndex(i=>i.id===s);return t===-1||this.templates[t].isDefault?!1:(this.templates.splice(t,1),!0)}createMemberFromTemplate(s,t,i){const a=this.getTemplate(s);if(!a)throw new Error("Template not found");return{id:"",email:t.email||"",firstName:t.firstName||"",lastName:t.lastName||"",role:a.role,status:a.defaultSettings.status,organization:{id:i,name:"",tier:"BASIC"},organizationId:i,department:a.defaultSettings.department||t.department||"",position:a.defaultSettings.position||t.position||"",phone:t.phone||"",licenseType:a.defaultSettings.licenseType,assignedProjects:[],joinedAt:new Date,createdAt:new Date,updatedAt:new Date,...t,...a.defaultSettings.customFields}}createBulkOperation(s,t,i,a,n,l){const d={id:`bulk_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,name:s,description:t,operation:i,template:l?this.getTemplate(l):void 0,criteria:a,affectedMembers:[],status:"pending",progress:0,results:{totalProcessed:0,successful:0,failed:0,errors:[],details:{}},createdBy:n,createdAt:new Date};return this.bulkOperations.push(d),d}async executeBulkOperation(s,t,i){const a=this.bulkOperations.find(d=>d.id===s);if(!a)throw new Error("Bulk operation not found");a.status="running",a.progress=0;const n={totalProcessed:0,successful:0,failed:0,errors:[],details:{}},l=this.filterMembersByCriteria(t,a.criteria);a.affectedMembers=l.map(d=>d.id),n.totalProcessed=l.length;for(let d=0;d<l.length;d++){const h=l[d];try{switch(a.operation){case"create":n.details[h.id]="Created successfully",n.successful++;break;case"update":n.details[h.id]="Updated successfully",n.successful++;break;case"delete":n.details[h.id]="Deleted successfully",n.successful++;break;case"assign_license":n.details[h.id]="License assigned successfully",n.successful++;break;case"change_role":n.details[h.id]="Role changed successfully",n.successful++;break}}catch(c){n.failed++,n.errors.push({memberId:h.id,error:c instanceof Error?c.message:"Unknown error"}),n.details[h.id]="Failed"}a.progress=Math.round((d+1)/l.length*100),i&&i(a.progress)}return a.results=n,a.status=n.failed===0?"completed":"failed",a.completedAt=new Date,n}filterMembersByCriteria(s,t){let i=[...s];return t.memberIds&&t.memberIds.length>0&&(i=i.filter(a=>t.memberIds.includes(a.id))),t.roles&&t.roles.length>0&&(i=i.filter(a=>t.roles.includes(a.role))),t.departments&&t.departments.length>0&&(i=i.filter(a=>a.department&&t.departments.includes(a.department))),t.statuses&&t.statuses.length>0&&(i=i.filter(a=>t.statuses.includes(a.status))),t.licenseTypes&&t.licenseTypes.length>0&&(i=i.filter(a=>a.licenseType&&t.licenseTypes.includes(a.licenseType))),i}getBulkOperations(s){let t=[...this.bulkOperations];return s&&(t=t.filter(i=>i.createdBy===s)),t.sort((i,a)=>a.createdAt.getTime()-i.createdAt.getTime())}getBulkOperation(s){return this.bulkOperations.find(t=>t.id===s)}getCategories(){return["executive","management","technical","creative","support","sales","marketing","operations","custom"]}getIndustries(){return["technology","software","it","media","advertising","design","entertainment","finance","healthcare","education","retail","manufacturing","consulting","nonprofit","government","all"]}};L(B,"instance");let Be=B;const oe=Be.getInstance();function X(j){const{children:s,value:t,index:i,...a}=j;return e.jsx("div",{role:"tabpanel",hidden:t!==i,id:`team-tabpanel-${i}`,"aria-labelledby":`team-tab-${i}`,...a,children:t===i&&e.jsx(S,{sx:{p:3},children:s})})}const Ps=()=>{var Ne,_e;const{enqueueSnackbar:j}=as(),[s,t]=x.useState(0),[i,a]=x.useState([]),[n,l]=x.useState({}),[d,h]=x.useState({field:"createdAt",direction:"desc"}),[c,m]=x.useState({page:1,pageSize:25}),[o,y]=x.useState("table"),[D,T]=x.useState(""),[W,Z]=x.useState(!1),[de,ue]=x.useState(!1),[he,q]=x.useState(!1),[Ee,js]=x.useState(!1),[He,G]=x.useState(!1),[Qe,pe]=x.useState(!1),[vs,ys]=x.useState(!1),[Je,Ye]=x.useState(null),[Re,Ke]=x.useState([]),[Xe,Ze]=x.useState([]),[Pe,O]=x.useState([]),[V,qe]=x.useState(null),[ws,ee]=x.useState(!1),[et,te]=x.useState(!1),[w,tt]=x.useState(null),[st,me]=x.useState(new Set),{loading:at,error:Fe}=is(),{data:I,loading:it,error:ze}=ns(),{data:A,loading:nt,error:Ve,refetch:se}=rs(),{data:ae}=ls();cs(),os(),ds(),us(),hs(),ps(),ms();const N=x.useMemo(()=>{if(!A)return[];const r={...n,search:D||void 0};return gs.filterTeamMembers(A,r,d,c).filteredMembers},[A,n,D,d,c]),ie=x.useMemo(()=>{if(!A)return{totalMembers:0,activeMembers:0,pendingInvites:0,availableLicenses:0,totalLicenses:0,assignedLicenses:0};const r=A.length,u=A.filter(_=>_.status==="active").length,f=A.filter(_=>_.status==="pending").length,b=A.filter(_=>_.licenseType&&_.licenseType!=="BASIC").length,E=(ae==null?void 0:ae.length)||0,wt=E-b;return{totalMembers:r,activeMembers:u,pendingInvites:f,availableLicenses:wt,totalLicenses:E,assignedLicenses:b}},[A,ae]),rt=x.useCallback(async()=>{if(A){ee(!0);try{const r=fs.generateAnalytics(A);Ye(r)}catch(r){console.error("Failed to load analytics:",r),j("Failed to load analytics",{variant:"error"})}finally{ee(!1)}}},[A,j]),lt=x.useCallback(async()=>{var r;if((r=I==null?void 0:I.organization)!=null&&r.id){ee(!0);try{const u={organizationId:I.organization.id,limit:100},f=xs.queryAuditLogs(u);Ke(f)}catch(u){console.error("Failed to load audit logs:",u),j("Failed to load audit logs",{variant:"error"})}finally{ee(!1)}}},[(Ne=I==null?void 0:I.organization)==null?void 0:Ne.id,j]),ct=x.useCallback(async()=>{try{const r=oe.getTemplates();Ze(r)}catch(r){console.error("Failed to load templates:",r),j("Failed to load templates",{variant:"error"})}},[j]),ot=x.useCallback(async()=>{try{const r=oe.getBulkOperations();O(r)}catch(r){console.error("Failed to load bulk operations:",r),j("Failed to load bulk operations",{variant:"error"})}},[j]),dt=x.useCallback(async()=>{if(A)try{const r=await Me.exportTeamMembers(A,{includeInactive:!0,includeAuditInfo:!0});Me.downloadCSV(r,`team-members-${new Date().toISOString().split("T")[0]}.csv`),j("Team members exported successfully",{variant:"success"})}catch(r){console.error("Failed to export CSV:",r),j("Failed to export CSV",{variant:"error"})}},[A,j]),ut=x.useCallback(async r=>{var u;if((u=I==null?void 0:I.organization)!=null&&u.id)try{const f=await r.text(),b=await Me.importTeamMembers(f,I.organization.id,E=>{});qe(b),b.success?(j(`Successfully imported ${b.successfulImports} team members`,{variant:"success"}),se()):j(`Import completed with ${b.failedImports} errors`,{variant:"warning"})}catch(f){console.error("Failed to import CSV:",f),j("Failed to import CSV",{variant:"error"})}},[(_e=I==null?void 0:I.organization)==null?void 0:_e.id,j,se]),ne=x.useCallback(async r=>{if(A){me(u=>new Set([...u,r.id]));try{const u=await oe.executeBulkOperation(r.id,A,f=>{O(b=>b.map(E=>E.id===r.id?{...E,progress:f}:E))});O(f=>f.map(b=>b.id===r.id?{...b,status:u.failed===0?"completed":"failed",progress:100,results:u,completedAt:new Date}:b)),j(`Bulk operation completed: ${u.successful} successful, ${u.failed} failed`,{variant:u.failed===0?"success":"warning"}),se()}catch(u){console.error("Failed to execute bulk operation:",u),O(f=>f.map(b=>b.id===r.id?{...b,status:"failed",progress:0}:b)),j("Failed to execute bulk operation",{variant:"error"})}finally{me(u=>{const f=new Set(u);return f.delete(r.id),f})}}},[A,j,se]),ht=x.useCallback(r=>{tt(r),te(!0)},[]),pt=x.useCallback(r=>{j("Edit functionality coming soon",{variant:"info"})},[j]),mt=x.useCallback(r=>{O(u=>u.filter(f=>f.id!==r.id)),j("Operation deleted successfully",{variant:"success"})},[j]),gt=x.useCallback(r=>{O(u=>u.map(f=>f.id===r.id?{...f,status:"pending",progress:0,results:{totalProcessed:0,successful:0,failed:0,errors:[],details:{}}}:f)),ne(r)},[ne]),ft=x.useCallback(r=>{O(u=>u.map(f=>f.id===r.id?{...f,status:"failed",progress:0}:f)),me(u=>{const f=new Set(u);return f.delete(r.id),f}),j("Operation stopped",{variant:"info"})},[j]),xt=(r,u)=>{switch(t(u),u){case 1:rt();break;case 2:lt();break;case 3:ct();break;case 4:ot();break}},jt=(r,u)=>{a(u?f=>[...f,r]:f=>f.filter(b=>b!==r))},vt=r=>{a(r?N.map(u=>u.id):[])},re=r=>{l(r),m(u=>({...u,page:1}))},yt=r=>{m(r)};return at||it||nt?e.jsxs(S,{sx:{p:3},children:[e.jsx(p,{variant:"h4",gutterBottom:!0,children:"Team Management"}),e.jsx(v,{container:!0,spacing:3,children:[1,2,3,4].map(r=>e.jsx(v,{item:!0,xs:12,sm:6,md:3,children:e.jsx(At,{variant:"rectangular",height:120})},r))})]}):Fe||ze||Ve?e.jsx(S,{sx:{p:3},children:e.jsxs(ge,{severity:"error",children:[e.jsx(fe,{children:"Error Loading Team Data"}),Fe||ze||Ve||"Unknown error occurred"]})}):e.jsxs(S,{sx:{p:3},children:[e.jsxs(S,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:[e.jsx(p,{variant:"h4",component:"h1",children:"Team Management"}),e.jsxs(S,{sx:{display:"flex",gap:1},children:[e.jsx(C,{variant:"outlined",startIcon:e.jsx(Ct,{}),onClick:dt,children:"Export CSV"}),e.jsx(C,{variant:"outlined",startIcon:e.jsx(Tt,{}),onClick:()=>pe(!0),children:"Import CSV"}),e.jsx(C,{variant:"contained",startIcon:e.jsx(It,{}),onClick:()=>{},children:"Invite Member"})]})]}),e.jsxs(v,{container:!0,spacing:3,sx:{mb:3},children:[e.jsx(v,{item:!0,xs:12,sm:6,md:3,children:e.jsx(ce,{title:"Total Members",value:ie.totalMembers,icon:e.jsx(Ue,{}),color:"primary"})}),e.jsx(v,{item:!0,xs:12,sm:6,md:3,children:e.jsx(ce,{title:"Active Members",value:ie.activeMembers,icon:e.jsx(Mt,{}),color:"success"})}),e.jsx(v,{item:!0,xs:12,sm:6,md:3,children:e.jsx(ce,{title:"Pending Invites",value:ie.pendingInvites,icon:e.jsx(Dt,{}),color:"warning"})}),e.jsx(v,{item:!0,xs:12,sm:6,md:3,children:e.jsx(ce,{title:"Available Licenses",value:ie.availableLicenses,icon:e.jsx(kt,{}),color:"primary"})})]}),e.jsxs(U,{children:[e.jsx(S,{sx:{borderBottom:1,borderColor:"divider"},children:e.jsxs(Lt,{value:s,onChange:xt,"aria-label":"team management tabs",children:[e.jsx(H,{label:"Team Members",icon:e.jsx(Ue,{})}),e.jsx(H,{label:"Analytics",icon:e.jsx(Ot,{})}),e.jsx(H,{label:"Audit Trail",icon:e.jsx(Bt,{})}),e.jsx(H,{label:"Templates",icon:e.jsx(Et,{})}),e.jsx(H,{label:"Bulk Operations",icon:e.jsx(le,{})})]})}),e.jsxs(X,{value:s,index:0,children:[e.jsxs(S,{sx:{display:"flex",gap:2,mb:3,alignItems:"center"},children:[e.jsx(xe,{fullWidth:!0,placeholder:"Search team members...",value:D,onChange:r=>T(r.target.value),InputProps:{startAdornment:e.jsx(Rt,{position:"start",children:e.jsx(Pt,{})})}}),e.jsx(C,{variant:"outlined",startIcon:e.jsx(Ft,{}),onClick:()=>Z(!W),children:"Filters"}),e.jsxs(zt,{value:o,exclusive:!0,onChange:(r,u)=>u&&y(u),size:"small",children:[e.jsx(je,{value:"table",children:e.jsx(Vt,{})}),e.jsx(je,{value:"grid",children:e.jsx(Nt,{})}),e.jsx(je,{value:"list",children:e.jsx(_t,{})})]})]}),W&&e.jsxs(U,{sx:{mb:3},children:[e.jsx(Ut,{title:"Advanced Filters"}),e.jsx(Q,{children:e.jsxs(v,{container:!0,spacing:2,children:[e.jsx(v,{item:!0,xs:12,sm:6,md:3,children:e.jsxs(J,{fullWidth:!0,children:[e.jsx(Y,{children:"Role"}),e.jsxs(K,{multiple:!0,value:n.role||[],onChange:r=>re({...n,role:r.target.value}),children:[e.jsx(M,{value:"admin",children:"Admin"}),e.jsx(M,{value:"member",children:"Member"}),e.jsx(M,{value:"viewer",children:"Viewer"}),e.jsx(M,{value:"owner",children:"Owner"})]})]})}),e.jsx(v,{item:!0,xs:12,sm:6,md:3,children:e.jsxs(J,{fullWidth:!0,children:[e.jsx(Y,{children:"Status"}),e.jsxs(K,{multiple:!0,value:n.status||[],onChange:r=>re({...n,status:r.target.value}),children:[e.jsx(M,{value:"active",children:"Active"}),e.jsx(M,{value:"pending",children:"Pending"}),e.jsx(M,{value:"suspended",children:"Suspended"})]})]})}),e.jsx(v,{item:!0,xs:12,sm:6,md:3,children:e.jsxs(J,{fullWidth:!0,children:[e.jsx(Y,{children:"Department"}),e.jsx(K,{multiple:!0,value:n.department||[],onChange:r=>re({...n,department:r.target.value})})]})}),e.jsx(v,{item:!0,xs:12,sm:6,md:3,children:e.jsxs(J,{fullWidth:!0,children:[e.jsx(Y,{children:"License Type"}),e.jsxs(K,{multiple:!0,value:n.licenseType||[],onChange:r=>re({...n,licenseType:r.target.value}),children:[e.jsx(M,{value:"BASIC",children:"Basic"}),e.jsx(M,{value:"PROFESSIONAL",children:"Professional"}),e.jsx(M,{value:"ENTERPRISE",children:"Enterprise"})]})]})})]})})]}),e.jsx(ve,{component:ye,children:e.jsxs(we,{children:[e.jsx(Se,{children:e.jsxs($,{children:[e.jsx(g,{padding:"checkbox",children:e.jsx($e,{indeterminate:i.length>0&&i.length<N.length,checked:N.length>0&&i.length===N.length,onChange:r=>vt(r.target.checked)})}),e.jsx(g,{children:"Member"}),e.jsx(g,{children:"Role"}),e.jsx(g,{children:"Status"}),e.jsx(g,{children:"Department"}),e.jsx(g,{children:"License"}),e.jsx(g,{children:"Last Active"}),e.jsx(g,{children:"Actions"})]})}),e.jsx(be,{children:N.map(r=>{var u,f;return e.jsxs($,{children:[e.jsx(g,{padding:"checkbox",children:e.jsx($e,{checked:i.includes(r.id),onChange:b=>jt(r.id,b.target.checked)})}),e.jsx(g,{children:e.jsxs(S,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsxs($t,{children:[(u=r.firstName)==null?void 0:u[0],(f=r.lastName)==null?void 0:f[0]]}),e.jsxs(S,{children:[e.jsxs(p,{variant:"subtitle2",children:[r.firstName," ",r.lastName]}),e.jsx(p,{variant:"body2",color:"text.secondary",children:r.email})]})]})}),e.jsx(g,{children:e.jsx(k,{label:r.role,color:r.role==="admin"?"primary":"default",size:"small"})}),e.jsx(g,{children:e.jsx(k,{label:r.status,color:r.status==="active"?"success":"default",size:"small"})}),e.jsx(g,{children:r.department||"-"}),e.jsx(g,{children:r.licenseType?e.jsx(k,{label:r.licenseType,color:"info",size:"small"}):"-"}),e.jsx(g,{children:r.lastActive?new Date(r.lastActive).toLocaleDateString():"-"}),e.jsx(g,{children:e.jsx(Wt,{size:"small",children:e.jsx(Gt,{})})})]},r.id)})})]})}),e.jsx(S,{sx:{display:"flex",justifyContent:"center",mt:3},children:e.jsx(Ht,{count:Math.ceil(N.length/c.pageSize),page:c.page,onChange:(r,u)=>yt({...c,page:u}),color:"primary"})})]}),e.jsx(X,{value:s,index:1,children:Je?e.jsxs(S,{children:[e.jsx(p,{variant:"h5",gutterBottom:!0,children:"Team Analytics"}),e.jsx(p,{children:"Analytics dashboard coming soon..."})]}):e.jsxs(S,{sx:{textAlign:"center",py:4},children:[e.jsx(Qt,{}),e.jsx(p,{variant:"body1",sx:{mt:2},children:"Loading analytics..."})]})}),e.jsxs(X,{value:s,index:2,children:[e.jsx(p,{variant:"h5",gutterBottom:!0,children:"Audit Trail"}),Re.length>0?e.jsx(ve,{component:ye,children:e.jsxs(we,{children:[e.jsx(Se,{children:e.jsxs($,{children:[e.jsx(g,{children:"Timestamp"}),e.jsx(g,{children:"Action"}),e.jsx(g,{children:"Actor"}),e.jsx(g,{children:"Target"}),e.jsx(g,{children:"Changes"})]})}),e.jsx(be,{children:Re.map(r=>e.jsxs($,{children:[e.jsx(g,{children:r.timestamp.toLocaleString()}),e.jsx(g,{children:e.jsx(k,{label:r.action,size:"small"})}),e.jsx(g,{children:r.actorEmail}),e.jsx(g,{children:r.targetMemberEmail}),e.jsxs(g,{children:[r.changes.length," changes"]})]},r.id))})]})}):e.jsx(p,{children:"No audit logs found."})]}),e.jsxs(X,{value:s,index:3,children:[e.jsx(p,{variant:"h5",gutterBottom:!0,children:"Team Member Templates"}),e.jsx(v,{container:!0,spacing:2,children:Xe.map(r=>e.jsx(v,{item:!0,xs:12,sm:6,md:4,children:e.jsx(U,{children:e.jsxs(Q,{children:[e.jsx(p,{variant:"h6",children:r.name}),e.jsx(p,{variant:"body2",color:"text.secondary",children:r.description}),e.jsxs(S,{sx:{mt:2},children:[e.jsx(k,{label:r.role,size:"small"}),e.jsx(k,{label:r.category,size:"small",sx:{ml:1}})]})]})})},r.id))})]}),e.jsxs(X,{value:s,index:4,children:[e.jsxs(S,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:[e.jsx(p,{variant:"h5",children:"Bulk Operations"}),e.jsx(C,{variant:"contained",startIcon:e.jsx(le,{}),onClick:()=>G(!0),children:"Create New Operation"})]}),Pe.length>0?e.jsx(ve,{component:ye,children:e.jsxs(we,{children:[e.jsx(Se,{children:e.jsxs($,{children:[e.jsx(g,{children:"Name"}),e.jsx(g,{children:"Description"}),e.jsx(g,{children:"Operation"}),e.jsx(g,{children:"Status"}),e.jsx(g,{children:"Progress"}),e.jsx(g,{children:"Created"}),e.jsx(g,{children:"Actions"})]})}),e.jsx(be,{children:Pe.map(r=>e.jsxs($,{children:[e.jsx(g,{children:e.jsx(p,{variant:"subtitle2",fontWeight:"medium",children:r.name})}),e.jsx(g,{children:e.jsx(p,{variant:"body2",color:"text.secondary",children:r.description})}),e.jsx(g,{children:e.jsx(k,{label:r.operation.replace("_"," "),size:"small",color:"primary",variant:"outlined"})}),e.jsx(g,{children:e.jsx(k,{label:r.status,color:r.status==="completed"?"success":r.status==="running"?"warning":r.status==="failed"?"error":"default",size:"small"})}),e.jsx(g,{children:e.jsxs(S,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(We,{variant:"determinate",value:r.progress,sx:{width:100},color:r.status==="completed"?"success":r.status==="failed"?"error":"primary"}),e.jsxs(p,{variant:"body2",children:[r.progress,"%"]})]})}),e.jsxs(g,{children:[e.jsx(p,{variant:"body2",children:r.createdAt.toLocaleDateString()}),e.jsx(p,{variant:"caption",color:"text.secondary",children:r.createdAt.toLocaleTimeString()})]}),e.jsx(g,{children:e.jsxs(S,{sx:{display:"flex",gap:.5,flexWrap:"wrap"},children:[r.status==="pending"&&e.jsx(C,{size:"small",variant:"contained",color:"primary",onClick:()=>ne(r),startIcon:e.jsx(Ge,{}),disabled:st.has(r.id),children:"Execute"}),r.status==="running"&&e.jsx(C,{size:"small",variant:"outlined",color:"warning",onClick:()=>ft(r),startIcon:e.jsx(Jt,{}),children:"Stop"}),r.status==="failed"&&e.jsx(C,{size:"small",variant:"outlined",color:"primary",onClick:()=>gt(r),startIcon:e.jsx(Yt,{}),children:"Retry"}),e.jsx(C,{size:"small",variant:"outlined",onClick:()=>ht(r),startIcon:e.jsx(Kt,{}),children:"Details"}),r.status==="pending"&&e.jsx(C,{size:"small",variant:"text",onClick:()=>pt(r),startIcon:e.jsx(Xt,{}),children:"Edit"}),(r.status==="completed"||r.status==="failed")&&e.jsx(C,{size:"small",variant:"text",color:"error",onClick:()=>mt(r),startIcon:e.jsx(Zt,{}),children:"Delete"})]})})]},r.id))})]})}):e.jsx(U,{children:e.jsxs(Q,{sx:{textAlign:"center",py:6},children:[e.jsx(le,{sx:{fontSize:64,color:"text.secondary",mb:2}}),e.jsx(p,{variant:"h6",gutterBottom:!0,children:"No Bulk Operations Found"}),e.jsx(p,{variant:"body2",color:"text.secondary",sx:{mb:3},children:"Create your first bulk operation to manage multiple team members at once."}),e.jsx(C,{variant:"contained",startIcon:e.jsx(le,{}),onClick:()=>G(!0),children:"Create New Operation"})]})})]})]}),e.jsxs(Ae,{open:Qe,onClose:()=>pe(!1),maxWidth:"md",fullWidth:!0,children:[e.jsx(Ce,{children:"Import Team Members from CSV"}),e.jsxs(Te,{children:[e.jsx(S,{sx:{mb:3},children:e.jsxs(C,{variant:"outlined",component:"label",startIcon:e.jsx(qt,{}),fullWidth:!0,children:["Choose CSV File",e.jsx("input",{type:"file",accept:".csv",hidden:!0,onChange:r=>{var f;const u=(f=r.target.files)==null?void 0:f[0];u&&ut(u)}})]})}),V&&e.jsxs(ge,{severity:V.success?"success":"warning",children:[e.jsxs(fe,{children:["Import ",V.success?"Successful":"Completed with Errors"]}),e.jsxs(p,{children:["Processed: ",V.totalRows," rows"]}),e.jsxs(p,{children:["Successful: ",V.successfulImports]}),e.jsxs(p,{children:["Failed: ",V.failedImports]})]})]}),e.jsx(Ie,{children:e.jsx(C,{onClick:()=>pe(!1),children:"Close"})})]}),e.jsxs(Ae,{open:He,onClose:()=>G(!1),maxWidth:"md",fullWidth:!0,children:[e.jsx(Ce,{children:"Create Bulk Operation"}),e.jsx(Te,{children:e.jsxs(S,{sx:{mt:2},children:[e.jsx(xe,{fullWidth:!0,label:"Operation Name",placeholder:"e.g., Update Engineering Team Roles",sx:{mb:2}}),e.jsx(xe,{fullWidth:!0,label:"Description",placeholder:"Describe what this operation will do",multiline:!0,rows:3,sx:{mb:2}}),e.jsxs(J,{fullWidth:!0,sx:{mb:2},children:[e.jsx(Y,{children:"Operation Type"}),e.jsxs(K,{label:"Operation Type",children:[e.jsx(M,{value:"update_role",children:"Update Roles"}),e.jsx(M,{value:"assign_license",children:"Assign Licenses"}),e.jsx(M,{value:"change_status",children:"Change Status"}),e.jsx(M,{value:"bulk_invite",children:"Bulk Invite"})]})]}),e.jsxs(ge,{severity:"info",sx:{mt:2},children:[e.jsx(fe,{children:"Bulk Operation Preview"}),"This operation will affect ",i.length," selected team members."]})]})}),e.jsxs(Ie,{children:[e.jsx(C,{onClick:()=>G(!1),children:"Cancel"}),e.jsx(C,{variant:"contained",onClick:()=>{const r=oe.createBulkOperation("Sample Bulk Operation","This is a sample bulk operation created from the UI","update_role",{roles:["member"]},"current-user");O(u=>[r,...u]),G(!1),j("Bulk operation created successfully",{variant:"success"})},children:"Create Operation"})]})]}),e.jsxs(Ae,{open:et,onClose:()=>te(!1),maxWidth:"md",fullWidth:!0,children:[e.jsx(Ce,{children:"Operation Details"}),e.jsx(Te,{children:w&&e.jsx(S,{sx:{mt:2},children:e.jsxs(v,{container:!0,spacing:3,children:[e.jsxs(v,{item:!0,xs:12,children:[e.jsx(p,{variant:"h6",gutterBottom:!0,children:w.name}),e.jsx(p,{variant:"body2",color:"text.secondary",sx:{mb:2},children:w.description})]}),e.jsxs(v,{item:!0,xs:12,md:6,children:[e.jsx(p,{variant:"subtitle2",gutterBottom:!0,children:"Operation Type"}),e.jsx(k,{label:w.operation.replace("_"," "),color:"primary",variant:"outlined"})]}),e.jsxs(v,{item:!0,xs:12,md:6,children:[e.jsx(p,{variant:"subtitle2",gutterBottom:!0,children:"Status"}),e.jsx(k,{label:w.status,color:w.status==="completed"?"success":w.status==="running"?"warning":w.status==="failed"?"error":"default"})]}),e.jsxs(v,{item:!0,xs:12,md:6,children:[e.jsx(p,{variant:"subtitle2",gutterBottom:!0,children:"Progress"}),e.jsxs(S,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(We,{variant:"determinate",value:w.progress,sx:{flex:1},color:w.status==="completed"?"success":w.status==="failed"?"error":"primary"}),e.jsxs(p,{variant:"body2",children:[w.progress,"%"]})]})]}),e.jsxs(v,{item:!0,xs:12,md:6,children:[e.jsx(p,{variant:"subtitle2",gutterBottom:!0,children:"Created"}),e.jsx(p,{variant:"body2",children:w.createdAt.toLocaleString()})]}),w.completedAt&&e.jsxs(v,{item:!0,xs:12,md:6,children:[e.jsx(p,{variant:"subtitle2",gutterBottom:!0,children:"Completed"}),e.jsx(p,{variant:"body2",children:w.completedAt.toLocaleString()})]}),e.jsxs(v,{item:!0,xs:12,md:6,children:[e.jsx(p,{variant:"subtitle2",gutterBottom:!0,children:"Created By"}),e.jsx(p,{variant:"body2",children:w.createdBy})]}),w.results&&e.jsxs(v,{item:!0,xs:12,children:[e.jsx(p,{variant:"subtitle2",gutterBottom:!0,children:"Results"}),e.jsx(U,{variant:"outlined",children:e.jsxs(Q,{children:[e.jsxs(v,{container:!0,spacing:2,children:[e.jsxs(v,{item:!0,xs:4,children:[e.jsx(p,{variant:"h6",color:"primary",children:w.results.totalProcessed}),e.jsx(p,{variant:"caption",children:"Total Processed"})]}),e.jsxs(v,{item:!0,xs:4,children:[e.jsx(p,{variant:"h6",color:"success.main",children:w.results.successful}),e.jsx(p,{variant:"caption",children:"Successful"})]}),e.jsxs(v,{item:!0,xs:4,children:[e.jsx(p,{variant:"h6",color:"error.main",children:w.results.failed}),e.jsx(p,{variant:"caption",children:"Failed"})]})]}),w.results.errors.length>0&&e.jsxs(S,{sx:{mt:2},children:[e.jsx(p,{variant:"subtitle2",gutterBottom:!0,children:"Errors"}),e.jsx(es,{dense:!0,children:w.results.errors.map((r,u)=>e.jsx(ts,{children:e.jsx(ss,{primary:r.memberId,secondary:r.error})},u))})]})]})})]}),e.jsxs(v,{item:!0,xs:12,children:[e.jsx(p,{variant:"subtitle2",gutterBottom:!0,children:"Criteria"}),e.jsx(U,{variant:"outlined",children:e.jsx(Q,{children:e.jsx("pre",{style:{margin:0,fontSize:"0.875rem"},children:JSON.stringify(w.criteria,null,2)})})})]})]})})}),e.jsxs(Ie,{children:[e.jsx(C,{onClick:()=>te(!1),children:"Close"}),w&&w.status==="pending"&&e.jsx(C,{variant:"contained",onClick:()=>{te(!1),ne(w)},startIcon:e.jsx(Ge,{}),children:"Execute Now"})]})]})]})};export{Ps as default};
