var zt=Object.defineProperty;var Ft=(g,s,t)=>s in g?zt(g,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):g[s]=t;var O=(g,s,t)=>Ft(g,typeof s!="symbol"?s+"":s,t);import{j as e,B as b,T as m,G as v,aR as Vt,d as ve,ai as ye,a as T,cd as Nt,ce as _t,c7 as Ut,al as Ye,p as $t,am as Wt,bP as Gt,t as G,aU as Ht,aV as Y,ab as Qt,aW as Jt,a6 as Yt,cf as ue,e as we,I as Kt,be as Xt,cg as Zt,bC as qt,bD as Se,ch as es,ci as ts,cj as ss,ck as as,v as K,ar as X,as as Z,at as q,M as C,aB as be,c as Ce,aC as Ae,aD as Te,aE as H,aF as x,l as Ke,aG as Ie,af as ns,r as L,g as is,aH as rs,cl as ls,C as cs,i as Xe,b8 as Ze,cm as os,R as ds,h as us,bO as qe,aO as et,aI as Me,aJ as De,aK as ke,cn as hs,aL as Le,w as ps,x as ms,z as gs,a5 as fs,y as ee,E as xs,u as js,L as vs,D as ys}from"./mui-DoW6Yw-n.js";import{r as p}from"./vendor-CjD1bmmO.js";import{u as ws}from"./notistack.esm-Ca-E78ev.js";import{b as Ss,c as bs,a as Cs,u as As,d as Ts,i as Is,j as Ms,k as Ds,g as ks,h as Ls,l as Os}from"./useStreamlinedData-D0Qf7uYr.js";import{M as he}from"./MetricCard-DiCbyu6H.js";import"./UnifiedDataService-oJ2208YH.js";import"./index-D8LWY4oJ.js";import"./stripe-8p04StgX.js";import"./index.esm-DdZh2hq1.js";import"./index.esm-Dkmm1Qng.js";import"./FirestoreCollectionManager-BboqllRY.js";import"./firebase-D4rALN9p.js";import"./index.esm-e-DuI42t.js";const z=class z{static getInstance(){return z.instance||(z.instance=new z),z.instance}async exportTeamMembers(s,t={}){const{includeInactive:n=!1,includePassword:a=!1,includeAuditInfo:i=!1,customFields:l=[]}=t;let d=s;n||(d=s.filter(o=>o.status==="active"));const h=["Email","First Name","Last Name","Role","Status","Department","Position","Phone","License Type","Organization ID","Created At","Last Active"];a&&h.splice(4,0,"Password"),i&&h.push("Created By","Updated At","Updated By"),l.forEach(o=>{h.includes(o)||h.push(o)});const c=d.map(o=>{const y=[o.email||"",o.firstName||"",o.lastName||"",o.role||"",o.status||"",o.department||"",o.position||"",o.phone||"",o.licenseType||"",o.organizationId||"",o.createdAt?new Date(o.createdAt).toISOString():"",o.lastActive?new Date(o.lastActive).toISOString():""];return a&&y.splice(4,0,o.password||""),i&&y.push(o.createdBy||"",o.updatedAt?new Date(o.updatedAt).toISOString():"",o.updatedBy||""),l.forEach(k=>{const I=o[k];y.push(typeof I=="string"?I:I?String(I):"")}),y});return[h.join(","),...c.map(o=>o.map(y=>typeof y=="string"&&y.includes(",")?`"${y.replace(/"/g,'""')}"`:y).join(","))].join(`
`)}async importTeamMembers(s,t,n){const a=s.split(`
`).filter(o=>o.trim());if(a.length<2)return{success:!1,totalRows:0,successfulImports:0,failedImports:0,errors:[{row:0,field:"general",value:"",error:"CSV file is empty or invalid"}],importedMembers:[]};const i=this.parseCSVLine(a[0]),l=a.slice(1),d=[],h=[],f=["Email","First Name","Last Name","Role"].filter(o=>!i.includes(o));if(f.length>0)return{success:!1,totalRows:l.length,successfulImports:0,failedImports:l.length,errors:[{row:0,field:"headers",value:f.join(", "),error:`Missing required headers: ${f.join(", ")}`}],importedMembers:[]};for(let o=0;o<l.length;o++){const y=l[o],k=this.parseCSVLine(y);n&&n(Math.round((o+1)/l.length*100));try{const I=this.validateAndCreateTeamMember(k,i,t,o+2);I&&h.push(I)}catch(I){d.push({row:o+2,field:"general",value:y,error:I instanceof Error?I.message:"Unknown error"})}}return{success:d.length===0,totalRows:l.length,successfulImports:h.length,failedImports:d.length,errors:d,importedMembers:h}}parseCSVLine(s){const t=[];let n="",a=!1;for(let i=0;i<s.length;i++){const l=s[i];l==='"'?a&&s[i+1]==='"'?(n+='"',i++):a=!a:l===","&&!a?(t.push(n.trim()),n=""):n+=l}return t.push(n.trim()),t}validateAndCreateTeamMember(s,t,n,a){var y,k,I,Q,se,me,ge,fe;const i=[],l={};t.forEach((ae,Fe)=>{l[ae.toLowerCase()]=s[Fe]||""});const d=(y=l.email)==null?void 0:y.trim(),h=(k=l["first name"])==null?void 0:k.trim(),c=(I=l["last name"])==null?void 0:I.trim(),f=(Q=l.role)==null?void 0:Q.trim();if(d?this.isValidEmail(d)||i.push({row:a,field:"email",value:d,error:"Invalid email format"}):i.push({row:a,field:"email",value:"",error:"Email is required"}),h||i.push({row:a,field:"first name",value:"",error:"First name is required"}),c||i.push({row:a,field:"last name",value:"",error:"Last name is required"}),f?["admin","member","viewer","owner"].includes(f.toLowerCase())||i.push({row:a,field:"role",value:f,error:"Invalid role. Must be admin, member, viewer, or owner"}):i.push({row:a,field:"role",value:"",error:"Role is required"}),i.length>0)throw new Error(`Validation errors: ${i.map(ae=>ae.error).join(", ")}`);return{id:"",email:d.toLowerCase(),firstName:h,lastName:c,role:f.toLowerCase(),status:"pending",organization:{id:n,name:"",tier:"BASIC"},organizationId:n,department:((se=l.department)==null?void 0:se.trim())||"",position:((me=l.position)==null?void 0:me.trim())||"",phone:((ge=l.phone)==null?void 0:ge.trim())||"",licenseType:((fe=l["license type"])==null?void 0:fe.trim())||"BASIC",assignedProjects:[],joinedAt:new Date,createdAt:new Date,updatedAt:new Date,lastActive:l["last active"]?new Date(l["last active"]):void 0}}isValidEmail(s){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(s)}downloadCSV(s,t="team-members.csv"){const n=new Blob([s],{type:"text/csv;charset=utf-8;"}),a=document.createElement("a"),i=URL.createObjectURL(n);a.setAttribute("href",i),a.setAttribute("download",t),a.style.visibility="hidden",document.body.appendChild(a),a.click(),document.body.removeChild(a)}generateTemplate(){const s=["Email","First Name","Last Name","Role","Status","Department","Position","Phone","License Type"],t=["john.doe@example.com","John","Doe","member","active","Engineering","Software Developer","+1-555-0123","PROFESSIONAL"];return[s.join(","),t.join(",")].join(`
`)}};O(z,"instance");let Be=z;const Oe=Be.getInstance(),F=class F{static getInstance(){return F.instance||(F.instance=new F),F.instance}filterTeamMembers(s,t,n,a){let i=[...s];t.search&&(i=this.applySearchFilter(i,t.search)),t.role&&t.role.length>0&&(i=i.filter(o=>t.role.includes(o.role))),t.status&&t.status.length>0&&(i=i.filter(o=>t.status.includes(o.status))),t.department&&t.department.length>0&&(i=i.filter(o=>o.department&&t.department.includes(o.department))),t.licenseType&&t.licenseType.length>0&&(i=i.filter(o=>o.licenseType&&t.licenseType.includes(o.licenseType))),t.dateRange&&(i=this.applyDateRangeFilter(i,t.dateRange)),t.hasLicense!==void 0&&(i=i.filter(o=>t.hasLicense?!!o.licenseType:!o.licenseType)),t.isActive!==void 0&&(i=i.filter(o=>t.isActive?o.status==="active":o.status!=="active")),t.customFields&&(i=this.applyCustomFieldFilters(i,t.customFields)),n&&(i=this.applySorting(i,n));const l=s.length,d=i.length;let h=i,c=!1,f={currentPage:1,totalPages:1,pageSize:d,totalItems:d};if(a){const o=(a.page-1)*a.pageSize,y=o+a.pageSize;h=i.slice(o,y),c=y<d,f={currentPage:a.page,totalPages:Math.ceil(d/a.pageSize),pageSize:a.pageSize,totalItems:d}}return{filteredMembers:h,totalCount:l,filteredCount:d,hasMore:c,pageInfo:f}}applySearchFilter(s,t){const n=t.toLowerCase();return s.filter(a=>[a.email,a.firstName,a.lastName,a.department,a.position,a.phone,a.role,a.status,a.licenseType].some(l=>l&&l.toLowerCase().includes(n)))}applyDateRangeFilter(s,t){return t?s.filter(n=>{const a=n[t.field];if(!a)return!1;const i=new Date(a),l=t.start?new Date(t.start):null,d=t.end?new Date(t.end):null;return!(l&&i<l||d&&i>d)}):s}applyCustomFieldFilters(s,t){return s.filter(n=>Object.entries(t).every(([a,i])=>{const l=n[a];return i==null?l===i:typeof i=="string"?l&&String(l).toLowerCase().includes(i.toLowerCase()):l===i}))}applySorting(s,t){return s.sort((n,a)=>{const i=n[t.field],l=a[t.field];if(i===void 0&&l===void 0)return 0;if(i===void 0)return t.direction==="asc"?1:-1;if(l===void 0)return t.direction==="asc"?-1:1;let d=0;return typeof i=="string"&&typeof l=="string"?d=i.localeCompare(l):i instanceof Date&&l instanceof Date?d=i.getTime()-l.getTime():typeof i=="number"&&typeof l=="number"?d=i-l:d=String(i).localeCompare(String(l)),t.direction==="asc"?d:-d})}getFilterOptions(s){const t=[...new Set(s.map(l=>l.role))].sort(),n=[...new Set(s.map(l=>l.status))].sort(),a=[...new Set(s.map(l=>l.department).filter(Boolean))].sort(),i=[...new Set(s.map(l=>l.licenseType).filter(Boolean))].sort();return{roles:t,statuses:n,departments:a,licenseTypes:i,totalMembers:s.length,activeMembers:s.filter(l=>l.status==="active").length,pendingMembers:s.filter(l=>l.status==="pending").length,licensedMembers:s.filter(l=>l.licenseType).length}}getQuickFilters(){return{all:{label:"All Members",criteria:{}},active:{label:"Active Members",criteria:{isActive:!0}},pending:{label:"Pending Invites",criteria:{status:["pending"]}},admins:{label:"Administrators",criteria:{role:["admin","owner"]}},licensed:{label:"Licensed Members",criteria:{hasLicense:!0}},recent:{label:"Recently Added",criteria:{dateRange:{field:"createdAt",start:new Date(Date.now()-30*24*60*60*1e3)}}}}}};O(F,"instance");let Ee=F;const Bs=Ee.getInstance(),V=class V{static getInstance(){return V.instance||(V.instance=new V),V.instance}generateAnalytics(s){return{overview:this.calculateOverviewStats(s),trends:this.calculateTrends(s),departmentBreakdown:this.calculateDepartmentStats(s),roleDistribution:this.calculateRoleDistribution(s),licenseUtilization:this.calculateLicenseStats(s),activityMetrics:this.calculateActivityMetrics(s),growthMetrics:this.calculateGrowthMetrics(s),topPerformers:this.identifyTopPerformers(s),recommendations:this.generateRecommendations(s)}}calculateOverviewStats(s){const t=s.length,n=s.filter(o=>o.status==="active").length,a=s.filter(o=>o.status==="pending").length,i=s.filter(o=>o.status==="suspended").length,l=s.filter(o=>o.licenseType&&o.licenseType!=="BASIC").length,d=t-l,h=s.map(o=>this.calculateActivityScore(o)),c=h.reduce((o,y)=>o+y,0)/h.length,f=this.calculateRetentionRate(s);return{totalMembers:t,activeMembers:n,pendingMembers:a,suspendedMembers:i,licensedMembers:l,unlicensedMembers:d,averageActivityScore:Math.round(c*100)/100,memberRetentionRate:Math.round(f*100)/100}}calculateTrends(s){const t=[],n=new Date;for(let a=11;a>=0;a--){const i=new Date(n.getFullYear(),n.getMonth()-a,1),l=new Date(n.getFullYear(),n.getMonth()-a+1,1),d=s.filter(f=>{const o=new Date(f.createdAt);return o>=i&&o<l}),h=s.filter(f=>{const o=f.lastActive?new Date(f.lastActive):null;return o&&o>=i&&o<l}),c=s.filter(f=>f.licenseType&&f.licenseType!=="BASIC"&&new Date(f.createdAt)<=l);t.push({period:i.toLocaleDateString("en-US",{month:"short",year:"numeric"}),membersAdded:d.length,membersRemoved:0,netGrowth:d.length,activeMembers:h.length,licenseUtilization:c.length})}return t}calculateDepartmentStats(s){const t=new Map;return s.forEach(n=>{const a=n.department||"Unassigned";t.has(a)||t.set(a,[]),t.get(a).push(n)}),Array.from(t.entries()).map(([n,a])=>{const i=a.filter(c=>c.status==="active").length,l=a.map(c=>this.calculateActivityScore(c)),d=l.reduce((c,f)=>c+f,0)/l.length,h=a.filter(c=>c.licenseType&&c.licenseType!=="BASIC").length;return{department:n,memberCount:a.length,activeMembers:i,averageActivityScore:Math.round(d*100)/100,licenseUtilization:Math.round(h/a.length*100),growthRate:0}}).sort((n,a)=>a.memberCount-n.memberCount)}calculateRoleDistribution(s){const t=new Map;s.forEach(a=>{t.has(a.role)||t.set(a.role,[]),t.get(a.role).push(a)});const n=s.length;return Array.from(t.entries()).map(([a,i])=>{const l=i.map(c=>this.calculateActivityScore(c)),d=l.reduce((c,f)=>c+f,0)/l.length,h=i.filter(c=>c.licenseType&&c.licenseType!=="BASIC").length;return{role:a,count:i.length,percentage:Math.round(i.length/n*100),averageActivityScore:Math.round(d*100)/100,licenseUtilization:Math.round(h/i.length*100)}}).sort((a,i)=>i.count-a.count)}calculateLicenseStats(s){const t=s.length,n=s.filter(d=>d.licenseType&&d.licenseType!=="BASIC").length,a=t-n,i=Math.round(n/t*100),l={};return s.forEach(d=>{d.licenseType&&(l[d.licenseType]=(l[d.licenseType]||0)+1)}),{totalLicenses:t,assignedLicenses:n,availableLicenses:a,utilizationRate:i,byType:l,projectedNeeds:Math.max(0,Math.ceil(t*.1))}}calculateActivityMetrics(s){const n=s.filter(c=>c.lastActive).map(c=>new Date(c.lastActive)),a=n.length>0?new Date(n.reduce((c,f)=>c+f.getTime(),0)/n.length):new Date,i=s.map(c=>({member:c,score:this.calculateActivityScore(c)})),l=i.sort((c,f)=>f.score-c.score).slice(0,5).map(c=>`${c.member.firstName} ${c.member.lastName}`),d=i.filter(c=>c.score<.3).map(c=>`${c.member.firstName} ${c.member.lastName}`),h={"High (0.8-1.0)":i.filter(c=>c.score>=.8).length,"Medium (0.5-0.8)":i.filter(c=>c.score>=.5&&c.score<.8).length,"Low (0.3-0.5)":i.filter(c=>c.score>=.3&&c.score<.5).length,"Inactive (0.0-0.3)":i.filter(c=>c.score<.3).length};return{averageLastActive:a,mostActiveMembers:l,inactiveMembers:d,activityScoreDistribution:h}}calculateGrowthMetrics(s){const t=new Date,n=new Date(t.getTime()-30*24*60*60*1e3);new Date(t.getTime()-90*24*60*60*1e3),new Date(t.getTime()-365*24*60*60*1e3);const a=s.filter(d=>new Date(d.createdAt)>=n).length,i=s.filter(d=>{const h=new Date(d.createdAt);return h>=new Date(n.getTime()-30*24*60*60*1e3)&&h<n}).length,l=i>0?(a-i)/i*100:0;return{monthlyGrowthRate:Math.round(l*100)/100,quarterlyGrowthRate:0,yearlyGrowthRate:0,projectedGrowth:Math.round(s.length*(l/100)),churnRate:0}}identifyTopPerformers(s){return s.map(t=>({memberId:t.id,name:`${t.firstName} ${t.lastName}`,email:t.email,score:this.calculateActivityScore(t),metrics:{activityScore:this.calculateActivityScore(t),projectCount:0,licenseUtilization:t.licenseType&&t.licenseType!=="BASIC"?1:0}})).sort((t,n)=>n.score-t.score).slice(0,10)}generateRecommendations(s){const t=[],n=this.calculateOverviewStats(s),a=Math.round(n.licensedMembers/n.totalMembers*100);return a<50&&t.push({type:"license",priority:"high",title:"Low License Utilization",description:`Only ${a}% of team members have licenses assigned.`,action:"Review license assignments and consider upgrading more members.",impact:"Improved productivity and feature access for team members."}),n.averageActivityScore<.5&&t.push({type:"activity",priority:"medium",title:"Low Team Activity",description:`Average activity score is ${n.averageActivityScore.toFixed(2)}.`,action:"Engage with inactive members and provide training.",impact:"Increased team engagement and productivity."}),n.totalMembers<10&&t.push({type:"growth",priority:"low",title:"Small Team Size",description:`Team has ${n.totalMembers} members. Consider expanding.`,action:"Invite more team members to scale operations.",impact:"Better resource distribution and team resilience."}),t}calculateActivityScore(s){let t=0;if(s.status==="active"&&(t+=.3),s.lastActive){const n=(Date.now()-new Date(s.lastActive).getTime())/864e5;n<7?t+=.4:n<30?t+=.2:n<90&&(t+=.1)}return s.licenseType&&s.licenseType!=="BASIC"&&(t+=.2),s.department&&s.position&&(t+=.1),Math.min(t,1)}calculateRetentionRate(s){const t=s.filter(a=>a.status==="active").length,n=s.length;return n>0?t/n:0}};O(V,"instance");let Re=V;const Es=Re.getInstance(),N=class N{constructor(){O(this,"auditLogs",[])}static getInstance(){return N.instance||(N.instance=new N),N.instance}logAction(s,t,n,a,i,l,d,h){const c={id:this.generateAuditId(),timestamp:new Date,action:s,actorId:t,actorEmail:n,targetMemberId:a,targetMemberEmail:i,changes:l,metadata:{...d,additionalContext:{...d.additionalContext,...h}}};this.auditLogs.push(c),console.log("🔍 [Audit] Team member action logged:",c)}logMemberCreation(s,t,n,a){const i=[{field:"email",oldValue:null,newValue:n.email,changeType:"added"},{field:"firstName",oldValue:null,newValue:n.firstName,changeType:"added"},{field:"lastName",oldValue:null,newValue:n.lastName,changeType:"added"},{field:"role",oldValue:null,newValue:n.role,changeType:"added"},{field:"status",oldValue:null,newValue:n.status,changeType:"added"}];this.logAction("member_created",s,t,n.id,n.email,i,a)}logMemberUpdate(s,t,n,a,i,l,d){const h=[];["firstName","lastName","email","role","status","department","position","phone","licenseType"].forEach(f=>{const o=i[f],y=l[f];o!==y&&h.push({field:f,oldValue:o,newValue:y,changeType:o===void 0?"added":y===void 0?"removed":"modified"})}),h.length>0&&this.logAction("member_updated",s,t,n,a,h,d)}logMemberDeletion(s,t,n,a){const i=[{field:"status",oldValue:n.status,newValue:"deleted",changeType:"modified"}];this.logAction("member_deleted",s,t,n.id,n.email,i,a)}logPasswordReset(s,t,n,a,i){const l=[{field:"password",oldValue:"[REDACTED]",newValue:"[RESET]",changeType:"modified"}];this.logAction("member_password_reset",s,t,n,a,l,i)}logLicenseAssignment(s,t,n,a,i,l,d){const h=[{field:"licenseType",oldValue:i||"BASIC",newValue:l,changeType:"modified"}];this.logAction("member_license_assigned",s,t,n,a,h,d)}logBulkOperation(s,t,n,a,i,l){const d=[{field:"bulk_operation",oldValue:null,newValue:n,changeType:"added"},{field:"affected_members",oldValue:null,newValue:a.length,changeType:"added"},...i];this.logAction("bulk_operation",s,t,a[0]||"multiple","multiple",d,l)}queryAuditLogs(s){let t=[...this.auditLogs];return s.memberId&&(t=t.filter(n=>n.targetMemberId===s.memberId)),s.actorId&&(t=t.filter(n=>n.actorId===s.actorId)),s.action&&(t=t.filter(n=>n.action===s.action)),s.startDate&&(t=t.filter(n=>n.timestamp>=s.startDate)),s.endDate&&(t=t.filter(n=>n.timestamp<=s.endDate)),s.organizationId&&(t=t.filter(n=>n.metadata.organizationId===s.organizationId)),t.sort((n,a)=>a.timestamp.getTime()-n.timestamp.getTime()),s.offset&&(t=t.slice(s.offset)),s.limit&&(t=t.slice(0,s.limit)),t}getAuditSummary(s,t=30){const n=new Date(Date.now()-t*24*60*60*1e3),a=this.auditLogs.filter(c=>c.metadata.organizationId===s&&c.timestamp>=n),i={};a.forEach(c=>{i[c.action]=(i[c.action]||0)+1});const l={};a.forEach(c=>{l[c.actorId]||(l[c.actorId]={actorEmail:c.actorEmail,count:0}),l[c.actorId].count++});const d=Object.entries(l).map(([c,f])=>({actorId:c,actorEmail:f.actorEmail,actionCount:f.count})).sort((c,f)=>f.actionCount-c.actionCount).slice(0,5),h=this.calculateComplianceScore(a);return{totalActions:a.length,actionsByType:i,recentActivity:a.slice(0,10),topActors:d,complianceScore:h}}calculateComplianceScore(s){if(s.length===0)return 100;let t=100;const n=s.filter(i=>i.action==="member_deleted"||i.action==="member_suspended"||i.action==="member_password_reset");t-=n.length*5;const a=s.filter(i=>i.action==="bulk_operation");return t-=a.length*2,Math.max(0,t)}generateAuditId(){return`audit_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}exportAuditLogs(s){const t=this.queryAuditLogs(s),n=["Timestamp","Action","Actor ID","Actor Email","Target Member ID","Target Member Email","Changes","Organization ID"],a=t.map(l=>[l.timestamp.toISOString(),l.action,l.actorId,l.actorEmail,l.targetMemberId,l.targetMemberEmail,JSON.stringify(l.changes),l.metadata.organizationId]);return[n.join(","),...a.map(l=>l.map(d=>typeof d=="string"&&d.includes(",")?`"${d.replace(/"/g,'""')}"`:d).join(","))].join(`
`)}};O(N,"instance");let Pe=N;const Rs=Pe.getInstance(),E=class E{constructor(){O(this,"templates",[]);O(this,"bulkOperations",[{id:"sample_1",name:"Update All Members to Professional License",description:"Upgrade all team members to Professional license type",operation:"assign_license",criteria:{roles:["member","admin"],statuses:["active"]},affectedMembers:[],status:"completed",progress:100,results:{totalProcessed:15,successful:15,failed:0,errors:[],details:{}},createdBy:"system",createdAt:new Date(Date.now()-2*24*60*60*1e3),completedAt:new Date(Date.now()-2*24*60*60*1e3)},{id:"sample_2",name:"Bulk Role Update - Engineering Team",description:"Update all engineering team members to admin role",operation:"update_role",criteria:{departments:["Engineering"],statuses:["active"]},affectedMembers:[],status:"pending",progress:0,results:{totalProcessed:0,successful:0,failed:0,errors:[],details:{}},createdBy:"system",createdAt:new Date(Date.now()-1*24*60*60*1e3)},{id:"sample_3",name:"Activate Pending Members",description:"Activate all pending team member invitations",operation:"change_status",criteria:{statuses:["pending"]},affectedMembers:[],status:"running",progress:60,results:{totalProcessed:5,successful:3,failed:0,errors:[],details:{}},createdBy:"system",createdAt:new Date(Date.now()-6*60*60*1e3)}])}static getInstance(){return E.instance||(E.instance=new E,E.instance.initializeDefaultTemplates()),E.instance}initializeDefaultTemplates(){this.templates=[{id:"executive_admin",name:"Executive Administrator",description:"Full administrative access with all permissions",category:"executive",industry:["all"],role:"admin",permissions:["manage_team","manage_licenses","manage_projects","view_analytics","manage_organization","audit_access"],defaultSettings:{department:"Executive",position:"Administrator",licenseType:"ENTERPRISE",status:"active"},isDefault:!0,isCustom:!1,createdAt:new Date,updatedAt:new Date},{id:"project_manager",name:"Project Manager",description:"Project management role with team coordination permissions",category:"management",industry:["all"],role:"member",permissions:["manage_projects","assign_team_members","view_analytics","manage_tasks"],defaultSettings:{department:"Project Management",position:"Project Manager",licenseType:"PROFESSIONAL",status:"active"},isDefault:!0,isCustom:!1,createdAt:new Date,updatedAt:new Date},{id:"software_developer",name:"Software Developer",description:"Technical role for software development teams",category:"technical",industry:["technology","software","it"],role:"member",permissions:["access_projects","manage_tasks","view_documentation"],defaultSettings:{department:"Engineering",position:"Software Developer",licenseType:"PROFESSIONAL",status:"active"},isDefault:!0,isCustom:!1,createdAt:new Date,updatedAt:new Date},{id:"creative_director",name:"Creative Director",description:"Creative leadership role for design and content teams",category:"creative",industry:["media","advertising","design","entertainment"],role:"member",permissions:["manage_creative_projects","approve_content","manage_assets","view_analytics"],defaultSettings:{department:"Creative",position:"Creative Director",licenseType:"PROFESSIONAL",status:"active"},isDefault:!0,isCustom:!1,createdAt:new Date,updatedAt:new Date},{id:"sales_representative",name:"Sales Representative",description:"Sales role with client management permissions",category:"sales",industry:["all"],role:"member",permissions:["manage_clients","view_sales_analytics","manage_opportunities"],defaultSettings:{department:"Sales",position:"Sales Representative",licenseType:"BASIC",status:"active"},isDefault:!0,isCustom:!1,createdAt:new Date,updatedAt:new Date},{id:"support_specialist",name:"Support Specialist",description:"Customer support role with limited access",category:"support",industry:["all"],role:"viewer",permissions:["view_tickets","manage_support_cases","view_documentation"],defaultSettings:{department:"Support",position:"Support Specialist",licenseType:"BASIC",status:"active"},isDefault:!0,isCustom:!1,createdAt:new Date,updatedAt:new Date}]}getTemplates(s,t){let n=[...this.templates];return s&&(n=n.filter(a=>a.category===s)),t&&(n=n.filter(a=>a.industry.includes("all")||a.industry.includes(t))),n.sort((a,i)=>a.name.localeCompare(i.name))}getTemplate(s){return this.templates.find(t=>t.id===s)}createTemplate(s,t){const n={...s,id:`custom_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,isDefault:!1,isCustom:!0,createdBy:t,createdAt:new Date,updatedAt:new Date};return this.templates.push(n),n}updateTemplate(s,t){const n=this.templates.findIndex(a=>a.id===s);return n===-1?!1:(this.templates[n]={...this.templates[n],...t,updatedAt:new Date},!0)}deleteTemplate(s){const t=this.templates.findIndex(n=>n.id===s);return t===-1||this.templates[t].isDefault?!1:(this.templates.splice(t,1),!0)}createMemberFromTemplate(s,t,n){const a=this.getTemplate(s);if(!a)throw new Error("Template not found");return{id:"",email:t.email||"",firstName:t.firstName||"",lastName:t.lastName||"",role:a.role,status:a.defaultSettings.status,organization:{id:n,name:"",tier:"BASIC"},organizationId:n,department:a.defaultSettings.department||t.department||"",position:a.defaultSettings.position||t.position||"",phone:t.phone||"",licenseType:a.defaultSettings.licenseType,assignedProjects:[],joinedAt:new Date,createdAt:new Date,updatedAt:new Date,...t,...a.defaultSettings.customFields}}createBulkOperation(s,t,n,a,i,l){const d={id:`bulk_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,name:s,description:t,operation:n,template:l?this.getTemplate(l):void 0,criteria:a,affectedMembers:[],status:"pending",progress:0,results:{totalProcessed:0,successful:0,failed:0,errors:[],details:{}},createdBy:i,createdAt:new Date};return this.bulkOperations.push(d),d}async executeBulkOperation(s,t,n){const a=this.bulkOperations.find(d=>d.id===s);if(!a)throw new Error("Bulk operation not found");a.status="running",a.progress=0;const i={totalProcessed:0,successful:0,failed:0,errors:[],details:{}},l=this.filterMembersByCriteria(t,a.criteria);a.affectedMembers=l.map(d=>d.id),i.totalProcessed=l.length;for(let d=0;d<l.length;d++){const h=l[d];try{switch(a.operation){case"create":i.details[h.id]="Created successfully",i.successful++;break;case"update":i.details[h.id]="Updated successfully",i.successful++;break;case"delete":i.details[h.id]="Deleted successfully",i.successful++;break;case"assign_license":i.details[h.id]="License assigned successfully",i.successful++;break;case"change_role":i.details[h.id]="Role changed successfully",i.successful++;break}}catch(c){i.failed++,i.errors.push({memberId:h.id,error:c instanceof Error?c.message:"Unknown error"}),i.details[h.id]="Failed"}a.progress=Math.round((d+1)/l.length*100),n&&n(a.progress)}return a.results=i,a.status=i.failed===0?"completed":"failed",a.completedAt=new Date,i}filterMembersByCriteria(s,t){let n=[...s];return t.memberIds&&t.memberIds.length>0&&(n=n.filter(a=>t.memberIds.includes(a.id))),t.roles&&t.roles.length>0&&(n=n.filter(a=>t.roles.includes(a.role))),t.departments&&t.departments.length>0&&(n=n.filter(a=>a.department&&t.departments.includes(a.department))),t.statuses&&t.statuses.length>0&&(n=n.filter(a=>t.statuses.includes(a.status))),t.licenseTypes&&t.licenseTypes.length>0&&(n=n.filter(a=>a.licenseType&&t.licenseTypes.includes(a.licenseType))),n}getBulkOperations(s){let t=[...this.bulkOperations];return s&&(t=t.filter(n=>n.createdBy===s)),t.sort((n,a)=>a.createdAt.getTime()-n.createdAt.getTime())}getBulkOperation(s){return this.bulkOperations.find(t=>t.id===s)}getCategories(){return["executive","management","technical","creative","support","sales","marketing","operations","custom"]}getIndustries(){return["technology","software","it","media","advertising","design","entertainment","finance","healthcare","education","retail","manufacturing","consulting","nonprofit","government","all"]}};O(E,"instance");let ze=E;const pe=ze.getInstance();function te(g){const{children:s,value:t,index:n,...a}=g;return e.jsx("div",{role:"tabpanel",hidden:t!==n,id:`team-tabpanel-${n}`,"aria-labelledby":`team-tab-${n}`,...a,children:t===n&&e.jsx(b,{sx:{p:3},children:s})})}const ea=()=>{var He,Qe,Je;const{enqueueSnackbar:g}=ws(),[s,t]=p.useState(0),[n,a]=p.useState([]),[i,l]=p.useState({}),[d,h]=p.useState({field:"createdAt",direction:"desc"}),[c,f]=p.useState({page:1,pageSize:25}),[o,y]=p.useState("table"),[k,I]=p.useState(""),[Q,se]=p.useState(!1),[me,ge]=p.useState(!1),[fe,ae]=p.useState(!1),[Fe,Ps]=p.useState(!1),[tt,J]=p.useState(!1),[st,xe]=p.useState(!1),[zs,Fs]=p.useState(!1),[at,nt]=p.useState(null),[Ve,it]=p.useState([]),[rt,lt]=p.useState([]),[Ne,B]=p.useState([]),[_,ct]=p.useState(null),[Vs,ne]=p.useState(!1),[ot,ie]=p.useState(!1),[w,dt]=p.useState(null),[ut,je]=p.useState(new Set),[_e,Ue]=p.useState(null),[D,R]=p.useState(null),{loading:ht,error:$e}=Ss(),{data:M,loading:pt,error:We}=bs(),{data:A,loading:mt,error:Ge,refetch:re}=Cs(),{data:le}=As();Ts(),Is(),Ms(),Ds(),ks(),Ls(),Os();const U=p.useMemo(()=>{if(!A)return[];const r={...i,search:k||void 0};return Bs.filterTeamMembers(A,r,d,c).filteredMembers},[A,i,k,d,c]),ce=p.useMemo(()=>{if(!A)return{totalMembers:0,activeMembers:0,pendingInvites:0,availableLicenses:0,totalLicenses:0,assignedLicenses:0};const r=A.length,u=A.filter(W=>W.status==="active").length,j=A.filter(W=>W.status==="pending").length,S=A.filter(W=>W.licenseType&&W.licenseType!=="BASIC").length,P=(le==null?void 0:le.length)||0,Pt=P-S;return{totalMembers:r,activeMembers:u,pendingInvites:j,availableLicenses:Pt,totalLicenses:P,assignedLicenses:S}},[A,le]),gt=p.useCallback(async()=>{if(A){ne(!0);try{const r=Es.generateAnalytics(A);nt(r)}catch(r){console.error("Failed to load analytics:",r),g("Failed to load analytics",{variant:"error"})}finally{ne(!1)}}},[A,g]),ft=p.useCallback(async()=>{var r;if((r=M==null?void 0:M.organization)!=null&&r.id){ne(!0);try{const u={organizationId:M.organization.id,limit:100},j=Rs.queryAuditLogs(u);it(j)}catch(u){console.error("Failed to load audit logs:",u),g("Failed to load audit logs",{variant:"error"})}finally{ne(!1)}}},[(He=M==null?void 0:M.organization)==null?void 0:He.id,g]),xt=p.useCallback(async()=>{try{const r=pe.getTemplates();lt(r)}catch(r){console.error("Failed to load templates:",r),g("Failed to load templates",{variant:"error"})}},[g]),jt=p.useCallback(async()=>{try{const r=pe.getBulkOperations();B(r)}catch(r){console.error("Failed to load bulk operations:",r),g("Failed to load bulk operations",{variant:"error"})}},[g]),vt=p.useCallback(async()=>{if(A)try{const r=await Oe.exportTeamMembers(A,{includeInactive:!0,includeAuditInfo:!0});Oe.downloadCSV(r,`team-members-${new Date().toISOString().split("T")[0]}.csv`),g("Team members exported successfully",{variant:"success"})}catch(r){console.error("Failed to export CSV:",r),g("Failed to export CSV",{variant:"error"})}},[A,g]),yt=p.useCallback(async r=>{var u;if((u=M==null?void 0:M.organization)!=null&&u.id)try{const j=await r.text(),S=await Oe.importTeamMembers(j,M.organization.id,P=>{});ct(S),S.success?(g(`Successfully imported ${S.successfulImports} team members`,{variant:"success"}),re()):g(`Import completed with ${S.failedImports} errors`,{variant:"warning"})}catch(j){console.error("Failed to import CSV:",j),g("Failed to import CSV",{variant:"error"})}},[(Qe=M==null?void 0:M.organization)==null?void 0:Qe.id,g,re]),oe=p.useCallback(async r=>{if(A){je(u=>new Set([...u,r.id]));try{const u=await pe.executeBulkOperation(r.id,A,j=>{B(S=>S.map(P=>P.id===r.id?{...P,progress:j}:P))});B(j=>j.map(S=>S.id===r.id?{...S,status:u.failed===0?"completed":"failed",progress:100,results:u,completedAt:new Date}:S)),g(`Bulk operation completed: ${u.successful} successful, ${u.failed} failed`,{variant:u.failed===0?"success":"warning"}),re()}catch(u){console.error("Failed to execute bulk operation:",u),B(j=>j.map(S=>S.id===r.id?{...S,status:"failed",progress:0}:S)),g("Failed to execute bulk operation",{variant:"error"})}finally{je(u=>{const j=new Set(u);return j.delete(r.id),j})}}},[A,g,re]),wt=p.useCallback(r=>{dt(r),ie(!0)},[]),St=p.useCallback(r=>{g("Edit functionality coming soon",{variant:"info"})},[g]),bt=p.useCallback(r=>{B(u=>u.filter(j=>j.id!==r.id)),g("Operation deleted successfully",{variant:"success"})},[g]),Ct=p.useCallback(r=>{B(u=>u.map(j=>j.id===r.id?{...j,status:"pending",progress:0,results:{totalProcessed:0,successful:0,failed:0,errors:[],details:{}}}:j)),oe(r)},[oe]),At=p.useCallback(r=>{B(u=>u.map(j=>j.id===r.id?{...j,status:"failed",progress:0}:j)),je(u=>{const j=new Set(u);return j.delete(r.id),j}),g("Operation stopped",{variant:"info"})},[g]),Tt=p.useCallback((r,u)=>{Ue(r.currentTarget),R(u)},[]),$=p.useCallback(()=>{Ue(null),R(null)},[]),It=p.useCallback(r=>{R(r),$(),g("Edit functionality coming soon",{variant:"info"})},[g]),Mt=p.useCallback(r=>{R(r),$(),g("Delete functionality coming soon",{variant:"info"})},[g]),Dt=p.useCallback(r=>{R(r),$(),g("License assignment coming soon",{variant:"info"})},[g]),kt=p.useCallback(r=>{R(r),$(),g("Password change coming soon",{variant:"info"})},[g]),Lt=p.useCallback(r=>{R(r),$(),g("Resend invite functionality coming soon",{variant:"info"})},[g]),Ot=(r,u)=>{switch(t(u),u){case 1:gt();break;case 2:ft();break;case 3:xt();break;case 4:jt();break}},Bt=(r,u)=>{a(u?j=>[...j,r]:j=>j.filter(S=>S!==r))},Et=r=>{a(r?U.map(u=>u.id):[])},de=r=>{l(r),f(u=>({...u,page:1}))},Rt=r=>{f(r)};return ht||pt||mt?e.jsxs(b,{sx:{p:3},children:[e.jsx(m,{variant:"h4",gutterBottom:!0,children:"Team Management"}),e.jsx(v,{container:!0,spacing:3,children:[1,2,3,4].map(r=>e.jsx(v,{item:!0,xs:12,sm:6,md:3,children:e.jsx(Vt,{variant:"rectangular",height:120})},r))})]}):$e||We||Ge?e.jsx(b,{sx:{p:3},children:e.jsxs(ve,{severity:"error",children:[e.jsx(ye,{children:"Error Loading Team Data"}),$e||We||Ge||"Unknown error occurred"]})}):e.jsxs(b,{sx:{p:3},children:[e.jsxs(b,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:[e.jsx(m,{variant:"h4",component:"h1",children:"Team Management"}),e.jsxs(b,{sx:{display:"flex",gap:1},children:[e.jsx(T,{variant:"outlined",startIcon:e.jsx(Nt,{}),onClick:vt,children:"Export CSV"}),e.jsx(T,{variant:"outlined",startIcon:e.jsx(_t,{}),onClick:()=>xe(!0),children:"Import CSV"}),e.jsx(T,{variant:"contained",startIcon:e.jsx(Ut,{}),onClick:()=>{},children:"Invite Member"})]})]}),e.jsxs(v,{container:!0,spacing:3,sx:{mb:3},children:[e.jsx(v,{item:!0,xs:12,sm:6,md:3,children:e.jsx(he,{title:"Total Members",value:ce.totalMembers,icon:e.jsx(Ye,{}),color:"primary"})}),e.jsx(v,{item:!0,xs:12,sm:6,md:3,children:e.jsx(he,{title:"Active Members",value:ce.activeMembers,icon:e.jsx($t,{}),color:"success"})}),e.jsx(v,{item:!0,xs:12,sm:6,md:3,children:e.jsx(he,{title:"Pending Invites",value:ce.pendingInvites,icon:e.jsx(Wt,{}),color:"warning"})}),e.jsx(v,{item:!0,xs:12,sm:6,md:3,children:e.jsx(he,{title:"Available Licenses",value:ce.availableLicenses,icon:e.jsx(Gt,{}),color:"primary"})})]}),e.jsxs(G,{children:[e.jsx(b,{sx:{borderBottom:1,borderColor:"divider"},children:e.jsxs(Ht,{value:s,onChange:Ot,"aria-label":"team management tabs",children:[e.jsx(Y,{label:"Team Members",icon:e.jsx(Ye,{})}),e.jsx(Y,{label:"Analytics",icon:e.jsx(Qt,{})}),e.jsx(Y,{label:"Audit Trail",icon:e.jsx(Jt,{})}),e.jsx(Y,{label:"Templates",icon:e.jsx(Yt,{})}),e.jsx(Y,{label:"Bulk Operations",icon:e.jsx(ue,{})})]})}),e.jsxs(te,{value:s,index:0,children:[e.jsxs(b,{sx:{display:"flex",gap:2,mb:3,alignItems:"center"},children:[e.jsx(we,{fullWidth:!0,placeholder:"Search team members...",value:k,onChange:r=>I(r.target.value),InputProps:{startAdornment:e.jsx(Kt,{position:"start",children:e.jsx(Xt,{})})}}),e.jsx(T,{variant:"outlined",startIcon:e.jsx(Zt,{}),onClick:()=>se(!Q),children:"Filters"}),e.jsxs(qt,{value:o,exclusive:!0,onChange:(r,u)=>u&&y(u),size:"small",children:[e.jsx(Se,{value:"table",children:e.jsx(es,{})}),e.jsx(Se,{value:"grid",children:e.jsx(ts,{})}),e.jsx(Se,{value:"list",children:e.jsx(ss,{})})]})]}),Q&&e.jsxs(G,{sx:{mb:3},children:[e.jsx(as,{title:"Advanced Filters"}),e.jsx(K,{children:e.jsxs(v,{container:!0,spacing:2,children:[e.jsx(v,{item:!0,xs:12,sm:6,md:3,children:e.jsxs(X,{fullWidth:!0,children:[e.jsx(Z,{children:"Role"}),e.jsxs(q,{multiple:!0,value:i.role||[],onChange:r=>de({...i,role:r.target.value}),children:[e.jsx(C,{value:"admin",children:"Admin"}),e.jsx(C,{value:"member",children:"Member"}),e.jsx(C,{value:"viewer",children:"Viewer"}),e.jsx(C,{value:"owner",children:"Owner"})]})]})}),e.jsx(v,{item:!0,xs:12,sm:6,md:3,children:e.jsxs(X,{fullWidth:!0,children:[e.jsx(Z,{children:"Status"}),e.jsxs(q,{multiple:!0,value:i.status||[],onChange:r=>de({...i,status:r.target.value}),children:[e.jsx(C,{value:"active",children:"Active"}),e.jsx(C,{value:"pending",children:"Pending"}),e.jsx(C,{value:"suspended",children:"Suspended"})]})]})}),e.jsx(v,{item:!0,xs:12,sm:6,md:3,children:e.jsxs(X,{fullWidth:!0,children:[e.jsx(Z,{children:"Department"}),e.jsx(q,{multiple:!0,value:i.department||[],onChange:r=>de({...i,department:r.target.value})})]})}),e.jsx(v,{item:!0,xs:12,sm:6,md:3,children:e.jsxs(X,{fullWidth:!0,children:[e.jsx(Z,{children:"License Type"}),e.jsxs(q,{multiple:!0,value:i.licenseType||[],onChange:r=>de({...i,licenseType:r.target.value}),children:[e.jsx(C,{value:"BASIC",children:"Basic"}),e.jsx(C,{value:"PROFESSIONAL",children:"Professional"}),e.jsx(C,{value:"ENTERPRISE",children:"Enterprise"})]})]})})]})})]}),e.jsx(be,{component:Ce,children:e.jsxs(Ae,{children:[e.jsx(Te,{children:e.jsxs(H,{children:[e.jsx(x,{padding:"checkbox",children:e.jsx(Ke,{indeterminate:n.length>0&&n.length<U.length,checked:U.length>0&&n.length===U.length,onChange:r=>Et(r.target.checked)})}),e.jsx(x,{children:"Member"}),e.jsx(x,{children:"Role"}),e.jsx(x,{children:"Status"}),e.jsx(x,{children:"Department"}),e.jsx(x,{children:"License"}),e.jsx(x,{children:"Last Active"}),e.jsx(x,{children:"Actions"})]})}),e.jsx(Ie,{children:U.map(r=>{var u,j;return e.jsxs(H,{children:[e.jsx(x,{padding:"checkbox",children:e.jsx(Ke,{checked:n.includes(r.id),onChange:S=>Bt(r.id,S.target.checked)})}),e.jsx(x,{children:e.jsxs(b,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsxs(ns,{children:[(u=r.firstName)==null?void 0:u[0],(j=r.lastName)==null?void 0:j[0]]}),e.jsxs(b,{children:[e.jsxs(m,{variant:"subtitle2",children:[r.firstName," ",r.lastName]}),e.jsx(m,{variant:"body2",color:"text.secondary",children:r.email})]})]})}),e.jsx(x,{children:e.jsx(L,{label:r.role,color:r.role==="admin"?"primary":"default",size:"small"})}),e.jsx(x,{children:e.jsx(L,{label:r.status,color:r.status==="active"?"success":"default",size:"small"})}),e.jsx(x,{children:r.department||"-"}),e.jsx(x,{children:r.licenseType?e.jsx(L,{label:r.licenseType,color:"info",size:"small"}):"-"}),e.jsx(x,{children:r.lastActive?new Date(r.lastActive).toLocaleDateString():"-"}),e.jsx(x,{children:e.jsx(is,{size:"small",onClick:S=>Tt(S,r),children:e.jsx(rs,{})})})]},r.id)})})]})}),e.jsx(b,{sx:{display:"flex",justifyContent:"center",mt:3},children:e.jsx(ls,{count:Math.ceil(U.length/c.pageSize),page:c.page,onChange:(r,u)=>Rt({...c,page:u}),color:"primary"})})]}),e.jsx(te,{value:s,index:1,children:at?e.jsxs(b,{children:[e.jsx(m,{variant:"h5",gutterBottom:!0,children:"Team Analytics"}),e.jsx(m,{children:"Analytics dashboard coming soon..."})]}):e.jsxs(b,{sx:{textAlign:"center",py:4},children:[e.jsx(cs,{}),e.jsx(m,{variant:"body1",sx:{mt:2},children:"Loading analytics..."})]})}),e.jsxs(te,{value:s,index:2,children:[e.jsx(m,{variant:"h5",gutterBottom:!0,children:"Audit Trail"}),Ve.length>0?e.jsx(be,{component:Ce,children:e.jsxs(Ae,{children:[e.jsx(Te,{children:e.jsxs(H,{children:[e.jsx(x,{children:"Timestamp"}),e.jsx(x,{children:"Action"}),e.jsx(x,{children:"Actor"}),e.jsx(x,{children:"Target"}),e.jsx(x,{children:"Changes"})]})}),e.jsx(Ie,{children:Ve.map(r=>e.jsxs(H,{children:[e.jsx(x,{children:r.timestamp.toLocaleString()}),e.jsx(x,{children:e.jsx(L,{label:r.action,size:"small"})}),e.jsx(x,{children:r.actorEmail}),e.jsx(x,{children:r.targetMemberEmail}),e.jsxs(x,{children:[r.changes.length," changes"]})]},r.id))})]})}):e.jsx(m,{children:"No audit logs found."})]}),e.jsxs(te,{value:s,index:3,children:[e.jsx(m,{variant:"h5",gutterBottom:!0,children:"Team Member Templates"}),e.jsx(v,{container:!0,spacing:2,children:rt.map(r=>e.jsx(v,{item:!0,xs:12,sm:6,md:4,children:e.jsx(G,{children:e.jsxs(K,{children:[e.jsx(m,{variant:"h6",children:r.name}),e.jsx(m,{variant:"body2",color:"text.secondary",children:r.description}),e.jsxs(b,{sx:{mt:2},children:[e.jsx(L,{label:r.role,size:"small"}),e.jsx(L,{label:r.category,size:"small",sx:{ml:1}})]})]})})},r.id))})]}),e.jsxs(te,{value:s,index:4,children:[e.jsxs(b,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:[e.jsx(m,{variant:"h5",children:"Bulk Operations"}),e.jsx(T,{variant:"contained",startIcon:e.jsx(ue,{}),onClick:()=>J(!0),children:"Create New Operation"})]}),Ne.length>0?e.jsx(be,{component:Ce,children:e.jsxs(Ae,{children:[e.jsx(Te,{children:e.jsxs(H,{children:[e.jsx(x,{children:"Name"}),e.jsx(x,{children:"Description"}),e.jsx(x,{children:"Operation"}),e.jsx(x,{children:"Status"}),e.jsx(x,{children:"Progress"}),e.jsx(x,{children:"Created"}),e.jsx(x,{children:"Actions"})]})}),e.jsx(Ie,{children:Ne.map(r=>e.jsxs(H,{children:[e.jsx(x,{children:e.jsx(m,{variant:"subtitle2",fontWeight:"medium",children:r.name})}),e.jsx(x,{children:e.jsx(m,{variant:"body2",color:"text.secondary",children:r.description})}),e.jsx(x,{children:e.jsx(L,{label:r.operation.replace("_"," "),size:"small",color:"primary",variant:"outlined"})}),e.jsx(x,{children:e.jsx(L,{label:r.status,color:r.status==="completed"?"success":r.status==="running"?"warning":r.status==="failed"?"error":"default",size:"small"})}),e.jsx(x,{children:e.jsxs(b,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(Xe,{variant:"determinate",value:r.progress,sx:{width:100},color:r.status==="completed"?"success":r.status==="failed"?"error":"primary"}),e.jsxs(m,{variant:"body2",children:[r.progress,"%"]})]})}),e.jsxs(x,{children:[e.jsx(m,{variant:"body2",children:r.createdAt.toLocaleDateString()}),e.jsx(m,{variant:"caption",color:"text.secondary",children:r.createdAt.toLocaleTimeString()})]}),e.jsx(x,{children:e.jsxs(b,{sx:{display:"flex",gap:.5,flexWrap:"wrap"},children:[r.status==="pending"&&e.jsx(T,{size:"small",variant:"contained",color:"primary",onClick:()=>oe(r),startIcon:e.jsx(Ze,{}),disabled:ut.has(r.id),children:"Execute"}),r.status==="running"&&e.jsx(T,{size:"small",variant:"outlined",color:"warning",onClick:()=>At(r),startIcon:e.jsx(os,{}),children:"Stop"}),r.status==="failed"&&e.jsx(T,{size:"small",variant:"outlined",color:"primary",onClick:()=>Ct(r),startIcon:e.jsx(ds,{}),children:"Retry"}),e.jsx(T,{size:"small",variant:"outlined",onClick:()=>wt(r),startIcon:e.jsx(us,{}),children:"Details"}),r.status==="pending"&&e.jsx(T,{size:"small",variant:"text",onClick:()=>St(r),startIcon:e.jsx(qe,{}),children:"Edit"}),(r.status==="completed"||r.status==="failed")&&e.jsx(T,{size:"small",variant:"text",color:"error",onClick:()=>bt(r),startIcon:e.jsx(et,{}),children:"Delete"})]})})]},r.id))})]})}):e.jsx(G,{children:e.jsxs(K,{sx:{textAlign:"center",py:6},children:[e.jsx(ue,{sx:{fontSize:64,color:"text.secondary",mb:2}}),e.jsx(m,{variant:"h6",gutterBottom:!0,children:"No Bulk Operations Found"}),e.jsx(m,{variant:"body2",color:"text.secondary",sx:{mb:3},children:"Create your first bulk operation to manage multiple team members at once."}),e.jsx(T,{variant:"contained",startIcon:e.jsx(ue,{}),onClick:()=>J(!0),children:"Create New Operation"})]})})]})]}),e.jsxs(Me,{open:st,onClose:()=>xe(!1),maxWidth:"md",fullWidth:!0,children:[e.jsx(De,{children:"Import Team Members from CSV"}),e.jsxs(ke,{children:[e.jsx(b,{sx:{mb:3},children:e.jsxs(T,{variant:"outlined",component:"label",startIcon:e.jsx(hs,{}),fullWidth:!0,children:["Choose CSV File",e.jsx("input",{type:"file",accept:".csv",hidden:!0,onChange:r=>{var j;const u=(j=r.target.files)==null?void 0:j[0];u&&yt(u)}})]})}),_&&e.jsxs(ve,{severity:_.success?"success":"warning",children:[e.jsxs(ye,{children:["Import ",_.success?"Successful":"Completed with Errors"]}),e.jsxs(m,{children:["Processed: ",_.totalRows," rows"]}),e.jsxs(m,{children:["Successful: ",_.successfulImports]}),e.jsxs(m,{children:["Failed: ",_.failedImports]})]})]}),e.jsx(Le,{children:e.jsx(T,{onClick:()=>xe(!1),children:"Close"})})]}),e.jsxs(Me,{open:tt,onClose:()=>J(!1),maxWidth:"md",fullWidth:!0,children:[e.jsx(De,{children:"Create Bulk Operation"}),e.jsx(ke,{children:e.jsxs(b,{sx:{mt:2},children:[e.jsx(we,{fullWidth:!0,label:"Operation Name",placeholder:"e.g., Update Engineering Team Roles",sx:{mb:2}}),e.jsx(we,{fullWidth:!0,label:"Description",placeholder:"Describe what this operation will do",multiline:!0,rows:3,sx:{mb:2}}),e.jsxs(X,{fullWidth:!0,sx:{mb:2},children:[e.jsx(Z,{children:"Operation Type"}),e.jsxs(q,{label:"Operation Type",children:[e.jsx(C,{value:"update_role",children:"Update Roles"}),e.jsx(C,{value:"assign_license",children:"Assign Licenses"}),e.jsx(C,{value:"change_status",children:"Change Status"}),e.jsx(C,{value:"bulk_invite",children:"Bulk Invite"})]})]}),e.jsxs(ve,{severity:"info",sx:{mt:2},children:[e.jsx(ye,{children:"Bulk Operation Preview"}),"This operation will affect ",n.length," selected team members."]})]})}),e.jsxs(Le,{children:[e.jsx(T,{onClick:()=>J(!1),children:"Cancel"}),e.jsx(T,{variant:"contained",onClick:()=>{const r=pe.createBulkOperation("Sample Bulk Operation","This is a sample bulk operation created from the UI","update_role",{roles:["member"]},"current-user");B(u=>[r,...u]),J(!1),g("Bulk operation created successfully",{variant:"success"})},children:"Create Operation"})]})]}),e.jsxs(Me,{open:ot,onClose:()=>ie(!1),maxWidth:"md",fullWidth:!0,children:[e.jsx(De,{children:"Operation Details"}),e.jsx(ke,{children:w&&e.jsx(b,{sx:{mt:2},children:e.jsxs(v,{container:!0,spacing:3,children:[e.jsxs(v,{item:!0,xs:12,children:[e.jsx(m,{variant:"h6",gutterBottom:!0,children:w.name}),e.jsx(m,{variant:"body2",color:"text.secondary",sx:{mb:2},children:w.description})]}),e.jsxs(v,{item:!0,xs:12,md:6,children:[e.jsx(m,{variant:"subtitle2",gutterBottom:!0,children:"Operation Type"}),e.jsx(L,{label:w.operation.replace("_"," "),color:"primary",variant:"outlined"})]}),e.jsxs(v,{item:!0,xs:12,md:6,children:[e.jsx(m,{variant:"subtitle2",gutterBottom:!0,children:"Status"}),e.jsx(L,{label:w.status,color:w.status==="completed"?"success":w.status==="running"?"warning":w.status==="failed"?"error":"default"})]}),e.jsxs(v,{item:!0,xs:12,md:6,children:[e.jsx(m,{variant:"subtitle2",gutterBottom:!0,children:"Progress"}),e.jsxs(b,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(Xe,{variant:"determinate",value:w.progress,sx:{flex:1},color:w.status==="completed"?"success":w.status==="failed"?"error":"primary"}),e.jsxs(m,{variant:"body2",children:[w.progress,"%"]})]})]}),e.jsxs(v,{item:!0,xs:12,md:6,children:[e.jsx(m,{variant:"subtitle2",gutterBottom:!0,children:"Created"}),e.jsx(m,{variant:"body2",children:w.createdAt.toLocaleString()})]}),w.completedAt&&e.jsxs(v,{item:!0,xs:12,md:6,children:[e.jsx(m,{variant:"subtitle2",gutterBottom:!0,children:"Completed"}),e.jsx(m,{variant:"body2",children:w.completedAt.toLocaleString()})]}),e.jsxs(v,{item:!0,xs:12,md:6,children:[e.jsx(m,{variant:"subtitle2",gutterBottom:!0,children:"Created By"}),e.jsx(m,{variant:"body2",children:w.createdBy})]}),w.results&&e.jsxs(v,{item:!0,xs:12,children:[e.jsx(m,{variant:"subtitle2",gutterBottom:!0,children:"Results"}),e.jsx(G,{variant:"outlined",children:e.jsxs(K,{children:[e.jsxs(v,{container:!0,spacing:2,children:[e.jsxs(v,{item:!0,xs:4,children:[e.jsx(m,{variant:"h6",color:"primary",children:w.results.totalProcessed}),e.jsx(m,{variant:"caption",children:"Total Processed"})]}),e.jsxs(v,{item:!0,xs:4,children:[e.jsx(m,{variant:"h6",color:"success.main",children:w.results.successful}),e.jsx(m,{variant:"caption",children:"Successful"})]}),e.jsxs(v,{item:!0,xs:4,children:[e.jsx(m,{variant:"h6",color:"error.main",children:w.results.failed}),e.jsx(m,{variant:"caption",children:"Failed"})]})]}),w.results.errors.length>0&&e.jsxs(b,{sx:{mt:2},children:[e.jsx(m,{variant:"subtitle2",gutterBottom:!0,children:"Errors"}),e.jsx(ps,{dense:!0,children:w.results.errors.map((r,u)=>e.jsx(ms,{children:e.jsx(gs,{primary:r.memberId,secondary:r.error})},u))})]})]})})]}),e.jsxs(v,{item:!0,xs:12,children:[e.jsx(m,{variant:"subtitle2",gutterBottom:!0,children:"Criteria"}),e.jsx(G,{variant:"outlined",children:e.jsx(K,{children:e.jsx("pre",{style:{margin:0,fontSize:"0.875rem"},children:JSON.stringify(w.criteria,null,2)})})})]})]})})}),e.jsxs(Le,{children:[e.jsx(T,{onClick:()=>ie(!1),children:"Close"}),w&&w.status==="pending"&&e.jsx(T,{variant:"contained",onClick:()=>{ie(!1),oe(w)},startIcon:e.jsx(Ze,{}),children:"Execute Now"})]})]}),e.jsxs(fs,{anchorEl:_e,open:!!_e,onClose:$,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},children:[e.jsxs(C,{onClick:()=>D&&It(D),children:[e.jsx(ee,{children:e.jsx(qe,{})}),"Edit Member"]}),((Je=D==null?void 0:D.status)==null?void 0:Je.toLowerCase())==="pending"&&e.jsxs(C,{onClick:()=>D&&Lt(D),children:[e.jsx(ee,{children:e.jsx(xs,{})}),"Resend Invite"]}),e.jsxs(C,{onClick:()=>D&&Dt(D),children:[e.jsx(ee,{children:e.jsx(js,{})}),"Assign License"]}),e.jsxs(C,{onClick:()=>D&&kt(D),children:[e.jsx(ee,{children:e.jsx(vs,{})}),"Change Password"]}),e.jsx(ys,{}),e.jsxs(C,{onClick:()=>D&&Mt(D),sx:{color:"error.main"},children:[e.jsx(ee,{children:e.jsx(et,{sx:{color:"error.main"}})}),"Remove Member"]})]})]})};export{ea as default};
