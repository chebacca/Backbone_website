const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/UnifiedDataService-Wpcn--aO.js","assets/index-Bbjr1I9O.js","assets/mui-D_3t3Wff.js","assets/vendor-CjD1bmmO.js","assets/stripe-DQqYxQf-.js","assets/index-CBai7h7s.css","assets/index.esm-B4qVkIPL.js","assets/index.esm-DmQE6AXN.js"])))=>i.map(i=>d[i]);
import{_ as xs}from"./index-Bbjr1I9O.js";import{j as e,B as a,C as hs,T as n,d as C,ai as ee,w as us,x as Ie,y as S,aj as re,z as we,H as js,a as v,ap as Se,G as P,ae as Fe,p as k,am as U,al as Ee,t as Ae,v as De,i as Te,af as Ne,aq as gs,ar as ms,as as ps,at as We,au as o,av as fs,r as se,u as Pe,ag as ne,g as vs,aw as ys,ax as bs,ay as M,az as G,aA as _,aB as V,aC as q,aD as K,aE as H,a5 as c,e as p,aF as X,aG as te,aH as ke,aI as ae,I as y,aJ as le,aK as Ue,E as Ls,X as Re,aL as Cs,a4 as Is,aM as ws,D as Oe}from"./mui-D_3t3Wff.js";import{r as h}from"./vendor-CjD1bmmO.js";import{u as Ss}from"./notistack.esm-Ca-E78ev.js";import{b as Es,c as As,u as Ds,a as Ts,d as Ns,e as Ws,f as Ps,g as ks}from"./useStreamlinedData-CYLJUzJq.js";import{M as J}from"./MetricCard-CmTmSA-Z.js";import"./stripe-DQqYxQf-.js";import"./UnifiedDataService-Wpcn--aO.js";import"./index.esm-B4qVkIPL.js";import"./index.esm-DmQE6AXN.js";const Us=i=>{switch(i){case"ACTIVE":return"success";case"PENDING":return"warning";case"SUSPENDED":return"error";case"EXPIRED":return"default";default:return"default"}},Rs=i=>{switch(i){case"ACTIVE":return e.jsx(k,{});case"PENDING":return e.jsx(U,{});case"SUSPENDED":return e.jsx(le,{});case"EXPIRED":return e.jsx(re,{});default:return e.jsx(Fe,{})}},Os=i=>{switch(i){case"BASIC":return"default";case"PROFESSIONAL":return"primary";case"ENTERPRISE":return"secondary";default:return"default"}},zs=()=>{const i=[];for(let r=0;r<4;r++)i.push(Math.random().toString(36).substr(2,4).toUpperCase());return`BL14-${i.join("-")}`},oe=(i,r)=>{if(!i)return"Unassigned";if(r&&i.email){const d=r.find(I=>I.email.toLowerCase()===i.email.toLowerCase());if(d){if(d.firstName&&d.lastName)return`${d.firstName} ${d.lastName}`;if(d.firstName)return d.firstName;if(d.lastName)return d.lastName}}return i.name&&i.name!=="Unknown User"?i.name:i.email?i.email.split("@")[0].replace(/[._-]/g," ").split(" ").map(E=>E.charAt(0).toUpperCase()+E.slice(1).toLowerCase()).join(" "):"Unknown User"},ze=(i,r)=>{if(!i)return"?";const d=oe(i,r);if(d==="Unassigned"||d==="Unknown User")return"?";const I=d.split(" ");return I.length>=2?(I[0].charAt(0)+I[1].charAt(0)).toUpperCase():d.charAt(0).toUpperCase()},ie=i=>i.firstName&&i.lastName?`${i.firstName} ${i.lastName}`:i.firstName?i.firstName:i.lastName?i.lastName:i.email.split("@")[0],Ys=()=>{var be,Le,Ce;const{enqueueSnackbar:i}=Ss(),{data:r,loading:d,error:I}=Es(),{data:E,loading:$e,error:Be}=As(),{data:g,loading:Me,error:Ge,refetch:b}=Ds(),{data:u,loading:_e,error:Ve}=Ts(),qe=Ns(),Y=Ws(),Ke=Ps();ks();const[He,T]=h.useState(!1),[Xe,R]=h.useState(!1),[Je,O]=h.useState(!1),[Ye,z]=h.useState(!1),[t,N]=h.useState(null),[ce,de]=h.useState(null),[Fs,$s]=h.useState(""),[F,xe]=h.useState(""),[w,he]=h.useState("PROFESSIONAL"),[L,ue]=h.useState(1),[je,ge]=h.useState(""),[Q,me]=h.useState("PROFESSIONAL"),[pe,fe]=h.useState("PENDING"),[ve,ye]=h.useState(""),Qe=d||$e||Me||_e,Ze=I||Be||Ge||Ve;h.useEffect(()=>{const s=async l=>{var x;const m=l;console.log("🔄 License refresh event received:",m.detail),((x=m.detail)==null?void 0:x.action)==="created"&&await b()};return window.addEventListener("licenses:refresh",s),()=>{window.removeEventListener("licenses:refresh",s)}},[b]);const f=h.useMemo(()=>{if(!r||!E||!g)return{licenses:[],stats:{totalLicenses:0,activeLicenses:0,expiringSoon:0,unassignedLicenses:0,utilizationRate:0}};const s=g.length,l=g.filter(D=>D.status==="ACTIVE").length,m=g.filter(D=>{const B=new Date(D.expiresAt),Z=new Date(Date.now()+30*24*60*60*1e3);return B<=Z}).length,x=g.filter(D=>!D.assignedTo).length,j=s>0?l/s*100:0;return{licenses:g,stats:{totalLicenses:s,activeLicenses:l,expiringSoon:m,unassignedLicenses:x,utilizationRate:j}}},[r,E,g]),es=(s,l)=>{N(l),de(s.currentTarget)},A=()=>{de(null),N(null)},ss=s=>{navigator.clipboard.writeText(s),i("License key copied to clipboard",{variant:"success"}),A()},$=h.useMemo(()=>{if(!u||!g)return[];const s=g.filter(l=>{var m;return(m=l.assignedTo)==null?void 0:m.userId}).map(l=>l.assignedTo.userId);return u.filter(l=>!s.includes(l.id))},[u,g]),ns=async()=>{if(!t||!F){i("Please select a valid team member to assign the license to",{variant:"error"});return}try{await Ke.mutate({licenseId:t.id,userId:F});const s=u==null?void 0:u.find(m=>m.id===F),l=s?ie(s):"Unknown User";i(`License assigned to ${l}`,{variant:"success"}),xe(""),R(!1),A(),b()}catch(s){i((s==null?void 0:s.message)||"Failed to assign license",{variant:"error"})}},ts=async()=>{var s,l,m;try{console.log("🎫 Starting license creation for",L,"license(s)...");const x=(g==null?void 0:g.length)||0;for(let j=0;j<L;j++){const W=zs(),D=x+j+1,B=`${w} License #${D.toString().padStart(3,"0")}`,Z={key:W,name:B,tier:w,status:"PENDING",organization:{id:((s=r==null?void 0:r.organization)==null?void 0:s.id)||"",name:((l=r==null?void 0:r.organization)==null?void 0:l.name)||"",tier:((m=r==null?void 0:r.organization)==null?void 0:m.tier)||"BASIC"},usage:{apiCalls:0,dataTransfer:0,deviceCount:0,maxDevices:w==="ENTERPRISE"?10:w==="PROFESSIONAL"?5:2},expiresAt:new Date(Date.now()+365*24*60*60*1e3)};console.log(`🎫 Creating license ${j+1}/${L}: ${B} (${W})`);const ds=await qe.mutate(Z);console.log(`✅ License created with ID: ${ds}`)}i(`${L} ${w.toLowerCase()} license(s) created successfully and ready for assignment`,{variant:"success"}),he("PROFESSIONAL"),ue(1),T(!1),console.log("🔄 Refreshing license data after creation..."),await b();try{const{unifiedDataService:j}=await xs(async()=>{const{unifiedDataService:W}=await import("./UnifiedDataService-Wpcn--aO.js");return{unifiedDataService:W}},__vite__mapDeps([0,1,2,3,4,5,6,7]));await j.forceRefreshLicenses(),console.log("🔄 Force refreshed license data via UnifiedDataService")}catch(j){console.warn("⚠️ Failed to force refresh via UnifiedDataService:",j)}setTimeout(async()=>{console.log("🔄 Secondary refresh for eventual consistency..."),await b()},1e3),setTimeout(async()=>{console.log("🔄 Final refresh for safety..."),await b()},3e3),window.dispatchEvent(new CustomEvent("licenses:refresh",{detail:{action:"created",count:L,tier:w}}))}catch(x){console.error("❌ License creation failed:",x),i((x==null?void 0:x.message)||"Failed to create license",{variant:"error"})}},as=async()=>{if(t){try{await Y.mutate({licenseId:t.id,updates:{status:"SUSPENDED"}}),i(`License ${t.name} has been suspended`,{variant:"warning"}),b()}catch(s){i((s==null?void 0:s.message)||"Failed to suspend license",{variant:"error"})}A()}},is=async()=>{if(t){try{await Y.mutate({licenseId:t.id,updates:{status:"ACTIVE"}}),i(`License ${t.name} has been activated`,{variant:"success"}),b()}catch(s){i((s==null?void 0:s.message)||"Failed to activate license",{variant:"error"})}A()}},rs=()=>{t&&(z(!0),A())},ls=async()=>{if(t)try{i(`License ${t.name} has been deleted`,{variant:"success"}),z(!1),N(null),b()}catch(s){i((s==null?void 0:s.message)||"Failed to delete license",{variant:"error"})}},os=s=>{console.log("🔧 [LicensesPage] Opening edit dialog for license:",s),N(s),ge(s.name),me(s.tier),fe(s.status),ye(new Date(s.expiresAt).toISOString().split("T")[0]),O(!0),A()},cs=async()=>{if(t)try{await Y.mutate({licenseId:t.id,updates:{name:je,tier:Q,status:pe,expiresAt:new Date(ve)}}),i(`License ${t.name} updated successfully`,{variant:"success"}),O(!1),N(null),b()}catch(s){i((s==null?void 0:s.message)||"Failed to update license",{variant:"error"})}};return Qe?e.jsx(a,{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"400px",children:e.jsxs(a,{textAlign:"center",children:[e.jsx(hs,{size:60}),e.jsx(n,{variant:"h6",sx:{mt:2},children:"Loading License Data..."}),e.jsx(n,{variant:"body2",color:"text.secondary",children:"Fetching your licenses and subscription details"})]})}):Ze?e.jsx(a,{sx:{p:3},children:e.jsxs(C,{severity:"error",children:[e.jsx(ee,{children:"Unable to Load License Data"}),e.jsx(n,{variant:"body2",sx:{mb:2},children:"We encountered an issue loading your license information. This could be due to:"}),e.jsxs(us,{dense:!0,children:[e.jsxs(Ie,{children:[e.jsx(S,{children:e.jsx(re,{fontSize:"small"})}),e.jsx(we,{primary:"Network connectivity issues"})]}),e.jsxs(Ie,{children:[e.jsx(S,{children:e.jsx(js,{fontSize:"small"})}),e.jsx(we,{primary:"Authentication token expired"})]})]}),e.jsx(a,{sx:{mt:2},children:e.jsx(v,{variant:"contained",onClick:()=>window.location.reload(),children:"Retry"})})]})}):!r||!E?e.jsx(a,{sx:{p:3},children:e.jsxs(C,{severity:"info",children:[e.jsx(ee,{children:"Setting Up License Management"}),e.jsx(n,{variant:"body2",children:"We're preparing your license management dashboard. This may take a moment for new accounts."})]})}):e.jsxs(a,{children:[e.jsxs(a,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:4},children:[e.jsxs(a,{children:[e.jsx(n,{variant:"h4",sx:{fontWeight:700,mb:1},children:"License Management"}),e.jsxs(n,{variant:"body1",color:"text.secondary",children:["Manage your ",((be=E.organization)==null?void 0:be.name)||"Organization"," licenses and assignments",g&&e.jsxs("span",{style:{marginLeft:"8px",fontWeight:500,color:"primary.main"},children:["• ",g.length," total licenses"]})]})]}),e.jsx(v,{variant:"contained",startIcon:e.jsx(Se,{}),onClick:()=>T(!0),sx:{background:"linear-gradient(135deg, #00d4ff 0%, #667eea 100%)",color:"#000",fontWeight:600},children:"Generate Licenses"})]}),e.jsxs(P,{container:!0,spacing:3,sx:{mb:4},children:[e.jsx(P,{item:!0,xs:12,sm:6,md:3,children:e.jsx(J,{title:"Total Licenses",value:f.stats.totalLicenses.toString(),icon:e.jsx(Fe,{}),color:"primary"})}),e.jsx(P,{item:!0,xs:12,sm:6,md:3,children:e.jsx(J,{title:"Active Licenses",value:f.stats.activeLicenses.toString(),icon:e.jsx(k,{}),color:"success"})}),e.jsx(P,{item:!0,xs:12,sm:6,md:3,children:e.jsx(J,{title:"Expiring Soon",value:f.stats.expiringSoon.toString(),icon:e.jsx(U,{}),color:"warning"})}),e.jsx(P,{item:!0,xs:12,sm:6,md:3,children:e.jsx(J,{title:"Unassigned",value:f.stats.unassignedLicenses.toString(),icon:e.jsx(Ee,{}),color:"secondary"})})]}),e.jsx(Ae,{sx:{mb:4},children:e.jsxs(De,{children:[e.jsx(n,{variant:"h6",sx:{fontWeight:600,mb:2},children:"License Utilization"}),e.jsxs(a,{sx:{display:"flex",alignItems:"center",gap:2,mb:1},children:[e.jsx(Te,{variant:"determinate",value:f.stats.utilizationRate,sx:{flex:1,height:8,borderRadius:4}}),e.jsxs(n,{variant:"body2",sx:{minWidth:60},children:[f.stats.utilizationRate.toFixed(1),"%"]})]}),e.jsxs(n,{variant:"body2",color:"text.secondary",children:[f.stats.activeLicenses," of ",f.stats.totalLicenses," licenses are currently active"]})]})}),f.stats.expiringSoon>0&&e.jsxs(C,{severity:"warning",sx:{mb:4},children:[e.jsx(ee,{children:"Licenses Expiring Soon"}),e.jsxs(n,{variant:"body2",sx:{mb:2},children:[f.stats.expiringSoon," license(s) will expire within the next 30 days."]}),e.jsx(v,{variant:"outlined",size:"small",onClick:()=>window.open("/dashboard/billing","_blank"),children:"Renew Licenses"})]}),e.jsx(Ae,{children:e.jsxs(De,{children:[e.jsxs(a,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:[e.jsxs(n,{variant:"h6",sx:{fontWeight:600},children:["All Licenses (",f.licenses.length,")"]}),e.jsx(v,{variant:"outlined",startIcon:e.jsx(Ne,{}),onClick:()=>i("License report downloaded",{variant:"success"}),children:"Export Report"})]}),e.jsx(gs,{children:e.jsxs(ms,{children:[e.jsx(ps,{children:e.jsxs(We,{children:[e.jsx(o,{sx:{fontWeight:600},children:"License"}),e.jsx(o,{sx:{fontWeight:600},children:"Tier"}),e.jsx(o,{sx:{fontWeight:600},children:"Status"}),e.jsx(o,{sx:{fontWeight:600},children:"Assigned To"}),e.jsx(o,{sx:{fontWeight:600},children:"Department"}),e.jsx(o,{sx:{fontWeight:600},children:"Role"}),e.jsx(o,{sx:{fontWeight:600},children:"Usage"}),e.jsx(o,{sx:{fontWeight:600},children:"Expires"}),e.jsx(o,{sx:{fontWeight:600},children:"Actions"})]})}),e.jsx(fs,{children:f.licenses.map(s=>{var l,m;return e.jsxs(We,{hover:!0,children:[e.jsx(o,{children:e.jsxs(a,{children:[e.jsx(n,{variant:"body1",sx:{fontWeight:500},children:s.name}),e.jsx(n,{variant:"body2",color:"text.secondary",sx:{fontFamily:"monospace"},children:s.key})]})}),e.jsx(o,{children:e.jsx(se,{label:s.tier,color:Os(s.tier),size:"small",icon:s.tier==="ENTERPRISE"?e.jsx(Pe,{}):void 0})}),e.jsx(o,{children:e.jsx(se,{icon:Rs(s.status),label:s.status,color:Us(s.status),size:"small"})}),e.jsx(o,{children:s.assignedTo?e.jsxs(a,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(ne,{sx:{width:24,height:24},children:ze(s.assignedTo,u)}),e.jsxs(a,{children:[e.jsx(n,{variant:"body2",sx:{fontWeight:500},children:oe(s.assignedTo,u)}),e.jsx(n,{variant:"caption",color:"text.secondary",children:s.assignedTo.email})]})]}):e.jsx(n,{variant:"body2",color:"text.secondary",children:"Unassigned"})}),e.jsx(o,{children:e.jsx(n,{variant:"body2",color:"text.secondary",children:s.assignedTo?((l=u==null?void 0:u.find(x=>{var j;return x.email===((j=s.assignedTo)==null?void 0:j.email)}))==null?void 0:l.department)||"Not specified":"—"})}),e.jsx(o,{children:s.assignedTo?e.jsx(se,{label:((m=u==null?void 0:u.find(x=>{var j;return x.email===((j=s.assignedTo)==null?void 0:j.email)}))==null?void 0:m.role)||"Member",color:"primary",size:"small",variant:"outlined"}):e.jsx(n,{variant:"body2",color:"text.secondary",children:"—"})}),e.jsx(o,{children:e.jsxs(a,{children:[e.jsxs(n,{variant:"body2",children:[s.usage.apiCalls.toLocaleString()," API calls"]}),e.jsxs(n,{variant:"caption",color:"text.secondary",children:[s.usage.dataTransfer," GB transferred"]})]})}),e.jsx(o,{children:e.jsx(n,{variant:"body2",color:new Date(s.expiresAt)<=new Date(Date.now()+30*24*60*60*1e3)?"warning.main":"text.primary",children:new Date(s.expiresAt).toLocaleDateString()})}),e.jsx(o,{children:e.jsx(vs,{size:"small",onClick:x=>es(x,s),children:e.jsx(ys,{})})})]},s.id)})})]})})]})}),e.jsx(bs,{color:"primary",sx:{position:"fixed",bottom:16,right:16,display:{xs:"flex",md:"none"}},onClick:()=>T(!0),children:e.jsx(Se,{})}),e.jsxs(M,{open:He,onClose:()=>T(!1),maxWidth:"sm",fullWidth:!0,children:[e.jsx(G,{children:e.jsxs(a,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(_,{color:"primary"}),"Generate New Licenses"]})}),e.jsx(V,{children:e.jsxs(a,{sx:{display:"flex",flexDirection:"column",gap:3,mt:2},children:[e.jsxs(C,{severity:"info",children:[e.jsx(n,{variant:"body2",sx:{mb:1},children:e.jsx("strong",{children:"Automatic License Generation"})}),e.jsx(n,{variant:"body2",children:"Licenses will be automatically generated with unique names and keys. You can assign them to team members after creation."})]}),e.jsxs(q,{fullWidth:!0,children:[e.jsx(K,{children:"License Tier"}),e.jsxs(H,{value:w,label:"License Tier",onChange:s=>he(s.target.value),children:[e.jsx(c,{value:"BASIC",children:e.jsxs(a,{children:[e.jsx(n,{variant:"body1",children:"Basic"}),e.jsx(n,{variant:"caption",color:"text.secondary",children:"Limited features • 2 max devices"})]})}),e.jsx(c,{value:"PROFESSIONAL",children:e.jsxs(a,{children:[e.jsx(n,{variant:"body1",children:"Professional"}),e.jsx(n,{variant:"caption",color:"text.secondary",children:"Full features • 5 max devices"})]})}),e.jsx(c,{value:"ENTERPRISE",children:e.jsxs(a,{children:[e.jsx(n,{variant:"body1",children:"Enterprise"}),e.jsx(n,{variant:"caption",color:"text.secondary",children:"Advanced features • 10 max devices"})]})})]})]}),e.jsx(p,{fullWidth:!0,label:"Number of Licenses to Generate",type:"number",value:L,onChange:s=>ue(parseInt(s.target.value)||1),inputProps:{min:1,max:50},helperText:`Will generate ${L} ${w.toLowerCase()} license${L>1?"s":""}`}),e.jsx(C,{severity:"success",children:e.jsxs(n,{variant:"body2",children:["✅ Each license will have a 1-year validity period",e.jsx("br",{}),"✅ Licenses can be assigned to team members immediately",e.jsx("br",{}),"✅ Unique license keys will be automatically generated"]})})]})}),e.jsxs(X,{children:[e.jsx(v,{onClick:()=>T(!1),children:"Cancel"}),e.jsxs(v,{onClick:ts,variant:"contained",startIcon:e.jsx(_,{}),sx:{background:"linear-gradient(135deg, #00d4ff 0%, #667eea 100%)",color:"#000",fontWeight:600},children:["Generate ",L," License",L>1?"s":""]})]})]}),e.jsxs(M,{open:Xe,onClose:()=>R(!1),maxWidth:"sm",fullWidth:!0,children:[e.jsx(G,{children:"Assign License"}),e.jsx(V,{children:t&&e.jsxs(a,{sx:{display:"flex",flexDirection:"column",gap:3,mt:2},children:[e.jsx(C,{severity:"info",children:e.jsxs(n,{variant:"body2",children:["Assigning license: ",e.jsx("strong",{children:t.name})]})}),e.jsxs(q,{fullWidth:!0,children:[e.jsx(K,{children:"Assign To"}),e.jsx(H,{value:F,label:"Assign To",onChange:s=>xe(s.target.value),disabled:$.length===0,children:$.length===0?e.jsx(c,{disabled:!0,children:e.jsx(n,{variant:"body2",color:"text.secondary",children:"No available team members for assignment"})}):$.map(s=>e.jsx(c,{value:s.id,children:e.jsxs(a,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(ne,{sx:{width:24,height:24},children:ie(s).charAt(0)}),e.jsxs(a,{children:[e.jsx(n,{variant:"body2",sx:{fontWeight:500},children:ie(s)}),e.jsx(n,{variant:"caption",color:"text.secondary",children:s.email})]})]})},s.id))})]}),$.length===0&&e.jsx(C,{severity:"info",children:e.jsx(n,{variant:"body2",children:"All team members already have licenses assigned. To assign this license, you'll need to unassign another license first or invite new team members."})}),e.jsx(n,{variant:"body2",color:"text.secondary",children:"The user will receive an email with instructions to activate their license."})]})}),e.jsxs(X,{children:[e.jsx(v,{onClick:()=>R(!1),children:"Cancel"}),e.jsx(v,{onClick:ns,variant:"contained",startIcon:e.jsx(te,{}),children:"Assign License"})]})]}),e.jsxs(M,{open:Ye,onClose:()=>z(!1),maxWidth:"sm",children:[e.jsx(G,{children:"Delete License"}),e.jsx(V,{children:t&&e.jsxs(a,{children:[e.jsxs(n,{variant:"body1",sx:{mb:2},children:["Are you sure you want to delete ",e.jsx("strong",{children:t.name}),"?"]}),e.jsx(C,{severity:"warning",children:e.jsx(n,{variant:"body2",children:"This action cannot be undone. The license will be permanently removed and any assigned user will lose access."})})]})}),e.jsxs(X,{children:[e.jsx(v,{onClick:()=>z(!1),children:"Cancel"}),e.jsx(v,{onClick:ls,variant:"contained",color:"error",startIcon:e.jsx(ke,{}),children:"Delete License"})]})]}),e.jsxs(M,{open:Je,onClose:()=>O(!1),maxWidth:"md",fullWidth:!0,children:[e.jsx(G,{children:e.jsxs(a,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsx(ae,{}),"Edit License: ",t==null?void 0:t.name]})}),e.jsx(V,{children:t&&e.jsxs(a,{sx:{display:"flex",flexDirection:"column",gap:3,mt:2},children:[e.jsxs(a,{children:[e.jsxs(n,{variant:"h6",sx:{mb:2,display:"flex",alignItems:"center",gap:1},children:[e.jsx(_,{})," Basic Information"]}),e.jsxs(a,{sx:{display:"flex",gap:2,mb:2},children:[e.jsx(p,{fullWidth:!0,label:"License Name",value:je,onChange:s=>ge(s.target.value),placeholder:"Development Team License",required:!0}),e.jsx(p,{fullWidth:!0,label:"License Key",value:t.key,disabled:!0,InputProps:{startAdornment:e.jsx(y,{position:"start",children:e.jsx(_,{})})},helperText:"License key is automatically generated and cannot be changed"})]}),e.jsxs(a,{sx:{display:"flex",gap:2,mb:2},children:[e.jsxs(q,{fullWidth:!0,children:[e.jsx(K,{children:"License Tier"}),e.jsxs(H,{value:Q,label:"License Tier",onChange:s=>me(s.target.value),children:[e.jsx(c,{value:"BASIC",children:e.jsxs(a,{children:[e.jsx(n,{variant:"body2",sx:{fontWeight:500},children:"Basic"}),e.jsx(n,{variant:"caption",color:"text.secondary",children:"Limited features • 2 max devices • Basic support"})]})}),e.jsx(c,{value:"PROFESSIONAL",children:e.jsxs(a,{children:[e.jsx(n,{variant:"body2",sx:{fontWeight:500},children:"Professional"}),e.jsx(n,{variant:"caption",color:"text.secondary",children:"Full features • 5 max devices • Priority support"})]})}),e.jsx(c,{value:"ENTERPRISE",children:e.jsxs(a,{children:[e.jsx(n,{variant:"body2",sx:{fontWeight:500},children:"Enterprise"}),e.jsx(n,{variant:"caption",color:"text.secondary",children:"Advanced features • 10 max devices • 24/7 support"})]})})]})]}),e.jsxs(q,{fullWidth:!0,children:[e.jsx(K,{children:"Status"}),e.jsxs(H,{value:pe,label:"Status",onChange:s=>fe(s.target.value),children:[e.jsx(c,{value:"PENDING",children:e.jsxs(a,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(U,{color:"warning"}),e.jsxs(a,{children:[e.jsx(n,{variant:"body2",sx:{fontWeight:500},children:"Pending"}),e.jsx(n,{variant:"caption",color:"text.secondary",children:"Awaiting activation"})]})]})}),e.jsx(c,{value:"ACTIVE",children:e.jsxs(a,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(k,{color:"success"}),e.jsxs(a,{children:[e.jsx(n,{variant:"body2",sx:{fontWeight:500},children:"Active"}),e.jsx(n,{variant:"caption",color:"text.secondary",children:"Fully operational"})]})]})}),e.jsx(c,{value:"SUSPENDED",children:e.jsxs(a,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(le,{color:"error"}),e.jsxs(a,{children:[e.jsx(n,{variant:"body2",sx:{fontWeight:500},children:"Suspended"}),e.jsx(n,{variant:"caption",color:"text.secondary",children:"Temporarily disabled"})]})]})}),e.jsx(c,{value:"EXPIRED",children:e.jsxs(a,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(re,{color:"warning"}),e.jsxs(a,{children:[e.jsx(n,{variant:"body2",sx:{fontWeight:500},children:"Expired"}),e.jsx(n,{variant:"caption",color:"text.secondary",children:"Past expiration date"})]})]})})]})]})]}),e.jsx(p,{fullWidth:!0,label:"Expiration Date",type:"date",value:ve,onChange:s=>ye(s.target.value),InputLabelProps:{shrink:!0},required:!0,InputProps:{startAdornment:e.jsx(y,{position:"start",children:e.jsx(U,{})})}})]}),e.jsxs(a,{children:[e.jsxs(n,{variant:"h6",sx:{mb:2,display:"flex",alignItems:"center",gap:1},children:[e.jsx(Ue,{})," Usage & Limits"]}),e.jsxs(a,{sx:{display:"flex",gap:2,mb:2},children:[e.jsx(p,{fullWidth:!0,label:"Max Devices",value:t.usage.maxDevices,disabled:!0,InputProps:{startAdornment:e.jsx(y,{position:"start",children:e.jsx(Ee,{})})},helperText:`${Q} tier limit`}),e.jsx(p,{fullWidth:!0,label:"Current Devices",value:t.usage.deviceCount,disabled:!0,InputProps:{startAdornment:e.jsx(y,{position:"start",children:e.jsx(k,{})})}})]}),e.jsxs(a,{sx:{display:"flex",gap:2,mb:2},children:[e.jsx(p,{fullWidth:!0,label:"API Calls Used",value:t.usage.apiCalls.toLocaleString(),disabled:!0,InputProps:{startAdornment:e.jsx(y,{position:"start",children:e.jsx(Ue,{})})}}),e.jsx(p,{fullWidth:!0,label:"Data Transfer (GB)",value:t.usage.dataTransfer,disabled:!0,InputProps:{startAdornment:e.jsx(y,{position:"start",children:e.jsx(Ne,{})})}})]}),e.jsxs(a,{sx:{mt:2},children:[e.jsxs(n,{variant:"body2",sx:{mb:1},children:["Device Usage: ",t.usage.deviceCount," / ",t.usage.maxDevices]}),e.jsx(Te,{variant:"determinate",value:t.usage.deviceCount/t.usage.maxDevices*100,sx:{height:8,borderRadius:4},color:t.usage.deviceCount>=t.usage.maxDevices?"error":"primary"})]})]}),e.jsxs(a,{children:[e.jsxs(n,{variant:"h6",sx:{mb:2,display:"flex",alignItems:"center",gap:1},children:[e.jsx(te,{})," Assignment Information"]}),t.assignedTo?e.jsxs(a,{sx:{display:"flex",gap:2,mb:2},children:[e.jsx(p,{fullWidth:!0,label:"Assigned To",value:oe(t.assignedTo,u),disabled:!0,InputProps:{startAdornment:e.jsx(y,{position:"start",children:e.jsx(ne,{sx:{width:20,height:20},children:ze(t.assignedTo,u)})})}}),e.jsx(p,{fullWidth:!0,label:"User Email",value:t.assignedTo.email,disabled:!0,InputProps:{startAdornment:e.jsx(y,{position:"start",children:e.jsx(Ls,{})})}})]}):e.jsx(C,{severity:"info",children:e.jsx(n,{variant:"body2",children:'This license is currently unassigned. Use the "Assign License" action to assign it to a team member.'})})]}),e.jsxs(a,{children:[e.jsxs(n,{variant:"h6",sx:{mb:2,display:"flex",alignItems:"center",gap:1},children:[e.jsx(Re,{})," Organization & Metadata"]}),e.jsxs(a,{sx:{display:"flex",gap:2,mb:2},children:[e.jsx(p,{fullWidth:!0,label:"Organization",value:((Le=t.organization)==null?void 0:Le.name)||"Unknown",disabled:!0,InputProps:{startAdornment:e.jsx(y,{position:"start",children:e.jsx(Re,{})})}}),e.jsx(p,{fullWidth:!0,label:"Organization Tier",value:((Ce=t.organization)==null?void 0:Ce.tier)||"BASIC",disabled:!0,InputProps:{startAdornment:e.jsx(y,{position:"start",children:e.jsx(Pe,{})})}})]}),e.jsxs(a,{sx:{display:"flex",gap:2,mb:2},children:[e.jsx(p,{fullWidth:!0,label:"Created Date",value:t.createdAt?new Date(t.createdAt).toLocaleDateString():"Unknown",disabled:!0,InputProps:{startAdornment:e.jsx(y,{position:"start",children:e.jsx(U,{})})}}),e.jsx(p,{fullWidth:!0,label:"Last Updated",value:t.updatedAt?new Date(t.updatedAt).toLocaleDateString():"Unknown",disabled:!0,InputProps:{startAdornment:e.jsx(y,{position:"start",children:e.jsx(Cs,{})})}})]})]}),e.jsxs(C,{severity:"warning",children:[e.jsx(n,{variant:"body2",sx:{fontWeight:500,mb:1},children:"⚠️ Important Notes"}),e.jsxs(n,{variant:"body2",children:["• Changing the license tier will update device limits and feature access",e.jsx("br",{}),"• Status changes will immediately affect the user's access to the system",e.jsx("br",{}),"• Expiration date changes should be communicated to the license holder",e.jsx("br",{}),"• Some fields are system-managed and cannot be edited here"]})]})]})}),e.jsxs(X,{children:[e.jsx(v,{onClick:()=>O(!1),children:"Cancel"}),e.jsx(v,{onClick:cs,variant:"contained",startIcon:e.jsx(ae,{}),sx:{background:"linear-gradient(135deg, #00d4ff 0%, #667eea 100%)",color:"#000",fontWeight:600},children:"Save Changes"})]})]}),e.jsxs(Is,{anchorEl:ce,open:!!ce,onClose:A,children:[e.jsxs(c,{onClick:()=>t&&ss(t.key),children:[e.jsx(S,{children:e.jsx(ws,{})}),"Copy License Key"]}),!(t!=null&&t.assignedTo)&&e.jsxs(c,{onClick:()=>R(!0),children:[e.jsx(S,{children:e.jsx(te,{})}),"Assign License"]}),e.jsxs(c,{onClick:()=>t&&os(t),children:[e.jsx(S,{children:e.jsx(ae,{})}),"Edit License"]}),e.jsx(Oe,{}),(t==null?void 0:t.status)==="ACTIVE"?e.jsxs(c,{onClick:as,children:[e.jsx(S,{children:e.jsx(le,{})}),"Suspend License"]}):e.jsxs(c,{onClick:is,children:[e.jsx(S,{children:e.jsx(k,{})}),"Activate License"]}),e.jsx(Oe,{}),e.jsxs(c,{onClick:rs,sx:{color:"error.main"},children:[e.jsx(S,{children:e.jsx(ke,{sx:{color:"error.main"}})}),"Delete License"]})]})]})};export{Ys as default};
