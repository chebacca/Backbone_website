const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-Ck1Tw4F8.js","assets/mui-DpsxcHA8.js","assets/vendor-DIxetjBo.js","assets/stripe-GgbZzTKy.js","assets/index-BFoWrjWu.css"])))=>i.map(i=>d[i]);
import{u as F,a as N,_ as O}from"./index-Ck1Tw4F8.js";import{j as e,a as s,b as U,d as h,s as q,c as R,T as l,t as w,S as B,u as p,v as b,w as V,I as M,x as z,y as Z,L as G,z as S,D as H}from"./mui-DpsxcHA8.js";import{u as Y,r as x,L as A}from"./vendor-DIxetjBo.js";import{u as $,C}from"./index.esm-9wQFonXx.js";import{u as J}from"./notistack.esm-Bg0Tn0tt.js";import"./stripe-GgbZzTKy.js";const ae=()=>{const o=Y(),{login:I}=F(),{setLoading:c}=N(),{enqueueSnackbar:d}=J(),[m,P]=x.useState(!1),[y,f]=x.useState(null),[g,T]=x.useState(null),[j,L]=x.useState(""),{control:v,handleSubmit:W,formState:{errors:u,isSubmitting:k}}=$({defaultValues:{email:"",password:""}}),D=async a=>{var t,i;try{f(null),c(!0);const r=await I(a.email,a.password);d("Welcome back!",{variant:"success"});const n=String((r==null?void 0:r.role)||"").toUpperCase();o(n==="SUPERADMIN"?"/admin":n==="ACCOUNTING"?"/accounting":"/dashboard")}catch(r){if((t=r==null?void 0:r.details)!=null&&t.requires2FA||r!=null&&r.requires2FA)T(((i=r==null?void 0:r.details)==null?void 0:i.interimToken)||(r==null?void 0:r.interimToken)||null);else{const n=r.message||"Login failed. Please try again.";f(n),d(n,{variant:"error"})}}finally{c(!1)}},E=()=>{P(!m)};return e.jsx(s,{sx:{minHeight:"100vh",background:"linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%)",display:"flex",alignItems:"center",py:{xs:4,md:0}},children:e.jsx(U,{maxWidth:"sm",children:e.jsxs(s,{initial:{opacity:0,y:50},animate:{opacity:1,y:0},transition:{duration:.6},children:[e.jsx(s,{sx:{mb:3},children:e.jsx(h,{startIcon:e.jsx(q,{}),onClick:()=>o("/"),sx:{color:"rgba(255, 255, 255, 0.7)","&:hover":{color:"primary.main",backgroundColor:"rgba(0, 212, 255, 0.1)"}},children:"Back to Home"})}),e.jsxs(R,{elevation:10,sx:{p:{xs:4,md:6},backgroundColor:"background.paper",borderRadius:3,border:"1px solid rgba(255, 255, 255, 0.1)"},children:[e.jsxs(s,{sx:{textAlign:"center",mb:4},children:[e.jsx(s,{sx:{width:60,height:60,borderRadius:2,background:"linear-gradient(135deg, #00d4ff 0%, #667eea 100%)",display:"flex",alignItems:"center",justifyContent:"center",mx:"auto",mb:3},children:e.jsx(l,{variant:"h4",sx:{fontWeight:700,color:"#000"},children:"D"})}),e.jsx(l,{variant:"h4",sx:{fontWeight:600,mb:2,textAlign:"center"},children:"Sign in to your BackboneLogic, Inc. account"}),e.jsx(l,{variant:"body1",color:"text.secondary",children:"Welcome back! Please sign in to continue."})]}),y&&e.jsx(w,{severity:"error",sx:{mb:3},children:y}),g?e.jsxs(s,{children:[e.jsx(w,{severity:"info",sx:{mb:3},children:"Enter the 6-digit code from your authenticator app. You can also use a backup code."}),e.jsx(p,{fullWidth:!0,label:"Authentication code",value:j,onChange:a=>L(a.target.value),sx:{mb:2}}),e.jsx(h,{variant:"contained",onClick:async()=>{var a;try{c(!0);const{verify2FA:t}=(await O(async()=>{const{authService:n}=await import("./index-Ck1Tw4F8.js").then(_=>_.f);return{authService:n}},__vite__mapDeps([0,1,2,3,4]))).authService;if(!g)return;const i=await t(g,j.trim());localStorage.setItem("auth_token",i.token),localStorage.setItem("auth_user",JSON.stringify(i.user)),d("2FA verified. Welcome back!",{variant:"success"});const r=String(((a=i.user)==null?void 0:a.role)||"").toUpperCase();o(r==="SUPERADMIN"?"/admin":r==="ACCOUNTING"?"/accounting":"/dashboard")}catch(t){d(t.message||"Invalid code",{variant:"error"})}finally{c(!1)}},sx:{background:"linear-gradient(135deg, #00d4ff 0%, #667eea 100%)",color:"#000"},children:"Verify Code"})]}):e.jsx(s,{component:"form",onSubmit:W(D),children:e.jsxs(B,{spacing:3,children:[e.jsx(C,{name:"email",control:v,rules:{required:"Email is required",pattern:{value:/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}$/i,message:"Please enter a valid email address"}},render:({field:a})=>{var t;return e.jsx(p,{...a,fullWidth:!0,label:"Email Address",type:"email",autoComplete:"email",error:!!u.email,helperText:(t=u.email)==null?void 0:t.message,InputProps:{startAdornment:e.jsx(b,{position:"start",children:e.jsx(V,{sx:{color:"text.secondary"}})})},sx:{"& .MuiOutlinedInput-root":{backgroundColor:"rgba(255, 255, 255, 0.05)"}}})}}),e.jsx(C,{name:"password",control:v,rules:{required:"Password is required",minLength:{value:8,message:"Password must be at least 8 characters"}},render:({field:a})=>{var t;return e.jsx(p,{...a,fullWidth:!0,label:"Password",type:m?"text":"password",autoComplete:"current-password",error:!!u.password,helperText:(t=u.password)==null?void 0:t.message,InputProps:{startAdornment:e.jsx(b,{position:"start",children:e.jsx(G,{sx:{color:"text.secondary"}})}),endAdornment:e.jsx(b,{position:"end",children:e.jsx(M,{onClick:E,edge:"end",sx:{color:"text.secondary"},children:m?e.jsx(z,{}):e.jsx(Z,{})})})},sx:{"& .MuiOutlinedInput-root":{backgroundColor:"rgba(255, 255, 255, 0.05)"}}})}}),e.jsx(s,{sx:{textAlign:"right"},children:e.jsx(S,{component:A,to:"/forgot-password",variant:"body2",sx:{color:"primary.main",textDecoration:"none","&:hover":{textDecoration:"underline"}},children:"Forgot your password?"})}),e.jsx(h,{type:"submit",fullWidth:!0,variant:"contained",size:"large",disabled:k,sx:{py:1.5,fontSize:"1.1rem",fontWeight:600,background:"linear-gradient(135deg, #00d4ff 0%, #667eea 100%)",color:"#000","&:hover":{background:"linear-gradient(135deg, #33ddff 0%, #7b8eed 100%)"},"&:disabled":{background:"rgba(255, 255, 255, 0.1)",color:"rgba(255, 255, 255, 0.5)"}},children:k?"Signing In...":"Sign In"})]})}),e.jsx(H,{sx:{my:4},children:e.jsx(l,{variant:"body2",color:"text.secondary",children:"OR"})}),e.jsxs(s,{sx:{textAlign:"center"},children:[e.jsxs(l,{variant:"body2",color:"text.secondary",children:["Don't have an account?"," ",e.jsx(S,{component:A,to:"/register",sx:{color:"primary.main",textDecoration:"none",fontWeight:600,"&:hover":{textDecoration:"underline"}},children:"Create one now"})]}),e.jsx(l,{variant:"caption",color:"text.secondary",sx:{mt:2,display:"block"},children:"ðŸ”’ Your data is secure and protected by industry-leading encryption"})]})]})]})})})};export{ae as default};
