import{j as e,a as t,b as p,c as b,O as H,T as o,d as x,n as M,t as S,L as f,u as I,v as u,I as R,x as W,y as A,H as O,z as D}from"./mui-DiYnqcGn.js";import{u as Y,i as Z,r as n,L as $}from"./vendor-DIxetjBo.js";import{u as G,C as L}from"./index.esm-9wQFonXx.js";import{b as U,c as J}from"./index-DQte3TP3.js";import{m as w}from"./proxy-B_KpOrcW.js";import"./stripe-CQkQ71Kl.js";const te=()=>{const a=Y(),{token:i}=Z(),{enqueueSnackbar:j}=U(),[m,T]=n.useState(!1),[g,z]=n.useState(!1),[y,d]=n.useState(null),[q,E]=n.useState(!1),[B,k]=n.useState(null),{control:v,handleSubmit:F,watch:N,formState:{errors:l,isSubmitting:P}}=G({defaultValues:{password:"",confirmPassword:""}}),h=N("password");n.useEffect(()=>{if(!i){k(!1),d("Invalid reset link");return}k(!0)},[i]);const c=(r=>{if(!r)return{score:0,label:"",color:"error"};let s=0;return r.length>=8&&(s+=25),/[a-z]/.test(r)&&(s+=25),/[A-Z]/.test(r)&&(s+=25),/[0-9]/.test(r)&&(s+=25),/[^A-Za-z0-9]/.test(r)&&(s+=25),s<=25?{score:s,label:"Weak",color:"error"}:s<=50?{score:s,label:"Fair",color:"warning"}:s<=75?{score:s,label:"Good",color:"info"}:{score:Math.min(s,100),label:"Strong",color:"success"}})(h),V=async r=>{if(!i){d("Invalid reset token");return}try{d(null),await J.resetPassword(i,r.password),E(!0),j("Password reset successful!",{variant:"success"}),setTimeout(()=>{a("/login")},3e3)}catch(s){const C=s.message||"Failed to reset password. Please try again.";d(C),j(C,{variant:"error"})}};return B===!1?e.jsx(t,{sx:{minHeight:"100vh",background:"linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%)",display:"flex",alignItems:"center",py:{xs:4,md:0}},children:e.jsx(p,{maxWidth:"sm",children:e.jsx(w.div,{initial:{opacity:0,y:50},animate:{opacity:1,y:0},transition:{duration:.6},children:e.jsxs(b,{elevation:10,sx:{p:{xs:4,md:6},backgroundColor:"background.paper",borderRadius:3,border:"1px solid rgba(255, 255, 255, 0.1)",textAlign:"center"},children:[e.jsx(H,{sx:{fontSize:80,color:"error.main",mb:3}}),e.jsx(o,{variant:"h4",sx:{fontWeight:600,mb:2},children:"Invalid Reset Link"}),e.jsx(o,{variant:"body1",color:"text.secondary",sx:{mb:4},children:"This password reset link is invalid or has expired. Please request a new one."}),e.jsxs(t,{sx:{display:"flex",flexDirection:"column",gap:2},children:[e.jsx(x,{variant:"contained",onClick:()=>a("/forgot-password"),sx:{background:"linear-gradient(135deg, #00d4ff 0%, #667eea 100%)",color:"#000"},children:"Request New Reset Link"}),e.jsx(x,{variant:"outlined",onClick:()=>a("/login"),children:"Back to Login"})]})]})})})}):q?e.jsx(t,{sx:{minHeight:"100vh",background:"linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%)",display:"flex",alignItems:"center",py:{xs:4,md:0}},children:e.jsx(p,{maxWidth:"sm",children:e.jsx(w.div,{initial:{opacity:0,y:50},animate:{opacity:1,y:0},transition:{duration:.6},children:e.jsxs(b,{elevation:10,sx:{p:{xs:4,md:6},backgroundColor:"background.paper",borderRadius:3,border:"1px solid rgba(255, 255, 255, 0.1)",textAlign:"center"},children:[e.jsx(M,{sx:{fontSize:80,color:"success.main",mb:3}}),e.jsx(o,{variant:"h4",sx:{fontWeight:600,mb:2},children:"Password Reset Successful!"}),e.jsx(o,{variant:"body1",color:"text.secondary",sx:{mb:4},children:"Your password has been successfully reset. You can now sign in with your new password."}),e.jsx(S,{severity:"info",sx:{mb:3},children:"Redirecting to login page in 3 seconds..."}),e.jsx(x,{variant:"contained",onClick:()=>a("/login"),sx:{background:"linear-gradient(135deg, #00d4ff 0%, #667eea 100%)",color:"#000"},children:"Continue to Login"})]})})})}):e.jsx(t,{sx:{minHeight:"100vh",background:"linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%)",display:"flex",alignItems:"center",py:{xs:4,md:0}},children:e.jsx(p,{maxWidth:"sm",children:e.jsx(w.div,{initial:{opacity:0,y:50},animate:{opacity:1,y:0},transition:{duration:.6},children:e.jsxs(b,{elevation:10,sx:{p:{xs:4,md:6},backgroundColor:"background.paper",borderRadius:3,border:"1px solid rgba(255, 255, 255, 0.1)"},children:[e.jsxs(t,{sx:{textAlign:"center",mb:4},children:[e.jsx(t,{sx:{width:80,height:80,borderRadius:2,backgroundColor:"rgba(0, 212, 255, 0.1)",display:"flex",alignItems:"center",justifyContent:"center",mx:"auto",mb:3},children:e.jsx(f,{sx:{fontSize:40,color:"primary.main"}})}),e.jsx(o,{variant:"h4",sx:{fontWeight:600,mb:1,background:"linear-gradient(135deg, #ffffff 0%, #00d4ff 100%)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",backgroundClip:"text"},children:"Reset Password"}),e.jsx(o,{variant:"body1",color:"text.secondary",children:"Enter your new password below"})]}),y&&e.jsx(S,{severity:"error",sx:{mb:3},children:y}),e.jsxs(t,{component:"form",onSubmit:F(V),children:[e.jsx(L,{name:"password",control:v,rules:{required:"Password is required",minLength:{value:8,message:"Password must be at least 8 characters"},validate:{hasLowerCase:r=>/[a-z]/.test(r)||"Password must contain a lowercase letter",hasUpperCase:r=>/[A-Z]/.test(r)||"Password must contain an uppercase letter",hasNumber:r=>/\d/.test(r)||"Password must contain a number"}},render:({field:r})=>{var s;return e.jsxs(t,{sx:{mb:3},children:[e.jsx(I,{...r,fullWidth:!0,label:"New Password",type:m?"text":"password",error:!!l.password,helperText:(s=l.password)==null?void 0:s.message,InputProps:{startAdornment:e.jsx(u,{position:"start",children:e.jsx(f,{sx:{color:"text.secondary"}})}),endAdornment:e.jsx(u,{position:"end",children:e.jsx(R,{onClick:()=>T(!m),edge:"end",sx:{color:"text.secondary"},children:m?e.jsx(W,{}):e.jsx(A,{})})})},sx:{"& .MuiOutlinedInput-root":{backgroundColor:"rgba(255, 255, 255, 0.05)"}}}),h&&e.jsxs(t,{sx:{mt:1},children:[e.jsxs(t,{sx:{display:"flex",alignItems:"center",gap:1,mb:.5},children:[e.jsx(o,{variant:"caption",color:"text.secondary",children:"Password strength:"}),e.jsx(o,{variant:"caption",color:`${c.color}.main`,sx:{fontWeight:600},children:c.label})]}),e.jsx(O,{variant:"determinate",value:c.score,color:c.color,sx:{height:4,borderRadius:2,backgroundColor:"rgba(255, 255, 255, 0.1)"}})]})]})}}),e.jsx(L,{name:"confirmPassword",control:v,rules:{required:"Please confirm your password",validate:r=>r===h||"Passwords do not match"},render:({field:r})=>{var s;return e.jsx(I,{...r,fullWidth:!0,label:"Confirm New Password",type:g?"text":"password",error:!!l.confirmPassword,helperText:(s=l.confirmPassword)==null?void 0:s.message,sx:{mb:3,"& .MuiOutlinedInput-root":{backgroundColor:"rgba(255, 255, 255, 0.05)"}},InputProps:{startAdornment:e.jsx(u,{position:"start",children:e.jsx(f,{sx:{color:"text.secondary"}})}),endAdornment:e.jsx(u,{position:"end",children:e.jsx(R,{onClick:()=>z(!g),edge:"end",sx:{color:"text.secondary"},children:g?e.jsx(W,{}):e.jsx(A,{})})})}})}}),e.jsx(x,{type:"submit",fullWidth:!0,variant:"contained",size:"large",disabled:P,sx:{py:1.5,fontSize:"1.1rem",fontWeight:600,background:"linear-gradient(135deg, #00d4ff 0%, #667eea 100%)",color:"#000",mb:3,"&:hover":{background:"linear-gradient(135deg, #33ddff 0%, #7b8eed 100%)"},"&:disabled":{background:"rgba(255, 255, 255, 0.1)",color:"rgba(255, 255, 255, 0.5)"}},children:P?"Resetting Password...":"Reset Password"})]}),e.jsxs(t,{sx:{textAlign:"center"},children:[e.jsxs(o,{variant:"body2",color:"text.secondary",children:["Remember your password?"," ",e.jsx(D,{component:$,to:"/login",sx:{color:"primary.main",textDecoration:"none",fontWeight:600,"&:hover":{textDecoration:"underline"}},children:"Sign in here"})]}),e.jsx(o,{variant:"caption",color:"text.secondary",sx:{mt:2,display:"block"},children:"ðŸ”’ Your new password will be securely encrypted"})]})]})})})})};export{te as default};
//# sourceMappingURL=ResetPasswordPage-Gtg5atRm.js.map
