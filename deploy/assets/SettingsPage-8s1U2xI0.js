import{j as e,a as l,T as o,G as t,c as p,at as xe,I as q,b6 as he,h as me,u as s,aZ as pe,a_ as be,a$ as ge,a4 as P,d as c,y as je,z as ye,U as I,W as j,X as y,Y as f,b7 as D,Q as O,M as K,p as R,t as T,as as X,b8 as fe,aD as Q,aE as Z,aG as $,aY as z,aJ as J,ah as ve}from"./mui-T5zcPaKR.js";import{h as Ce,u as we,r as h}from"./vendor-OeuszDaU.js";import{u as ke}from"./notistack.esm-CcFOI6Un.js";import{u as Pe,d as Te,c as Ae,e as Se,b as U}from"./index-BCTuZqxR.js";import"./stripe-Bd-xCkZF.js";const Ne=[{id:"two_factor",title:"Two-Factor Authentication",description:"Add an extra layer of security to your account",enabled:!1,icon:e.jsx(R,{}),type:"security"},{id:"email_notifications",title:"Email Notifications",description:"Receive email alerts for important account activities",enabled:!0,icon:e.jsx(ve,{}),type:"notifications"},{id:"login_alerts",title:"Login Alerts",description:"Get notified when someone logs into your account",enabled:!0,icon:e.jsx(R,{}),type:"security"},{id:"data_export",title:"Data Export Access",description:"Allow downloading of your account data",enabled:!0,icon:e.jsx(X,{}),type:"privacy"}],Le=()=>{var M,Y,_;const{user:i}=Pe(),{enqueueSnackbar:d}=ke(),W=Ce(),H=we(),[m,b]=h.useState({firstName:(i==null?void 0:i.firstName)||"",lastName:(i==null?void 0:i.lastName)||"",email:(i==null?void 0:i.email)||"",company:"",jobTitle:"",phone:"",timezone:"UTC",language:"en"}),[w,A]=h.useState({currentPassword:"",newPassword:"",confirmPassword:""}),[F,ee]=h.useState(Ne),[v,E]=h.useState({}),[ae,S]=h.useState(!1),[G,te]=h.useState(""),[k,re]=h.useState(!1),[ie,N]=h.useState(!1),[u,B]=h.useState("profile"),[n,x]=h.useState({firstName:"",lastName:"",dateOfBirth:"",nationality:"",countryOfResidence:"",phoneNumber:"",governmentIdType:"",governmentIdNumber:"",governmentIdCountry:"",governmentIdExpiry:""}),V=String((i==null?void 0:i.kycStatus)||"").toUpperCase();h.useEffect(()=>{const a=(W.hash||"").replace("#","").toLowerCase();a&&["profile","security","notifications","privacy","compliance","danger"].includes(a)&&B(a)},[W.hash]);const ne=a=>{B(a);const r=`${W.pathname}#${a}`;H(r,{replace:!0})},se=()=>{d("Profile updated successfully",{variant:"success"})},oe=()=>{if(w.newPassword!==w.confirmPassword){d("Passwords do not match",{variant:"error"});return}d("Password changed successfully",{variant:"success"}),A({currentPassword:"",newPassword:"",confirmPassword:""})},L=a=>{ee(r=>r.map(g=>g.id===a?{...g,enabled:!g.enabled}:g)),d("Setting updated",{variant:"success"})},le=async()=>{try{const a=await U.twoFASetupInitiate();E({qr:a.qrCodeDataUrl,secret:a.secret,enabled:!1}),S(!0)}catch(a){d(a.message||"Failed to start 2FA setup",{variant:"error"})}},ce=async()=>{try{const a=await U.twoFASetupVerify(G.trim());E(r=>({...r,enabled:!0,backupCodes:a.backupCodes})),d("Two-factor authentication enabled",{variant:"success"}),S(!1)}catch(a){d(a.message||"Invalid code",{variant:"error"})}},de=async()=>{try{await U.twoFADisable(),E({enabled:!1}),d("Two-factor authentication disabled",{variant:"success"})}catch(a){d(a.message||"Failed to disable 2FA",{variant:"error"})}},ue=()=>{d("Account deletion initiated. Check your email for confirmation.",{variant:"warning"}),N(!1)},C=({id:a,label:r,isActive:g})=>e.jsx(c,{variant:g?"contained":"outlined",onClick:()=>ne(a),sx:{mr:1,mb:1,...g&&{background:"linear-gradient(135deg, #00d4ff 0%, #667eea 100%)",color:"#000"}},children:r});return e.jsxs(l,{children:[e.jsx(l,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.6},children:e.jsxs(l,{sx:{mb:4},children:[e.jsx(o,{variant:"h4",sx:{fontWeight:700,mb:1},children:"Account Settings"}),e.jsx(o,{variant:"body1",color:"text.secondary",children:"Manage your account preferences and security settings"})]})}),e.jsx(l,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.1},children:e.jsxs(l,{sx:{mb:4},children:[e.jsx(C,{id:"profile",label:"Profile",isActive:u==="profile"}),e.jsx(C,{id:"security",label:"Security",isActive:u==="security"}),e.jsx(C,{id:"notifications",label:"Notifications",isActive:u==="notifications"}),e.jsx(C,{id:"privacy",label:"Privacy",isActive:u==="privacy"}),e.jsx(C,{id:"compliance",label:"Compliance",isActive:u==="compliance"}),e.jsx(C,{id:"danger",label:"Danger Zone",isActive:u==="danger"})]})}),u==="profile"&&e.jsx(l,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},children:e.jsxs(t,{container:!0,spacing:4,children:[e.jsx(t,{item:!0,xs:12,md:4,children:e.jsxs(p,{sx:{p:3,textAlign:"center",background:"linear-gradient(135deg, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0.05) 100%)",backdropFilter:"blur(20px)",border:"1px solid rgba(255,255,255,0.1)"},children:[e.jsxs(l,{sx:{position:"relative",display:"inline-block",mb:2},children:[e.jsxs(xe,{sx:{width:120,height:120,fontSize:"3rem",bgcolor:"primary.main"},children:[(M=i==null?void 0:i.firstName)==null?void 0:M[0],(Y=i==null?void 0:i.lastName)==null?void 0:Y[0]]}),e.jsx(q,{sx:{position:"absolute",bottom:0,right:0,bgcolor:"primary.main",color:"#000","&:hover":{bgcolor:"primary.dark"}},children:e.jsx(he,{})})]}),e.jsxs(o,{variant:"h6",sx:{fontWeight:600},children:[m.firstName," ",m.lastName]}),e.jsx(o,{variant:"body2",color:"text.secondary",children:m.email}),e.jsx(me,{label:((_=i==null?void 0:i.subscription)==null?void 0:_.tier)||"Pro",color:"primary",sx:{mt:1}})]})}),e.jsx(t,{item:!0,xs:12,md:8,children:e.jsxs(p,{sx:{p:4,background:"linear-gradient(135deg, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0.05) 100%)",backdropFilter:"blur(20px)",border:"1px solid rgba(255,255,255,0.1)"},children:[e.jsx(o,{variant:"h6",sx:{fontWeight:600,mb:3},children:"Personal Information"}),e.jsxs(t,{container:!0,spacing:3,children:[e.jsx(t,{item:!0,xs:12,sm:6,children:e.jsx(s,{fullWidth:!0,label:"First Name",value:m.firstName,onChange:a=>b(r=>({...r,firstName:a.target.value}))})}),e.jsx(t,{item:!0,xs:12,sm:6,children:e.jsx(s,{fullWidth:!0,label:"Last Name",value:m.lastName,onChange:a=>b(r=>({...r,lastName:a.target.value}))})}),e.jsx(t,{item:!0,xs:12,children:e.jsx(s,{fullWidth:!0,label:"Email Address",value:m.email,onChange:a=>b(r=>({...r,email:a.target.value})),disabled:!0,helperText:"Contact support to change your email address"})}),e.jsx(t,{item:!0,xs:12,sm:6,children:e.jsx(s,{fullWidth:!0,label:"Company",value:m.company,onChange:a=>b(r=>({...r,company:a.target.value}))})}),e.jsx(t,{item:!0,xs:12,sm:6,children:e.jsx(s,{fullWidth:!0,label:"Job Title",value:m.jobTitle,onChange:a=>b(r=>({...r,jobTitle:a.target.value}))})}),e.jsx(t,{item:!0,xs:12,sm:6,children:e.jsx(s,{fullWidth:!0,label:"Phone Number",value:m.phone,onChange:a=>b(r=>({...r,phone:a.target.value}))})}),e.jsx(t,{item:!0,xs:12,sm:6,children:e.jsxs(pe,{fullWidth:!0,children:[e.jsx(be,{id:"timezone-select-label",children:"Timezone"}),e.jsxs(ge,{labelId:"timezone-select-label",id:"timezone-select",value:m.timezone,label:"Timezone",onChange:a=>b(r=>({...r,timezone:a.target.value})),inputProps:{"aria-label":"Select timezone",title:"Select your timezone",name:"timezone"},"aria-labelledby":"timezone-select-label",title:"Select your timezone",children:[e.jsx(P,{value:"UTC",children:"UTC"}),e.jsx(P,{value:"America/New_York",children:"Eastern Time"}),e.jsx(P,{value:"America/Chicago",children:"Central Time"}),e.jsx(P,{value:"America/Denver",children:"Mountain Time"}),e.jsx(P,{value:"America/Los_Angeles",children:"Pacific Time"})]})]})})]}),e.jsxs(l,{sx:{mt:4,display:"flex",gap:2},children:[e.jsx(c,{variant:"contained",onClick:se,sx:{background:"linear-gradient(135deg, #00d4ff 0%, #667eea 100%)",color:"#000"},children:"Save Changes"}),e.jsx(c,{variant:"outlined",children:"Cancel"})]})]})})]})}),u==="security"&&e.jsx(l,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},children:e.jsxs(t,{container:!0,spacing:4,children:[e.jsx(t,{item:!0,xs:12,md:6,children:e.jsxs(p,{sx:{p:4,background:"linear-gradient(135deg, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0.05) 100%)",backdropFilter:"blur(20px)",border:"1px solid rgba(255,255,255,0.1)"},children:[e.jsx(o,{variant:"h6",sx:{fontWeight:600,mb:3},children:"Change Password"}),e.jsxs(t,{container:!0,spacing:3,children:[e.jsx(t,{item:!0,xs:12,children:e.jsx(s,{fullWidth:!0,label:"Current Password",type:k?"text":"password",value:w.currentPassword,onChange:a=>A(r=>({...r,currentPassword:a.target.value})),InputProps:{endAdornment:e.jsx(q,{onClick:()=>re(!k),edge:"end",children:k?e.jsx(je,{}):e.jsx(ye,{})})}})}),e.jsx(t,{item:!0,xs:12,children:e.jsx(s,{fullWidth:!0,label:"New Password",type:k?"text":"password",value:w.newPassword,onChange:a=>A(r=>({...r,newPassword:a.target.value}))})}),e.jsx(t,{item:!0,xs:12,children:e.jsx(s,{fullWidth:!0,label:"Confirm New Password",type:k?"text":"password",value:w.confirmPassword,onChange:a=>A(r=>({...r,confirmPassword:a.target.value}))})})]}),e.jsx(c,{variant:"contained",onClick:oe,sx:{mt:3,background:"linear-gradient(135deg, #00d4ff 0%, #667eea 100%)",color:"#000"},children:"Update Password"})]})}),e.jsx(t,{item:!0,xs:12,md:6,children:e.jsxs(p,{sx:{p:4,background:"linear-gradient(135deg, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0.05) 100%)",backdropFilter:"blur(20px)",border:"1px solid rgba(255,255,255,0.1)"},children:[e.jsx(o,{variant:"h6",sx:{fontWeight:600,mb:3},children:"Security Settings"}),e.jsxs(I,{children:[F.filter(a=>a.type==="security").map(a=>e.jsxs(j,{sx:{px:0},children:[e.jsx(y,{children:a.icon}),e.jsx(f,{primary:a.title,secondary:a.description}),e.jsx(D,{children:e.jsx(O,{checked:a.enabled,onChange:()=>L(a.id),color:"primary"})})]},a.id)),e.jsx(K,{sx:{my:2}}),e.jsxs(j,{sx:{px:0},children:[e.jsx(y,{children:e.jsx(R,{})}),e.jsx(f,{primary:"Two-Factor Authentication (TOTP)",secondary:v.enabled?"Enabled":"Disabled"}),e.jsx(D,{children:v.enabled?e.jsx(c,{variant:"outlined",color:"error",onClick:de,children:"Disable"}):e.jsx(c,{variant:"contained",onClick:le,sx:{background:"linear-gradient(135deg, #00d4ff 0%, #667eea 100%)",color:"#000"},children:"Enable"})})]})]})]})})]})}),u==="notifications"&&e.jsx(l,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},children:e.jsxs(p,{sx:{p:4,background:"linear-gradient(135deg, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0.05) 100%)",backdropFilter:"blur(20px)",border:"1px solid rgba(255,255,255,0.1)"},children:[e.jsx(o,{variant:"h6",sx:{fontWeight:600,mb:3},children:"Notification Preferences"}),e.jsx(I,{children:F.filter(a=>a.type==="notifications").map(a=>e.jsxs(j,{sx:{px:0},children:[e.jsx(y,{children:a.icon}),e.jsx(f,{primary:a.title,secondary:a.description}),e.jsx(D,{children:e.jsx(O,{checked:a.enabled,onChange:()=>L(a.id),color:"primary"})})]},a.id))})]})}),u==="privacy"&&e.jsx(l,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},children:e.jsxs(p,{sx:{p:4,background:"linear-gradient(135deg, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0.05) 100%)",backdropFilter:"blur(20px)",border:"1px solid rgba(255,255,255,0.1)"},children:[e.jsx(o,{variant:"h6",sx:{fontWeight:600,mb:3},children:"Privacy & Data Controls"}),e.jsx(I,{children:F.filter(a=>a.type==="privacy").map(a=>e.jsxs(j,{sx:{px:0},children:[e.jsx(y,{children:a.icon}),e.jsx(f,{primary:a.title,secondary:a.description}),e.jsx(D,{children:e.jsx(O,{checked:a.enabled,onChange:()=>L(a.id),color:"primary"})})]},a.id))}),e.jsx(K,{sx:{my:3}}),e.jsx(T,{severity:"info",sx:{mb:3},children:e.jsxs(o,{variant:"body2",children:[e.jsx("strong",{children:"Data Export:"})," You can download a copy of your data at any time. This includes your profile information, license history, and usage analytics."]})}),e.jsx(c,{variant:"outlined",startIcon:e.jsx(X,{}),sx:{mr:2},children:"Export My Data"})]})}),u==="compliance"&&e.jsx(l,{children:e.jsxs(p,{sx:{p:4,background:"linear-gradient(135deg, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0.05) 100%)",backdropFilter:"blur(20px)",border:"1px solid rgba(255,255,255,0.1)",mb:3},children:[e.jsx(o,{variant:"h6",sx:{fontWeight:600,mb:1},children:"Identity Verification (KYC)"}),e.jsxs(T,{severity:V==="COMPLETED"?"success":"warning",sx:{mb:2},children:["Status: ",V||"PENDING"]}),e.jsxs(t,{container:!0,spacing:2,children:[e.jsx(t,{item:!0,xs:12,sm:6,children:e.jsx(s,{fullWidth:!0,label:"First Name",value:n.firstName,onChange:a=>x({...n,firstName:a.target.value})})}),e.jsx(t,{item:!0,xs:12,sm:6,children:e.jsx(s,{fullWidth:!0,label:"Last Name",value:n.lastName,onChange:a=>x({...n,lastName:a.target.value})})}),e.jsx(t,{item:!0,xs:12,sm:6,children:e.jsx(s,{fullWidth:!0,type:"date",label:"Date of Birth",InputLabelProps:{shrink:!0},value:n.dateOfBirth,onChange:a=>x({...n,dateOfBirth:a.target.value})})}),e.jsx(t,{item:!0,xs:12,sm:6,children:e.jsx(s,{fullWidth:!0,label:"Nationality (ISO alpha-2)",placeholder:"US",value:n.nationality,onChange:a=>x({...n,nationality:a.target.value.toUpperCase()})})}),e.jsx(t,{item:!0,xs:12,sm:6,children:e.jsx(s,{fullWidth:!0,label:"Country of Residence (ISO alpha-2)",placeholder:"US",value:n.countryOfResidence,onChange:a=>x({...n,countryOfResidence:a.target.value.toUpperCase()})})}),e.jsx(t,{item:!0,xs:12,sm:6,children:e.jsx(s,{fullWidth:!0,label:"Phone Number",value:n.phoneNumber,onChange:a=>x({...n,phoneNumber:a.target.value})})}),e.jsx(t,{item:!0,xs:12,sm:6,children:e.jsx(s,{fullWidth:!0,label:"Government ID Type (optional)",value:n.governmentIdType,onChange:a=>x({...n,governmentIdType:a.target.value})})}),e.jsx(t,{item:!0,xs:12,sm:6,children:e.jsx(s,{fullWidth:!0,label:"Government ID Number (optional)",value:n.governmentIdNumber,onChange:a=>x({...n,governmentIdNumber:a.target.value})})}),e.jsx(t,{item:!0,xs:12,sm:6,children:e.jsx(s,{fullWidth:!0,label:"Government ID Country (ISO alpha-2)",value:n.governmentIdCountry,onChange:a=>x({...n,governmentIdCountry:a.target.value.toUpperCase()})})}),e.jsx(t,{item:!0,xs:12,sm:6,children:e.jsx(s,{fullWidth:!0,type:"date",label:"Government ID Expiry (optional)",InputLabelProps:{shrink:!0},value:n.governmentIdExpiry,onChange:a=>x({...n,governmentIdExpiry:a.target.value})})})]}),e.jsxs(l,{sx:{mt:3,display:"flex",gap:2},children:[e.jsx(c,{variant:"contained",onClick:async()=>{try{await Te.withLoading(async()=>Ae.post(Se.users.kycVerify(),n)),d("KYC submitted successfully",{variant:"success"})}catch(a){d(a.message||"Failed to submit KYC",{variant:"error"})}},sx:{background:"linear-gradient(135deg, #00d4ff 0%, #667eea 100%)",color:"#000"},children:"Submit Verification"}),e.jsx(c,{variant:"outlined",onClick:()=>x({firstName:"",lastName:"",dateOfBirth:"",nationality:"",countryOfResidence:"",phoneNumber:"",governmentIdType:"",governmentIdNumber:"",governmentIdCountry:"",governmentIdExpiry:""}),children:"Clear"})]})]})}),u==="danger"&&e.jsx(l,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},children:e.jsxs(p,{sx:{p:4,background:"linear-gradient(135deg, rgba(244, 67, 54, 0.1) 0%, rgba(244, 67, 54, 0.05) 100%)",backdropFilter:"blur(20px)",border:"1px solid rgba(244, 67, 54, 0.2)"},children:[e.jsx(o,{variant:"h6",sx:{fontWeight:600,mb:3,color:"error.main"},children:"Danger Zone"}),e.jsx(T,{severity:"warning",sx:{mb:3},children:e.jsxs(o,{variant:"body2",children:[e.jsx("strong",{children:"Warning:"})," These actions are irreversible. Please proceed with caution."]})}),e.jsxs(l,{sx:{p:3,border:"1px solid",borderColor:"error.main",borderRadius:2},children:[e.jsx(o,{variant:"subtitle1",sx:{fontWeight:600,mb:1},children:"Delete Account"}),e.jsx(o,{variant:"body2",color:"text.secondary",sx:{mb:2},children:"Permanently delete your account and all associated data. This action cannot be undone."}),e.jsx(c,{variant:"contained",color:"error",startIcon:e.jsx(fe,{}),onClick:()=>N(!0),children:"Delete My Account"})]})]})}),e.jsxs(Q,{open:ie,onClose:()=>N(!1),PaperProps:{sx:{backgroundColor:"background.paper",border:"1px solid rgba(244, 67, 54, 0.2)"}},children:[e.jsx(Z,{sx:{color:"error.main"},children:"Delete Account"}),e.jsxs($,{children:[e.jsx(T,{severity:"error",sx:{mb:2},children:"This action is permanent and cannot be undone."}),e.jsx(o,{variant:"body1",sx:{mb:2},children:"Are you sure you want to delete your account? This will:"}),e.jsxs(I,{dense:!0,children:[e.jsxs(j,{children:[e.jsx(y,{children:e.jsx(z,{color:"error"})}),e.jsx(f,{primary:"Permanently delete all your data"})]}),e.jsxs(j,{children:[e.jsx(y,{children:e.jsx(z,{color:"error"})}),e.jsx(f,{primary:"Cancel all active subscriptions"})]}),e.jsxs(j,{children:[e.jsx(y,{children:e.jsx(z,{color:"error"})}),e.jsx(f,{primary:"Revoke all license keys"})]})]}),e.jsx(s,{fullWidth:!0,label:"Type 'DELETE' to confirm",sx:{mt:2},placeholder:"DELETE"})]}),e.jsxs(J,{children:[e.jsx(c,{onClick:()=>N(!1),children:"Cancel"}),e.jsx(c,{onClick:ue,color:"error",variant:"contained",children:"Delete Account"})]})]}),e.jsxs(Q,{open:ae,onClose:()=>S(!1),PaperProps:{sx:{backgroundColor:"background.paper",border:"1px solid rgba(255, 255, 255, 0.1)"}},children:[e.jsx(Z,{children:"Set up Two-Factor Authentication"}),e.jsxs($,{children:[e.jsx(o,{variant:"body2",sx:{mb:2},children:"Scan the QR code with Google Authenticator, Authy, or another TOTP app. Then enter the 6-digit code to confirm."}),v.qr&&e.jsx(l,{sx:{display:"flex",justifyContent:"center",mb:2},children:e.jsx("img",{src:v.qr,alt:"2FA QR Code",width:200,height:200})}),v.secret&&e.jsxs(T,{severity:"info",sx:{mb:2},children:["Secret: ",v.secret]}),e.jsx(s,{fullWidth:!0,label:"Authentication code",value:G,onChange:a=>te(a.target.value)})]}),e.jsxs(J,{children:[e.jsx(c,{onClick:()=>S(!1),children:"Cancel"}),e.jsx(c,{variant:"contained",onClick:ce,sx:{background:"linear-gradient(135deg, #00d4ff 0%, #667eea 100%)",color:"#000"},children:"Verify & Enable"})]})]})]})};export{Le as default};
