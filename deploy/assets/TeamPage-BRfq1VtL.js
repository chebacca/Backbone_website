const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/FirestoreLicenseService-DF3qBrOS.js","assets/index-CZ6EhAF9.js","assets/mui-D8UjIA2s.js","assets/vendor-CjD1bmmO.js","assets/stripe-CUttI3Gx.js","assets/index-CBai7h7s.css","assets/index.esm-ClhtutUx.js","assets/index.esm-COtph9ny.js","assets/index.esm-DOG5cvVU.js","assets/firebase-CfPrsEWw.js"])))=>i.map(i=>d[i]);
import{u as ba,_ as S,c as We,e as Be}from"./index-CZ6EhAF9.js";import{j as e,B as G,T as V,a as $,aS as wa,G as P,aT as va,p as Me,u as qe,ao as xa,c as Ta,ap as Pa,aq as ya,ar as Ge,as as N,at as Sa,ag as Ea,r as Ye,aU as ja,aV as Ia,g as te,au as Aa,aW as Ma,ai as _a,a4 as Da,a5 as C,y as Se,ay as Ca,aX as Qe,aw as Ee,aB as me,aC as ge,aD as ue,d as K,e as U,aG as je,aH as Ie,aI as Ae,I as he,V as pe,h as fe,aE as be,al as Ra}from"./mui-D8UjIA2s.js";import{r as y}from"./vendor-CjD1bmmO.js";import{u as Oa}from"./notistack.esm-Ca-E78ev.js";import{M as we}from"./MetricCard-B_DL-kwb.js";import"./stripe-CUttI3Gx.js";const Na=u=>{switch(u){case"admin":return"secondary";case"owner":return"secondary";case"manager":return"info";case"member":return"success";case"viewer":return"default";default:return"default"}},La=u=>{switch(u){case"active":return"success";case"pending":return"warning";case"suspended":return"error";case"removed":return"default";default:return"default"}},Fa=u=>{switch(u){case"active":return e.jsx(Me,{});case"pending":return e.jsx(Ra,{});case"suspended":return e.jsx(Qe,{});default:return e.jsx(Me,{})}},Ya=()=>{const{enqueueSnackbar:u}=Oa(),{user:g}=ba(),He=()=>{const a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$%^&*";let s="";for(let i=0;i<12;i++)s+=a.charAt(Math.floor(Math.random()*a.length));return s},[Xe,Q]=y.useState([]),[k,Y]=y.useState({totalMembers:0,activeMembers:0,pendingInvites:0,availableSeats:0,totalSeats:0}),R=!0,[M,ne]=y.useState(null),[za,oe]=y.useState(""),[$a,_e]=y.useState(null),[L,ve]=y.useState(null),H=(a,{includeTime:s=!1}={})=>{try{if(!a){const l=new Date;return s?l.toISOString():l.toISOString().slice(0,10)}if(typeof a=="string"||typeof a=="number"){const l=new Date(a);if(!Number.isNaN(l.getTime()))return s?l.toISOString():l.toISOString().slice(0,10)}if(typeof a=="object"){const l=a._seconds,w=a._nanoseconds??0;if(typeof l=="number"){const b=l*1e3+Math.floor(w/1e6),x=new Date(b);return s?x.toISOString():x.toISOString().slice(0,10)}}}catch{}const i=new Date;return s?i.toISOString():i.toISOString().slice(0,10)};y.useEffect(()=>{let a=!0;return(async()=>{try{console.log("[TeamPage] useEffect - Web-only mode detection:"),console.log("  - isWebOnlyHost:",R),console.log("  - hostname:",typeof window<"u"?window.location.hostname:"N/A"),console.log("  - WEBONLY_MODE:",typeof window<"u"?window.WEBONLY_MODE:"N/A"),console.log("  - localStorage WEB_ONLY:",typeof window<"u"?localStorage.getItem("WEB_ONLY"):"N/A"),console.log("  - localStorage USE_FIRESTORE:",typeof window<"u"?localStorage.getItem("USE_FIRESTORE"):"N/A"),console.log("  - user?.id:",g==null?void 0:g.id);let s=null,i=[],l=null,w=null;if(R&&(g!=null&&g.id))try{console.log("[TeamPage] Web-only mode: Getting data from Firestore...");const{firestoreLicenseService:r}=await S(async()=>{const{firestoreLicenseService:p}=await import("./FirestoreLicenseService-DF3qBrOS.js");return{firestoreLicenseService:p}},__vite__mapDeps([0,1,2,3,4,5,6,7,8])),{getFirestore:o,collection:t,query:n,where:c,getDocs:f}=await S(async()=>{const{getFirestore:p,collection:j,query:z,where:D,getDocs:h}=await import("./index.esm-ClhtutUx.js");return{getFirestore:p,collection:j,query:z,where:D,getDocs:h}},__vite__mapDeps([6,7])),{db:v}=await S(async()=>{const{db:p}=await import("./firebase-CfPrsEWw.js");return{db:p}},__vite__mapDeps([9,1,2,3,4,5,7,6,8])),T=await f(n(t(v,"users"),c("id","==",g.id)));if(console.log("[TeamPage] User document query result:",T.empty?"empty":"found",T.docs.length,"docs"),T.empty)console.warn("[TeamPage] No user document found in Firestore for ID:",g.id);else{const p=T.docs[0].data();if(console.log("[TeamPage] User data from Firestore:",p),p.organizationId){console.log("[TeamPage] User has organizationId:",p.organizationId);const j=await f(n(t(v,"organizations"),c("id","==",p.organizationId)));console.log("[TeamPage] Organization query result:",j.empty?"empty":"found",j.docs.length,"docs"),j.empty?(console.warn("[TeamPage] No organization found for ID:",p.organizationId),console.log("[TeamPage] Creating fallback organization object..."),s={id:p.organizationId,name:"Enterprise Organization",type:"ENTERPRISE",status:"ACTIVE"},console.log("[TeamPage] Created fallback organization:",s)):(s={id:p.organizationId,...j.docs[0].data()},console.log("[TeamPage] Found organization in Firestore:",s));const z=n(t(v,"teamMembers"),c("organizationId","==",p.organizationId));i=(await f(z)).docs.map(F=>({id:F.id,...F.data()})),console.log("[TeamPage] Found team members in Firestore:",i.length);const h=n(t(v,"org_members"),c("userId","==",g.id)),A=await f(h);A.empty?console.warn("[TeamPage] No org_members record found for user:",g.id):(w=A.docs[0].data().role,console.log("[TeamPage] User role from Firestore:",w))}else{console.warn("[TeamPage] User has no organizationId in Firestore"),console.log("[TeamPage] Trying to get organization ID from team members...");const j=n(t(v,"teamMembers")),D=(await f(j)).docs.find(h=>h.data().email===g.email);if(D){const h=D.data();if(console.log("[TeamPage] Found team member data:",h),h.organizationId){console.log("[TeamPage] Using organization ID from team member:",h.organizationId);const A=await f(n(t(v,"organizations"),c("id","==",h.organizationId)));if(A.empty){console.log("[TeamPage] Creating fallback organization from team member data..."),s={id:h.organizationId,name:"Enterprise Organization",type:"ENTERPRISE",status:"ACTIVE"},console.log("[TeamPage] Created fallback organization from team member:",s);const F=n(t(v,"teamMembers"),c("organizationId","==",h.organizationId));i=(await f(F)).docs.map(B=>({id:B.id,...B.data()})),console.log("[TeamPage] Found team members from team member query:",i.length)}else{s={id:h.organizationId,...A.docs[0].data()},console.log("[TeamPage] Found organization from team member:",s);const F=n(t(v,"teamMembers"),c("organizationId","==",h.organizationId));i=(await f(F)).docs.map(B=>({id:B.id,...B.data()})),console.log("[TeamPage] Found team members from team member query:",i.length)}}}}}}catch(r){console.warn("[TeamPage] Failed to get data from Firestore:",r)}if(!s){a&&(ne(null),oe(""),Q([]),Y({totalMembers:0,activeMembers:0,pendingInvites:0,availableSeats:0,totalSeats:0}));return}const b=i.filter(r=>r.status==="ACTIVE").length;let x=0;l&&l.status==="ACTIVE"&&l.organizationId===s.id&&(x=Number(l.seats||0));let E=Math.max(0,x-b);if(console.log(`[TeamPage] Web-only mode check: ${R}, User ID: ${g==null?void 0:g.id}, Org ID: ${s==null?void 0:s.id}`),R&&(g!=null&&g.id)&&(s!=null&&s.id))try{const{firestoreLicenseService:r}=await S(async()=>{const{firestoreLicenseService:t}=await import("./FirestoreLicenseService-DF3qBrOS.js");return{firestoreLicenseService:t}},__vite__mapDeps([0,1,2,3,4,5,6,7,8]));console.log(`[TeamPage] Checking Firestore licenses for organization: ${s.id}`);let o=await r.getUnassignedLicenses(s.id);if(console.log(`[TeamPage] Unassigned licenses found: ${o.length}`),o.length===0){console.log("[TeamPage] No unassigned licenses found, trying organization licenses...");const t=await r.getOrganizationLicenses(s.id);console.log(`[TeamPage] Organization licenses found: ${t.length}`),o=t.filter(n=>n.status==="ACTIVE"&&!n.assignedToUserId&&!n.assignedToEmail),console.log(`[TeamPage] Filtered available licenses: ${o.length}`)}if(o.length===0){console.log("[TeamPage] No organization licenses found, trying fallback method...");const t=await r.getAllAccessibleLicenses();console.log(`[TeamPage] Fallback licenses found: ${t.length}`);const n=t.filter(c=>!c.organizationId||c.organizationId===s.id||!c.assignedToUserId&&!c.assignedToEmail);console.log(`[TeamPage] Filtered licenses for org: ${n.length}`),o=n.filter(c=>c.status==="ACTIVE"&&!c.assignedToUserId&&!c.assignedToEmail)}if(o.length===0&&(console.log("[TeamPage] Still no licenses found, trying final fallback..."),o=await r.getAllUnassignedLicenses(),console.log(`[TeamPage] Final fallback found: ${o.length} unassigned licenses`)),console.log(`[TeamPage] Final result: ${o.length} available licenses for organization ${s.id}`),console.log("[TeamPage] License details:",o.map(t=>({id:t.id,status:t.status,assignedToUserId:t.assignedToUserId,assignedToEmail:t.assignedToEmail,organizationId:t.organizationId}))),o.length>0){const t=await r.getOrganizationLicenses(s.id);x=t.filter(c=>c.status==="ACTIVE").length;const n=t.filter(c=>c.status==="ACTIVE"&&(c.assignedToUserId||c.assignedToEmail));E=o.length,console.log(`[TeamPage] Updated from Firestore: totalSeats=${x}, assignedLicenses=${n.length}, availableSeats=${E}`)}}catch(r){console.warn("[TeamPage] Failed to check Firestore licenses:",r),console.error("[TeamPage] Error details:",r)}const m=(Array.isArray(i)?i:[]).filter(r=>r&&r.status!=="REMOVED"&&r.status!=="removed").map(r=>{var T,p;const o=String(r.email||"user@example.com"),t=o.split("@")[0]||"User",n={OWNER:"owner",ENTERPRISE_ADMIN:"admin",MANAGER:"manager",MEMBER:"member"},c={INVITED:"pending",ACTIVE:"active",REMOVED:"removed"},f=r.firstName||((T=r.name)==null?void 0:T.split(" ")[0])||t.charAt(0).toUpperCase()+t.slice(1),v=r.lastName||((p=r.name)==null?void 0:p.split(" ").slice(1).join(" "))||"";return{id:String(r.id||`${o}-${Math.random().toString(36).slice(2)}`),firstName:f,lastName:v,email:o,role:n[String(r.role)]||"member",status:c[String(r.status)]||"active",department:r.department||"",licenseType:r.licenseType||"PROFESSIONAL",joinedAt:H(r.joinedAt),lastActive:H(r.updatedAt||r.joinedAt||new Date,{includeTime:!0})}});if(!a)return;ne(s.id),oe(s.name||"Organization"),_e(w||null),console.log("[TeamPage] Organization ID:",s.id,"Type:",typeof s.id,"Length:",String(s.id).length),console.log("[TeamPage] Organization ID characters:",Array.from(String(s.id)).map(r=>`${r}(${r.charCodeAt(0)})`).join(" ")),ve(l?{id:String(l.id),tier:String(l.tier).toUpperCase(),seats:Number(l.seats||0),status:String(l.status||""),organizationId:l.organizationId}:null),Q(m),Y({totalMembers:m.length,activeMembers:b,pendingInvites:0,availableSeats:E,totalSeats:x})}catch(s){if(!a)return;console.error("[TeamPage] Failed to load team data:",s),Q([]),Y({totalMembers:0,activeMembers:0,pendingInvites:0,availableSeats:0,totalSeats:0})}})(),()=>{a=!1}},[g==null?void 0:g.email]),y.useEffect(()=>{if(!M)return;let a;return(async()=>{try{const{db:s}=await S(async()=>{const{db:E}=await import("./firebase-CfPrsEWw.js");return{db:E}},__vite__mapDeps([9,1,2,3,4,5,7,6,8])),{collection:i,query:l,where:w,onSnapshot:b}=await S(async()=>{const{collection:E,query:m,where:r,onSnapshot:o}=await import("./index.esm-ClhtutUx.js");return{collection:E,query:m,where:r,onSnapshot:o}},__vite__mapDeps([6,7])),x=l(i(s,"teamMembers"),w("organizationId","==",String(M)));a=b(x,E=>{console.log("[TeamPage] Firestore subscription: received",E.docs.length,"team members");const r=E.docs.filter(t=>{const n=t.data(),c=n&&(n.status==="REMOVED"||n.status==="removed");return c&&console.log("[TeamPage] Filtering out removed member:",n.email,"with status:",n.status),n&&!c}).map(t=>{const n=t.data(),c=String(n.email||"user@example.com"),f=c.split("@")[0]||"User",v=n.firstName||f.charAt(0).toUpperCase()+f.slice(1),T=n.lastName||"",p={INVITED:"pending",ACTIVE:"active",REMOVED:"removed",SUSPENDED:"suspended"},j={OWNER:"owner",ENTERPRISE_ADMIN:"admin",MANAGER:"manager",MEMBER:"member"};return{id:t.id,firstName:v,lastName:T,email:c,role:j[String(n.role)]||"member",status:p[String(n.status)]||"active",department:n.department||"",licenseType:n.licenseType||"PROFESSIONAL",joinedAt:H(n.createdAt),lastActive:H(n.updatedAt||n.createdAt||new Date,{includeTime:!0})}}).sort((t,n)=>{const c=f=>{if(!f)return 0;const v=new Date(f);return isNaN(v.getTime())?0:v.getTime()};return c(n.joinedAt)-c(t.joinedAt)}),o=r.filter(t=>t.status==="active").length;Q(r),Y(t=>({...t,totalMembers:r.length,activeMembers:o,pendingInvites:0,availableSeats:Math.max(0,t.totalSeats-o)}))})}catch(s){console.warn("[TeamPage] Firestore subscription failed:",s)}})(),()=>{try{a&&a()}catch{}}},[M]);const re=async()=>{try{let a=null,s=[],i=null,l=null;if(R&&(g!=null&&g.id))try{console.log("[TeamPage] Refresh: Web-only mode - Getting data from Firestore...");const{firestoreLicenseService:m}=await S(async()=>{const{firestoreLicenseService:T}=await import("./FirestoreLicenseService-DF3qBrOS.js");return{firestoreLicenseService:T}},__vite__mapDeps([0,1,2,3,4,5,6,7,8])),{getFirestore:r,collection:o,query:t,where:n,getDocs:c}=await S(async()=>{const{getFirestore:T,collection:p,query:j,where:z,getDocs:D}=await import("./index.esm-ClhtutUx.js");return{getFirestore:T,collection:p,query:j,where:z,getDocs:D}},__vite__mapDeps([6,7])),{db:f}=await S(async()=>{const{db:T}=await import("./firebase-CfPrsEWw.js");return{db:T}},__vite__mapDeps([9,1,2,3,4,5,7,6,8])),v=await c(t(o(f,"users"),n("id","==",g.id)));if(!v.empty){const T=v.docs[0].data();if(T.organizationId){const p=await c(t(o(f,"organizations"),n("id","==",T.organizationId)));p.empty||(a={id:T.organizationId,...p.docs[0].data()},console.log("[TeamPage] Refresh: Found organization in Firestore:",a));const j=t(o(f,"teamMembers"),n("organizationId","==",T.organizationId));s=(await c(j)).docs.map(A=>({id:A.id,...A.data()})),console.log("[TeamPage] Refresh: Found team members in Firestore:",s.length);const D=t(o(f,"org_members"),n("userId","==",g.id)),h=await c(D);h.empty||(l=h.docs[0].data().role,console.log("[TeamPage] Refresh: User role from Firestore:",l))}}}catch(m){console.warn("[TeamPage] Refresh: Failed to get data from Firestore:",m)}if(!a){ne(null),oe(""),Q([]),Y({totalMembers:0,activeMembers:0,pendingInvites:0,availableSeats:0,totalSeats:0});return}const w=s.filter(m=>m.status==="ACTIVE").length;let b=0;i&&i.status==="ACTIVE"&&i.organizationId===a.id&&(b=Number(i.seats||0));let x=Math.max(0,b-w);if(R&&(g!=null&&g.id)&&(a!=null&&a.id))try{const{firestoreLicenseService:m}=await S(async()=>{const{firestoreLicenseService:o}=await import("./FirestoreLicenseService-DF3qBrOS.js");return{firestoreLicenseService:o}},__vite__mapDeps([0,1,2,3,4,5,6,7,8]));console.log(`[TeamPage] Refresh - Checking Firestore licenses for organization: ${a.id}`);let r=await m.getUnassignedLicenses(a.id);if(console.log(`[TeamPage] Refresh - Unassigned licenses found: ${r.length}`),r.length===0){console.log("[TeamPage] Refresh - No unassigned licenses found, trying organization licenses...");const o=await m.getOrganizationLicenses(a.id);console.log(`[TeamPage] Refresh - Organization licenses found: ${o.length}`),r=o.filter(t=>t.status==="ACTIVE"&&!t.assignedToUserId&&!t.assignedToEmail),console.log(`[TeamPage] Refresh - Filtered available licenses: ${r.length}`)}if(r.length===0){console.log("[TeamPage] Refresh - No organization licenses found, trying fallback method...");const o=await m.getAllAccessibleLicenses();console.log(`[TeamPage] Refresh - Fallback licenses found: ${o.length}`);const t=o.filter(n=>!n.organizationId||n.organizationId===a.id||!n.assignedToUserId&&!n.assignedToEmail);console.log(`[TeamPage] Refresh - Filtered licenses for org: ${t.length}`),r=t.filter(n=>n.status==="ACTIVE"&&!n.assignedToUserId&&!n.assignedToEmail)}if(r.length===0&&(console.log("[TeamPage] Refresh - Still no licenses found, trying final fallback..."),r=await m.getAllUnassignedLicenses(),console.log(`[TeamPage] Refresh - Final fallback found: ${r.length} unassigned licenses`)),console.log(`[TeamPage] Refresh - Final result: ${r.length} available licenses for organization ${a.id}`),r.length>0){const o=await m.getOrganizationLicenses(a.id);b=o.filter(n=>n.status==="ACTIVE").length;const t=o.filter(n=>n.status==="ACTIVE"&&(n.assignedToUserId||n.assignedToEmail));x=r.length,console.log(`[TeamPage] Refresh - Updated from Firestore: totalSeats=${b}, assignedLicenses=${t.length}, availableSeats=${x}`)}}catch(m){console.warn("[TeamPage] Refresh - Failed to check Firestore licenses:",m)}const E=(Array.isArray(s)?s:[]).filter(m=>m&&m.status!=="REMOVED"&&m.status!=="removed").map(m=>{const r=String(m.email||"user@example.com"),o=r.split("@")[0]||"User",t={OWNER:"owner",ENTERPRISE_ADMIN:"admin",MANAGER:"manager",MEMBER:"member"},n={INVITED:"pending",ACTIVE:"active",REMOVED:"removed"};return{id:String(m.id||`${r}-${Math.random().toString(36).slice(2)}`),firstName:o.charAt(0).toUpperCase()+o.slice(1),lastName:"",email:r,role:t[String(m.role)]||"member",status:n[String(m.status)]||"active",department:m.department||"",licenseType:m.licenseType||"PROFESSIONAL",joinedAt:H(m.joinedAt),lastActive:H(m.updatedAt||m.joinedAt||new Date,{includeTime:!0})}});ne(a.id),oe(a.name||"Organization"),_e(l||null),ve(i?{id:String(i.id),tier:String(i.tier).toUpperCase(),seats:Number(i.seats||0),status:String(i.status||""),organizationId:i.organizationId}:null),Q(E),Y({totalMembers:E.length,activeMembers:w,pendingInvites:0,availableSeats:x,totalSeats:b})}catch(a){console.error("[TeamPage] Failed to refresh team data:",a)}},[De,Ce]=y.useState(null),[_,Re]=y.useState(null),[Ze,X]=y.useState(!1),[Je,ie]=y.useState(!1),[Oe,Ne]=y.useState(0),[Ke,ee]=y.useState(!1),[ae,le]=y.useState(!1),[Le,Fe]=y.useState(!1),[ze,$e]=y.useState(!1),[xe,ea]=y.useState(!1),[Te,aa]=y.useState(!1),[I,Z]=y.useState({newPassword:"",confirmPassword:"",email:"",role:"member",status:"active"}),[sa,Pe]=y.useState(!1),[O,ye]=y.useState(null),[d,W]=y.useState({email:"",firstName:"",lastName:"",role:"member",department:"",message:"",password:"",confirmPassword:""}),ta=(a,s)=>{Ce(a.currentTarget),Re(s)},ce=()=>{Ce(null)},na=async()=>{var a,s,i,l,w,b,x,E,m,r;if(M){if(d.password||d.confirmPassword){if(d.password!==d.confirmPassword){u("Passwords do not match",{variant:"error"});return}if(d.password.length<8){u("Password must be at least 8 characters long",{variant:"error"});return}}try{if(typeof window<"u"&&(window.WEBONLY_MODE===!0||localStorage.getItem("WEB_ONLY")==="true"||localStorage.getItem("USE_FIRESTORE")==="true"||window.location.hostname.includes("backbone-client.web.app")||window.location.hostname.includes("web.app")||window.location.hostname.includes("firebaseapp.com"))){console.log("[TeamPage] WebOnly mode detected - checking Firebase Auth...");const{db:t,auth:n}=await S(async()=>{const{db:h,auth:A}=await import("./firebase-CfPrsEWw.js");return{db:h,auth:A}},__vite__mapDeps([9,1,2,3,4,5,7,6,8])),{collection:c,addDoc:f,serverTimestamp:v,doc:T,setDoc:p}=await S(async()=>{const{collection:h,addDoc:A,serverTimestamp:F,doc:q,setDoc:B}=await import("./index.esm-ClhtutUx.js");return{collection:h,addDoc:A,serverTimestamp:F,doc:q,setDoc:B}},__vite__mapDeps([6,7])),{createUserWithEmailAndPassword:j,signInAnonymously:z}=await S(async()=>{const{createUserWithEmailAndPassword:h,signInAnonymously:A}=await import("./index.esm-DOG5cvVU.js");return{createUserWithEmailAndPassword:h,signInAnonymously:A}},__vite__mapDeps([8,7]));if(!n.currentUser){console.log("[TeamPage] No Firebase Auth user - attempting anonymous sign-in...");try{await z(n),console.log("[TeamPage] Anonymous sign-in successful")}catch(h){throw console.error("[TeamPage] Anonymous sign-in failed:",h),new Error("Firebase authentication required for team member creation")}}console.log("[TeamPage] Creating Firebase Auth user account...");const D=d.password||He();try{const A=(await j(n,d.email.trim(),D)).user;console.log("[TeamPage] Firebase Auth user created successfully:",A.uid);const F={id:A.uid,email:d.email.trim(),firstName:d.firstName.trim(),lastName:d.lastName.trim(),licenseType:"PROFESSIONAL",organizationId:M,role:"MEMBER",status:"ACTIVE",department:((a=d.department)==null?void 0:a.trim())||void 0,createdBy:((s=n.currentUser)==null?void 0:s.uid)||(g==null?void 0:g.id)||"unknown",createdAt:v(),updatedAt:v(),temporaryPassword:D},q=Object.fromEntries(Object.entries(F).filter(([se,J])=>J!=null));console.log("[TeamPage] Creating team member in Firestore with data:",q);const B=await p(T(t,"teamMembers",A.uid),q);console.log("[TeamPage] Team member created successfully in Firestore:",A.uid);try{console.log("[TeamPage] Attempting to assign license to new team member via API...");const{firestoreLicenseService:se}=await S(async()=>{const{firestoreLicenseService:Ve}=await import("./FirestoreLicenseService-DF3qBrOS.js");return{firestoreLicenseService:Ve}},__vite__mapDeps([0,1,2,3,4,5,6,7,8])),J=await se.getUnassignedLicenses(M);if(console.log(`[TeamPage] Found ${J.length} available licenses for organization ${M}`),J.length>0){const de=J.sort((ha,pa)=>{const Ue={ENTERPRISE:3,PRO:2,BASIC:1},fa=Ue[ha.tier]||0;return(Ue[pa.tier]||0)-fa})[0];console.log(`[TeamPage] Assigning license ${de.id} (${de.tier}) to new team member`),await se.assignLicense(de.id,d.email.trim()),console.log(`[TeamPage] Successfully assigned license ${de.id} to ${d.email}`),u(`License automatically assigned to ${d.email}`,{variant:"info"})}else console.warn("[TeamPage] No available licenses found for automatic assignment"),u("Team member created but no licenses available for automatic assignment",{variant:"warning"})}catch(se){console.error("[TeamPage] Failed to automatically assign license:",se),u("Team member created but license assignment failed",{variant:"warning"})}const ua=d.password?`Team member ${d.email} created successfully with your custom password!`:`Team member ${d.email} created successfully! Temporary password: ${D}`;u(ua,{variant:"success"}),X(!1),W({email:"",firstName:"",lastName:"",role:"member",department:"",message:"",password:"",confirmPassword:""}),await re()}catch(h){throw console.error("[TeamPage] Firebase Auth user creation failed:",h),h.code==="auth/email-already-in-use"?u(`User with email ${d.email} already exists in Firebase Auth`,{variant:"error"}):h.code==="auth/weak-password"?u("Password is too weak. Please use a stronger password.",{variant:"error"}):u(`Failed to create Firebase Auth user: ${h.message}`,{variant:"error"}),h}}else{console.log("[TeamPage] Using HTTP API for team member creation");const t={email:d.email.trim(),firstName:d.firstName.trim(),lastName:d.lastName.trim(),licenseType:"PROFESSIONAL",organizationId:M,createdBy:(g==null?void 0:g.id)||"unknown",sendWelcomeEmail:!0};d.department&&d.department.trim()&&(t.department=d.department.trim()),d.password&&d.password.trim()&&(t.temporaryPassword=d.password.trim());const n=Object.fromEntries(Object.entries(t).filter(([f,v])=>v!=null));console.log("[TeamPage] Creating team member with payload:",n),console.log("[TeamPage] Organization ID:",M,"Type:",typeof M),console.log("[TeamPage] Organization ID validation test:",/^[a-zA-Z0-9\-_\.]+$/.test(String(M))),console.log("[TeamPage] Organization ID characters:",Array.from(String(M)).map(f=>`${f}(${f.charCodeAt(0)})`).join(" "));const c=await We.post(Be.teamMembers.create(),n);if((i=c.data)!=null&&i.success){const f=c.data.data.teamMember,v=c.data.data.temporaryPassword;try{console.log("[TeamPage] Attempting to assign license to new team member via API...");const{firestoreLicenseService:p}=await S(async()=>{const{firestoreLicenseService:z}=await import("./FirestoreLicenseService-DF3qBrOS.js");return{firestoreLicenseService:z}},__vite__mapDeps([0,1,2,3,4,5,6,7,8])),j=await p.getUnassignedLicenses(M);if(console.log(`[TeamPage] Found ${j.length} available licenses for organization ${M}`),j.length>0){const D=j.sort((h,A)=>{const F={ENTERPRISE:3,PRO:2,BASIC:1},q=F[h.tier]||0;return(F[A.tier]||0)-q})[0];console.log(`[TeamPage] Assigning license ${D.id} (${D.tier}) to new team member`),await p.assignLicense(D.id,d.email.trim()),console.log(`[TeamPage] Successfully assigned license ${D.id} to ${d.email}`),u(`License automatically assigned to ${d.email}`,{variant:"info"})}else console.warn("[TeamPage] No available licenses found for automatic assignment"),u("Team member created but no licenses available for automatic assignment",{variant:"warning"})}catch(p){console.error("[TeamPage] Failed to automatically assign license:",p),u("Team member created but license assignment failed",{variant:"warning"})}const T=d.password?`Team member ${f.email} created successfully with your custom password!`:`Team member ${f.email} created successfully! Temporary password: ${v}`;u(T,{variant:"success"}),X(!1),W({email:"",firstName:"",lastName:"",role:"member",department:"",message:"",password:"",confirmPassword:""}),await re()}else throw new Error("Failed to create team member")}}catch(o){if(console.error("[TeamPage] Team member creation failed:",o),o!=null&&o.response){console.error("[TeamPage] Error response:",(l=o==null?void 0:o.response)==null?void 0:l.data),console.error("[TeamPage] Error status:",(w=o==null?void 0:o.response)==null?void 0:w.status),console.error("[TeamPage] Error headers:",(b=o==null?void 0:o.response)==null?void 0:b.headers);const t=((E=(x=o==null?void 0:o.response)==null?void 0:x.data)==null?void 0:E.message)||((r=(m=o==null?void 0:o.response)==null?void 0:m.data)==null?void 0:r.error)||(o==null?void 0:o.message)||"Failed to create team member";u(t,{variant:"error"})}else{const t=(o==null?void 0:o.message)||"Failed to create team member";u(t,{variant:"error"})}}}},oa=y.useMemo(()=>String((g==null?void 0:g.role)||"").toUpperCase()==="SUPERADMIN",[g==null?void 0:g.role]),ra=()=>{if(!L){u("No active subscription found for this organization.",{variant:"warning"});return}Ne(Number(L.seats||0)),ie(!0)},ia=async()=>{var a,s;if(L)try{const i=L.tier,l=Number(Oe||0);if(i==="BASIC"&&l!==1){u("Basic plan supports exactly 1 seat.",{variant:"warning"});return}if(i==="PRO"&&(l<1||l>50)){u("Pro plan seats must be between 1 and 50.",{variant:"warning"});return}if(i==="ENTERPRISE"&&l<10){u("Enterprise requires minimum 10 seats.",{variant:"warning"});return}await We.put(Be.subscriptions.update(L.id),{seats:l}),ve(w=>w&&{...w,seats:l}),Y(w=>({...w,totalSeats:l,availableSeats:Math.max(0,l-(w.activeMembers+w.pendingInvites))})),u("Seats updated successfully",{variant:"success"}),ie(!1)}catch(i){const l=((s=(a=i==null?void 0:i.response)==null?void 0:a.data)==null?void 0:s.message)||(i==null?void 0:i.message)||"Failed to update seats";u(l,{variant:"error"})}},la=()=>{Z({newPassword:"",confirmPassword:"",email:(_==null?void 0:_.email)||"",role:(_==null?void 0:_.role)||"member",status:(_==null?void 0:_.status)||"active"}),Fe(!1),$e(!1),ee(!0)},ca=async()=>{var l,w;if(!_)return;if(_.status!=="active"){u("Password can only be set after the member has joined (status Active).",{variant:"warning"});return}const a=_.email,{newPassword:s,confirmPassword:i}=I;if(!s||s.length<8){u("Password must be at least 8 characters.",{variant:"warning"});return}if(s!==i){u("Passwords do not match.",{variant:"warning"});return}try{if(le(!0),R){console.log("[TeamPage] Web-only mode detected - updating password in Firestore...");const{db:b}=await S(async()=>{const{db:r}=await import("./firebase-CfPrsEWw.js");return{db:r}},__vite__mapDeps([9,1,2,3,4,5,7,6,8])),{doc:x,updateDoc:E,serverTimestamp:m}=await S(async()=>{const{doc:r,updateDoc:o,serverTimestamp:t}=await import("./index.esm-ClhtutUx.js");return{doc:r,updateDoc:o,serverTimestamp:t}},__vite__mapDeps([6,7]));await E(x(b,"teamMembers",_.id),{temporaryPassword:s,updatedAt:m()})}u(`Password set for ${a}`,{variant:"success"}),ee(!1)}catch(b){const x=((w=(l=b==null?void 0:b.response)==null?void 0:l.data)==null?void 0:w.message)||(b==null?void 0:b.message)||"Failed to set password";u(x,{variant:"error"})}finally{le(!1)}},da=async()=>{var a,s;if(!(!_||!M))try{le(!0);const i={admin:"ENTERPRISE_ADMIN",owner:"ENTERPRISE_ADMIN",manager:"MANAGER",member:"MEMBER",viewer:"MEMBER"},l={pending:"INVITED",active:"ACTIVE",suspended:"SUSPENDED",removed:"REMOVED"};if(console.log("Updating member:",{memberId:_.id,email:I.email,role:i[I.role],status:l[I.status]}),R){console.log("[TeamPage] Web-only mode detected - updating team member in Firestore...");const{db:w}=await S(async()=>{const{db:m}=await import("./firebase-CfPrsEWw.js");return{db:m}},__vite__mapDeps([9,1,2,3,4,5,7,6,8])),{doc:b,updateDoc:x,serverTimestamp:E}=await S(async()=>{const{doc:m,updateDoc:r,serverTimestamp:o}=await import("./index.esm-ClhtutUx.js");return{doc:m,updateDoc:r,serverTimestamp:o}},__vite__mapDeps([6,7]));await x(b(w,"teamMembers",_.id),{email:I.email,role:i[I.role],status:l[I.status],updatedAt:E()}),I.newPassword&&I.confirmPassword&&I.newPassword===I.confirmPassword&&await x(b(w,"teamMembers",_.id),{temporaryPassword:I.newPassword,updatedAt:E()})}u("Member updated successfully",{variant:"success"}),ee(!1),await re()}catch(i){console.error("[TeamPage] Update member failed:",i);const l=((s=(a=i==null?void 0:i.response)==null?void 0:a.data)==null?void 0:s.message)||(i==null?void 0:i.message)||"Failed to update member";u(l,{variant:"error"})}finally{le(!1)}},ma=()=>{_&&(ye(_),Pe(!0),ce())},ga=async()=>{if(!(!O||!M))try{if(R){console.log("[TeamPage] Web-only mode detected - removing team member in Firestore...");const{db:a}=await S(async()=>{const{db:t}=await import("./firebase-CfPrsEWw.js");return{db:t}},__vite__mapDeps([9,1,2,3,4,5,7,6,8])),{doc:s,updateDoc:i,serverTimestamp:l,deleteDoc:w,collection:b,query:x,where:E,getDocs:m}=await S(async()=>{const{doc:t,updateDoc:n,serverTimestamp:c,deleteDoc:f,collection:v,query:T,where:p,getDocs:j}=await import("./index.esm-ClhtutUx.js");return{doc:t,updateDoc:n,serverTimestamp:c,deleteDoc:f,collection:v,query:T,where:p,getDocs:j}},__vite__mapDeps([6,7])),{firestoreLicenseService:r}=await S(async()=>{const{firestoreLicenseService:t}=await import("./FirestoreLicenseService-DF3qBrOS.js");return{firestoreLicenseService:t}},__vite__mapDeps([0,1,2,3,4,5,6,7,8])),{getAuth:o}=await S(async()=>{const{getAuth:t}=await import("./index.esm-DOG5cvVU.js");return{getAuth:t}},__vite__mapDeps([8,7]));console.log(`[TeamPage] Finding licenses assigned to ${O.email}...`);try{const t=x(b(a,"licenses"),E("assignedToEmail","==",O.email)),n=await m(t);if(n.empty)console.log(`[TeamPage] No licenses found for ${O.email}`);else{console.log(`[TeamPage] Found ${n.size} licenses assigned to ${O.email}`);for(const c of n.docs)console.log(`[TeamPage] Unassigning license ${c.id} from ${O.email}`),await r.unassignLicense(c.id);console.log(`[TeamPage] Successfully released all licenses for ${O.email}`),u(`Released ${n.size} licenses from ${O.email}`,{variant:"info"})}}catch(t){console.error("[TeamPage] Error releasing licenses:",t)}await i(s(a,"teamMembers",O.id),{status:"REMOVED",updatedAt:l()});try{console.log(`[TeamPage] Attempting to delete Firebase Auth user for ${O.email}...`);const t=o();console.log("[TeamPage] Firebase Auth user deletion should be handled by a backend process")}catch(t){console.warn("[TeamPage] Could not delete Firebase Auth user (expected in client code):",t)}}u(`${O.email} removed from team`,{variant:"warning"}),await re()}catch(a){console.error("[TeamPage] Remove member failed:",a),u((a==null?void 0:a.message)||"Failed to remove member",{variant:"error"})}finally{Pe(!1),ye(null)}},ke=()=>{Pe(!1),ye(null)};return y.useMemo(()=>k.totalSeats<=0?0:(k.totalSeats-k.availableSeats)/k.totalSeats*100,[k.totalSeats,k.availableSeats]),e.jsxs(G,{children:[e.jsx(G,{children:e.jsxs(G,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:4},children:[e.jsxs(G,{children:[e.jsx(V,{variant:"h4",sx:{fontWeight:700,mb:1},children:"Team Management"}),e.jsx(V,{variant:"body1",color:"text.secondary",sx:{mb:2},children:"Create and manage your team members with automatic Firebase Authentication setup. Each member gets their own account and temporary password."})]}),e.jsx($,{variant:"contained",startIcon:e.jsx(wa,{}),onClick:()=>X(!0),disabled:!1,sx:{background:"linear-gradient(135deg, #00d4ff 0%, #667eea 100%)",color:"#000",fontWeight:600},children:"Add Team Member"}),oa&&e.jsxs($,{variant:"outlined",onClick:ra,sx:{ml:2},children:["Manage Seats",L?` (${L.seats})`:""]}),typeof window<"u"&&window.location.hostname==="localhost"&&e.jsx($,{variant:"outlined",onClick:async()=>{try{console.log("ðŸ” [TeamPage] Debug: Testing license service...");const{firestoreLicenseService:a}=await S(async()=>{const{firestoreLicenseService:s}=await import("./FirestoreLicenseService-DF3qBrOS.js");return{firestoreLicenseService:s}},__vite__mapDeps([0,1,2,3,4,5,6,7,8]));if(M){console.log("ðŸ” [TeamPage] Debug: Testing with org ID:",M);const s=await a.getUnassignedLicenses(M),i=await a.getOrganizationLicenses(M),l=await a.getAllAccessibleLicenses();console.log("ðŸ“Š [TeamPage] Debug Results:"),console.log("  - Unassigned licenses:",s.length),console.log("  - Organization licenses:",i.length),console.log("  - All accessible licenses:",l.length),console.log("  - Unassigned details:",s),console.log("  - Org licenses details:",i)}else console.log("âŒ [TeamPage] Debug: No org ID available")}catch(a){console.error("âŒ [TeamPage] Debug: License service test failed:",a)}},sx:{ml:2},children:"Debug Licenses"})]})}),e.jsxs(P,{container:!0,spacing:3,sx:{mb:4},children:[e.jsx(P,{item:!0,xs:12,sm:6,md:3,children:e.jsx(we,{title:"Team Members",value:k.totalMembers,icon:e.jsx(va,{}),color:"primary",trend:{value:12,direction:"up"}})}),e.jsx(P,{item:!0,xs:12,sm:6,md:3,children:e.jsx(we,{title:"Active Members",value:k.activeMembers,icon:e.jsx(Me,{}),color:"success",trend:{value:8,direction:"up"}})}),e.jsx(P,{item:!0,xs:12,sm:6,md:3,children:e.jsx(we,{title:"Total Seats",value:k.totalSeats,icon:e.jsx(qe,{}),color:"primary"})}),e.jsx(P,{item:!0,xs:12,sm:6,md:3,children:e.jsx(we,{title:"Available Seats",value:k.availableSeats,icon:e.jsx(qe,{}),color:"secondary"})})]}),e.jsx(G,{children:e.jsx(xa,{component:Ta,sx:{background:"linear-gradient(135deg, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0.05) 100%)",backdropFilter:"blur(20px)",border:"1px solid rgba(255,255,255,0.1)"},children:e.jsxs(Pa,{children:[e.jsx(ya,{children:e.jsxs(Ge,{children:[e.jsx(N,{sx:{fontWeight:600},children:"Member"}),e.jsx(N,{sx:{fontWeight:600},children:"Role"}),e.jsx(N,{sx:{fontWeight:600},children:"Department"}),e.jsx(N,{sx:{fontWeight:600},children:"Status"}),e.jsx(N,{sx:{fontWeight:600},children:"License"}),e.jsx(N,{sx:{fontWeight:600},children:"Last Active"}),e.jsx(N,{sx:{fontWeight:600},children:"Actions"})]})}),e.jsx(Sa,{children:Xe.map(a=>e.jsxs(Ge,{hover:!0,children:[e.jsx(N,{children:e.jsxs(G,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsxs(Ea,{sx:{width:40,height:40},children:[a.firstName[0],a.lastName[0]]}),e.jsxs(G,{children:[e.jsxs(V,{variant:"body2",sx:{fontWeight:500},children:[a.firstName," ",a.lastName]}),e.jsx(V,{variant:"caption",color:"text.secondary",children:a.email})]})]})}),e.jsx(N,{children:e.jsx(Ye,{icon:a.role==="admin"?e.jsx(ja,{}):e.jsx(Ia,{}),label:a.role.toUpperCase(),color:Na(a.role),size:"small",variant:"outlined"})}),e.jsx(N,{children:e.jsx(V,{variant:"body2",children:a.department||"Not assigned"})}),e.jsx(N,{children:e.jsx(Ye,{icon:Fa(a.status),label:a.status.toUpperCase(),color:La(a.status),size:"small"})}),e.jsx(N,{children:e.jsx(V,{variant:"body2",children:a.licenseType||"PROFESSIONAL"})}),e.jsx(N,{children:e.jsx(V,{variant:"body2",children:a.lastActive?new Date(a.lastActive).toLocaleDateString():"Never"})}),e.jsx(N,{children:e.jsx(te,{onClick:s=>ta(s,a),size:"small",children:e.jsx(Aa,{})})})]},a.id))})]})})}),e.jsx(Ma,{color:"primary",sx:{position:"fixed",bottom:24,right:24,background:"linear-gradient(135deg, #00d4ff 0%, #667eea 100%)",color:"#000"},onClick:()=>X(!0),children:e.jsx(_a,{})}),e.jsxs(Da,{anchorEl:De,open:!!De,onClose:ce,PaperProps:{sx:{backgroundColor:"background.paper",border:"1px solid rgba(255, 255, 255, 0.1)"}},children:[e.jsxs(C,{onClick:()=>{ce(),la()},children:[e.jsx(Se,{children:e.jsx(Ca,{fontSize:"small"})}),"Edit Member"]}),e.jsxs(C,{onClick:ce,children:[e.jsx(Se,{children:e.jsx(Qe,{fontSize:"small"})}),"Suspend Member"]}),e.jsxs(C,{onClick:ma,sx:{color:"error.main"},children:[e.jsx(Se,{children:e.jsx(Ee,{fontSize:"small",sx:{color:"error.main"}})}),"Remove Member"]})]}),e.jsx(me,{open:Ze,onClose:()=>X(!1),maxWidth:"sm",fullWidth:!0,PaperProps:{sx:{backgroundColor:"background.paper",border:"1px solid rgba(255, 255, 255, 0.1)"}},children:e.jsxs("form",{onSubmit:a=>{a.preventDefault(),na()},children:[e.jsx(ge,{children:"Create New Team Member"}),e.jsxs(ue,{children:[e.jsx(V,{variant:"body2",color:"text.secondary",sx:{mb:2},children:"Create a new team member account with automatic Firebase Authentication setup. You can set a custom password or leave it blank to auto-generate one. The member will receive a welcome email with their login credentials."}),e.jsxs(P,{container:!0,spacing:3,sx:{mt:1},children:[k.availableSeats<=0&&e.jsx(P,{item:!0,xs:12,children:e.jsx(K,{severity:"warning",children:"No available licenses. Please check your organization's licenses to add more team members."})}),e.jsx(P,{item:!0,xs:12,sm:6,children:e.jsx(U,{fullWidth:!0,label:"First Name",value:d.firstName,onChange:a=>W(s=>({...s,firstName:a.target.value})),required:!0})}),e.jsx(P,{item:!0,xs:12,sm:6,children:e.jsx(U,{fullWidth:!0,label:"Last Name",value:d.lastName,onChange:a=>W(s=>({...s,lastName:a.target.value})),required:!0})}),e.jsx(P,{item:!0,xs:12,children:e.jsx(U,{fullWidth:!0,label:"Email Address",type:"email",value:d.email,onChange:a=>W(s=>({...s,email:a.target.value})),required:!0})}),e.jsx(P,{item:!0,xs:12,sm:6,children:e.jsxs(je,{fullWidth:!0,children:[e.jsx(Ie,{children:"Role"}),e.jsxs(Ae,{value:d.role,label:"Role",onChange:a=>W(s=>({...s,role:a.target.value})),inputProps:{"aria-label":"Select team member role",title:"Select the role for this team member"},children:[e.jsx(C,{value:"viewer",children:"Viewer"}),e.jsx(C,{value:"member",children:"Member"}),e.jsx(C,{value:"admin",children:"Admin"})]})]})}),e.jsx(P,{item:!0,xs:12,sm:6,children:e.jsx(U,{fullWidth:!0,label:"Department",value:d.department,onChange:a=>W(s=>({...s,department:a.target.value}))})}),e.jsx(P,{item:!0,xs:12,children:e.jsx(K,{severity:"info",sx:{mb:2},children:e.jsxs(V,{variant:"body2",children:[e.jsx("strong",{children:"Password Setup:"})," You can either set a custom password for the team member or leave it blank to auto-generate a secure temporary password."]})})}),e.jsx(P,{item:!0,xs:12,sm:6,children:e.jsx(U,{fullWidth:!0,label:"Password (Optional)",type:xe?"text":"password",value:d.password,onChange:a=>W(s=>({...s,password:a.target.value})),helperText:"Leave blank to auto-generate a secure password",inputProps:{autoComplete:"new-password"},InputProps:{endAdornment:e.jsx(he,{position:"end",children:e.jsx(te,{onClick:()=>ea(!xe),edge:"end","aria-label":"toggle password visibility",children:xe?e.jsx(pe,{}):e.jsx(fe,{})})})}})}),e.jsx(P,{item:!0,xs:12,sm:6,children:e.jsx(U,{fullWidth:!0,label:"Confirm Password",type:Te?"text":"password",value:d.confirmPassword,onChange:a=>W(s=>({...s,confirmPassword:a.target.value})),disabled:!d.password,helperText:d.password?"Must match the password above":"Enter a password first",inputProps:{autoComplete:"new-password"},InputProps:{endAdornment:e.jsx(he,{position:"end",children:e.jsx(te,{onClick:()=>aa(!Te),edge:"end","aria-label":"toggle confirm password visibility",disabled:!d.password,children:Te?e.jsx(pe,{}):e.jsx(fe,{})})})}})}),e.jsx(P,{item:!0,xs:12,children:e.jsx(U,{fullWidth:!0,label:"Welcome Message (Optional)",multiline:!0,rows:3,value:d.message,onChange:a=>W(s=>({...s,message:a.target.value}))})})]})]}),e.jsxs(be,{children:[e.jsx($,{onClick:()=>X(!1),children:"Cancel"}),e.jsx($,{type:"submit",variant:"contained",disabled:!d.email||!d.firstName||!d.lastName||!R,sx:{background:"linear-gradient(135deg, #00d4ff 0%, #667eea 100%)",color:"#000",fontWeight:600},children:"Create Team Member"})]})]})}),e.jsxs(me,{open:Je,onClose:()=>ie(!1),maxWidth:"xs",fullWidth:!0,PaperProps:{sx:{backgroundColor:"background.paper",border:"1px solid rgba(255, 255, 255, 0.1)"}},children:[e.jsx(ge,{children:"Manage Seats"}),e.jsx(ue,{children:e.jsxs(P,{container:!0,spacing:2,sx:{mt:.5},children:[e.jsx(P,{item:!0,xs:12,children:e.jsx(K,{severity:"info",children:L?`${L.tier} subscription`:"No active subscription"})}),e.jsx(P,{item:!0,xs:12,children:e.jsx(U,{fullWidth:!0,type:"number",label:"Total Seats",value:Oe,onChange:a=>Ne(parseInt(a.target.value||"0",10)),inputProps:{min:1,max:(L==null?void 0:L.tier)==="PRO"?50:1e3}})})]})}),e.jsxs(be,{children:[e.jsx($,{onClick:()=>ie(!1),children:"Cancel"}),e.jsx($,{onClick:ia,variant:"contained",disabled:!L,children:"Save"})]})]}),e.jsxs(me,{open:Ke,onClose:()=>{ee(!1),Re(null)},maxWidth:"sm",fullWidth:!0,PaperProps:{sx:{backgroundColor:"background.paper",border:"1px solid rgba(255, 255, 255, 0.1)"}},children:[e.jsx(ge,{children:"Edit Member"}),e.jsx(ue,{children:e.jsxs(P,{container:!0,spacing:3,sx:{mt:1},children:[e.jsx(P,{item:!0,xs:12,children:e.jsx(U,{fullWidth:!0,label:"Email",value:I.email,onChange:a=>Z(s=>({...s,email:a.target.value}))})}),e.jsx(P,{item:!0,xs:12,sm:6,children:e.jsxs(je,{fullWidth:!0,children:[e.jsx(Ie,{children:"Role"}),e.jsxs(Ae,{value:I.role,label:"Role",onChange:a=>Z(s=>({...s,role:a.target.value})),children:[e.jsx(C,{value:"viewer",children:"Viewer"}),e.jsx(C,{value:"member",children:"Member"}),e.jsx(C,{value:"manager",children:"Manager"}),e.jsx(C,{value:"admin",children:"Admin"}),e.jsx(C,{value:"owner",children:"Owner"})]})]})}),e.jsx(P,{item:!0,xs:12,sm:6,children:e.jsxs(je,{fullWidth:!0,children:[e.jsx(Ie,{children:"Status"}),e.jsxs(Ae,{value:I.status,label:"Status",onChange:a=>Z(s=>({...s,status:a.target.value})),children:[e.jsx(C,{value:"pending",children:"Pending"}),e.jsx(C,{value:"active",children:"Active"}),e.jsx(C,{value:"suspended",children:"Suspended"}),e.jsx(C,{value:"removed",children:"Removed"})]})]})}),e.jsx(P,{item:!0,xs:12,children:I.status!=="active"?e.jsx(K,{severity:"warning",children:"This member has not joined yet (Pending/Suspended/Removed). You can only set a password for Active members."}):e.jsx(K,{severity:"info",children:"Set a temporary password for this user to log into Backbone. They can change it later."})}),e.jsx(P,{item:!0,xs:12,sm:6,children:e.jsx(U,{fullWidth:!0,label:"New Password",type:Le?"text":"password",value:I.newPassword,onChange:a=>Z(s=>({...s,newPassword:a.target.value})),inputProps:{minLength:8},helperText:"Minimum 8 characters",InputProps:{endAdornment:e.jsx(he,{position:"end",children:e.jsx(te,{onClick:()=>Fe(a=>!a),edge:"end","aria-label":"toggle password visibility",children:Le?e.jsx(pe,{}):e.jsx(fe,{})})})}})}),e.jsx(P,{item:!0,xs:12,sm:6,children:e.jsx(U,{fullWidth:!0,label:"Confirm Password",type:ze?"text":"password",value:I.confirmPassword,onChange:a=>Z(s=>({...s,confirmPassword:a.target.value})),InputProps:{endAdornment:e.jsx(he,{position:"end",children:e.jsx(te,{onClick:()=>$e(a=>!a),edge:"end","aria-label":"toggle password visibility",children:ze?e.jsx(pe,{}):e.jsx(fe,{})})})}})})]})}),e.jsxs(be,{children:[e.jsx($,{onClick:()=>ee(!1),disabled:ae,children:"Cancel"}),e.jsx($,{onClick:da,variant:"outlined",disabled:ae,children:ae?"Savingâ€¦":"Save Changes"}),e.jsx($,{onClick:ca,variant:"contained",disabled:ae||!I.newPassword||!I.confirmPassword||I.status!=="active",children:ae?"Savingâ€¦":"Save Password Only"})]})]}),e.jsxs(me,{open:sa,onClose:ke,maxWidth:"sm",fullWidth:!0,PaperProps:{sx:{backgroundColor:"background.paper",border:"1px solid rgba(255, 255, 255, 0.1)"}},children:[e.jsx(ge,{children:e.jsxs(G,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(Ee,{color:"error"}),"Remove Team Member"]})}),e.jsxs(ue,{children:[e.jsxs(V,{variant:"body1",sx:{mb:2},children:["Are you sure you want to remove ",e.jsx("strong",{children:O==null?void 0:O.email})," from your team?"]}),e.jsx(K,{severity:"warning",sx:{mt:2},children:e.jsx(V,{variant:"body2",children:"This action cannot be undone. The member will lose access to all organization resources and data."})})]}),e.jsxs(be,{children:[e.jsx($,{onClick:ke,color:"inherit",children:"Cancel"}),e.jsx($,{onClick:ga,color:"error",variant:"contained",startIcon:e.jsx(Ee,{}),children:"Remove Member"})]})]})]})};export{Ya as default};
