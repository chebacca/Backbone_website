import{j as e,a as M,T as S,d as V,b9 as ra,G as p,k as ie,l as oe,at as te,o as ia,n as ve,ax as Fe,m as oa,D as la,aN as da,c as ca,aO as ma,aP as ua,aQ as We,aR as y,aS as ga,h as Ve,ba as xa,bb as ha,bc as pa,I as ce,aT as ba,bd as va,az as ja,aj as fa,a4 as w,X as le,aW as Sa,x as wa,be as $e,b8 as Ma,aD as me,aE as ue,aG as ge,t as de,u as _,aZ as xe,a_ as he,a$ as pe,aJ as be,v as ze,y as Be,z as Ue}from"./mui-T5zcPaKR.js";import{r as v}from"./vendor-OeuszDaU.js";import{u as Ea}from"./notistack.esm-CcFOI6Un.js";import{u as Ia,c as D,e as T}from"./index-qIQj-L8L.js";import"./stripe-Bd-xCkZF.js";const ya=l=>{switch(l){case"admin":return"secondary";case"owner":return"secondary";case"manager":return"info";case"member":return"success";case"viewer":return"default";default:return"default"}},Aa=l=>{switch(l){case"active":return"success";case"pending":return"warning";case"suspended":return"error";case"removed":return"default";default:return"default"}},Ca=l=>{switch(l){case"active":return e.jsx(ve,{});case"pending":return e.jsx(Fe,{});case"suspended":return e.jsx($e,{});default:return e.jsx(ve,{})}},ka=()=>{const{enqueueSnackbar:l}=Ea(),{user:W}=Ia(),[_e,G]=v.useState([]),[E,F]=v.useState({totalMembers:0,activeMembers:0,pendingInvites:0,availableSeats:0,totalSeats:0}),[P,je]=v.useState(null),[Pa,fe]=v.useState(""),[Se,Ge]=v.useState(null),[A,we]=v.useState(null),z=(a,{includeTime:t=!1}={})=>{try{if(!a){const s=new Date;return t?s.toISOString():s.toISOString().slice(0,10)}if(typeof a=="string"||typeof a=="number"){const s=new Date(a);if(!Number.isNaN(s.getTime()))return t?s.toISOString():s.toISOString().slice(0,10)}if(typeof a=="object"){const s=a._seconds,n=a._nanoseconds??0;if(typeof s=="number"){const b=s*1e3+Math.floor(n/1e6),c=new Date(b);return t?c.toISOString():c.toISOString().slice(0,10)}}}catch{}const r=new Date;return t?r.toISOString():r.toISOString().slice(0,10)};v.useEffect(()=>{let a=!0;return(async()=>{var t,r,s,n,b,c,C,o,j,R,O,i,f,k;try{const g=await D.get(T.organizations.context()).catch(()=>null),m=((r=(t=g==null?void 0:g.data)==null?void 0:t.data)==null?void 0:r.organization)||null,u=((n=(s=g==null?void 0:g.data)==null?void 0:s.data)==null?void 0:n.members)||[],U=((c=(b=g==null?void 0:g.data)==null?void 0:b.data)==null?void 0:c.activeSubscription)||null,q=((o=(C=g==null?void 0:g.data)==null?void 0:C.data)==null?void 0:o.primaryRole)||null;let I=m,$=u,N=U;if(!I){const x=await D.get(T.organizations.my()),H=((R=(j=x==null?void 0:x.data)==null?void 0:j.data)==null?void 0:R.owned)??[],ee=((i=(O=x==null?void 0:x.data)==null?void 0:O.data)==null?void 0:i.memberOf)??[];I=H[0]||ee[0]||null,$=(I==null?void 0:I.members)||[]}if(!I){a&&(je(null),fe(""),G([]),F({totalMembers:0,activeMembers:0,pendingInvites:0,availableSeats:0,totalSeats:0}));return}const Re=$.filter(x=>x.status==="INVITED").length,Oe=$.filter(x=>x.status==="ACTIVE").length;let re=0;N&&N.status==="ACTIVE"&&N.organizationId===I.id?re=Number(N.seats||0):re=(((k=(f=(await D.get(T.subscriptions.mySubscriptions())).data)==null?void 0:f.data)==null?void 0:k.subscriptions)??[]).filter(J=>J.organizationId===I.id&&J.status==="ACTIVE").reduce((J,ae)=>(!N&&ae.status==="ACTIVE"&&(N=ae),J+(ae.seats||0)),0);const na=Math.max(0,re-(Oe+Re)),ke=(Array.isArray($)?$:[]).filter(x=>x&&x.status!=="REMOVED").map(x=>{const H=String(x.email||"user@example.com"),ee=H.split("@")[0]||"User",J={OWNER:"owner",ENTERPRISE_ADMIN:"admin",MANAGER:"manager",MEMBER:"member"},ae={INVITED:"pending",ACTIVE:"active",REMOVED:"removed"};return{id:String(x.id||`${H}-${Math.random().toString(36).slice(2)}`),firstName:ee.charAt(0).toUpperCase()+ee.slice(1),lastName:"",email:H,role:J[String(x.role)]||"member",status:ae[String(x.status)]||"active",joinedAt:z(x.joinedAt),lastActive:z(x.updatedAt||x.joinedAt||new Date,{includeTime:!0})}});if(!a)return;je(I.id),fe(I.name||"Organization"),Ge(q||null),we(N?{id:String(N.id),tier:String(N.tier).toUpperCase(),seats:Number(N.seats||0),status:String(N.status||""),organizationId:N.organizationId}:null),G(ke),F({totalMembers:ke.length,activeMembers:Oe,pendingInvites:Re,availableSeats:na,totalSeats:re})}catch(g){if(!a)return;console.error("[TeamPage] Failed to load team data:",g),G([]),F({totalMembers:0,activeMembers:0,pendingInvites:0,availableSeats:0,totalSeats:0})}})(),()=>{a=!1}},[W==null?void 0:W.email]);const[Me,Ee]=v.useState(null),[d,Ie]=v.useState(null),[Le,Q]=v.useState(!1),[qe,se]=v.useState(!1),[ye,Ae]=v.useState(0),[He,X]=v.useState(!1),[Y,ne]=v.useState(!1),[Ce,Pe]=v.useState(!1),[Ne,De]=v.useState(!1),[h,L]=v.useState({newPassword:"",confirmPassword:"",email:"",role:"member",status:"active"}),[B,Z]=v.useState({email:"",role:"member",department:"",message:""}),Je=(a,t)=>{Ee(a.currentTarget),Ie(t)},K=()=>{Ee(null)},Qe=async()=>{var a,t,r,s,n,b,c,C;if(P){if(E.availableSeats<=0){l("No seats available. Please add seats from Billing before inviting new members.",{variant:"warning"});return}try{const o={admin:"ENTERPRISE_ADMIN",owner:"ENTERPRISE_ADMIN",manager:"MANAGER",member:"MEMBER",viewer:"MEMBER"};await D.post(T.organizations.invite(P),{email:B.email,role:o[B.role]||"MEMBER"}),l(`Invitation sent to ${B.email}`,{variant:"success"}),Q(!1),Z({email:"",role:"member",department:"",message:""});const j=await D.get(T.organizations.my()),R=((t=(a=j==null?void 0:j.data)==null?void 0:a.data)==null?void 0:t.owned)??[],O=((s=(r=j==null?void 0:j.data)==null?void 0:r.data)==null?void 0:s.memberOf)??[],i=[...R,...O].find(f=>f.id===P)||R[0]||O[0];if(i){const f=i.members||[],k=(Array.isArray(f)?f:[]).filter(u=>u&&u.status!=="REMOVED").map(u=>{const U=String(u.email||"user@example.com"),q=U.split("@")[0]||"User",I={OWNER:"owner",ENTERPRISE_ADMIN:"admin",MANAGER:"manager",MEMBER:"member"},$={INVITED:"pending",ACTIVE:"active",REMOVED:"removed"};return{id:String(u.id||`${U}-${Math.random().toString(36).slice(2)}`),firstName:q.charAt(0).toUpperCase()+q.slice(1),lastName:"",email:U,role:I[String(u.role)]||"member",status:$[String(u.status)]||"active",joinedAt:z(u.joinedAt),lastActive:z(u.updatedAt||u.joinedAt||new Date,{includeTime:!0})}}),g=f.filter(u=>u.status==="INVITED").length,m=f.filter(u=>u.status==="ACTIVE").length;G(k),F(u=>({...u,totalMembers:k.length,pendingInvites:g,activeMembers:m,availableSeats:Math.max(0,u.totalSeats-(m+g))}))}}catch(o){console.error("[TeamPage] Invite failed:",o);const j=((b=(n=o==null?void 0:o.response)==null?void 0:n.data)==null?void 0:b.message)||((C=(c=o==null?void 0:o.response)==null?void 0:c.data)==null?void 0:C.error)||(o==null?void 0:o.message)||"Failed to send invitation";l(j,{variant:"error"})}}},Xe=v.useMemo(()=>{const t=String((W==null?void 0:W.role)||"").toUpperCase()==="SUPERADMIN",r=Se||void 0;return t||(r==="OWNER"||r==="ENTERPRISE_ADMIN")},[W==null?void 0:W.role,Se]),Ye=()=>{if(!A){l("No active subscription found for this organization.",{variant:"warning"});return}Ae(Number(A.seats||0)),se(!0)},Ze=async()=>{var a,t;if(A)try{const r=A.tier,s=Number(ye||0);if(r==="BASIC"&&s!==1){l("Basic plan supports exactly 1 seat.",{variant:"warning"});return}if(r==="PRO"&&(s<1||s>50)){l("Pro plan seats must be between 1 and 50.",{variant:"warning"});return}if(r==="ENTERPRISE"&&s<10){l("Enterprise requires minimum 10 seats.",{variant:"warning"});return}await D.put(T.subscriptions.update(A.id),{seats:s}),we(n=>n&&{...n,seats:s}),F(n=>({...n,totalSeats:s,availableSeats:Math.max(0,s-(n.activeMembers+n.pendingInvites))})),l("Seats updated successfully",{variant:"success"}),se(!1)}catch(r){const s=((t=(a=r==null?void 0:r.response)==null?void 0:a.data)==null?void 0:t.message)||(r==null?void 0:r.message)||"Failed to update seats";l(s,{variant:"error"})}},Ke=()=>{d&&l(`Invitation resent to ${d.email}`,{variant:"success"}),K()},ea=()=>{L({newPassword:"",confirmPassword:"",email:(d==null?void 0:d.email)||"",role:(d==null?void 0:d.role)||"member",status:(d==null?void 0:d.status)||"active"}),Pe(!1),De(!1),X(!0)},aa=async()=>{var s,n;if(!d)return;if(d.status!=="active"){l("Password can only be set after the member has joined (status Active).",{variant:"warning"});return}const a=d.email,{newPassword:t,confirmPassword:r}=h;if(!t||t.length<8){l("Password must be at least 8 characters.",{variant:"warning"});return}if(t!==r){l("Passwords do not match.",{variant:"warning"});return}try{if(ne(!0),!P){l("Organization context not found.",{variant:"error"});return}await D.put(T.organizations.setMemberPassword(P,d.id),{password:t}),l(`Password set for ${a}`,{variant:"success"}),X(!1)}catch(b){const c=((n=(s=b==null?void 0:b.response)==null?void 0:s.data)==null?void 0:n.message)||(b==null?void 0:b.message)||"Failed to set password";l(c,{variant:"error"})}finally{ne(!1)}},ta=async()=>{var a,t,r,s,n,b;if(!(!d||!P))try{ne(!0);const c={admin:"ENTERPRISE_ADMIN",owner:"ENTERPRISE_ADMIN",manager:"MANAGER",member:"MEMBER",viewer:"MEMBER"},C={pending:"INVITED",active:"ACTIVE",suspended:"SUSPENDED",removed:"REMOVED"};console.log("Updating member:",{memberId:d.id,email:h.email,role:c[h.role],status:C[h.status]}),await D.patch(T.organizations.updateMember(P,d.id),{email:h.email,role:c[h.role],status:C[h.status]}),h.newPassword&&h.confirmPassword&&h.newPassword===h.confirmPassword&&await D.put(T.organizations.setMemberPassword(P,d.id),{password:h.newPassword}),l("Member updated successfully",{variant:"success"}),X(!1);const o=await D.get(T.organizations.my()),j=((t=(a=o==null?void 0:o.data)==null?void 0:a.data)==null?void 0:t.owned)??[],R=((s=(r=o==null?void 0:o.data)==null?void 0:r.data)==null?void 0:s.memberOf)??[],O=[...j,...R].find(i=>i.id===P)||j[0]||R[0];if(O){const i=O.members||[],f=(Array.isArray(i)?i:[]).filter(m=>m&&m.status!=="REMOVED").map(m=>{const u=String(m.email||"user@example.com"),U=u.split("@")[0]||"User",q={OWNER:"owner",ENTERPRISE_ADMIN:"admin",MANAGER:"manager",MEMBER:"member"},I={INVITED:"pending",ACTIVE:"active",REMOVED:"removed"};return{id:String(m.id||`${u}-${Math.random().toString(36).slice(2)}`),firstName:U.charAt(0).toUpperCase()+U.slice(1),lastName:"",email:u,role:q[String(m.role)]||"member",status:I[String(m.status)]||"active",joinedAt:z(m.joinedAt),lastActive:z(m.updatedAt||m.joinedAt||new Date,{includeTime:!0})}}),k=i.filter(m=>m.status==="INVITED").length,g=i.filter(m=>m.status==="ACTIVE").length;G(f),F(m=>({...m,totalMembers:f.length,pendingInvites:k,activeMembers:g,availableSeats:Math.max(0,m.totalSeats-(g+k))}))}}catch(c){console.error("[TeamPage] Update member failed:",c);const C=((b=(n=c==null?void 0:c.response)==null?void 0:n.data)==null?void 0:b.message)||(c==null?void 0:c.message)||"Failed to update member";l(C,{variant:"error"})}finally{ne(!1)}},sa=async()=>{var a,t,r,s;if(!(!d||!P))try{await D.post(T.organizations.removeMember(P,d.id)),l(`${d.email} removed from team`,{variant:"warning"});const n=await D.get(T.organizations.my()),b=((t=(a=n==null?void 0:n.data)==null?void 0:a.data)==null?void 0:t.owned)??[],c=((s=(r=n==null?void 0:n.data)==null?void 0:r.data)==null?void 0:s.memberOf)??[],C=[...b,...c].find(o=>o.id===P)||b[0]||c[0];if(C){const o=C.members||[],j=(Array.isArray(o)?o:[]).filter(i=>i&&i.status!=="REMOVED").map(i=>{const f=String(i.email||"user@example.com"),k=f.split("@")[0]||"User",g={OWNER:"owner",ENTERPRISE_ADMIN:"admin",MANAGER:"manager",MEMBER:"member"},m={INVITED:"pending",ACTIVE:"active",REMOVED:"removed"};return{id:String(i.id||`${f}-${Math.random().toString(36).slice(2)}`),firstName:k.charAt(0).toUpperCase()+k.slice(1),lastName:"",email:f,role:g[String(i.role)]||"member",status:m[String(i.status)]||"active",joinedAt:z(i.joinedAt),lastActive:z(i.updatedAt||i.joinedAt||new Date,{includeTime:!0})}}),R=o.filter(i=>i.status==="INVITED").length,O=o.filter(i=>i.status==="ACTIVE").length;G(j),F(i=>({...i,totalMembers:j.length,pendingInvites:R,activeMembers:O,availableSeats:Math.max(0,i.totalSeats-(O+R))}))}}catch(n){console.error("[TeamPage] Remove member failed:",n),l((n==null?void 0:n.message)||"Failed to remove member",{variant:"error"})}finally{K()}},Te=v.useMemo(()=>E.totalSeats<=0?0:(E.totalSeats-E.availableSeats)/E.totalSeats*100,[E.totalSeats,E.availableSeats]);return e.jsxs(M,{children:[e.jsx(M,{children:e.jsxs(M,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:4},children:[e.jsxs(M,{children:[e.jsx(S,{variant:"h4",sx:{fontWeight:700,mb:1},children:"Team Management"}),e.jsx(S,{variant:"body1",color:"text.secondary",children:"Manage your team members, roles, and license assignments"})]}),e.jsx(V,{variant:"contained",startIcon:e.jsx(ra,{}),onClick:()=>Q(!0),disabled:E.availableSeats<=0,sx:{background:"linear-gradient(135deg, #00d4ff 0%, #667eea 100%)",color:"#000",fontWeight:600},children:"Invite Member"}),Xe&&e.jsxs(V,{variant:"outlined",onClick:Ye,sx:{ml:2},children:["Manage Seats",A?` (${A.seats})`:""]})]})}),e.jsxs(p,{container:!0,spacing:3,sx:{mb:4},children:[e.jsx(p,{item:!0,xs:12,sm:6,md:3,children:e.jsx(M,{children:e.jsx(ie,{sx:{background:"linear-gradient(135deg, rgba(0, 212, 255, 0.1) 0%, rgba(102, 126, 234, 0.1) 100%)",border:"1px solid rgba(0, 212, 255, 0.2)"},children:e.jsxs(oe,{children:[e.jsx(M,{sx:{display:"flex",alignItems:"center",gap:2,mb:2},children:e.jsx(te,{sx:{bgcolor:"primary.main"},children:e.jsx(ia,{})})}),e.jsx(S,{variant:"h3",sx:{fontWeight:700,color:"primary.main"},children:E.totalMembers}),e.jsx(S,{variant:"body2",color:"text.secondary",children:"Total Members"})]})})})}),e.jsx(p,{item:!0,xs:12,sm:6,md:3,children:e.jsx(M,{children:e.jsx(ie,{sx:{background:"linear-gradient(135deg, rgba(76, 175, 80, 0.1) 0%, rgba(76, 175, 80, 0.05) 100%)",border:"1px solid rgba(76, 175, 80, 0.2)"},children:e.jsxs(oe,{children:[e.jsx(M,{sx:{display:"flex",alignItems:"center",gap:2,mb:2},children:e.jsx(te,{sx:{bgcolor:"success.main"},children:e.jsx(ve,{})})}),e.jsx(S,{variant:"h3",sx:{fontWeight:700,color:"success.main"},children:E.activeMembers}),e.jsx(S,{variant:"body2",color:"text.secondary",children:"Active Members"})]})})})}),e.jsx(p,{item:!0,xs:12,sm:6,md:3,children:e.jsx(M,{children:e.jsx(ie,{sx:{background:"linear-gradient(135deg, rgba(255, 152, 0, 0.1) 0%, rgba(255, 152, 0, 0.05) 100%)",border:"1px solid rgba(255, 152, 0, 0.2)"},children:e.jsxs(oe,{children:[e.jsx(M,{sx:{display:"flex",alignItems:"center",gap:2,mb:2},children:e.jsx(te,{sx:{bgcolor:"warning.main"},children:e.jsx(Fe,{})})}),e.jsx(S,{variant:"h3",sx:{fontWeight:700,color:"warning.main"},children:E.pendingInvites}),e.jsx(S,{variant:"body2",color:"text.secondary",children:"Pending Invites"})]})})})}),e.jsx(p,{item:!0,xs:12,sm:6,md:3,children:e.jsx(M,{children:e.jsx(ie,{sx:{background:"linear-gradient(135deg, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0.05) 100%)",border:"1px solid rgba(255,255,255,0.1)"},children:e.jsxs(oe,{children:[e.jsx(M,{sx:{display:"flex",alignItems:"center",gap:2,mb:2},children:e.jsx(te,{sx:{bgcolor:"secondary.main"},children:e.jsx(oa,{})})}),e.jsx(S,{variant:"h3",sx:{fontWeight:700},children:E.availableSeats}),e.jsx(S,{variant:"body2",color:"text.secondary",children:"Available Seats"}),e.jsx(la,{variant:"determinate",value:Te,sx:{mt:1,height:4,borderRadius:2,backgroundColor:"rgba(255,255,255,0.1)","& .MuiLinearProgress-bar":{borderRadius:2,background:Te>80?"linear-gradient(90deg, #ff9800 0%, #f44336 100%)":"linear-gradient(90deg, #00d4ff 0%, #667eea 100%)"}}})]})})})})]}),e.jsx(M,{children:e.jsx(da,{component:ca,sx:{background:"linear-gradient(135deg, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0.05) 100%)",backdropFilter:"blur(20px)",border:"1px solid rgba(255,255,255,0.1)"},children:e.jsxs(ma,{children:[e.jsx(ua,{children:e.jsxs(We,{children:[e.jsx(y,{sx:{fontWeight:600},children:"Member"}),e.jsx(y,{sx:{fontWeight:600},children:"Role"}),e.jsx(y,{sx:{fontWeight:600},children:"Department"}),e.jsx(y,{sx:{fontWeight:600},children:"Status"}),e.jsx(y,{sx:{fontWeight:600},children:"License"}),e.jsx(y,{sx:{fontWeight:600},children:"Last Active"}),e.jsx(y,{sx:{fontWeight:600},children:"Actions"})]})}),e.jsx(ga,{children:_e.map(a=>e.jsxs(We,{hover:!0,children:[e.jsx(y,{children:e.jsxs(M,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsxs(te,{sx:{width:40,height:40},children:[a.firstName[0],a.lastName[0]]}),e.jsxs(M,{children:[e.jsxs(S,{variant:"body2",sx:{fontWeight:500},children:[a.firstName," ",a.lastName]}),e.jsx(S,{variant:"caption",color:"text.secondary",children:a.email})]})]})}),e.jsx(y,{children:e.jsx(Ve,{icon:a.role==="admin"?e.jsx(xa,{}):e.jsx(ha,{}),label:a.role.toUpperCase(),color:ya(a.role),size:"small",variant:"outlined"})}),e.jsx(y,{children:e.jsx(S,{variant:"body2",children:a.department||"Not assigned"})}),e.jsx(y,{children:e.jsx(Ve,{icon:Ca(a.status),label:a.status.toUpperCase(),color:Aa(a.status),size:"small"})}),e.jsx(y,{children:a.licenseAssigned?e.jsx(pa,{title:a.licenseAssigned,children:e.jsx(S,{variant:"body2",sx:{fontFamily:"monospace",maxWidth:120,overflow:"hidden",textOverflow:"ellipsis"},children:a.licenseAssigned})}):e.jsx(S,{variant:"body2",color:"text.secondary",children:"No license"})}),e.jsx(y,{children:e.jsx(S,{variant:"body2",children:a.lastActive?new Date(a.lastActive).toLocaleDateString():"Never"})}),e.jsx(y,{children:e.jsx(ce,{onClick:t=>Je(t,a),size:"small",children:e.jsx(ba,{})})})]},a.id))})]})})}),e.jsx(va,{color:"primary",sx:{position:"fixed",bottom:24,right:24,background:"linear-gradient(135deg, #00d4ff 0%, #667eea 100%)",color:"#000"},onClick:()=>Q(!0),children:e.jsx(ja,{})}),e.jsxs(fa,{anchorEl:Me,open:!!Me,onClose:K,PaperProps:{sx:{backgroundColor:"background.paper",border:"1px solid rgba(255, 255, 255, 0.1)"}},children:[e.jsxs(w,{onClick:()=>{K(),ea()},children:[e.jsx(le,{children:e.jsx(Sa,{fontSize:"small"})}),"Edit Member"]}),(d==null?void 0:d.status)==="pending"&&e.jsxs(w,{onClick:Ke,children:[e.jsx(le,{children:e.jsx(wa,{fontSize:"small"})}),"Resend Invite"]}),e.jsxs(w,{onClick:K,children:[e.jsx(le,{children:e.jsx($e,{fontSize:"small"})}),"Suspend Member"]}),e.jsxs(w,{onClick:sa,sx:{color:"error.main"},children:[e.jsx(le,{children:e.jsx(Ma,{fontSize:"small",sx:{color:"error.main"}})}),"Remove Member"]})]}),e.jsxs(me,{open:Le,onClose:()=>Q(!1),maxWidth:"sm",fullWidth:!0,PaperProps:{sx:{backgroundColor:"background.paper",border:"1px solid rgba(255, 255, 255, 0.1)"}},children:[e.jsx(ue,{children:"Invite Team Member"}),e.jsx(ge,{children:e.jsxs(p,{container:!0,spacing:3,sx:{mt:1},children:[E.availableSeats<=0&&e.jsx(p,{item:!0,xs:12,children:e.jsx(de,{severity:"warning",children:"No available seats. Add seats on the Billing page to invite more team members."})}),e.jsx(p,{item:!0,xs:12,children:e.jsx(_,{fullWidth:!0,label:"Email Address",type:"email",value:B.email,onChange:a=>Z(t=>({...t,email:a.target.value}))})}),e.jsx(p,{item:!0,xs:12,sm:6,children:e.jsxs(xe,{fullWidth:!0,children:[e.jsx(he,{children:"Role"}),e.jsxs(pe,{value:B.role,label:"Role",onChange:a=>Z(t=>({...t,role:a.target.value})),inputProps:{"aria-label":"Select team member role",title:"Select the role for this team member"},children:[e.jsx(w,{value:"viewer",children:"Viewer"}),e.jsx(w,{value:"member",children:"Member"}),e.jsx(w,{value:"admin",children:"Admin"})]})]})}),e.jsx(p,{item:!0,xs:12,sm:6,children:e.jsx(_,{fullWidth:!0,label:"Department",value:B.department,onChange:a=>Z(t=>({...t,department:a.target.value}))})}),e.jsx(p,{item:!0,xs:12,children:e.jsx(_,{fullWidth:!0,label:"Welcome Message (Optional)",multiline:!0,rows:3,value:B.message,onChange:a=>Z(t=>({...t,message:a.target.value}))})})]})}),e.jsxs(be,{children:[e.jsx(V,{onClick:()=>Q(!1),children:"Cancel"}),e.jsx(V,{onClick:Qe,variant:"contained",disabled:!B.email||E.availableSeats<=0,children:"Send Invitation"})]})]}),e.jsxs(me,{open:qe,onClose:()=>se(!1),maxWidth:"xs",fullWidth:!0,PaperProps:{sx:{backgroundColor:"background.paper",border:"1px solid rgba(255, 255, 255, 0.1)"}},children:[e.jsx(ue,{children:"Manage Seats"}),e.jsx(ge,{children:e.jsxs(p,{container:!0,spacing:2,sx:{mt:.5},children:[e.jsx(p,{item:!0,xs:12,children:e.jsx(de,{severity:"info",children:A?`${A.tier} subscription`:"No active subscription"})}),e.jsx(p,{item:!0,xs:12,children:e.jsx(_,{fullWidth:!0,type:"number",label:"Total Seats",value:ye,onChange:a=>Ae(parseInt(a.target.value||"0",10)),inputProps:{min:1,max:(A==null?void 0:A.tier)==="PRO"?50:1e3}})})]})}),e.jsxs(be,{children:[e.jsx(V,{onClick:()=>se(!1),children:"Cancel"}),e.jsx(V,{onClick:Ze,variant:"contained",disabled:!A,children:"Save"})]})]}),e.jsxs(me,{open:He,onClose:()=>{X(!1),Ie(null)},maxWidth:"sm",fullWidth:!0,PaperProps:{sx:{backgroundColor:"background.paper",border:"1px solid rgba(255, 255, 255, 0.1)"}},children:[e.jsx(ue,{children:"Edit Member"}),e.jsx(ge,{children:e.jsxs(p,{container:!0,spacing:3,sx:{mt:1},children:[e.jsx(p,{item:!0,xs:12,children:e.jsx(_,{fullWidth:!0,label:"Email",value:h.email,onChange:a=>L(t=>({...t,email:a.target.value}))})}),e.jsx(p,{item:!0,xs:12,sm:6,children:e.jsxs(xe,{fullWidth:!0,children:[e.jsx(he,{children:"Role"}),e.jsxs(pe,{value:h.role,label:"Role",onChange:a=>L(t=>({...t,role:a.target.value})),children:[e.jsx(w,{value:"viewer",children:"Viewer"}),e.jsx(w,{value:"member",children:"Member"}),e.jsx(w,{value:"manager",children:"Manager"}),e.jsx(w,{value:"admin",children:"Admin"}),e.jsx(w,{value:"owner",children:"Owner"})]})]})}),e.jsx(p,{item:!0,xs:12,sm:6,children:e.jsxs(xe,{fullWidth:!0,children:[e.jsx(he,{children:"Status"}),e.jsxs(pe,{value:h.status,label:"Status",onChange:a=>L(t=>({...t,status:a.target.value})),children:[e.jsx(w,{value:"pending",children:"Pending"}),e.jsx(w,{value:"active",children:"Active"}),e.jsx(w,{value:"suspended",children:"Suspended"}),e.jsx(w,{value:"removed",children:"Removed"})]})]})}),e.jsx(p,{item:!0,xs:12,children:h.status!=="active"?e.jsx(de,{severity:"warning",children:"This member has not joined yet (Pending/Suspended/Removed). You can only set a password for Active members."}):e.jsx(de,{severity:"info",children:"Set a temporary password for this user to log into Backbone. They can change it later."})}),e.jsx(p,{item:!0,xs:12,sm:6,children:e.jsx(_,{fullWidth:!0,label:"New Password",type:Ce?"text":"password",value:h.newPassword,onChange:a=>L(t=>({...t,newPassword:a.target.value})),inputProps:{minLength:8},helperText:"Minimum 8 characters",InputProps:{endAdornment:e.jsx(ze,{position:"end",children:e.jsx(ce,{onClick:()=>Pe(a=>!a),edge:"end","aria-label":"toggle password visibility",children:Ce?e.jsx(Be,{}):e.jsx(Ue,{})})})}})}),e.jsx(p,{item:!0,xs:12,sm:6,children:e.jsx(_,{fullWidth:!0,label:"Confirm Password",type:Ne?"text":"password",value:h.confirmPassword,onChange:a=>L(t=>({...t,confirmPassword:a.target.value})),InputProps:{endAdornment:e.jsx(ze,{position:"end",children:e.jsx(ce,{onClick:()=>De(a=>!a),edge:"end","aria-label":"toggle password visibility",children:Ne?e.jsx(Be,{}):e.jsx(Ue,{})})})}})})]})}),e.jsxs(be,{children:[e.jsx(V,{onClick:()=>X(!1),disabled:Y,children:"Cancel"}),e.jsx(V,{onClick:ta,variant:"outlined",disabled:Y,children:Y?"Saving…":"Save Changes"}),e.jsx(V,{onClick:aa,variant:"contained",disabled:Y||!h.newPassword||!h.confirmPassword||h.status!=="active",children:Y?"Saving…":"Save Password Only"})]})]})]})};export{ka as default};
