import{j as e,a as t,T as s,d as I,b3 as ae,G as o,k as f,l as y,at as b,o as se,n as k,ax as V,m as te,H as ne,aC as ie,c as re,aD as le,aE as oe,aF as F,aG as i,aH as ce,h as B,b4 as de,b5 as xe,b6 as he,I as ue,aI as me,b7 as ge,az as je,ak as be,a4 as h,X as S,aL as pe,w as ve,b8 as H,b2 as fe,aN as ye,aO as Se,aP as Ce,u as M,aS as Ie,aT as Me,aU as ke,aQ as Ae}from"./mui-DiYnqcGn.js";import{r as d}from"./vendor-DIxetjBo.js";import{u as we}from"./notistack.esm-Bg0Tn0tt.js";import{u as We,c as $,e as G}from"./index-uRcWre8y.js";import"./stripe-CQkQ71Kl.js";const Te=c=>{switch(c){case"admin":return"error";case"member":return"primary";case"viewer":return"default";default:return"default"}},De=c=>{switch(c){case"active":return"success";case"pending":return"warning";case"suspended":return"error";default:return"default"}},Re=c=>{switch(c){case"active":return e.jsx(k,{});case"pending":return e.jsx(V,{});case"suspended":return e.jsx(H,{});default:return e.jsx(k,{})}},Ge=()=>{const{enqueueSnackbar:c}=we(),{user:u}=We(),[U,A]=d.useState([]),[l,w]=d.useState({totalMembers:0,activeMembers:0,pendingInvites:0,availableSeats:0,totalSeats:0});d.useEffect(()=>{let a=!0;return(async()=>{var n,E,N,P;try{const L=((E=(n=(await $.get(G.subscriptions.mySubscriptions())).data)==null?void 0:n.data)==null?void 0:E.subscriptions)??[],z=L.reduce((r,v)=>r+(v.seats??0),0),C=L.flatMap(r=>r.licenses??[]).filter(r=>r.status==="ACTIVE").length,_=Math.max(0,z-C),ee=(((P=(N=(await $.get(G.licenses.myLicenses())).data)==null?void 0:N.data)==null?void 0:P.licenses)??[]).map((r,v)=>{var O;return{id:r.id,firstName:"Seat",lastName:String(v+1),email:`${(u==null?void 0:u.email)??"seat"}+${v+1}`,role:"member",status:r.status==="ACTIVE"?"active":r.status==="PENDING"?"pending":"suspended",joinedAt:new Date(r.createdAt??Date.now()).toISOString().slice(0,10),lastActive:new Date(r.activatedAt??r.updatedAt??Date.now()).toISOString(),licenseAssigned:((O=r.key)==null?void 0:O.slice(0,8))+"-â€¦",department:void 0}});if(!a)return;A(ee),w({totalMembers:C,activeMembers:C,pendingInvites:0,availableSeats:_,totalSeats:z})}catch{if(!a)return;A([]),w({totalMembers:0,activeMembers:0,pendingInvites:0,availableSeats:0,totalSeats:0})}})(),()=>{a=!1}},[u==null?void 0:u.email]);const[W,T]=d.useState(null),[x,D]=d.useState(null),[q,g]=d.useState(!1),[Ee,Q]=d.useState(!1),[m,j]=d.useState({email:"",role:"member",department:"",message:""}),X=(a,n)=>{T(a.currentTarget),D(n)},p=()=>{T(null),D(null)},J=()=>{c(`Invitation sent to ${m.email}`,{variant:"success"}),g(!1),j({email:"",role:"member",department:"",message:""})},K=()=>{x&&c(`Invitation resent to ${x.email}`,{variant:"success"}),p()},Y=()=>{x&&c(`${x.firstName} ${x.lastName} removed from team`,{variant:"warning"}),p()},R=d.useMemo(()=>l.totalSeats<=0?0:(l.totalSeats-l.availableSeats)/l.totalSeats*100,[l.totalSeats,l.availableSeats]);return e.jsxs(t,{children:[e.jsx(t,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.6},children:e.jsxs(t,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:4},children:[e.jsxs(t,{children:[e.jsx(s,{variant:"h4",sx:{fontWeight:700,mb:1},children:"Team Management"}),e.jsx(s,{variant:"body1",color:"text.secondary",children:"Manage your team members, roles, and license assignments"})]}),e.jsx(I,{variant:"contained",startIcon:e.jsx(ae,{}),onClick:()=>g(!0),sx:{background:"linear-gradient(135deg, #00d4ff 0%, #667eea 100%)",color:"#000",fontWeight:600},children:"Invite Member"})]})}),e.jsxs(o,{container:!0,spacing:3,sx:{mb:4},children:[e.jsx(o,{item:!0,xs:12,sm:6,md:3,children:e.jsx(t,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.1},children:e.jsx(f,{sx:{background:"linear-gradient(135deg, rgba(0, 212, 255, 0.1) 0%, rgba(102, 126, 234, 0.1) 100%)",border:"1px solid rgba(0, 212, 255, 0.2)"},children:e.jsxs(y,{children:[e.jsx(t,{sx:{display:"flex",alignItems:"center",gap:2,mb:2},children:e.jsx(b,{sx:{bgcolor:"primary.main"},children:e.jsx(se,{})})}),e.jsx(s,{variant:"h3",sx:{fontWeight:700,color:"primary.main"},children:l.totalMembers}),e.jsx(s,{variant:"body2",color:"text.secondary",children:"Total Members"})]})})})}),e.jsx(o,{item:!0,xs:12,sm:6,md:3,children:e.jsx(t,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.2},children:e.jsx(f,{sx:{background:"linear-gradient(135deg, rgba(76, 175, 80, 0.1) 0%, rgba(76, 175, 80, 0.05) 100%)",border:"1px solid rgba(76, 175, 80, 0.2)"},children:e.jsxs(y,{children:[e.jsx(t,{sx:{display:"flex",alignItems:"center",gap:2,mb:2},children:e.jsx(b,{sx:{bgcolor:"success.main"},children:e.jsx(k,{})})}),e.jsx(s,{variant:"h3",sx:{fontWeight:700,color:"success.main"},children:l.activeMembers}),e.jsx(s,{variant:"body2",color:"text.secondary",children:"Active Members"})]})})})}),e.jsx(o,{item:!0,xs:12,sm:6,md:3,children:e.jsx(t,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.3},children:e.jsx(f,{sx:{background:"linear-gradient(135deg, rgba(255, 152, 0, 0.1) 0%, rgba(255, 152, 0, 0.05) 100%)",border:"1px solid rgba(255, 152, 0, 0.2)"},children:e.jsxs(y,{children:[e.jsx(t,{sx:{display:"flex",alignItems:"center",gap:2,mb:2},children:e.jsx(b,{sx:{bgcolor:"warning.main"},children:e.jsx(V,{})})}),e.jsx(s,{variant:"h3",sx:{fontWeight:700,color:"warning.main"},children:l.pendingInvites}),e.jsx(s,{variant:"body2",color:"text.secondary",children:"Pending Invites"})]})})})}),e.jsx(o,{item:!0,xs:12,sm:6,md:3,children:e.jsx(t,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.4},children:e.jsx(f,{sx:{background:"linear-gradient(135deg, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0.05) 100%)",border:"1px solid rgba(255,255,255,0.1)"},children:e.jsxs(y,{children:[e.jsx(t,{sx:{display:"flex",alignItems:"center",gap:2,mb:2},children:e.jsx(b,{sx:{bgcolor:"secondary.main"},children:e.jsx(te,{})})}),e.jsx(s,{variant:"h3",sx:{fontWeight:700},children:l.availableSeats}),e.jsx(s,{variant:"body2",color:"text.secondary",children:"Available Seats"}),e.jsx(ne,{variant:"determinate",value:R,sx:{mt:1,height:4,borderRadius:2,backgroundColor:"rgba(255,255,255,0.1)","& .MuiLinearProgress-bar":{borderRadius:2,background:R>80?"linear-gradient(90deg, #ff9800 0%, #f44336 100%)":"linear-gradient(90deg, #00d4ff 0%, #667eea 100%)"}}})]})})})})]}),e.jsx(t,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.5},children:e.jsx(ie,{component:re,sx:{background:"linear-gradient(135deg, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0.05) 100%)",backdropFilter:"blur(20px)",border:"1px solid rgba(255,255,255,0.1)"},children:e.jsxs(le,{children:[e.jsx(oe,{children:e.jsxs(F,{children:[e.jsx(i,{sx:{fontWeight:600},children:"Member"}),e.jsx(i,{sx:{fontWeight:600},children:"Role"}),e.jsx(i,{sx:{fontWeight:600},children:"Department"}),e.jsx(i,{sx:{fontWeight:600},children:"Status"}),e.jsx(i,{sx:{fontWeight:600},children:"License"}),e.jsx(i,{sx:{fontWeight:600},children:"Last Active"}),e.jsx(i,{sx:{fontWeight:600},children:"Actions"})]})}),e.jsx(ce,{children:U.map(a=>e.jsxs(F,{hover:!0,children:[e.jsx(i,{children:e.jsxs(t,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsxs(b,{sx:{width:40,height:40},children:[a.firstName[0],a.lastName[0]]}),e.jsxs(t,{children:[e.jsxs(s,{variant:"body2",sx:{fontWeight:500},children:[a.firstName," ",a.lastName]}),e.jsx(s,{variant:"caption",color:"text.secondary",children:a.email})]})]})}),e.jsx(i,{children:e.jsx(B,{icon:a.role==="admin"?e.jsx(de,{}):e.jsx(xe,{}),label:a.role.toUpperCase(),color:Te(a.role),size:"small",variant:"outlined"})}),e.jsx(i,{children:e.jsx(s,{variant:"body2",children:a.department||"Not assigned"})}),e.jsx(i,{children:e.jsx(B,{icon:Re(a.status),label:a.status.toUpperCase(),color:De(a.status),size:"small"})}),e.jsx(i,{children:a.licenseAssigned?e.jsx(he,{title:a.licenseAssigned,children:e.jsx(s,{variant:"body2",sx:{fontFamily:"monospace",maxWidth:120,overflow:"hidden",textOverflow:"ellipsis"},children:a.licenseAssigned})}):e.jsx(s,{variant:"body2",color:"text.secondary",children:"No license"})}),e.jsx(i,{children:e.jsx(s,{variant:"body2",children:a.lastActive?new Date(a.lastActive).toLocaleDateString():"Never"})}),e.jsx(i,{children:e.jsx(ue,{onClick:n=>X(n,a),size:"small",children:e.jsx(me,{})})})]},a.id))})]})})}),e.jsx(ge,{color:"primary",sx:{position:"fixed",bottom:24,right:24,background:"linear-gradient(135deg, #00d4ff 0%, #667eea 100%)",color:"#000"},onClick:()=>g(!0),children:e.jsx(je,{})}),e.jsxs(be,{anchorEl:W,open:!!W,onClose:p,PaperProps:{sx:{backgroundColor:"background.paper",border:"1px solid rgba(255, 255, 255, 0.1)"}},children:[e.jsxs(h,{onClick:()=>Q(!0),children:[e.jsx(S,{children:e.jsx(pe,{fontSize:"small"})}),"Edit Member"]}),(x==null?void 0:x.status)==="pending"&&e.jsxs(h,{onClick:K,children:[e.jsx(S,{children:e.jsx(ve,{fontSize:"small"})}),"Resend Invite"]}),e.jsxs(h,{onClick:p,children:[e.jsx(S,{children:e.jsx(H,{fontSize:"small"})}),"Suspend Member"]}),e.jsxs(h,{onClick:Y,sx:{color:"error.main"},children:[e.jsx(S,{children:e.jsx(fe,{fontSize:"small",sx:{color:"error.main"}})}),"Remove Member"]})]}),e.jsxs(ye,{open:q,onClose:()=>g(!1),maxWidth:"sm",fullWidth:!0,PaperProps:{sx:{backgroundColor:"background.paper",border:"1px solid rgba(255, 255, 255, 0.1)"}},children:[e.jsx(Se,{children:"Invite Team Member"}),e.jsx(Ce,{children:e.jsxs(o,{container:!0,spacing:3,sx:{mt:1},children:[e.jsx(o,{item:!0,xs:12,children:e.jsx(M,{fullWidth:!0,label:"Email Address",type:"email",value:m.email,onChange:a=>j(n=>({...n,email:a.target.value}))})}),e.jsx(o,{item:!0,xs:12,sm:6,children:e.jsxs(Ie,{fullWidth:!0,children:[e.jsx(Me,{children:"Role"}),e.jsxs(ke,{value:m.role,label:"Role",onChange:a=>j(n=>({...n,role:a.target.value})),inputProps:{"aria-label":"Select team member role",title:"Select the role for this team member"},children:[e.jsx(h,{value:"viewer",children:"Viewer"}),e.jsx(h,{value:"member",children:"Member"}),e.jsx(h,{value:"admin",children:"Admin"})]})]})}),e.jsx(o,{item:!0,xs:12,sm:6,children:e.jsx(M,{fullWidth:!0,label:"Department",value:m.department,onChange:a=>j(n=>({...n,department:a.target.value}))})}),e.jsx(o,{item:!0,xs:12,children:e.jsx(M,{fullWidth:!0,label:"Welcome Message (Optional)",multiline:!0,rows:3,value:m.message,onChange:a=>j(n=>({...n,message:a.target.value}))})})]})}),e.jsxs(Ae,{children:[e.jsx(I,{onClick:()=>g(!1),children:"Cancel"}),e.jsx(I,{onClick:J,variant:"contained",disabled:!m.email,children:"Send Invitation"})]})]})]})};export{Ge as default};
