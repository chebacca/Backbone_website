import{j as e,a as q,T as B,d as U,bw as ot,G as h,aG as lt,w as Ie,K as Ve,b0 as dt,c as ct,b1 as mt,b2 as ut,b3 as Fe,b4 as N,b5 as gt,aC as pt,m as $e,bx as ht,by as bt,I as je,bd as xt,bz as vt,aT as ft,as as jt,ae as C,s as Se,bg as St,bA as _e,b9 as we,D as ue,k as ge,l as pe,A as ne,n as L,aN as Me,b7 as ye,b8 as Ee,v as he,X as Ue,_ as Be,$ as Le,aJ as wt}from"./mui-CWufCee_.js";import{r as b}from"./vendor-OeuszDaU.js";import{u as Mt}from"./notistack.esm-CcFOI6Un.js";import{u as yt,c as D,e as O}from"./index-DPYqItWE.js";import{M as be}from"./MetricCard-Cep6NJsK.js";import"./stripe-DjIiidKe.js";const Et=c=>{switch(c){case"admin":return"secondary";case"owner":return"secondary";case"manager":return"info";case"member":return"success";case"viewer":return"default";default:return"default"}},It=c=>{switch(c){case"active":return"success";case"pending":return"warning";case"suspended":return"error";case"removed":return"default";default:return"default"}},At=c=>{switch(c){case"active":return e.jsx(Ie,{});case"pending":return e.jsx(wt,{});case"suspended":return e.jsx(_e,{});default:return e.jsx(Ie,{})}},zt=()=>{const{enqueueSnackbar:c}=Mt(),{user:z}=yt(),[Ge,H]=b.useState([]),[P,_]=b.useState({totalMembers:0,activeMembers:0,pendingInvites:0,availableSeats:0,totalSeats:0}),[E,ie]=b.useState(null),[Ct,oe]=b.useState(""),[Pt,Ae]=b.useState(null),[R,xe]=b.useState(null),G=(t,{includeTime:a=!1}={})=>{try{if(!t){const r=new Date;return a?r.toISOString():r.toISOString().slice(0,10)}if(typeof t=="string"||typeof t=="number"){const r=new Date(t);if(!Number.isNaN(r.getTime()))return a?r.toISOString():r.toISOString().slice(0,10)}if(typeof t=="object"){const r=t._seconds,n=t._nanoseconds??0;if(typeof r=="number"){const u=r*1e3+Math.floor(n/1e6),d=new Date(u);return a?d.toISOString():d.toISOString().slice(0,10)}}}catch{}const o=new Date;return a?o.toISOString():o.toISOString().slice(0,10)};b.useEffect(()=>{let t=!0;return(async()=>{var a,o,r,n,u,d,M,s,S,y,k,l,W,g;try{const v=await D.get(O.organizations.context()).catch(()=>null),p=((o=(a=v==null?void 0:v.data)==null?void 0:a.data)==null?void 0:o.organization)||null,K=((n=(r=v==null?void 0:v.data)==null?void 0:r.data)==null?void 0:n.members)||[],Q=((d=(u=v==null?void 0:v.data)==null?void 0:u.data)==null?void 0:d.activeSubscription)||null,T=((s=(M=v==null?void 0:v.data)==null?void 0:M.data)==null?void 0:s.primaryRole)||null;let f=p,w=K,A=Q;if(!f){const i=await D.get(O.organizations.my()),V=((y=(S=i==null?void 0:i.data)==null?void 0:S.data)==null?void 0:y.owned)??[],F=((l=(k=i==null?void 0:i.data)==null?void 0:k.data)==null?void 0:l.memberOf)??[];f=V[0]||F[0]||null,w=(f==null?void 0:f.members)||[]}if(!f){t&&(ie(null),oe(""),H([]),_({totalMembers:0,activeMembers:0,pendingInvites:0,availableSeats:0,totalSeats:0}));return}const X=w.filter(i=>i.status==="ACTIVE").length;let ee=0;A&&A.status==="ACTIVE"&&A.organizationId===f.id?ee=Number(A.seats||0):ee=(((g=(W=(await D.get(O.subscriptions.mySubscriptions())).data)==null?void 0:W.data)==null?void 0:g.subscriptions)??[]).filter($=>$.organizationId===f.id&&$.status==="ACTIVE").reduce(($,re)=>(!A&&re.status==="ACTIVE"&&(A=re),$+(re.seats||0)),0);const me=Math.max(0,ee-X),m=(Array.isArray(w)?w:[]).filter(i=>i&&i.status!=="REMOVED").map(i=>{const V=String(i.email||"user@example.com"),F=V.split("@")[0]||"User",$={OWNER:"owner",ENTERPRISE_ADMIN:"admin",MANAGER:"manager",MEMBER:"member"},re={INVITED:"pending",ACTIVE:"active",REMOVED:"removed"};return{id:String(i.id||`${V}-${Math.random().toString(36).slice(2)}`),firstName:F.charAt(0).toUpperCase()+F.slice(1),lastName:"",email:V,role:$[String(i.role)]||"member",status:re[String(i.status)]||"active",department:i.department||"",licenseType:i.licenseType||"PROFESSIONAL",joinedAt:G(i.joinedAt),lastActive:G(i.updatedAt||i.joinedAt||new Date,{includeTime:!0})}});if(!t)return;ie(f.id),oe(f.name||"Organization"),Ae(T||null),console.log("[TeamPage] Organization ID:",f.id,"Type:",typeof f.id,"Length:",String(f.id).length),console.log("[TeamPage] Organization ID characters:",Array.from(String(f.id)).map(i=>`${i}(${i.charCodeAt(0)})`).join(" ")),xe(A?{id:String(A.id),tier:String(A.tier).toUpperCase(),seats:Number(A.seats||0),status:String(A.status||""),organizationId:A.organizationId}:null),H(m),_({totalMembers:m.length,activeMembers:X,pendingInvites:0,availableSeats:me,totalSeats:ee})}catch(v){if(!t)return;console.error("[TeamPage] Failed to load team data:",v),H([]),_({totalMembers:0,activeMembers:0,pendingInvites:0,availableSeats:0,totalSeats:0})}})(),()=>{t=!1}},[z==null?void 0:z.email]);const qe=async()=>{var t,a,o,r,n,u,d,M,s,S,y,k,l,W;try{const g=await D.get(O.organizations.context()).catch(()=>null),v=((a=(t=g==null?void 0:g.data)==null?void 0:t.data)==null?void 0:a.organization)||null,p=((r=(o=g==null?void 0:g.data)==null?void 0:o.data)==null?void 0:r.members)||[],K=((u=(n=g==null?void 0:g.data)==null?void 0:n.data)==null?void 0:u.activeSubscription)||null,Q=((M=(d=g==null?void 0:g.data)==null?void 0:d.data)==null?void 0:M.primaryRole)||null;let T=v,f=p,w=K;if(!T){const m=await D.get(O.organizations.my()),i=((S=(s=m==null?void 0:m.data)==null?void 0:s.data)==null?void 0:S.owned)??[],V=((k=(y=m==null?void 0:m.data)==null?void 0:y.data)==null?void 0:k.memberOf)??[];T=i[0]||V[0]||null,f=(T==null?void 0:T.members)||[]}if(!T){ie(null),oe(""),H([]),_({totalMembers:0,activeMembers:0,pendingInvites:0,availableSeats:0,totalSeats:0});return}const A=f.filter(m=>m.status==="ACTIVE").length;let X=0;w&&w.status==="ACTIVE"&&w.organizationId===T.id?X=Number(w.seats||0):X=(((W=(l=(await D.get(O.subscriptions.mySubscriptions())).data)==null?void 0:l.data)==null?void 0:W.subscriptions)??[]).filter(F=>F.organizationId===T.id&&F.status==="ACTIVE").reduce((F,$)=>(!w&&$.status==="ACTIVE"&&(w=$),F+($.seats||0)),0);const ee=Math.max(0,X-A),me=(Array.isArray(f)?f:[]).filter(m=>m&&m.status!=="REMOVED").map(m=>{const i=String(m.email||"user@example.com"),V=i.split("@")[0]||"User",F={OWNER:"owner",ENTERPRISE_ADMIN:"admin",MANAGER:"manager",MEMBER:"member"},$={INVITED:"pending",ACTIVE:"active",REMOVED:"removed"};return{id:String(m.id||`${i}-${Math.random().toString(36).slice(2)}`),firstName:V.charAt(0).toUpperCase()+V.slice(1),lastName:"",email:i,role:F[String(m.role)]||"member",status:$[String(m.status)]||"active",department:m.department||"",licenseType:m.licenseType||"PROFESSIONAL",joinedAt:G(m.joinedAt),lastActive:G(m.updatedAt||m.joinedAt||new Date,{includeTime:!0})}});ie(T.id),oe(T.name||"Organization"),Ae(Q||null),xe(w?{id:String(w.id),tier:String(w.tier).toUpperCase(),seats:Number(w.seats||0),status:String(w.status||""),organizationId:w.organizationId}:null),H(me),_({totalMembers:me.length,activeMembers:A,pendingInvites:0,availableSeats:ee,totalSeats:X})}catch(g){console.error("[TeamPage] Failed to refresh team data:",g)}},[Ce,Pe]=b.useState(null),[j,Te]=b.useState(null),[He,te]=b.useState(!1),[Je,le]=b.useState(!1),[Ne,De]=b.useState(0),[Ke,ae]=b.useState(!1),[se,de]=b.useState(!1),[Oe,Re]=b.useState(!1),[ke,ze]=b.useState(!1),[x,Y]=b.useState({newPassword:"",confirmPassword:"",email:"",role:"member",status:"active"}),[Xe,ve]=b.useState(!1),[Z,fe]=b.useState(null),[I,J]=b.useState({email:"",firstName:"",lastName:"",role:"member",department:"",message:""}),Ye=(t,a)=>{Pe(t.currentTarget),Te(a)},ce=()=>{Pe(null)},Ze=async()=>{var t,a,o,r,n,u,d,M;if(E){if(P.availableSeats<=0){c("No seats available. Please add seats from Billing before inviting new members.",{variant:"warning"});return}try{const s={email:I.email.trim(),firstName:I.firstName.trim(),lastName:I.lastName.trim(),licenseType:"PROFESSIONAL",organizationId:E,createdBy:(z==null?void 0:z.id)||"unknown",sendWelcomeEmail:!0};I.department&&I.department.trim()&&(s.department=I.department.trim()),console.log("[TeamPage] Creating team member with payload:",s),console.log("[TeamPage] Organization ID:",E,"Type:",typeof E),console.log("[TeamPage] Organization ID validation test:",/^[a-zA-Z0-9\-_\.]+$/.test(String(E))),console.log("[TeamPage] Organization ID characters:",Array.from(String(E)).map(y=>`${y}(${y.charCodeAt(0)})`).join(" "));const S=await D.post(O.teamMembers.create(),s);if((t=S.data)!=null&&t.success){const y=S.data.data.teamMember,k=S.data.data.temporaryPassword;c(`Team member ${y.email} created successfully! Temporary password: ${k}`,{variant:"success"}),te(!1),J({email:"",firstName:"",lastName:"",role:"member",department:"",message:""}),await qe()}else throw new Error("Failed to create team member")}catch(s){console.error("[TeamPage] Team member creation failed:",s),console.error("[TeamPage] Error response:",(a=s==null?void 0:s.response)==null?void 0:a.data),console.error("[TeamPage] Error status:",(o=s==null?void 0:s.response)==null?void 0:o.status),console.error("[TeamPage] Error headers:",(r=s==null?void 0:s.response)==null?void 0:r.headers);const S=((u=(n=s==null?void 0:s.response)==null?void 0:n.data)==null?void 0:u.message)||((M=(d=s==null?void 0:s.response)==null?void 0:d.data)==null?void 0:M.error)||(s==null?void 0:s.message)||"Failed to create team member";c(S,{variant:"error"})}}},Qe=b.useMemo(()=>String((z==null?void 0:z.role)||"").toUpperCase()==="SUPERADMIN",[z==null?void 0:z.role]),et=()=>{if(!R){c("No active subscription found for this organization.",{variant:"warning"});return}De(Number(R.seats||0)),le(!0)},tt=async()=>{var t,a;if(R)try{const o=R.tier,r=Number(Ne||0);if(o==="BASIC"&&r!==1){c("Basic plan supports exactly 1 seat.",{variant:"warning"});return}if(o==="PRO"&&(r<1||r>50)){c("Pro plan seats must be between 1 and 50.",{variant:"warning"});return}if(o==="ENTERPRISE"&&r<10){c("Enterprise requires minimum 10 seats.",{variant:"warning"});return}await D.put(O.subscriptions.update(R.id),{seats:r}),xe(n=>n&&{...n,seats:r}),_(n=>({...n,totalSeats:r,availableSeats:Math.max(0,r-(n.activeMembers+n.pendingInvites))})),c("Seats updated successfully",{variant:"success"}),le(!1)}catch(o){const r=((a=(t=o==null?void 0:o.response)==null?void 0:t.data)==null?void 0:a.message)||(o==null?void 0:o.message)||"Failed to update seats";c(r,{variant:"error"})}},at=()=>{Y({newPassword:"",confirmPassword:"",email:(j==null?void 0:j.email)||"",role:(j==null?void 0:j.role)||"member",status:(j==null?void 0:j.status)||"active"}),Re(!1),ze(!1),ae(!0)},st=async()=>{var r,n;if(!j)return;if(j.status!=="active"){c("Password can only be set after the member has joined (status Active).",{variant:"warning"});return}const t=j.email,{newPassword:a,confirmPassword:o}=x;if(!a||a.length<8){c("Password must be at least 8 characters.",{variant:"warning"});return}if(a!==o){c("Passwords do not match.",{variant:"warning"});return}try{if(de(!0),!E){c("Organization context not found.",{variant:"error"});return}await D.put(O.organizations.setMemberPassword(E,j.id),{password:a}),c(`Password set for ${t}`,{variant:"success"}),ae(!1)}catch(u){const d=((n=(r=u==null?void 0:u.response)==null?void 0:r.data)==null?void 0:n.message)||(u==null?void 0:u.message)||"Failed to set password";c(d,{variant:"error"})}finally{de(!1)}},rt=async()=>{var t,a,o,r,n,u;if(!(!j||!E))try{de(!0);const d={admin:"ENTERPRISE_ADMIN",owner:"ENTERPRISE_ADMIN",manager:"MANAGER",member:"MEMBER",viewer:"MEMBER"},M={pending:"INVITED",active:"ACTIVE",suspended:"SUSPENDED",removed:"REMOVED"};console.log("Updating member:",{memberId:j.id,email:x.email,role:d[x.role],status:M[x.status]}),await D.patch(O.organizations.updateMember(E,j.id),{email:x.email,role:d[x.role],status:M[x.status]}),x.newPassword&&x.confirmPassword&&x.newPassword===x.confirmPassword&&await D.put(O.organizations.setMemberPassword(E,j.id),{password:x.newPassword}),c("Member updated successfully",{variant:"success"}),ae(!1);const s=await D.get(O.organizations.my()),S=((a=(t=s==null?void 0:s.data)==null?void 0:t.data)==null?void 0:a.owned)??[],y=((r=(o=s==null?void 0:s.data)==null?void 0:o.data)==null?void 0:r.memberOf)??[],k=[...S,...y].find(l=>l.id===E)||S[0]||y[0];if(k){const l=k.members||[],W=(Array.isArray(l)?l:[]).filter(p=>p&&p.status!=="REMOVED").map(p=>{const K=String(p.email||"user@example.com"),Q=K.split("@")[0]||"User",T={OWNER:"owner",ENTERPRISE_ADMIN:"admin",MANAGER:"manager",MEMBER:"member"},f={INVITED:"pending",ACTIVE:"active",REMOVED:"removed"};return{id:String(p.id||`${K}-${Math.random().toString(36).slice(2)}`),firstName:Q.charAt(0).toUpperCase()+Q.slice(1),lastName:"",email:K,role:T[String(p.role)]||"member",status:f[String(p.status)]||"active",joinedAt:G(p.joinedAt),lastActive:G(p.updatedAt||p.joinedAt||new Date,{includeTime:!0})}}),g=l.filter(p=>p.status==="INVITED").length,v=l.filter(p=>p.status==="ACTIVE").length;H(W),_(p=>({...p,totalMembers:W.length,pendingInvites:g,activeMembers:v,availableSeats:Math.max(0,p.totalSeats-(v+g))}))}}catch(d){console.error("[TeamPage] Update member failed:",d);const M=((u=(n=d==null?void 0:d.response)==null?void 0:n.data)==null?void 0:u.message)||(d==null?void 0:d.message)||"Failed to update member";c(M,{variant:"error"})}finally{de(!1)}},nt=()=>{j&&(fe(j),ve(!0),ce())},it=async()=>{var t,a,o,r;if(!(!Z||!E))try{await D.post(O.organizations.removeMember(E,Z.id)),c(`${Z.email} removed from team`,{variant:"warning"});const n=await D.get(O.organizations.my()),u=((a=(t=n==null?void 0:n.data)==null?void 0:t.data)==null?void 0:a.owned)??[],d=((r=(o=n==null?void 0:n.data)==null?void 0:o.data)==null?void 0:r.memberOf)??[],M=[...u,...d].find(s=>s.id===E)||u[0]||d[0];if(M){const s=M.members||[],S=(Array.isArray(s)?s:[]).filter(l=>l&&l.status!=="REMOVED").map(l=>{const W=String(l.email||"user@example.com"),g=W.split("@")[0]||"User",v={OWNER:"owner",ENTERPRISE_ADMIN:"admin",MANAGER:"manager",MEMBER:"member"},p={INVITED:"pending",ACTIVE:"active",REMOVED:"removed"};return{id:String(l.id||`${W}-${Math.random().toString(36).slice(2)}`),firstName:g.charAt(0).toUpperCase()+g.slice(1),lastName:"",email:W,role:v[String(l.role)]||"member",status:p[String(l.status)]||"active",joinedAt:G(l.joinedAt),lastActive:G(l.updatedAt||l.joinedAt||new Date,{includeTime:!0})}}),y=s.filter(l=>l.status==="INVITED").length,k=s.filter(l=>l.status==="ACTIVE").length;H(S),_(l=>({...l,totalMembers:S.length,pendingInvites:y,activeMembers:k,availableSeats:Math.max(0,l.totalSeats-(k+y))}))}}catch(n){console.error("[TeamPage] Remove member failed:",n),c((n==null?void 0:n.message)||"Failed to remove member",{variant:"error"})}finally{ve(!1),fe(null)}},We=()=>{ve(!1),fe(null)};return b.useMemo(()=>P.totalSeats<=0?0:(P.totalSeats-P.availableSeats)/P.totalSeats*100,[P.totalSeats,P.availableSeats]),e.jsxs(q,{children:[e.jsx(q,{children:e.jsxs(q,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:4},children:[e.jsxs(q,{children:[e.jsx(B,{variant:"h4",sx:{fontWeight:700,mb:1},children:"Team Management"}),e.jsx(B,{variant:"body1",color:"text.secondary",sx:{mb:2},children:"Create and manage your team members with automatic Firebase Authentication setup. Each member gets their own account and temporary password."})]}),e.jsx(U,{variant:"contained",startIcon:e.jsx(ot,{}),onClick:()=>te(!0),disabled:P.availableSeats<=0,sx:{background:"linear-gradient(135deg, #00d4ff 0%, #667eea 100%)",color:"#000",fontWeight:600},children:"Add Team Member"}),Qe&&e.jsxs(U,{variant:"outlined",onClick:et,sx:{ml:2},children:["Manage Seats",R?` (${R.seats})`:""]})]})}),e.jsxs(h,{container:!0,spacing:3,sx:{mb:4},children:[e.jsx(h,{item:!0,xs:12,sm:6,md:3,children:e.jsx(be,{title:"Team Members",value:P.totalMembers,icon:e.jsx(lt,{}),color:"primary",trend:{value:12,direction:"up"}})}),e.jsx(h,{item:!0,xs:12,sm:6,md:3,children:e.jsx(be,{title:"Active Members",value:P.activeMembers,icon:e.jsx(Ie,{}),color:"success",trend:{value:8,direction:"up"}})}),e.jsx(h,{item:!0,xs:12,sm:6,md:3,children:e.jsx(be,{title:"Total Seats",value:P.totalSeats,icon:e.jsx(Ve,{}),color:"primary"})}),e.jsx(h,{item:!0,xs:12,sm:6,md:3,children:e.jsx(be,{title:"Available Seats",value:P.availableSeats,icon:e.jsx(Ve,{}),color:"secondary"})})]}),e.jsx(q,{children:e.jsx(dt,{component:ct,sx:{background:"linear-gradient(135deg, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0.05) 100%)",backdropFilter:"blur(20px)",border:"1px solid rgba(255,255,255,0.1)"},children:e.jsxs(mt,{children:[e.jsx(ut,{children:e.jsxs(Fe,{children:[e.jsx(N,{sx:{fontWeight:600},children:"Member"}),e.jsx(N,{sx:{fontWeight:600},children:"Role"}),e.jsx(N,{sx:{fontWeight:600},children:"Department"}),e.jsx(N,{sx:{fontWeight:600},children:"Status"}),e.jsx(N,{sx:{fontWeight:600},children:"License"}),e.jsx(N,{sx:{fontWeight:600},children:"Last Active"}),e.jsx(N,{sx:{fontWeight:600},children:"Actions"})]})}),e.jsx(gt,{children:Ge.map(t=>e.jsxs(Fe,{hover:!0,children:[e.jsx(N,{children:e.jsxs(q,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsxs(pt,{sx:{width:40,height:40},children:[t.firstName[0],t.lastName[0]]}),e.jsxs(q,{children:[e.jsxs(B,{variant:"body2",sx:{fontWeight:500},children:[t.firstName," ",t.lastName]}),e.jsx(B,{variant:"caption",color:"text.secondary",children:t.email})]})]})}),e.jsx(N,{children:e.jsx($e,{icon:t.role==="admin"?e.jsx(ht,{}):e.jsx(bt,{}),label:t.role.toUpperCase(),color:Et(t.role),size:"small",variant:"outlined"})}),e.jsx(N,{children:e.jsx(B,{variant:"body2",children:t.department||"Not assigned"})}),e.jsx(N,{children:e.jsx($e,{icon:At(t.status),label:t.status.toUpperCase(),color:It(t.status),size:"small"})}),e.jsx(N,{children:e.jsx(B,{variant:"body2",children:t.licenseType||"PROFESSIONAL"})}),e.jsx(N,{children:e.jsx(B,{variant:"body2",children:t.lastActive?new Date(t.lastActive).toLocaleDateString():"Never"})}),e.jsx(N,{children:e.jsx(je,{onClick:a=>Ye(a,t),size:"small",children:e.jsx(xt,{})})})]},t.id))})]})})}),e.jsx(vt,{color:"primary",sx:{position:"fixed",bottom:24,right:24,background:"linear-gradient(135deg, #00d4ff 0%, #667eea 100%)",color:"#000"},onClick:()=>te(!0),children:e.jsx(ft,{})}),e.jsxs(jt,{anchorEl:Ce,open:!!Ce,onClose:ce,PaperProps:{sx:{backgroundColor:"background.paper",border:"1px solid rgba(255, 255, 255, 0.1)"}},children:[e.jsxs(C,{onClick:()=>{ce(),at()},children:[e.jsx(Se,{children:e.jsx(St,{fontSize:"small"})}),"Edit Member"]}),e.jsxs(C,{onClick:ce,children:[e.jsx(Se,{children:e.jsx(_e,{fontSize:"small"})}),"Suspend Member"]}),e.jsxs(C,{onClick:nt,sx:{color:"error.main"},children:[e.jsx(Se,{children:e.jsx(we,{fontSize:"small",sx:{color:"error.main"}})}),"Remove Member"]})]}),e.jsxs(ue,{open:He,onClose:()=>te(!1),maxWidth:"sm",fullWidth:!0,PaperProps:{sx:{backgroundColor:"background.paper",border:"1px solid rgba(255, 255, 255, 0.1)"}},children:[e.jsx(ge,{children:"Create New Team Member"}),e.jsxs(pe,{children:[e.jsx(B,{variant:"body2",color:"text.secondary",sx:{mb:2},children:"Create a new team member account with automatic Firebase Authentication setup. The member will receive a welcome email with their temporary password."}),e.jsxs(h,{container:!0,spacing:3,sx:{mt:1},children:[P.availableSeats<=0&&e.jsx(h,{item:!0,xs:12,children:e.jsx(ne,{severity:"warning",children:"No available seats. Add seats on the Billing page to invite more team members."})}),e.jsx(h,{item:!0,xs:12,sm:6,children:e.jsx(L,{fullWidth:!0,label:"First Name",value:I.firstName,onChange:t=>J(a=>({...a,firstName:t.target.value})),required:!0})}),e.jsx(h,{item:!0,xs:12,sm:6,children:e.jsx(L,{fullWidth:!0,label:"Last Name",value:I.lastName,onChange:t=>J(a=>({...a,lastName:t.target.value})),required:!0})}),e.jsx(h,{item:!0,xs:12,children:e.jsx(L,{fullWidth:!0,label:"Email Address",type:"email",value:I.email,onChange:t=>J(a=>({...a,email:t.target.value})),required:!0})}),e.jsx(h,{item:!0,xs:12,sm:6,children:e.jsxs(Me,{fullWidth:!0,children:[e.jsx(ye,{children:"Role"}),e.jsxs(Ee,{value:I.role,label:"Role",onChange:t=>J(a=>({...a,role:t.target.value})),inputProps:{"aria-label":"Select team member role",title:"Select the role for this team member"},children:[e.jsx(C,{value:"viewer",children:"Viewer"}),e.jsx(C,{value:"member",children:"Member"}),e.jsx(C,{value:"admin",children:"Admin"})]})]})}),e.jsx(h,{item:!0,xs:12,sm:6,children:e.jsx(L,{fullWidth:!0,label:"Department",value:I.department,onChange:t=>J(a=>({...a,department:t.target.value}))})}),e.jsx(h,{item:!0,xs:12,children:e.jsx(L,{fullWidth:!0,label:"Welcome Message (Optional)",multiline:!0,rows:3,value:I.message,onChange:t=>J(a=>({...a,message:t.target.value}))})})]})]}),e.jsxs(he,{children:[e.jsx(U,{onClick:()=>te(!1),children:"Cancel"}),e.jsx(U,{onClick:Ze,variant:"contained",disabled:!I.email||!I.firstName||!I.lastName||P.availableSeats<=0,children:"Create Team Member"})]})]}),e.jsxs(ue,{open:Je,onClose:()=>le(!1),maxWidth:"xs",fullWidth:!0,PaperProps:{sx:{backgroundColor:"background.paper",border:"1px solid rgba(255, 255, 255, 0.1)"}},children:[e.jsx(ge,{children:"Manage Seats"}),e.jsx(pe,{children:e.jsxs(h,{container:!0,spacing:2,sx:{mt:.5},children:[e.jsx(h,{item:!0,xs:12,children:e.jsx(ne,{severity:"info",children:R?`${R.tier} subscription`:"No active subscription"})}),e.jsx(h,{item:!0,xs:12,children:e.jsx(L,{fullWidth:!0,type:"number",label:"Total Seats",value:Ne,onChange:t=>De(parseInt(t.target.value||"0",10)),inputProps:{min:1,max:(R==null?void 0:R.tier)==="PRO"?50:1e3}})})]})}),e.jsxs(he,{children:[e.jsx(U,{onClick:()=>le(!1),children:"Cancel"}),e.jsx(U,{onClick:tt,variant:"contained",disabled:!R,children:"Save"})]})]}),e.jsxs(ue,{open:Ke,onClose:()=>{ae(!1),Te(null)},maxWidth:"sm",fullWidth:!0,PaperProps:{sx:{backgroundColor:"background.paper",border:"1px solid rgba(255, 255, 255, 0.1)"}},children:[e.jsx(ge,{children:"Edit Member"}),e.jsx(pe,{children:e.jsxs(h,{container:!0,spacing:3,sx:{mt:1},children:[e.jsx(h,{item:!0,xs:12,children:e.jsx(L,{fullWidth:!0,label:"Email",value:x.email,onChange:t=>Y(a=>({...a,email:t.target.value}))})}),e.jsx(h,{item:!0,xs:12,sm:6,children:e.jsxs(Me,{fullWidth:!0,children:[e.jsx(ye,{children:"Role"}),e.jsxs(Ee,{value:x.role,label:"Role",onChange:t=>Y(a=>({...a,role:t.target.value})),children:[e.jsx(C,{value:"viewer",children:"Viewer"}),e.jsx(C,{value:"member",children:"Member"}),e.jsx(C,{value:"manager",children:"Manager"}),e.jsx(C,{value:"admin",children:"Admin"}),e.jsx(C,{value:"owner",children:"Owner"})]})]})}),e.jsx(h,{item:!0,xs:12,sm:6,children:e.jsxs(Me,{fullWidth:!0,children:[e.jsx(ye,{children:"Status"}),e.jsxs(Ee,{value:x.status,label:"Status",onChange:t=>Y(a=>({...a,status:t.target.value})),children:[e.jsx(C,{value:"pending",children:"Pending"}),e.jsx(C,{value:"active",children:"Active"}),e.jsx(C,{value:"suspended",children:"Suspended"}),e.jsx(C,{value:"removed",children:"Removed"})]})]})}),e.jsx(h,{item:!0,xs:12,children:x.status!=="active"?e.jsx(ne,{severity:"warning",children:"This member has not joined yet (Pending/Suspended/Removed). You can only set a password for Active members."}):e.jsx(ne,{severity:"info",children:"Set a temporary password for this user to log into Backbone. They can change it later."})}),e.jsx(h,{item:!0,xs:12,sm:6,children:e.jsx(L,{fullWidth:!0,label:"New Password",type:Oe?"text":"password",value:x.newPassword,onChange:t=>Y(a=>({...a,newPassword:t.target.value})),inputProps:{minLength:8},helperText:"Minimum 8 characters",InputProps:{endAdornment:e.jsx(Ue,{position:"end",children:e.jsx(je,{onClick:()=>Re(t=>!t),edge:"end","aria-label":"toggle password visibility",children:Oe?e.jsx(Be,{}):e.jsx(Le,{})})})}})}),e.jsx(h,{item:!0,xs:12,sm:6,children:e.jsx(L,{fullWidth:!0,label:"Confirm Password",type:ke?"text":"password",value:x.confirmPassword,onChange:t=>Y(a=>({...a,confirmPassword:t.target.value})),InputProps:{endAdornment:e.jsx(Ue,{position:"end",children:e.jsx(je,{onClick:()=>ze(t=>!t),edge:"end","aria-label":"toggle password visibility",children:ke?e.jsx(Be,{}):e.jsx(Le,{})})})}})})]})}),e.jsxs(he,{children:[e.jsx(U,{onClick:()=>ae(!1),disabled:se,children:"Cancel"}),e.jsx(U,{onClick:rt,variant:"outlined",disabled:se,children:se?"Saving…":"Save Changes"}),e.jsx(U,{onClick:st,variant:"contained",disabled:se||!x.newPassword||!x.confirmPassword||x.status!=="active",children:se?"Saving…":"Save Password Only"})]})]}),e.jsxs(ue,{open:Xe,onClose:We,maxWidth:"sm",fullWidth:!0,PaperProps:{sx:{backgroundColor:"background.paper",border:"1px solid rgba(255, 255, 255, 0.1)"}},children:[e.jsx(ge,{children:e.jsxs(q,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(we,{color:"error"}),"Remove Team Member"]})}),e.jsxs(pe,{children:[e.jsxs(B,{variant:"body1",sx:{mb:2},children:["Are you sure you want to remove ",e.jsx("strong",{children:Z==null?void 0:Z.email})," from your team?"]}),e.jsx(ne,{severity:"warning",sx:{mt:2},children:e.jsx(B,{variant:"body2",children:"This action cannot be undone. The member will lose access to all organization resources and data."})})]}),e.jsxs(he,{children:[e.jsx(U,{onClick:We,color:"inherit",children:"Cancel"}),e.jsx(U,{onClick:it,color:"error",variant:"contained",startIcon:e.jsx(we,{}),children:"Remove Member"})]})]})]})};export{zt as default};
