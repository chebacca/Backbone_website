import{j as e,a as Y,T as B,d as U,bx as ha,G as u,aH as xa,w as Ne,K as qe,b1 as ba,c as fa,b2 as va,b3 as ja,b4 as Ge,b5 as N,b6 as wa,aC as Sa,m as Ye,by as ya,bz as Ma,I as ie,be as Ia,bA as Ea,aT as Aa,as as Pa,ae as P,s as Ee,bh as Ca,bB as He,ba as Ae,D as pe,k as ge,l as he,A as ae,n as L,aN as Pe,b8 as Ce,b9 as Te,X as xe,_ as be,$ as fe,v as ve,aJ as Ta}from"./mui-Ilj8o9AZ.js";import{r as g}from"./vendor-OeuszDaU.js";import{u as Na}from"./notistack.esm-CcFOI6Un.js";import{u as Da,c as D,e as O}from"./index-CQhV54Ik.js";import{M as je}from"./MetricCard-BdSYF6k0.js";import"./stripe-BKUR_tcx.js";const Oa=c=>{switch(c){case"admin":return"secondary";case"owner":return"secondary";case"manager":return"info";case"member":return"success";case"viewer":return"default";default:return"default"}},ka=c=>{switch(c){case"active":return"success";case"pending":return"warning";case"suspended":return"error";case"removed":return"default";default:return"default"}},Ra=c=>{switch(c){case"active":return e.jsx(Ne,{});case"pending":return e.jsx(Ta,{});case"suspended":return e.jsx(He,{});default:return e.jsx(Ne,{})}},_a=()=>{const{enqueueSnackbar:c}=Na(),{user:z}=Da(),[Je,H]=g.useState([]),[C,q]=g.useState({totalMembers:0,activeMembers:0,pendingInvites:0,availableSeats:0,totalSeats:0}),[E,oe]=g.useState(null),[za,le]=g.useState(""),[Wa,De]=g.useState(null),[k,we]=g.useState(null),G=(a,{includeTime:t=!1}={})=>{try{if(!a){const r=new Date;return t?r.toISOString():r.toISOString().slice(0,10)}if(typeof a=="string"||typeof a=="number"){const r=new Date(a);if(!Number.isNaN(r.getTime()))return t?r.toISOString():r.toISOString().slice(0,10)}if(typeof a=="object"){const r=a._seconds,n=a._nanoseconds??0;if(typeof r=="number"){const h=r*1e3+Math.floor(n/1e6),m=new Date(h);return t?m.toISOString():m.toISOString().slice(0,10)}}}catch{}const l=new Date;return t?l.toISOString():l.toISOString().slice(0,10)};g.useEffect(()=>{let a=!0;return(async()=>{var t,l,r,n,h,m,I,s,S,y,R,o,W,x;try{const v=await D.get(O.organizations.context()).catch(()=>null),b=((l=(t=v==null?void 0:v.data)==null?void 0:t.data)==null?void 0:l.organization)||null,J=((n=(r=v==null?void 0:v.data)==null?void 0:r.data)==null?void 0:n.members)||[],Q=((m=(h=v==null?void 0:v.data)==null?void 0:h.data)==null?void 0:m.activeSubscription)||null,T=((s=(I=v==null?void 0:v.data)==null?void 0:I.data)==null?void 0:s.primaryRole)||null;let j=b,M=J,A=Q;if(!j){const i=await D.get(O.organizations.my()),V=((y=(S=i==null?void 0:i.data)==null?void 0:S.data)==null?void 0:y.owned)??[],F=((o=(R=i==null?void 0:i.data)==null?void 0:R.data)==null?void 0:o.memberOf)??[];j=V[0]||F[0]||null,M=(j==null?void 0:j.members)||[]}if(!j){a&&(oe(null),le(""),H([]),q({totalMembers:0,activeMembers:0,pendingInvites:0,availableSeats:0,totalSeats:0}));return}const K=M.filter(i=>i.status==="ACTIVE").length;let ee=0;A&&A.status==="ACTIVE"&&A.organizationId===j.id?ee=Number(A.seats||0):ee=(((x=(W=(await D.get(O.subscriptions.mySubscriptions())).data)==null?void 0:W.data)==null?void 0:x.subscriptions)??[]).filter($=>$.organizationId===j.id&&$.status==="ACTIVE").reduce(($,ne)=>(!A&&ne.status==="ACTIVE"&&(A=ne),$+(ne.seats||0)),0);const ue=Math.max(0,ee-K),p=(Array.isArray(M)?M:[]).filter(i=>i&&i.status!=="REMOVED").map(i=>{var Le,_e;const V=String(i.email||"user@example.com"),F=V.split("@")[0]||"User",$={OWNER:"owner",ENTERPRISE_ADMIN:"admin",MANAGER:"manager",MEMBER:"member"},ne={INVITED:"pending",ACTIVE:"active",REMOVED:"removed"},pa=i.firstName||((Le=i.name)==null?void 0:Le.split(" ")[0])||F.charAt(0).toUpperCase()+F.slice(1),ga=i.lastName||((_e=i.name)==null?void 0:_e.split(" ").slice(1).join(" "))||"";return{id:String(i.id||`${V}-${Math.random().toString(36).slice(2)}`),firstName:pa,lastName:ga,email:V,role:$[String(i.role)]||"member",status:ne[String(i.status)]||"active",department:i.department||"",licenseType:i.licenseType||"PROFESSIONAL",joinedAt:G(i.joinedAt),lastActive:G(i.updatedAt||i.joinedAt||new Date,{includeTime:!0})}});if(!a)return;oe(j.id),le(j.name||"Organization"),De(T||null),console.log("[TeamPage] Organization ID:",j.id,"Type:",typeof j.id,"Length:",String(j.id).length),console.log("[TeamPage] Organization ID characters:",Array.from(String(j.id)).map(i=>`${i}(${i.charCodeAt(0)})`).join(" ")),we(A?{id:String(A.id),tier:String(A.tier).toUpperCase(),seats:Number(A.seats||0),status:String(A.status||""),organizationId:A.organizationId}:null),H(p),q({totalMembers:p.length,activeMembers:K,pendingInvites:0,availableSeats:ue,totalSeats:ee})}catch(v){if(!a)return;console.error("[TeamPage] Failed to load team data:",v),H([]),q({totalMembers:0,activeMembers:0,pendingInvites:0,availableSeats:0,totalSeats:0})}})(),()=>{a=!1}},[z==null?void 0:z.email]);const Ke=async()=>{var a,t,l,r,n,h,m,I,s,S,y,R,o,W;try{const x=await D.get(O.organizations.context()).catch(()=>null),v=((t=(a=x==null?void 0:x.data)==null?void 0:a.data)==null?void 0:t.organization)||null,b=((r=(l=x==null?void 0:x.data)==null?void 0:l.data)==null?void 0:r.members)||[],J=((h=(n=x==null?void 0:x.data)==null?void 0:n.data)==null?void 0:h.activeSubscription)||null,Q=((I=(m=x==null?void 0:x.data)==null?void 0:m.data)==null?void 0:I.primaryRole)||null;let T=v,j=b,M=J;if(!T){const p=await D.get(O.organizations.my()),i=((S=(s=p==null?void 0:p.data)==null?void 0:s.data)==null?void 0:S.owned)??[],V=((R=(y=p==null?void 0:p.data)==null?void 0:y.data)==null?void 0:R.memberOf)??[];T=i[0]||V[0]||null,j=(T==null?void 0:T.members)||[]}if(!T){oe(null),le(""),H([]),q({totalMembers:0,activeMembers:0,pendingInvites:0,availableSeats:0,totalSeats:0});return}const A=j.filter(p=>p.status==="ACTIVE").length;let K=0;M&&M.status==="ACTIVE"&&M.organizationId===T.id?K=Number(M.seats||0):K=(((W=(o=(await D.get(O.subscriptions.mySubscriptions())).data)==null?void 0:o.data)==null?void 0:W.subscriptions)??[]).filter(F=>F.organizationId===T.id&&F.status==="ACTIVE").reduce((F,$)=>(!M&&$.status==="ACTIVE"&&(M=$),F+($.seats||0)),0);const ee=Math.max(0,K-A),ue=(Array.isArray(j)?j:[]).filter(p=>p&&p.status!=="REMOVED").map(p=>{const i=String(p.email||"user@example.com"),V=i.split("@")[0]||"User",F={OWNER:"owner",ENTERPRISE_ADMIN:"admin",MANAGER:"manager",MEMBER:"member"},$={INVITED:"pending",ACTIVE:"active",REMOVED:"removed"};return{id:String(p.id||`${i}-${Math.random().toString(36).slice(2)}`),firstName:V.charAt(0).toUpperCase()+V.slice(1),lastName:"",email:i,role:F[String(p.role)]||"member",status:$[String(p.status)]||"active",department:p.department||"",licenseType:p.licenseType||"PROFESSIONAL",joinedAt:G(p.joinedAt),lastActive:G(p.updatedAt||p.joinedAt||new Date,{includeTime:!0})}});oe(T.id),le(T.name||"Organization"),De(Q||null),we(M?{id:String(M.id),tier:String(M.tier).toUpperCase(),seats:Number(M.seats||0),status:String(M.status||""),organizationId:M.organizationId}:null),H(ue),q({totalMembers:ue.length,activeMembers:A,pendingInvites:0,availableSeats:ee,totalSeats:K})}catch(x){console.error("[TeamPage] Failed to refresh team data:",x)}},[Oe,ke]=g.useState(null),[w,Re]=g.useState(null),[Xe,te]=g.useState(!1),[Ze,de]=g.useState(!1),[ze,We]=g.useState(0),[Qe,se]=g.useState(!1),[re,ce]=g.useState(!1),[Ve,Fe]=g.useState(!1),[$e,Be]=g.useState(!1),[Se,ea]=g.useState(!1),[ye,aa]=g.useState(!1),[f,X]=g.useState({newPassword:"",confirmPassword:"",email:"",role:"member",status:"active"}),[ta,Me]=g.useState(!1),[Z,Ie]=g.useState(null),[d,_]=g.useState({email:"",firstName:"",lastName:"",role:"member",department:"",message:"",password:"",confirmPassword:""}),sa=(a,t)=>{ke(a.currentTarget),Re(t)},me=()=>{ke(null)},ra=async()=>{var a,t,l,r,n,h,m,I;if(E){if(C.availableSeats<=0){c("No seats available. Please add seats from Billing before inviting new members.",{variant:"warning"});return}if(d.password||d.confirmPassword){if(d.password!==d.confirmPassword){c("Passwords do not match",{variant:"error"});return}if(d.password.length<8){c("Password must be at least 8 characters long",{variant:"error"});return}}try{const s={email:d.email.trim(),firstName:d.firstName.trim(),lastName:d.lastName.trim(),licenseType:"PROFESSIONAL",organizationId:E,createdBy:(z==null?void 0:z.id)||"unknown",sendWelcomeEmail:!0};d.department&&d.department.trim()&&(s.department=d.department.trim()),d.password&&d.password.trim()&&(s.temporaryPassword=d.password.trim()),console.log("[TeamPage] Creating team member with payload:",s),console.log("[TeamPage] Organization ID:",E,"Type:",typeof E),console.log("[TeamPage] Organization ID validation test:",/^[a-zA-Z0-9\-_\.]+$/.test(String(E))),console.log("[TeamPage] Organization ID characters:",Array.from(String(E)).map(y=>`${y}(${y.charCodeAt(0)})`).join(" "));const S=await D.post(O.teamMembers.create(),s);if((a=S.data)!=null&&a.success){const y=S.data.data.teamMember,R=S.data.data.temporaryPassword,o=d.password?`Team member ${y.email} created successfully with your custom password!`:`Team member ${y.email} created successfully! Temporary password: ${R}`;c(o,{variant:"success"}),te(!1),_({email:"",firstName:"",lastName:"",role:"member",department:"",message:"",password:"",confirmPassword:""}),await Ke()}else throw new Error("Failed to create team member")}catch(s){console.error("[TeamPage] Team member creation failed:",s),console.error("[TeamPage] Error response:",(t=s==null?void 0:s.response)==null?void 0:t.data),console.error("[TeamPage] Error status:",(l=s==null?void 0:s.response)==null?void 0:l.status),console.error("[TeamPage] Error headers:",(r=s==null?void 0:s.response)==null?void 0:r.headers);const S=((h=(n=s==null?void 0:s.response)==null?void 0:n.data)==null?void 0:h.message)||((I=(m=s==null?void 0:s.response)==null?void 0:m.data)==null?void 0:I.error)||(s==null?void 0:s.message)||"Failed to create team member";c(S,{variant:"error"})}}},na=g.useMemo(()=>String((z==null?void 0:z.role)||"").toUpperCase()==="SUPERADMIN",[z==null?void 0:z.role]),ia=()=>{if(!k){c("No active subscription found for this organization.",{variant:"warning"});return}We(Number(k.seats||0)),de(!0)},oa=async()=>{var a,t;if(k)try{const l=k.tier,r=Number(ze||0);if(l==="BASIC"&&r!==1){c("Basic plan supports exactly 1 seat.",{variant:"warning"});return}if(l==="PRO"&&(r<1||r>50)){c("Pro plan seats must be between 1 and 50.",{variant:"warning"});return}if(l==="ENTERPRISE"&&r<10){c("Enterprise requires minimum 10 seats.",{variant:"warning"});return}await D.put(O.subscriptions.update(k.id),{seats:r}),we(n=>n&&{...n,seats:r}),q(n=>({...n,totalSeats:r,availableSeats:Math.max(0,r-(n.activeMembers+n.pendingInvites))})),c("Seats updated successfully",{variant:"success"}),de(!1)}catch(l){const r=((t=(a=l==null?void 0:l.response)==null?void 0:a.data)==null?void 0:t.message)||(l==null?void 0:l.message)||"Failed to update seats";c(r,{variant:"error"})}},la=()=>{X({newPassword:"",confirmPassword:"",email:(w==null?void 0:w.email)||"",role:(w==null?void 0:w.role)||"member",status:(w==null?void 0:w.status)||"active"}),Fe(!1),Be(!1),se(!0)},da=async()=>{var r,n;if(!w)return;if(w.status!=="active"){c("Password can only be set after the member has joined (status Active).",{variant:"warning"});return}const a=w.email,{newPassword:t,confirmPassword:l}=f;if(!t||t.length<8){c("Password must be at least 8 characters.",{variant:"warning"});return}if(t!==l){c("Passwords do not match.",{variant:"warning"});return}try{if(ce(!0),!E){c("Organization context not found.",{variant:"error"});return}await D.put(O.organizations.setMemberPassword(E,w.id),{password:t}),c(`Password set for ${a}`,{variant:"success"}),se(!1)}catch(h){const m=((n=(r=h==null?void 0:h.response)==null?void 0:r.data)==null?void 0:n.message)||(h==null?void 0:h.message)||"Failed to set password";c(m,{variant:"error"})}finally{ce(!1)}},ca=async()=>{var a,t,l,r,n,h;if(!(!w||!E))try{ce(!0);const m={admin:"ENTERPRISE_ADMIN",owner:"ENTERPRISE_ADMIN",manager:"MANAGER",member:"MEMBER",viewer:"MEMBER"},I={pending:"INVITED",active:"ACTIVE",suspended:"SUSPENDED",removed:"REMOVED"};console.log("Updating member:",{memberId:w.id,email:f.email,role:m[f.role],status:I[f.status]}),await D.patch(O.organizations.updateMember(E,w.id),{email:f.email,role:m[f.role],status:I[f.status]}),f.newPassword&&f.confirmPassword&&f.newPassword===f.confirmPassword&&await D.put(O.organizations.setMemberPassword(E,w.id),{password:f.newPassword}),c("Member updated successfully",{variant:"success"}),se(!1);const s=await D.get(O.organizations.my()),S=((t=(a=s==null?void 0:s.data)==null?void 0:a.data)==null?void 0:t.owned)??[],y=((r=(l=s==null?void 0:s.data)==null?void 0:l.data)==null?void 0:r.memberOf)??[],R=[...S,...y].find(o=>o.id===E)||S[0]||y[0];if(R){const o=R.members||[],W=(Array.isArray(o)?o:[]).filter(b=>b&&b.status!=="REMOVED").map(b=>{const J=String(b.email||"user@example.com"),Q=J.split("@")[0]||"User",T={OWNER:"owner",ENTERPRISE_ADMIN:"admin",MANAGER:"manager",MEMBER:"member"},j={INVITED:"pending",ACTIVE:"active",REMOVED:"removed"};return{id:String(b.id||`${J}-${Math.random().toString(36).slice(2)}`),firstName:Q.charAt(0).toUpperCase()+Q.slice(1),lastName:"",email:J,role:T[String(b.role)]||"member",status:j[String(b.status)]||"active",joinedAt:G(b.joinedAt),lastActive:G(b.updatedAt||b.joinedAt||new Date,{includeTime:!0})}}),x=o.filter(b=>b.status==="INVITED").length,v=o.filter(b=>b.status==="ACTIVE").length;H(W),q(b=>({...b,totalMembers:W.length,pendingInvites:x,activeMembers:v,availableSeats:Math.max(0,b.totalSeats-(v+x))}))}}catch(m){console.error("[TeamPage] Update member failed:",m);const I=((h=(n=m==null?void 0:m.response)==null?void 0:n.data)==null?void 0:h.message)||(m==null?void 0:m.message)||"Failed to update member";c(I,{variant:"error"})}finally{ce(!1)}},ma=()=>{w&&(Ie(w),Me(!0),me())},ua=async()=>{var a,t,l,r;if(!(!Z||!E))try{await D.post(O.organizations.removeMember(E,Z.id)),c(`${Z.email} removed from team`,{variant:"warning"});const n=await D.get(O.organizations.my()),h=((t=(a=n==null?void 0:n.data)==null?void 0:a.data)==null?void 0:t.owned)??[],m=((r=(l=n==null?void 0:n.data)==null?void 0:l.data)==null?void 0:r.memberOf)??[],I=[...h,...m].find(s=>s.id===E)||h[0]||m[0];if(I){const s=I.members||[],S=(Array.isArray(s)?s:[]).filter(o=>o&&o.status!=="REMOVED").map(o=>{const W=String(o.email||"user@example.com"),x=W.split("@")[0]||"User",v={OWNER:"owner",ENTERPRISE_ADMIN:"admin",MANAGER:"manager",MEMBER:"member"},b={INVITED:"pending",ACTIVE:"active",REMOVED:"removed"};return{id:String(o.id||`${W}-${Math.random().toString(36).slice(2)}`),firstName:x.charAt(0).toUpperCase()+x.slice(1),lastName:"",email:W,role:v[String(o.role)]||"member",status:b[String(o.status)]||"active",joinedAt:G(o.joinedAt),lastActive:G(o.updatedAt||o.joinedAt||new Date,{includeTime:!0})}}),y=s.filter(o=>o.status==="INVITED").length,R=s.filter(o=>o.status==="ACTIVE").length;H(S),q(o=>({...o,totalMembers:S.length,pendingInvites:y,activeMembers:R,availableSeats:Math.max(0,o.totalSeats-(R+y))}))}}catch(n){console.error("[TeamPage] Remove member failed:",n),c((n==null?void 0:n.message)||"Failed to remove member",{variant:"error"})}finally{Me(!1),Ie(null)}},Ue=()=>{Me(!1),Ie(null)};return g.useMemo(()=>C.totalSeats<=0?0:(C.totalSeats-C.availableSeats)/C.totalSeats*100,[C.totalSeats,C.availableSeats]),e.jsxs(Y,{children:[e.jsx(Y,{children:e.jsxs(Y,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:4},children:[e.jsxs(Y,{children:[e.jsx(B,{variant:"h4",sx:{fontWeight:700,mb:1},children:"Team Management"}),e.jsx(B,{variant:"body1",color:"text.secondary",sx:{mb:2},children:"Create and manage your team members with automatic Firebase Authentication setup. Each member gets their own account and temporary password."})]}),e.jsx(U,{variant:"contained",startIcon:e.jsx(ha,{}),onClick:()=>te(!0),disabled:C.availableSeats<=0,sx:{background:"linear-gradient(135deg, #00d4ff 0%, #667eea 100%)",color:"#000",fontWeight:600},children:"Add Team Member"}),na&&e.jsxs(U,{variant:"outlined",onClick:ia,sx:{ml:2},children:["Manage Seats",k?` (${k.seats})`:""]})]})}),e.jsxs(u,{container:!0,spacing:3,sx:{mb:4},children:[e.jsx(u,{item:!0,xs:12,sm:6,md:3,children:e.jsx(je,{title:"Team Members",value:C.totalMembers,icon:e.jsx(xa,{}),color:"primary",trend:{value:12,direction:"up"}})}),e.jsx(u,{item:!0,xs:12,sm:6,md:3,children:e.jsx(je,{title:"Active Members",value:C.activeMembers,icon:e.jsx(Ne,{}),color:"success",trend:{value:8,direction:"up"}})}),e.jsx(u,{item:!0,xs:12,sm:6,md:3,children:e.jsx(je,{title:"Total Seats",value:C.totalSeats,icon:e.jsx(qe,{}),color:"primary"})}),e.jsx(u,{item:!0,xs:12,sm:6,md:3,children:e.jsx(je,{title:"Available Seats",value:C.availableSeats,icon:e.jsx(qe,{}),color:"secondary"})})]}),e.jsx(Y,{children:e.jsx(ba,{component:fa,sx:{background:"linear-gradient(135deg, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0.05) 100%)",backdropFilter:"blur(20px)",border:"1px solid rgba(255,255,255,0.1)"},children:e.jsxs(va,{children:[e.jsx(ja,{children:e.jsxs(Ge,{children:[e.jsx(N,{sx:{fontWeight:600},children:"Member"}),e.jsx(N,{sx:{fontWeight:600},children:"Role"}),e.jsx(N,{sx:{fontWeight:600},children:"Department"}),e.jsx(N,{sx:{fontWeight:600},children:"Status"}),e.jsx(N,{sx:{fontWeight:600},children:"License"}),e.jsx(N,{sx:{fontWeight:600},children:"Last Active"}),e.jsx(N,{sx:{fontWeight:600},children:"Actions"})]})}),e.jsx(wa,{children:Je.map(a=>e.jsxs(Ge,{hover:!0,children:[e.jsx(N,{children:e.jsxs(Y,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsxs(Sa,{sx:{width:40,height:40},children:[a.firstName[0],a.lastName[0]]}),e.jsxs(Y,{children:[e.jsxs(B,{variant:"body2",sx:{fontWeight:500},children:[a.firstName," ",a.lastName]}),e.jsx(B,{variant:"caption",color:"text.secondary",children:a.email})]})]})}),e.jsx(N,{children:e.jsx(Ye,{icon:a.role==="admin"?e.jsx(ya,{}):e.jsx(Ma,{}),label:a.role.toUpperCase(),color:Oa(a.role),size:"small",variant:"outlined"})}),e.jsx(N,{children:e.jsx(B,{variant:"body2",children:a.department||"Not assigned"})}),e.jsx(N,{children:e.jsx(Ye,{icon:Ra(a.status),label:a.status.toUpperCase(),color:ka(a.status),size:"small"})}),e.jsx(N,{children:e.jsx(B,{variant:"body2",children:a.licenseType||"PROFESSIONAL"})}),e.jsx(N,{children:e.jsx(B,{variant:"body2",children:a.lastActive?new Date(a.lastActive).toLocaleDateString():"Never"})}),e.jsx(N,{children:e.jsx(ie,{onClick:t=>sa(t,a),size:"small",children:e.jsx(Ia,{})})})]},a.id))})]})})}),e.jsx(Ea,{color:"primary",sx:{position:"fixed",bottom:24,right:24,background:"linear-gradient(135deg, #00d4ff 0%, #667eea 100%)",color:"#000"},onClick:()=>te(!0),children:e.jsx(Aa,{})}),e.jsxs(Pa,{anchorEl:Oe,open:!!Oe,onClose:me,PaperProps:{sx:{backgroundColor:"background.paper",border:"1px solid rgba(255, 255, 255, 0.1)"}},children:[e.jsxs(P,{onClick:()=>{me(),la()},children:[e.jsx(Ee,{children:e.jsx(Ca,{fontSize:"small"})}),"Edit Member"]}),e.jsxs(P,{onClick:me,children:[e.jsx(Ee,{children:e.jsx(He,{fontSize:"small"})}),"Suspend Member"]}),e.jsxs(P,{onClick:ma,sx:{color:"error.main"},children:[e.jsx(Ee,{children:e.jsx(Ae,{fontSize:"small",sx:{color:"error.main"}})}),"Remove Member"]})]}),e.jsxs(pe,{open:Xe,onClose:()=>te(!1),maxWidth:"sm",fullWidth:!0,PaperProps:{sx:{backgroundColor:"background.paper",border:"1px solid rgba(255, 255, 255, 0.1)"}},children:[e.jsx(ge,{children:"Create New Team Member"}),e.jsxs(he,{children:[e.jsx(B,{variant:"body2",color:"text.secondary",sx:{mb:2},children:"Create a new team member account with automatic Firebase Authentication setup. You can set a custom password or leave it blank to auto-generate one. The member will receive a welcome email with their login credentials."}),e.jsxs(u,{container:!0,spacing:3,sx:{mt:1},children:[C.availableSeats<=0&&e.jsx(u,{item:!0,xs:12,children:e.jsx(ae,{severity:"warning",children:"No available seats. Add seats on the Billing page to invite more team members."})}),e.jsx(u,{item:!0,xs:12,sm:6,children:e.jsx(L,{fullWidth:!0,label:"First Name",value:d.firstName,onChange:a=>_(t=>({...t,firstName:a.target.value})),required:!0})}),e.jsx(u,{item:!0,xs:12,sm:6,children:e.jsx(L,{fullWidth:!0,label:"Last Name",value:d.lastName,onChange:a=>_(t=>({...t,lastName:a.target.value})),required:!0})}),e.jsx(u,{item:!0,xs:12,children:e.jsx(L,{fullWidth:!0,label:"Email Address",type:"email",value:d.email,onChange:a=>_(t=>({...t,email:a.target.value})),required:!0})}),e.jsx(u,{item:!0,xs:12,sm:6,children:e.jsxs(Pe,{fullWidth:!0,children:[e.jsx(Ce,{children:"Role"}),e.jsxs(Te,{value:d.role,label:"Role",onChange:a=>_(t=>({...t,role:a.target.value})),inputProps:{"aria-label":"Select team member role",title:"Select the role for this team member"},children:[e.jsx(P,{value:"viewer",children:"Viewer"}),e.jsx(P,{value:"member",children:"Member"}),e.jsx(P,{value:"admin",children:"Admin"})]})]})}),e.jsx(u,{item:!0,xs:12,sm:6,children:e.jsx(L,{fullWidth:!0,label:"Department",value:d.department,onChange:a=>_(t=>({...t,department:a.target.value}))})}),e.jsx(u,{item:!0,xs:12,children:e.jsx(ae,{severity:"info",sx:{mb:2},children:e.jsxs(B,{variant:"body2",children:[e.jsx("strong",{children:"Password Setup:"})," You can either set a custom password for the team member or leave it blank to auto-generate a secure temporary password."]})})}),e.jsx(u,{item:!0,xs:12,sm:6,children:e.jsx(L,{fullWidth:!0,label:"Password (Optional)",type:Se?"text":"password",value:d.password,onChange:a=>_(t=>({...t,password:a.target.value})),helperText:"Leave blank to auto-generate a secure password",InputProps:{endAdornment:e.jsx(xe,{position:"end",children:e.jsx(ie,{onClick:()=>ea(!Se),edge:"end","aria-label":"toggle password visibility",children:Se?e.jsx(be,{}):e.jsx(fe,{})})})}})}),e.jsx(u,{item:!0,xs:12,sm:6,children:e.jsx(L,{fullWidth:!0,label:"Confirm Password",type:ye?"text":"password",value:d.confirmPassword,onChange:a=>_(t=>({...t,confirmPassword:a.target.value})),disabled:!d.password,helperText:d.password?"Must match the password above":"Enter a password first",InputProps:{endAdornment:e.jsx(xe,{position:"end",children:e.jsx(ie,{onClick:()=>aa(!ye),edge:"end","aria-label":"toggle confirm password visibility",disabled:!d.password,children:ye?e.jsx(be,{}):e.jsx(fe,{})})})}})}),e.jsx(u,{item:!0,xs:12,children:e.jsx(L,{fullWidth:!0,label:"Welcome Message (Optional)",multiline:!0,rows:3,value:d.message,onChange:a=>_(t=>({...t,message:a.target.value}))})})]})]}),e.jsxs(ve,{children:[e.jsx(U,{onClick:()=>te(!1),children:"Cancel"}),e.jsx(U,{onClick:ra,variant:"contained",disabled:!d.email||!d.firstName||!d.lastName||C.availableSeats<=0,children:"Create Team Member"})]})]}),e.jsxs(pe,{open:Ze,onClose:()=>de(!1),maxWidth:"xs",fullWidth:!0,PaperProps:{sx:{backgroundColor:"background.paper",border:"1px solid rgba(255, 255, 255, 0.1)"}},children:[e.jsx(ge,{children:"Manage Seats"}),e.jsx(he,{children:e.jsxs(u,{container:!0,spacing:2,sx:{mt:.5},children:[e.jsx(u,{item:!0,xs:12,children:e.jsx(ae,{severity:"info",children:k?`${k.tier} subscription`:"No active subscription"})}),e.jsx(u,{item:!0,xs:12,children:e.jsx(L,{fullWidth:!0,type:"number",label:"Total Seats",value:ze,onChange:a=>We(parseInt(a.target.value||"0",10)),inputProps:{min:1,max:(k==null?void 0:k.tier)==="PRO"?50:1e3}})})]})}),e.jsxs(ve,{children:[e.jsx(U,{onClick:()=>de(!1),children:"Cancel"}),e.jsx(U,{onClick:oa,variant:"contained",disabled:!k,children:"Save"})]})]}),e.jsxs(pe,{open:Qe,onClose:()=>{se(!1),Re(null)},maxWidth:"sm",fullWidth:!0,PaperProps:{sx:{backgroundColor:"background.paper",border:"1px solid rgba(255, 255, 255, 0.1)"}},children:[e.jsx(ge,{children:"Edit Member"}),e.jsx(he,{children:e.jsxs(u,{container:!0,spacing:3,sx:{mt:1},children:[e.jsx(u,{item:!0,xs:12,children:e.jsx(L,{fullWidth:!0,label:"Email",value:f.email,onChange:a=>X(t=>({...t,email:a.target.value}))})}),e.jsx(u,{item:!0,xs:12,sm:6,children:e.jsxs(Pe,{fullWidth:!0,children:[e.jsx(Ce,{children:"Role"}),e.jsxs(Te,{value:f.role,label:"Role",onChange:a=>X(t=>({...t,role:a.target.value})),children:[e.jsx(P,{value:"viewer",children:"Viewer"}),e.jsx(P,{value:"member",children:"Member"}),e.jsx(P,{value:"manager",children:"Manager"}),e.jsx(P,{value:"admin",children:"Admin"}),e.jsx(P,{value:"owner",children:"Owner"})]})]})}),e.jsx(u,{item:!0,xs:12,sm:6,children:e.jsxs(Pe,{fullWidth:!0,children:[e.jsx(Ce,{children:"Status"}),e.jsxs(Te,{value:f.status,label:"Status",onChange:a=>X(t=>({...t,status:a.target.value})),children:[e.jsx(P,{value:"pending",children:"Pending"}),e.jsx(P,{value:"active",children:"Active"}),e.jsx(P,{value:"suspended",children:"Suspended"}),e.jsx(P,{value:"removed",children:"Removed"})]})]})}),e.jsx(u,{item:!0,xs:12,children:f.status!=="active"?e.jsx(ae,{severity:"warning",children:"This member has not joined yet (Pending/Suspended/Removed). You can only set a password for Active members."}):e.jsx(ae,{severity:"info",children:"Set a temporary password for this user to log into Backbone. They can change it later."})}),e.jsx(u,{item:!0,xs:12,sm:6,children:e.jsx(L,{fullWidth:!0,label:"New Password",type:Ve?"text":"password",value:f.newPassword,onChange:a=>X(t=>({...t,newPassword:a.target.value})),inputProps:{minLength:8},helperText:"Minimum 8 characters",InputProps:{endAdornment:e.jsx(xe,{position:"end",children:e.jsx(ie,{onClick:()=>Fe(a=>!a),edge:"end","aria-label":"toggle password visibility",children:Ve?e.jsx(be,{}):e.jsx(fe,{})})})}})}),e.jsx(u,{item:!0,xs:12,sm:6,children:e.jsx(L,{fullWidth:!0,label:"Confirm Password",type:$e?"text":"password",value:f.confirmPassword,onChange:a=>X(t=>({...t,confirmPassword:a.target.value})),InputProps:{endAdornment:e.jsx(xe,{position:"end",children:e.jsx(ie,{onClick:()=>Be(a=>!a),edge:"end","aria-label":"toggle password visibility",children:$e?e.jsx(be,{}):e.jsx(fe,{})})})}})})]})}),e.jsxs(ve,{children:[e.jsx(U,{onClick:()=>se(!1),disabled:re,children:"Cancel"}),e.jsx(U,{onClick:ca,variant:"outlined",disabled:re,children:re?"Saving…":"Save Changes"}),e.jsx(U,{onClick:da,variant:"contained",disabled:re||!f.newPassword||!f.confirmPassword||f.status!=="active",children:re?"Saving…":"Save Password Only"})]})]}),e.jsxs(pe,{open:ta,onClose:Ue,maxWidth:"sm",fullWidth:!0,PaperProps:{sx:{backgroundColor:"background.paper",border:"1px solid rgba(255, 255, 255, 0.1)"}},children:[e.jsx(ge,{children:e.jsxs(Y,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(Ae,{color:"error"}),"Remove Team Member"]})}),e.jsxs(he,{children:[e.jsxs(B,{variant:"body1",sx:{mb:2},children:["Are you sure you want to remove ",e.jsx("strong",{children:Z==null?void 0:Z.email})," from your team?"]}),e.jsx(ae,{severity:"warning",sx:{mt:2},children:e.jsx(B,{variant:"body2",children:"This action cannot be undone. The member will lose access to all organization resources and data."})})]}),e.jsxs(ve,{children:[e.jsx(U,{onClick:Ue,color:"inherit",children:"Cancel"}),e.jsx(U,{onClick:ua,color:"error",variant:"contained",startIcon:e.jsx(Ae,{}),children:"Remove Member"})]})]})]})};export{_a as default};
