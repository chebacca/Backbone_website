import{j as e,a as d,T as s,d as M,b3 as se,G as l,k as y,l as S,at as p,o as te,n as A,ax as H,m as ne,H as ie,aC as re,c as le,aD as oe,aE as de,aF as B,aG as n,aH as ce,h as $,b4 as xe,b5 as he,b6 as me,I as ue,aI as ge,b7 as je,az as be,ak as pe,a4 as h,X as C,aL as ve,w as fe,b8 as U,b2 as ye,aN as Se,aO as Ce,aP as Ie,u as k,aS as Me,aT as ke,aU as Ae,aQ as we}from"./mui-DiYnqcGn.js";import{r as c}from"./vendor-DIxetjBo.js";import{b as We,u as Te,d as G,e as V}from"./index-DQte3TP3.js";import{m as g}from"./proxy-B_KpOrcW.js";import"./stripe-CQkQ71Kl.js";const De=o=>{switch(o){case"admin":return"error";case"member":return"primary";case"viewer":return"default";default:return"default"}},Re=o=>{switch(o){case"active":return"success";case"pending":return"warning";case"suspended":return"error";default:return"default"}},Ee=o=>{switch(o){case"active":return e.jsx(A,{});case"pending":return e.jsx(H,{});case"suspended":return e.jsx(U,{});default:return e.jsx(A,{})}},Ve=()=>{const{enqueueSnackbar:o}=We(),{user:m}=Te(),[q,w]=c.useState([]),[r,W]=c.useState({totalMembers:0,activeMembers:0,pendingInvites:0,availableSeats:0,totalSeats:0});c.useEffect(()=>{let a=!0;return(async()=>{var t,N,P,L;try{const z=((N=(t=(await G.get(V.subscriptions.mySubscriptions())).data)==null?void 0:t.data)==null?void 0:N.subscriptions)??[],O=z.reduce((i,f)=>i+(f.seats??0),0),I=z.flatMap(i=>i.licenses??[]).filter(i=>i.status==="ACTIVE").length,ee=Math.max(0,O-I),ae=(((L=(P=(await G.get(V.licenses.myLicenses())).data)==null?void 0:P.data)==null?void 0:L.licenses)??[]).map((i,f)=>{var F;return{id:i.id,firstName:"Seat",lastName:String(f+1),email:`${(m==null?void 0:m.email)??"seat"}+${f+1}`,role:"member",status:i.status==="ACTIVE"?"active":i.status==="PENDING"?"pending":"suspended",joinedAt:new Date(i.createdAt??Date.now()).toISOString().slice(0,10),lastActive:new Date(i.activatedAt??i.updatedAt??Date.now()).toISOString(),licenseAssigned:((F=i.key)==null?void 0:F.slice(0,8))+"-â€¦",department:void 0}});if(!a)return;w(ae),W({totalMembers:I,activeMembers:I,pendingInvites:0,availableSeats:ee,totalSeats:O})}catch{if(!a)return;w([]),W({totalMembers:0,activeMembers:0,pendingInvites:0,availableSeats:0,totalSeats:0})}})(),()=>{a=!1}},[m==null?void 0:m.email]);const[T,D]=c.useState(null),[x,R]=c.useState(null),[Q,j]=c.useState(!1),[Ne,X]=c.useState(!1),[u,b]=c.useState({email:"",role:"member",department:"",message:""}),J=(a,t)=>{D(a.currentTarget),R(t)},v=()=>{D(null),R(null)},K=()=>{o(`Invitation sent to ${u.email}`,{variant:"success"}),j(!1),b({email:"",role:"member",department:"",message:""})},Y=()=>{x&&o(`Invitation resent to ${x.email}`,{variant:"success"}),v()},Z=()=>{x&&o(`${x.firstName} ${x.lastName} removed from team`,{variant:"warning"}),v()},E=c.useMemo(()=>r.totalSeats<=0?0:(r.totalSeats-r.availableSeats)/r.totalSeats*100,[r.totalSeats,r.availableSeats]);return e.jsxs(d,{children:[e.jsx(g.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.6},children:e.jsxs(d,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:4},children:[e.jsxs(d,{children:[e.jsx(s,{variant:"h4",sx:{fontWeight:700,mb:1},children:"Team Management"}),e.jsx(s,{variant:"body1",color:"text.secondary",children:"Manage your team members, roles, and license assignments"})]}),e.jsx(M,{variant:"contained",startIcon:e.jsx(se,{}),onClick:()=>j(!0),sx:{background:"linear-gradient(135deg, #00d4ff 0%, #667eea 100%)",color:"#000",fontWeight:600},children:"Invite Member"})]})}),e.jsxs(l,{container:!0,spacing:3,sx:{mb:4},children:[e.jsx(l,{item:!0,xs:12,sm:6,md:3,children:e.jsx(g.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.1},children:e.jsx(y,{sx:{background:"linear-gradient(135deg, rgba(0, 212, 255, 0.1) 0%, rgba(102, 126, 234, 0.1) 100%)",border:"1px solid rgba(0, 212, 255, 0.2)"},children:e.jsxs(S,{children:[e.jsx(d,{sx:{display:"flex",alignItems:"center",gap:2,mb:2},children:e.jsx(p,{sx:{bgcolor:"primary.main"},children:e.jsx(te,{})})}),e.jsx(s,{variant:"h3",sx:{fontWeight:700,color:"primary.main"},children:r.totalMembers}),e.jsx(s,{variant:"body2",color:"text.secondary",children:"Total Members"})]})})})}),e.jsx(l,{item:!0,xs:12,sm:6,md:3,children:e.jsx(g.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.2},children:e.jsx(y,{sx:{background:"linear-gradient(135deg, rgba(76, 175, 80, 0.1) 0%, rgba(76, 175, 80, 0.05) 100%)",border:"1px solid rgba(76, 175, 80, 0.2)"},children:e.jsxs(S,{children:[e.jsx(d,{sx:{display:"flex",alignItems:"center",gap:2,mb:2},children:e.jsx(p,{sx:{bgcolor:"success.main"},children:e.jsx(A,{})})}),e.jsx(s,{variant:"h3",sx:{fontWeight:700,color:"success.main"},children:r.activeMembers}),e.jsx(s,{variant:"body2",color:"text.secondary",children:"Active Members"})]})})})}),e.jsx(l,{item:!0,xs:12,sm:6,md:3,children:e.jsx(g.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.3},children:e.jsx(y,{sx:{background:"linear-gradient(135deg, rgba(255, 152, 0, 0.1) 0%, rgba(255, 152, 0, 0.05) 100%)",border:"1px solid rgba(255, 152, 0, 0.2)"},children:e.jsxs(S,{children:[e.jsx(d,{sx:{display:"flex",alignItems:"center",gap:2,mb:2},children:e.jsx(p,{sx:{bgcolor:"warning.main"},children:e.jsx(H,{})})}),e.jsx(s,{variant:"h3",sx:{fontWeight:700,color:"warning.main"},children:r.pendingInvites}),e.jsx(s,{variant:"body2",color:"text.secondary",children:"Pending Invites"})]})})})}),e.jsx(l,{item:!0,xs:12,sm:6,md:3,children:e.jsx(g.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.4},children:e.jsx(y,{sx:{background:"linear-gradient(135deg, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0.05) 100%)",border:"1px solid rgba(255,255,255,0.1)"},children:e.jsxs(S,{children:[e.jsx(d,{sx:{display:"flex",alignItems:"center",gap:2,mb:2},children:e.jsx(p,{sx:{bgcolor:"secondary.main"},children:e.jsx(ne,{})})}),e.jsx(s,{variant:"h3",sx:{fontWeight:700},children:r.availableSeats}),e.jsx(s,{variant:"body2",color:"text.secondary",children:"Available Seats"}),e.jsx(ie,{variant:"determinate",value:E,sx:{mt:1,height:4,borderRadius:2,backgroundColor:"rgba(255,255,255,0.1)","& .MuiLinearProgress-bar":{borderRadius:2,background:E>80?"linear-gradient(90deg, #ff9800 0%, #f44336 100%)":"linear-gradient(90deg, #00d4ff 0%, #667eea 100%)"}}})]})})})})]}),e.jsx(g.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.5},children:e.jsx(re,{component:le,sx:{background:"linear-gradient(135deg, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0.05) 100%)",backdropFilter:"blur(20px)",border:"1px solid rgba(255,255,255,0.1)"},children:e.jsxs(oe,{children:[e.jsx(de,{children:e.jsxs(B,{children:[e.jsx(n,{sx:{fontWeight:600},children:"Member"}),e.jsx(n,{sx:{fontWeight:600},children:"Role"}),e.jsx(n,{sx:{fontWeight:600},children:"Department"}),e.jsx(n,{sx:{fontWeight:600},children:"Status"}),e.jsx(n,{sx:{fontWeight:600},children:"License"}),e.jsx(n,{sx:{fontWeight:600},children:"Last Active"}),e.jsx(n,{sx:{fontWeight:600},children:"Actions"})]})}),e.jsx(ce,{children:q.map(a=>e.jsxs(B,{hover:!0,children:[e.jsx(n,{children:e.jsxs(d,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsxs(p,{sx:{width:40,height:40},children:[a.firstName[0],a.lastName[0]]}),e.jsxs(d,{children:[e.jsxs(s,{variant:"body2",sx:{fontWeight:500},children:[a.firstName," ",a.lastName]}),e.jsx(s,{variant:"caption",color:"text.secondary",children:a.email})]})]})}),e.jsx(n,{children:e.jsx($,{icon:a.role==="admin"?e.jsx(xe,{}):e.jsx(he,{}),label:a.role.toUpperCase(),color:De(a.role),size:"small",variant:"outlined"})}),e.jsx(n,{children:e.jsx(s,{variant:"body2",children:a.department||"Not assigned"})}),e.jsx(n,{children:e.jsx($,{icon:Ee(a.status),label:a.status.toUpperCase(),color:Re(a.status),size:"small"})}),e.jsx(n,{children:a.licenseAssigned?e.jsx(me,{title:a.licenseAssigned,children:e.jsx(s,{variant:"body2",sx:{fontFamily:"monospace",maxWidth:120,overflow:"hidden",textOverflow:"ellipsis"},children:a.licenseAssigned})}):e.jsx(s,{variant:"body2",color:"text.secondary",children:"No license"})}),e.jsx(n,{children:e.jsx(s,{variant:"body2",children:a.lastActive?new Date(a.lastActive).toLocaleDateString():"Never"})}),e.jsx(n,{children:e.jsx(ue,{onClick:t=>J(t,a),size:"small",children:e.jsx(ge,{})})})]},a.id))})]})})}),e.jsx(je,{color:"primary",sx:{position:"fixed",bottom:24,right:24,background:"linear-gradient(135deg, #00d4ff 0%, #667eea 100%)",color:"#000"},onClick:()=>j(!0),children:e.jsx(be,{})}),e.jsxs(pe,{anchorEl:T,open:!!T,onClose:v,PaperProps:{sx:{backgroundColor:"background.paper",border:"1px solid rgba(255, 255, 255, 0.1)"}},children:[e.jsxs(h,{onClick:()=>X(!0),children:[e.jsx(C,{children:e.jsx(ve,{fontSize:"small"})}),"Edit Member"]}),(x==null?void 0:x.status)==="pending"&&e.jsxs(h,{onClick:Y,children:[e.jsx(C,{children:e.jsx(fe,{fontSize:"small"})}),"Resend Invite"]}),e.jsxs(h,{onClick:v,children:[e.jsx(C,{children:e.jsx(U,{fontSize:"small"})}),"Suspend Member"]}),e.jsxs(h,{onClick:Z,sx:{color:"error.main"},children:[e.jsx(C,{children:e.jsx(ye,{fontSize:"small",sx:{color:"error.main"}})}),"Remove Member"]})]}),e.jsxs(Se,{open:Q,onClose:()=>j(!1),maxWidth:"sm",fullWidth:!0,PaperProps:{sx:{backgroundColor:"background.paper",border:"1px solid rgba(255, 255, 255, 0.1)"}},children:[e.jsx(Ce,{children:"Invite Team Member"}),e.jsx(Ie,{children:e.jsxs(l,{container:!0,spacing:3,sx:{mt:1},children:[e.jsx(l,{item:!0,xs:12,children:e.jsx(k,{fullWidth:!0,label:"Email Address",type:"email",value:u.email,onChange:a=>b(t=>({...t,email:a.target.value}))})}),e.jsx(l,{item:!0,xs:12,sm:6,children:e.jsxs(Me,{fullWidth:!0,children:[e.jsx(ke,{children:"Role"}),e.jsxs(Ae,{value:u.role,label:"Role",onChange:a=>b(t=>({...t,role:a.target.value})),inputProps:{"aria-label":"Select team member role",title:"Select the role for this team member"},children:[e.jsx(h,{value:"viewer",children:"Viewer"}),e.jsx(h,{value:"member",children:"Member"}),e.jsx(h,{value:"admin",children:"Admin"})]})]})}),e.jsx(l,{item:!0,xs:12,sm:6,children:e.jsx(k,{fullWidth:!0,label:"Department",value:u.department,onChange:a=>b(t=>({...t,department:a.target.value}))})}),e.jsx(l,{item:!0,xs:12,children:e.jsx(k,{fullWidth:!0,label:"Welcome Message (Optional)",multiline:!0,rows:3,value:u.message,onChange:a=>b(t=>({...t,message:a.target.value}))})})]})}),e.jsxs(we,{children:[e.jsx(M,{onClick:()=>j(!1),children:"Cancel"}),e.jsx(M,{onClick:K,variant:"contained",disabled:!u.email,children:"Send Invitation"})]})]})]})};export{Ve as default};
//# sourceMappingURL=TeamPage-DHqNKJk9.js.map
