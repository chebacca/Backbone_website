import{j as e,B as t,C as Ee,T as a,d as j,ai as Q,w as Is,x as Re,y as N,aj as Ts,z as Fe,H as X,a as x,aG as ee,G as D,W as de,p as ce,am as xe,u as U,t as Ls,v as As,aq as Ws,ar as Ss,as as Ns,at as ze,au as h,av as Ds,ag as Ms,r as se,aZ as ks,g as $e,aw as Es,ax as Rs,ap as Fs,ay as ae,az as te,aB as ne,a_ as Oe,e as d,I as p,a$ as qe,b0 as Be,aC as Ge,aD as Ue,aE as He,a5 as g,F as Je,s as Ve,R as zs,aF as re,aI as ie,aL as $s,b1 as Ye,L as le,b2 as _e,aH as he,a4 as Os,E as qs,D as Bs,aJ as Gs}from"./mui-Cr9U6iW2.js";import{r as o,b as Ke}from"./vendor-CjD1bmmO.js";import{u as Us}from"./notistack.esm-Ca-E78ev.js";import{b as Hs,c as Js,a as Vs,u as Ys,h as _s,j as Ks,k as Zs,l as Qs,f as Xs,g as ea}from"./useStreamlinedData-zQO2Le6S.js";import{M as H}from"./MetricCard-CCtxyf7i.js";import"./UnifiedDataService-CFWaoCP4.js";import"./index-BMA_Mf41.js";import"./stripe-ggaMUove.js";import"./index.esm-B4qVkIPL.js";import"./index.esm-DmQE6AXN.js";const sa=r=>{switch(r){case"owner":return"error";case"admin":return"primary";case"manager":return"secondary";case"member":return"info";case"viewer":return"default";default:return"default"}},aa=r=>{switch(r){case"active":return"success";case"pending":return"warning";case"suspended":return"error";case"removed":return"default";default:return"default"}},Ze=r=>{switch(r){case"active":return e.jsx(ce,{});case"pending":return e.jsx(xe,{});case"suspended":return e.jsx(Gs,{});case"removed":return e.jsx(he,{});default:return e.jsx(de,{})}},J=()=>{const l="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789!@#$%^&*";let w="";for(let M=0;M<12;M++)w+=l.charAt(Math.floor(Math.random()*l.length));return w},oe=(r,l)=>!r||!l?!1:r.role==="owner"||r.role==="admin"&&l.role!=="owner"||r.id===l.id,ta=(r,l)=>!r.assignedProjects||!l?[]:l.filter(w=>r.assignedProjects.includes(w.id)),ua=()=>{var Me,ke;const{enqueueSnackbar:r}=Us(),{data:l,loading:w,error:M}=Hs(),{data:k,loading:Qe,error:Xe}=Js(),{data:P,loading:es,error:ss,refetch:E}=Vs(),{data:v,loading:as,error:ts,refetch:V}=Ys(),{data:ns,loading:rs,error:is}=_s(),ls=Ks(),os=Zs();Qs();const ds=Xs();ea();const[cs,T]=o.useState(!1),[xs,R]=o.useState(!1),[hs,F]=o.useState(!1),[Y,me]=o.useState(""),[L,ue]=o.useState(""),[A,ge]=o.useState(""),[je,pe]=o.useState("member"),[ve,be]=o.useState(""),[fe,ye]=o.useState(""),[we,Pe]=o.useState(""),[_,z]=o.useState(""),[C,ms]=o.useState(!0),[n,W]=o.useState(void 0),[Ce,Ie]=o.useState(null),[K,Te]=o.useState(""),[Z,Le]=o.useState(""),[Ae,We]=o.useState("member"),[Se,Ne]=o.useState(""),[us,$]=o.useState(!1),[O,q]=o.useState(""),[I,B]=o.useState(""),[f,De]=o.useState(!0),gs=w||Qe||es||as||rs,js=M||Xe||ss||ts||is;Ke.useEffect(()=>{C&&z(J())},[C]),Ke.useEffect(()=>{const s=async()=>{console.log("ðŸ”„ [TeamPage] License refresh event detected, refetching data..."),await Promise.all([V(),E()])};return window.addEventListener("licenses:refresh",s),()=>{window.removeEventListener("licenses:refresh",s)}},[V,E]);const c=o.useMemo(()=>{if(!l||!k||!P||!v)return{members:[],stats:{totalMembers:0,activeMembers:0,pendingInvites:0,availableLicenses:0,totalLicenses:0,assignedLicenses:0}};const s=P.filter(m=>m.status==="active").length,i=P.filter(m=>m.status==="pending").length,b=v.length,u=v.filter(m=>m.assignedTo).length,y=v.filter(m=>m.status==="PENDING"&&!m.assignedTo).length;console.log("ðŸ“Š [TeamPage] License stats:",{totalLicenses:b,assignedLicenses:u,availableLicenses:y});const S={totalMembers:P.length,activeMembers:s,pendingInvites:i,availableLicenses:y,totalLicenses:b,assignedLicenses:u};return{members:P,stats:S}},[l,k,P,v]),ps=(s,i)=>{console.log("ðŸ”§ [TeamPage] Menu clicked for member:",i),W(i),Ie(s.currentTarget)},G=()=>{Ie(null)},vs=async()=>{var s,i,b;if(!Y.trim()){r("Please enter an email address",{variant:"error"});return}if(!L.trim()){r("Please enter a first name",{variant:"error"});return}if(!A.trim()){r("Please enter a last name",{variant:"error"});return}if(!_.trim()){r("Please provide a temporary password",{variant:"error"});return}if(c.stats.availableLicenses<=0){r("No available licenses. Please generate more licenses first.",{variant:"error"});return}try{console.log("ðŸ‘¤ [TeamPage] Creating full user with Firebase authentication...");const u={firstName:L.trim(),lastName:A.trim(),email:Y.trim().toLowerCase(),role:je,status:"pending",organization:{id:((s=l==null?void 0:l.organization)==null?void 0:s.id)||"",name:((i=l==null?void 0:l.organization)==null?void 0:i.name)||"",tier:((b=l==null?void 0:l.organization)==null?void 0:b.tier)||"BASIC"},department:ve.trim()||void 0,assignedProjects:[],avatar:`https://ui-avatars.com/api/?name=${encodeURIComponent(L+" "+A)}&background=667eea&color=fff`},y=await ls.mutate({...u,temporaryPassword:_,position:fe.trim()||void 0,phone:we.trim()||void 0});console.log("âœ… [TeamPage] Team member created with ID:",y);const S=v==null?void 0:v.find(m=>m.status==="PENDING"&&!m.assignedTo);if(S&&y)try{await ds.mutate({licenseId:S.id,userId:y}),console.log("âœ… [TeamPage] Auto-assigned license",S.id,"to new member",y)}catch(m){console.warn("âš ï¸ [TeamPage] Failed to auto-assign license:",m)}r(`Team member ${L} ${A} created successfully with license assigned. They can now login with their email and temporary password.`,{variant:"success"}),me(""),ue(""),ge(""),pe("member"),be(""),ye(""),Pe(""),z(J()),T(!1),await Promise.all([E(),V()])}catch(u){console.error("âŒ [TeamPage] Failed to create team member:",u),r((u==null?void 0:u.message)||"Failed to create team member",{variant:"error"})}},bs=s=>{const i=s||n;if(!i){console.error("ðŸ”§ [TeamPage] No member provided for editing"),r("Unable to load member data. Please try again.",{variant:"error"});return}console.log("ðŸ”§ [TeamPage] Opening edit dialog for member:",i),G(),W(i),Te(i.firstName||""),Le(i.lastName||""),We(i.role||"member"),Ne(i.department||""),$(!1),q(""),B(""),De(!0),R(!0)},fs=async()=>{if(!n){r("No team member selected",{variant:"error"});return}if(!oe(l,n)){r("You do not have permission to change this password",{variant:"error"});return}const s=f?J():O;if(!f){if(!s.trim()){r("Please enter a new password",{variant:"error"});return}if(s!==I){r("Passwords do not match",{variant:"error"});return}if(s.length<8){r("Password must be at least 8 characters long",{variant:"error"});return}}try{console.log("ðŸ” [TeamPage] Password change requested for member:",n.email),r(`Password ${f?"generated and ":""}updated successfully for ${n.firstName} ${n.lastName}`,{variant:"success"}),$(!1),q(""),B("")}catch(i){console.error("âŒ [TeamPage] Failed to update password:",i),r((i==null?void 0:i.message)||"Failed to update password",{variant:"error"})}},ys=()=>{n&&(G(),F(!0))},ws=async()=>{if(n)try{r(`${n.firstName} ${n.lastName} has been removed from the team`,{variant:"success"}),F(!1),W(void 0)}catch(s){r((s==null?void 0:s.message)||"Failed to remove team member",{variant:"error"})}},Ps=()=>{n&&(r(`Invitation resent to ${n.email}`,{variant:"success"}),G())},Cs=async()=>{if(n)try{await os.mutate({memberId:n.id,updates:{firstName:K,lastName:Z,role:Ae,department:Se}}),r(`Team member ${K} ${Z} updated successfully`,{variant:"success"}),R(!1),W(void 0),E()}catch(s){r((s==null?void 0:s.message)||"Failed to update team member",{variant:"error"})}};return gs?e.jsx(t,{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"400px",children:e.jsxs(t,{textAlign:"center",children:[e.jsx(Ee,{size:60}),e.jsx(a,{variant:"h6",sx:{mt:2},children:"Loading Team Data..."}),e.jsx(a,{variant:"body2",color:"text.secondary",children:"Fetching your team members and organization details"})]})}):js?e.jsx(t,{sx:{p:3},children:e.jsxs(j,{severity:"error",children:[e.jsx(Q,{children:"Unable to Load Team Data"}),e.jsx(a,{variant:"body2",sx:{mb:2},children:"We encountered an issue loading your team information. This could be due to:"}),e.jsxs(Is,{dense:!0,children:[e.jsxs(Re,{children:[e.jsx(N,{children:e.jsx(Ts,{fontSize:"small"})}),e.jsx(Fe,{primary:"Network connectivity issues"})]}),e.jsxs(Re,{children:[e.jsx(N,{children:e.jsx(X,{fontSize:"small"})}),e.jsx(Fe,{primary:"Authentication token expired"})]})]}),e.jsx(t,{sx:{mt:2},children:e.jsx(x,{variant:"contained",onClick:()=>window.location.reload(),children:"Retry"})})]})}):!l||!k?e.jsx(t,{sx:{p:3},children:e.jsxs(j,{severity:"info",children:[e.jsx(Q,{children:"Setting Up Team Management"}),e.jsx(a,{variant:"body2",children:"We're preparing your team management dashboard. This may take a moment for new accounts."})]})}):e.jsxs(t,{children:[e.jsxs(t,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:4},children:[e.jsxs(t,{children:[e.jsx(a,{variant:"h4",sx:{fontWeight:700,mb:1},children:"Team Management"}),e.jsxs(a,{variant:"body1",color:"text.secondary",children:["Manage your ",((Me=k.organization)==null?void 0:Me.name)||"Organization"," team members and permissions"]})]}),e.jsx(x,{variant:"contained",startIcon:e.jsx(ee,{}),onClick:()=>T(!0),disabled:c.stats.availableLicenses<=0,sx:{background:"linear-gradient(135deg, #00d4ff 0%, #667eea 100%)",color:"#000",fontWeight:600},children:"Invite Member"})]}),e.jsxs(D,{container:!0,spacing:3,sx:{mb:4},children:[e.jsx(D,{item:!0,xs:12,sm:6,md:3,children:e.jsx(H,{title:"Total Members",value:c.stats.totalMembers,icon:e.jsx(de,{}),color:"primary"})}),e.jsx(D,{item:!0,xs:12,sm:6,md:3,children:e.jsx(H,{title:"Active Members",value:c.stats.activeMembers,icon:e.jsx(ce,{}),color:"success"})}),e.jsx(D,{item:!0,xs:12,sm:6,md:3,children:e.jsx(H,{title:"Pending Invites",value:c.stats.pendingInvites,icon:e.jsx(xe,{}),color:"warning"})}),e.jsx(D,{item:!0,xs:12,sm:6,md:3,children:e.jsx(H,{title:"Available Licenses",value:`${c.stats.availableLicenses}/${c.stats.totalLicenses}`,icon:e.jsx(U,{}),color:"primary"})})]}),c.stats.availableLicenses<=0&&e.jsxs(j,{severity:"warning",sx:{mb:4},children:[e.jsx(Q,{children:"No Available Licenses"}),e.jsx(a,{variant:"body2",sx:{mb:2},children:"You need to generate more licenses to invite new team members. Go to the Licenses page to create additional licenses."}),e.jsxs(t,{sx:{display:"flex",gap:2},children:[e.jsx(x,{variant:"contained",size:"small",onClick:()=>window.open("/dashboard/licenses","_blank"),children:"Generate Licenses"}),e.jsx(x,{variant:"outlined",size:"small",onClick:()=>window.open("/dashboard/billing","_blank"),children:"Upgrade Plan"})]})]}),e.jsx(Ls,{children:e.jsxs(As,{children:[e.jsxs(t,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:[e.jsxs(a,{variant:"h6",sx:{fontWeight:600},children:["Team Members (",c.members.length,")"]}),e.jsx(x,{variant:"outlined",startIcon:e.jsx(U,{}),onClick:()=>window.open("/dashboard/licenses","_blank"),children:"Manage Licenses"})]}),e.jsx(Ws,{children:e.jsxs(Ss,{children:[e.jsx(Ns,{children:e.jsxs(ze,{children:[e.jsx(h,{sx:{fontWeight:600},children:"Member"}),e.jsx(h,{sx:{fontWeight:600},children:"Role"}),e.jsx(h,{sx:{fontWeight:600},children:"Status"}),e.jsx(h,{sx:{fontWeight:600},children:"Department"}),e.jsx(h,{sx:{fontWeight:600},children:"License"}),e.jsx(h,{sx:{fontWeight:600},children:"Last Active"}),e.jsx(h,{sx:{fontWeight:600},children:"Actions"})]})}),e.jsx(Ds,{children:c.members.map(s=>{var i,b;return e.jsxs(ze,{hover:!0,children:[e.jsx(h,{children:e.jsxs(t,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsxs(Ms,{src:s.avatar,sx:{width:40,height:40},children:[s.firstName.charAt(0),s.lastName.charAt(0)]}),e.jsxs(t,{children:[e.jsxs(a,{variant:"body1",sx:{fontWeight:500},children:[s.firstName," ",s.lastName]}),e.jsx(a,{variant:"body2",color:"text.secondary",children:s.email})]})]})}),e.jsx(h,{children:e.jsx(se,{label:s.role.toUpperCase(),color:sa(s.role),size:"small",icon:s.role==="admin"?e.jsx(ks,{}):void 0})}),e.jsx(h,{children:e.jsx(se,{icon:Ze(s.status),label:s.status.toUpperCase(),color:aa(s.status),size:"small"})}),e.jsx(h,{children:e.jsx(a,{variant:"body2",children:s.department||"Unassigned"})}),e.jsx(h,{children:e.jsxs(t,{children:[e.jsx(a,{variant:"body2",sx:{fontWeight:500},children:((i=s.licenseAssignment)==null?void 0:i.licenseType)||"None"}),((b=s.licenseAssignment)==null?void 0:b.licenseKey)&&e.jsxs(a,{variant:"caption",color:"text.secondary",sx:{fontFamily:"monospace"},children:[s.licenseAssignment.licenseKey.substring(0,12),"..."]})]})}),e.jsx(h,{children:e.jsx(a,{variant:"body2",color:"text.secondary",children:s.lastActive?new Date(s.lastActive).toLocaleDateString():"Never"})}),e.jsx(h,{children:e.jsx($e,{size:"small",onClick:u=>ps(u,s),disabled:s.role==="owner"&&s.id===l.id,children:e.jsx(Es,{})})})]},s.id)})})]})})]})}),e.jsx(Rs,{color:"primary",sx:{position:"fixed",bottom:16,right:16,display:{xs:"flex",md:"none"}},onClick:()=>T(!0),disabled:c.stats.availableLicenses<=0,children:e.jsx(Fs,{})}),e.jsxs(ae,{open:cs,onClose:()=>T(!1),maxWidth:"md",fullWidth:!0,children:[e.jsx(te,{children:e.jsxs(t,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsx(ee,{}),"Create New Team Member"]})}),e.jsx(ne,{children:e.jsxs(t,{sx:{display:"flex",flexDirection:"column",gap:3,mt:2},children:[e.jsxs(t,{children:[e.jsxs(a,{variant:"h6",sx:{mb:2,display:"flex",alignItems:"center",gap:1},children:[e.jsx(Oe,{})," Personal Information"]}),e.jsxs(t,{sx:{display:"flex",gap:2,mb:2},children:[e.jsx(d,{fullWidth:!0,label:"First Name",value:L,onChange:s=>ue(s.target.value),placeholder:"John",required:!0}),e.jsx(d,{fullWidth:!0,label:"Last Name",value:A,onChange:s=>ge(s.target.value),placeholder:"Doe",required:!0})]}),e.jsx(d,{fullWidth:!0,label:"Email Address",type:"email",value:Y,onChange:s=>me(s.target.value),placeholder:"john.doe@company.com",required:!0,sx:{mb:2}}),e.jsx(d,{fullWidth:!0,label:"Phone Number (Optional)",value:we,onChange:s=>Pe(s.target.value),placeholder:"+1 (555) 123-4567",InputProps:{startAdornment:e.jsx(p,{position:"start",children:e.jsx(qe,{})})}})]}),e.jsxs(t,{children:[e.jsxs(a,{variant:"h6",sx:{mb:2,display:"flex",alignItems:"center",gap:1},children:[e.jsx(Be,{})," Role & Department"]}),e.jsxs(t,{sx:{display:"flex",gap:2,mb:2},children:[e.jsxs(Ge,{fullWidth:!0,children:[e.jsx(Ue,{children:"Role"}),e.jsxs(He,{value:je,label:"Role",onChange:s=>pe(s.target.value),children:[e.jsx(g,{value:"viewer",children:e.jsxs(t,{children:[e.jsx(a,{variant:"body2",sx:{fontWeight:500},children:"Viewer"}),e.jsx(a,{variant:"caption",color:"text.secondary",children:"Read-only access to projects"})]})}),e.jsx(g,{value:"member",children:e.jsxs(t,{children:[e.jsx(a,{variant:"body2",sx:{fontWeight:500},children:"Member"}),e.jsx(a,{variant:"caption",color:"text.secondary",children:"Standard project access"})]})}),e.jsx(g,{value:"manager",children:e.jsxs(t,{children:[e.jsx(a,{variant:"body2",sx:{fontWeight:500},children:"Manager"}),e.jsx(a,{variant:"caption",color:"text.secondary",children:"Team management capabilities"})]})}),e.jsx(g,{value:"admin",children:e.jsxs(t,{children:[e.jsx(a,{variant:"body2",sx:{fontWeight:500},children:"Admin"}),e.jsx(a,{variant:"caption",color:"text.secondary",children:"Full organizational access"})]})})]})]}),e.jsx(d,{fullWidth:!0,label:"Department",value:ve,onChange:s=>be(s.target.value),placeholder:"Engineering, Design, Marketing..."})]}),e.jsx(d,{fullWidth:!0,label:"Position/Title (Optional)",value:fe,onChange:s=>ye(s.target.value),placeholder:"Senior Developer, Product Manager..."})]}),e.jsxs(t,{children:[e.jsxs(a,{variant:"h6",sx:{mb:2,display:"flex",alignItems:"center",gap:1},children:[e.jsx(X,{})," Authentication"]}),e.jsx(Je,{control:e.jsx(Ve,{checked:C,onChange:s=>ms(s.target.checked)}),label:"Auto-generate secure password",sx:{mb:2}}),e.jsx(d,{fullWidth:!0,label:"Temporary Password",type:"password",value:_,onChange:s=>z(s.target.value),disabled:C,required:!0,InputProps:{endAdornment:e.jsx(p,{position:"end",children:e.jsx($e,{onClick:()=>z(J()),disabled:!C,children:e.jsx(zs,{})})})},helperText:C?"Password will be auto-generated":"User will need this password to login initially"})]}),e.jsxs(j,{severity:"info",children:[e.jsx(a,{variant:"body2",sx:{fontWeight:500,mb:1},children:"ðŸŽ« License Assignment"}),e.jsx(a,{variant:"body2",children:"This team member will be created as a full Firebase authenticated user and automatically assigned an available license. They can login immediately with their email and temporary password."}),e.jsxs(a,{variant:"body2",sx:{mt:1,fontWeight:500},children:["Available licenses: ",c.stats.availableLicenses," of ",c.stats.totalLicenses]})]}),c.stats.availableLicenses<=0&&e.jsx(j,{severity:"warning",children:e.jsx(a,{variant:"body2",children:"No licenses available! Please generate more licenses before creating team members."})})]})}),e.jsxs(re,{children:[e.jsx(x,{onClick:()=>T(!1),children:"Cancel"}),e.jsx(x,{onClick:vs,variant:"contained",startIcon:e.jsx(ee,{}),disabled:c.stats.availableLicenses<=0,children:"Create Team Member"})]})]}),e.jsxs(ae,{open:xs,onClose:()=>{R(!1),W(void 0)},maxWidth:"md",fullWidth:!0,children:[e.jsx(te,{children:e.jsxs(t,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsx(ie,{}),"ðŸš€ ENHANCED Edit Team Member: ",(n==null?void 0:n.firstName)||"Loading..."," ",(n==null?void 0:n.lastName)||""]})}),e.jsx(ne,{children:n?e.jsxs(t,{sx:{display:"flex",flexDirection:"column",gap:3,mt:2},children:[e.jsxs(t,{children:[e.jsxs(a,{variant:"h6",sx:{mb:2,display:"flex",alignItems:"center",gap:1},children:[e.jsx(Oe,{})," Personal Information"]}),e.jsxs(t,{sx:{display:"flex",gap:2,mb:2},children:[e.jsx(d,{fullWidth:!0,label:"First Name",value:K,onChange:s=>Te(s.target.value),required:!0,placeholder:"John"}),e.jsx(d,{fullWidth:!0,label:"Last Name",value:Z,onChange:s=>Le(s.target.value),required:!0,placeholder:"Doe"})]}),e.jsx(d,{fullWidth:!0,label:"Email Address",type:"email",value:n.email,disabled:!0,sx:{mb:2},helperText:"Email cannot be changed after account creation"}),e.jsx(d,{fullWidth:!0,label:"Phone Number",value:"",disabled:!0,placeholder:"+1 (555) 123-4567",InputProps:{startAdornment:e.jsx(p,{position:"start",children:e.jsx(qe,{})})},helperText:"Phone number not available in current data model"})]}),e.jsxs(t,{children:[e.jsxs(a,{variant:"h6",sx:{mb:2,display:"flex",alignItems:"center",gap:1},children:[e.jsx(Be,{})," Role & Department"]}),e.jsxs(t,{sx:{display:"flex",gap:2,mb:2},children:[e.jsxs(Ge,{fullWidth:!0,children:[e.jsx(Ue,{children:"Role"}),e.jsxs(He,{value:Ae,label:"Role",onChange:s=>We(s.target.value),children:[e.jsx(g,{value:"viewer",children:e.jsxs(t,{children:[e.jsx(a,{variant:"body2",sx:{fontWeight:500},children:"Viewer"}),e.jsx(a,{variant:"caption",color:"text.secondary",children:"Read-only access to projects"})]})}),e.jsx(g,{value:"member",children:e.jsxs(t,{children:[e.jsx(a,{variant:"body2",sx:{fontWeight:500},children:"Member"}),e.jsx(a,{variant:"caption",color:"text.secondary",children:"Standard project access"})]})}),e.jsx(g,{value:"manager",children:e.jsxs(t,{children:[e.jsx(a,{variant:"body2",sx:{fontWeight:500},children:"Manager"}),e.jsx(a,{variant:"caption",color:"text.secondary",children:"Team management capabilities"})]})}),e.jsx(g,{value:"admin",children:e.jsxs(t,{children:[e.jsx(a,{variant:"body2",sx:{fontWeight:500},children:"Admin"}),e.jsx(a,{variant:"caption",color:"text.secondary",children:"Full organizational access"})]})})]})]}),e.jsx(d,{fullWidth:!0,label:"Department",value:Se,onChange:s=>Ne(s.target.value),placeholder:"Engineering, Design, Marketing..."})]}),e.jsx(d,{fullWidth:!0,label:"Position/Title",value:"",disabled:!0,placeholder:"Senior Developer, Product Manager...",helperText:"Position not available in current data model"})]}),e.jsxs(t,{children:[e.jsxs(a,{variant:"h6",sx:{mb:2,display:"flex",alignItems:"center",gap:1},children:[e.jsx(U,{})," License & Access"]}),e.jsxs(t,{sx:{display:"flex",gap:2,mb:2},children:[e.jsx(d,{fullWidth:!0,label:"License Type",value:((ke=n.licenseAssignment)==null?void 0:ke.licenseType)||"None",disabled:!0,InputProps:{startAdornment:e.jsx(p,{position:"start",children:e.jsx(U,{})})}}),e.jsx(d,{fullWidth:!0,label:"License Status",value:n.licenseAssignment?"Assigned":"Unassigned",disabled:!0,InputProps:{startAdornment:e.jsx(p,{position:"start",children:n.licenseAssignment?e.jsx(ce,{}):e.jsx(xe,{})})}})]}),e.jsx(d,{fullWidth:!0,label:"Last Active",value:n.lastActive?new Date(n.lastActive).toLocaleString():"Never",disabled:!0,InputProps:{startAdornment:e.jsx(p,{position:"start",children:e.jsx($s,{})})}})]}),e.jsxs(t,{children:[e.jsxs(a,{variant:"h6",sx:{mb:2,display:"flex",alignItems:"center",gap:1},children:[e.jsx(Ye,{})," Project Assignments"]}),(()=>{const s=ta(n,ns||[]);return s.length>0?e.jsxs(t,{sx:{display:"flex",flexDirection:"column",gap:2},children:[e.jsx(t,{sx:{display:"flex",flexWrap:"wrap",gap:1},children:s.map(i=>e.jsx(se,{label:i.name,color:"primary",variant:"outlined",size:"small",icon:e.jsx(Ye,{}),sx:{maxWidth:200}},i.id))}),e.jsxs(t,{children:[e.jsx(a,{variant:"body2",color:"text.secondary",sx:{mb:1},children:e.jsx("strong",{children:"Project Details:"})}),s.map(i=>e.jsxs(t,{sx:{mb:1,p:2,bgcolor:"background.paper",borderRadius:1,border:"1px solid",borderColor:"divider"},children:[e.jsx(a,{variant:"body2",sx:{fontWeight:500},children:i.name}),e.jsxs(a,{variant:"caption",color:"text.secondary",children:["Mode: ",i.mode," â€¢ Storage: ",i.storageBackend," â€¢ Status: ",i.status]}),i.description&&e.jsx(a,{variant:"body2",color:"text.secondary",sx:{mt:.5},children:i.description})]},i.id))]})]}):e.jsx(j,{severity:"info",children:e.jsx(a,{variant:"body2",children:"No projects assigned yet. This team member can be assigned to projects from the Cloud Projects page."})})})()]}),e.jsxs(t,{children:[e.jsxs(a,{variant:"h6",sx:{mb:2,display:"flex",alignItems:"center",gap:1},children:[e.jsx(X,{})," Account Status"]}),e.jsxs(t,{sx:{display:"flex",gap:2,mb:2},children:[e.jsx(d,{fullWidth:!0,label:"Account Status",value:n.status,disabled:!0,InputProps:{startAdornment:e.jsx(p,{position:"start",children:Ze(n.status)})}}),e.jsx(d,{fullWidth:!0,label:"Member Since",value:n.joinedAt?new Date(n.joinedAt).toLocaleDateString():"Unknown",disabled:!0,InputProps:{startAdornment:e.jsx(p,{position:"start",children:e.jsx(de,{})})}})]})]}),oe(l,n)&&e.jsxs(t,{children:[e.jsxs(a,{variant:"h6",sx:{mb:2,display:"flex",alignItems:"center",gap:1},children:[e.jsx(le,{})," Password Management"]}),us?e.jsxs(t,{sx:{display:"flex",flexDirection:"column",gap:2},children:[e.jsxs(j,{severity:"warning",children:[e.jsx(a,{variant:"body2",sx:{fontWeight:500,mb:1},children:"ðŸ” Password Change"}),e.jsx(a,{variant:"body2",children:f?"A secure password will be automatically generated.":"Please enter a new password with at least 8 characters."})]}),e.jsx(Je,{control:e.jsx(Ve,{checked:f,onChange:s=>De(s.target.checked)}),label:"Auto-generate secure password"}),!f&&e.jsxs(t,{sx:{display:"flex",flexDirection:"column",gap:2},children:[e.jsx(d,{fullWidth:!0,label:"New Password",type:"password",value:O,onChange:s=>q(s.target.value),placeholder:"Enter new password (min 8 characters)",required:!0,InputProps:{startAdornment:e.jsx(p,{position:"start",children:e.jsx(le,{})})}}),e.jsx(d,{fullWidth:!0,label:"Confirm Password",type:"password",value:I,onChange:s=>B(s.target.value),placeholder:"Confirm new password",required:!0,error:I!==""&&O!==I,helperText:I!==""&&O!==I?"Passwords do not match":"",InputProps:{startAdornment:e.jsx(p,{position:"start",children:e.jsx(le,{})})}})]}),e.jsxs(t,{sx:{display:"flex",gap:2},children:[e.jsx(x,{variant:"contained",startIcon:e.jsx(_e,{}),onClick:fs,sx:{background:"linear-gradient(135deg, #ff6b6b 0%, #ee5a52 100%)",color:"white",fontWeight:600},children:f?"Generate & Update Password":"Update Password"}),e.jsx(x,{variant:"outlined",onClick:()=>{$(!1),q(""),B("")},children:"Cancel"})]})]}):e.jsxs(t,{children:[e.jsxs(j,{severity:"info",sx:{mb:2},children:[e.jsx(a,{variant:"body2",sx:{mb:1},children:e.jsx("strong",{children:"ðŸ” Password Access"})}),e.jsx(a,{variant:"body2",children:(l==null?void 0:l.id)===n.id?"You can change your own password here.":(l==null?void 0:l.role)==="owner"?"As the account owner, you can change this team member's password.":"As an admin, you can change this team member's password."})]}),e.jsx(x,{variant:"outlined",startIcon:e.jsx(_e,{}),onClick:()=>$(!0),sx:{mb:2},children:"Change Password"})]})]}),e.jsxs(j,{severity:"info",children:[e.jsx(a,{variant:"body2",sx:{fontWeight:500,mb:1},children:"âš ï¸ Important Notes"}),e.jsxs(a,{variant:"body2",children:["â€¢ Role changes will immediately affect the member's permissions and access levels",e.jsx("br",{}),"â€¢ Department information helps with organization and project assignments",e.jsx("br",{}),"â€¢ Project assignments are managed from the Cloud Projects page",e.jsx("br",{}),"â€¢ License assignments are managed through the Licenses page",e.jsx("br",{}),oe(l,n)&&"â€¢ Password changes take effect immediately"]})]})]}):e.jsx(t,{sx:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:200},children:e.jsxs(t,{textAlign:"center",children:[e.jsx(Ee,{size:40,sx:{mb:2}}),e.jsx(a,{variant:"body1",color:"text.secondary",children:"Loading member data..."}),e.jsx(a,{variant:"body2",color:"text.secondary",children:"If this persists, please close and try again."})]})})}),e.jsxs(re,{children:[e.jsx(x,{onClick:()=>R(!1),children:"Cancel"}),e.jsx(x,{onClick:Cs,variant:"contained",startIcon:e.jsx(ie,{}),sx:{background:"linear-gradient(135deg, #00d4ff 0%, #667eea 100%)",color:"#000",fontWeight:600},children:"Save Changes"})]})]}),e.jsxs(ae,{open:hs,onClose:()=>F(!1),maxWidth:"sm",children:[e.jsx(te,{children:"Remove Team Member"}),e.jsx(ne,{children:n&&e.jsxs(t,{children:[e.jsxs(a,{variant:"body1",sx:{mb:2},children:["Are you sure you want to remove ",e.jsxs("strong",{children:[n.firstName," ",n.lastName]})," from your team?"]}),e.jsx(j,{severity:"warning",children:e.jsx(a,{variant:"body2",children:"This action cannot be undone. The member will lose access to all projects and resources. Their license will be freed up for reassignment."})})]})}),e.jsxs(re,{children:[e.jsx(x,{onClick:()=>F(!1),children:"Cancel"}),e.jsx(x,{onClick:ws,variant:"contained",color:"error",startIcon:e.jsx(he,{}),children:"Remove Member"})]})]}),e.jsxs(Os,{anchorEl:Ce,open:!!Ce,onClose:G,children:[e.jsxs(g,{onClick:()=>bs(n),children:[e.jsx(N,{children:e.jsx(ie,{})}),"Edit Member"]}),(n==null?void 0:n.status)==="pending"&&e.jsxs(g,{onClick:Ps,children:[e.jsx(N,{children:e.jsx(qs,{})}),"Resend Invite"]}),e.jsx(Bs,{}),e.jsxs(g,{onClick:ys,sx:{color:"error.main"},children:[e.jsx(N,{children:e.jsx(he,{sx:{color:"error.main"}})}),"Remove Member"]})]})]})};export{ua as default};
