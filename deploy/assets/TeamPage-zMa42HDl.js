const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/FirestoreLicenseService-BX4lrM3F.js","assets/index-Bq4VIwtE.js","assets/mui-C0ZDli_l.js","assets/vendor-CjD1bmmO.js","assets/stripe-BUwd9CCU.js","assets/index-CBai7h7s.css","assets/index.esm-ClhtutUx.js","assets/index.esm-COtph9ny.js","assets/index.esm-DOG5cvVU.js","assets/firebase-CHJUTjcp.js"])))=>i.map(i=>d[i]);
import{u as ba,_ as x,c as We,e as Be}from"./index-Bq4VIwtE.js";import{j as e,B as Y,T as U,a as k,aU as wa,G as P,al as va,p as _e,u as qe,au as xa,c as Ta,av as Pa,aw as ya,ax as Ye,ay as F,az as Ea,ag as Sa,r as Qe,aV as Ia,aW as ja,g as te,aA as Aa,aX as _a,ap as Ma,a4 as Da,a5 as O,y as Ee,aE as Ra,aY as Ge,aC as Se,aH as me,aI as ge,aJ as ue,d as Z,e as W,aQ as Ie,aR as je,aS as Ae,I as he,V as fe,h as pe,aK as be,am as Ca}from"./mui-C0ZDli_l.js";import{r as S}from"./vendor-CjD1bmmO.js";import{u as Oa}from"./notistack.esm-Ca-E78ev.js";import{M as we}from"./MetricCard-D3r5nfcW.js";import"./stripe-BUwd9CCU.js";const Na=u=>{switch(u){case"admin":return"secondary";case"owner":return"secondary";case"manager":return"info";case"member":return"success";case"viewer":return"default";default:return"default"}},La=u=>{switch(u){case"active":return"success";case"pending":return"warning";case"suspended":return"error";case"removed":return"default";default:return"default"}},Fa=u=>{switch(u){case"active":return e.jsx(_e,{});case"pending":return e.jsx(Ca,{});case"suspended":return e.jsx(Ge,{});default:return e.jsx(_e,{})}},Qa=()=>{const{enqueueSnackbar:u}=Oa(),{user:g}=ba(),He=()=>{const a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$%^&*";let s="";for(let i=0;i<12;i++)s+=a.charAt(Math.floor(Math.random()*a.length));return s},[Je,G]=S.useState([]),[V,Q]=S.useState({totalMembers:0,activeMembers:0,pendingInvites:0,availableSeats:0,totalSeats:0}),N=!0,[M,ne]=S.useState(null),[za,oe]=S.useState(""),[$a,Me]=S.useState(null),[z,ve]=S.useState(null),H=(a,{includeTime:s=!1}={})=>{try{if(!a){const l=new Date;return s?l.toISOString():l.toISOString().slice(0,10)}if(typeof a=="string"||typeof a=="number"){const l=new Date(a);if(!Number.isNaN(l.getTime()))return s?l.toISOString():l.toISOString().slice(0,10)}if(typeof a=="object"){const l=a._seconds,b=a._nanoseconds??0;if(typeof l=="number"){const p=l*1e3+Math.floor(b/1e6),T=new Date(p);return s?T.toISOString():T.toISOString().slice(0,10)}}}catch{}const i=new Date;return s?i.toISOString():i.toISOString().slice(0,10)};S.useEffect(()=>{let a=!0;return(async()=>{try{console.log("[TeamPage] useEffect - Web-only mode detection:"),console.log("  - isWebOnlyHost:",N),console.log("  - hostname:",typeof window<"u"?window.location.hostname:"N/A"),console.log("  - WEBONLY_MODE:",typeof window<"u"?window.WEBONLY_MODE:"N/A"),console.log("  - localStorage WEB_ONLY:",typeof window<"u"?localStorage.getItem("WEB_ONLY"):"N/A"),console.log("  - localStorage USE_FIRESTORE:",typeof window<"u"?localStorage.getItem("USE_FIRESTORE"):"N/A"),console.log("  - user?.id:",g==null?void 0:g.id);let s=null,i=[],l=null,b=null;if(N&&(g!=null&&g.id))try{console.log("[TeamPage] Web-only mode: Getting data from Firestore...");const{firestoreLicenseService:r}=await x(async()=>{const{firestoreLicenseService:h}=await import("./FirestoreLicenseService-BX4lrM3F.js");return{firestoreLicenseService:h}},__vite__mapDeps([0,1,2,3,4,5,6,7,8])),{getFirestore:n,collection:t,query:o,where:d,getDocs:w}=await x(async()=>{const{getFirestore:h,collection:E,query:$,where:R,getDocs:f}=await import("./index.esm-ClhtutUx.js");return{getFirestore:h,collection:E,query:$,where:R,getDocs:f}},__vite__mapDeps([6,7])),{db:v}=await x(async()=>{const{db:h}=await import("./firebase-CHJUTjcp.js");return{db:h}},__vite__mapDeps([9,1,2,3,4,5,7,6,8])),y=await x(async()=>{const{doc:h,getDoc:E}=await import("./index.esm-ClhtutUx.js");return{doc:h,getDoc:E}},__vite__mapDeps([6,7])).then(({doc:h,getDoc:E})=>E(h(v,"users",g.id)));if(console.log("[TeamPage] User document query result:",y.exists()?"found":"not found"),y.exists()){const h=y.data();if(console.log("[TeamPage] User data from Firestore:",h),h.organizationId){console.log("[TeamPage] User has organizationId:",h.organizationId);const E=await x(async()=>{const{doc:_,getDoc:C}=await import("./index.esm-ClhtutUx.js");return{doc:_,getDoc:C}},__vite__mapDeps([6,7])).then(({doc:_,getDoc:C})=>C(_(v,"organizations",h.organizationId)));console.log("[TeamPage] Organization query result:",E.exists()?"found":"not found"),E.exists()?(s={id:h.organizationId,...E.data()},console.log("[TeamPage] Found organization in Firestore:",s)):(console.warn("[TeamPage] No organization found for ID:",h.organizationId),console.log("[TeamPage] Creating fallback organization object..."),s={id:h.organizationId,name:"Enterprise Organization",type:"ENTERPRISE",status:"ACTIVE"},console.log("[TeamPage] Created fallback organization:",s));const $=o(t(v,"teamMembers"),d("organizationId","==",h.organizationId));i=(await w($)).docs.map(_=>({id:_.id,..._.data()})),console.log("[TeamPage] Found team members in Firestore:",i.length);const f=o(t(v,"org_members"),d("userId","==",g.id)),A=await w(f);A.empty?console.warn("[TeamPage] No org_members record found for user:",g.id):(b=A.docs[0].data().role,console.log("[TeamPage] User role from Firestore:",b))}else{console.warn("[TeamPage] User has no organizationId in Firestore"),console.log("[TeamPage] Trying to get organization ID from team members...");const E=o(t(v,"teamMembers")),R=(await w(E)).docs.find(f=>f.data().email===g.email);if(R){const f=R.data();if(console.log("[TeamPage] Found team member data:",f),f.organizationId){console.log("[TeamPage] Using organization ID from team member:",f.organizationId);const A=await x(async()=>{const{doc:_,getDoc:C}=await import("./index.esm-ClhtutUx.js");return{doc:_,getDoc:C}},__vite__mapDeps([6,7])).then(({doc:_,getDoc:C})=>C(_(v,"organizations",f.organizationId)));if(A.exists()){s={id:f.organizationId,...A.data()},console.log("[TeamPage] Found organization from team member:",s);const _=o(t(v,"teamMembers"),d("organizationId","==",f.organizationId));i=(await w(_)).docs.map(q=>({id:q.id,...q.data()})),console.log("[TeamPage] Found team members from team member query:",i.length)}else{console.log("[TeamPage] Creating fallback organization from team member data..."),s={id:f.organizationId,name:"Enterprise Organization",type:"ENTERPRISE",status:"ACTIVE"},console.log("[TeamPage] Created fallback organization from team member:",s);const _=o(t(v,"teamMembers"),d("organizationId","==",f.organizationId));i=(await w(_)).docs.map(q=>({id:q.id,...q.data()})),console.log("[TeamPage] Found team members from team member query:",i.length)}}}}}else console.warn("[TeamPage] No user document found in Firestore for ID:",g.id)}catch(r){console.warn("[TeamPage] Failed to get data from Firestore:",r)}if(!s){a&&(ne(null),oe(""),G([]),Q({totalMembers:0,activeMembers:0,pendingInvites:0,availableSeats:0,totalSeats:0}));return}const p=i.filter(r=>r.status==="ACTIVE").length;let T=0;l&&l.status==="ACTIVE"&&l.organizationId===s.id&&(T=Number(l.seats||0));let I=Math.max(0,T-p);if(console.log(`[TeamPage] Web-only mode check: ${N}, User ID: ${g==null?void 0:g.id}, Org ID: ${s==null?void 0:s.id}`),N&&(g!=null&&g.id)&&(s!=null&&s.id))try{const{firestoreLicenseService:r}=await x(async()=>{const{firestoreLicenseService:t}=await import("./FirestoreLicenseService-BX4lrM3F.js");return{firestoreLicenseService:t}},__vite__mapDeps([0,1,2,3,4,5,6,7,8]));console.log(`[TeamPage] Checking Firestore licenses for organization: ${s.id}`);let n=await r.getUnassignedLicenses(s.id);if(console.log(`[TeamPage] Unassigned licenses found: ${n.length}`),n.length===0){console.log("[TeamPage] No unassigned licenses found, trying organization licenses...");const t=await r.getOrganizationLicenses(s.id);console.log(`[TeamPage] Organization licenses found: ${t.length}`),n=t.filter(o=>o.status==="ACTIVE"&&!o.assignedToUserId&&!o.assignedToEmail),console.log(`[TeamPage] Filtered available licenses: ${n.length}`)}if(n.length===0){console.log("[TeamPage] No organization licenses found, trying fallback method...");const t=await r.getAllAccessibleLicenses();console.log(`[TeamPage] Fallback licenses found: ${t.length}`);const o=t.filter(d=>!d.organizationId||d.organizationId===s.id||!d.assignedToUserId&&!d.assignedToEmail);console.log(`[TeamPage] Filtered licenses for org: ${o.length}`),n=o.filter(d=>d.status==="ACTIVE"&&!d.assignedToUserId&&!d.assignedToEmail)}if(n.length===0&&(console.log("[TeamPage] Still no licenses found, trying final fallback..."),n=await r.getAllUnassignedLicenses(),console.log(`[TeamPage] Final fallback found: ${n.length} unassigned licenses`)),console.log(`[TeamPage] Final result: ${n.length} available licenses for organization ${s.id}`),console.log("[TeamPage] License details:",n.map(t=>({id:t.id,status:t.status,assignedToUserId:t.assignedToUserId,assignedToEmail:t.assignedToEmail,organizationId:t.organizationId}))),n.length>0){const t=await r.getOrganizationLicenses(s.id);T=t.filter(d=>d.status==="ACTIVE").length;const o=t.filter(d=>d.status==="ACTIVE"&&(d.assignedToUserId||d.assignedToEmail));I=n.length,console.log(`[TeamPage] Updated from Firestore: totalSeats=${T}, assignedLicenses=${o.length}, availableSeats=${I}`)}}catch(r){console.warn("[TeamPage] Failed to check Firestore licenses:",r),console.error("[TeamPage] Error details:",r)}const m=(Array.isArray(i)?i:[]).filter(r=>r&&r.status!=="REMOVED"&&r.status!=="removed").map(r=>{var y,h;const n=String(r.email||"user@example.com"),t=n.split("@")[0]||"User",o={OWNER:"owner",ENTERPRISE_ADMIN:"admin",MANAGER:"manager",MEMBER:"member"},d={INVITED:"pending",ACTIVE:"active",REMOVED:"removed"},w=r.firstName||((y=r.name)==null?void 0:y.split(" ")[0])||t.charAt(0).toUpperCase()+t.slice(1),v=r.lastName||((h=r.name)==null?void 0:h.split(" ").slice(1).join(" "))||"";return{id:String(r.id||`${n}-${Math.random().toString(36).slice(2)}`),firstName:w,lastName:v,email:n,role:o[String(r.role)]||"member",status:d[String(r.status)]||"active",department:r.department||"",licenseType:r.licenseType||"PROFESSIONAL",joinedAt:H(r.joinedAt),lastActive:H(r.updatedAt||r.joinedAt||new Date,{includeTime:!0})}});if(!a)return;ne(s.id),oe(s.name||"Organization"),Me(b||null),console.log("[TeamPage] Organization ID:",s.id,"Type:",typeof s.id,"Length:",String(s.id).length),console.log("[TeamPage] Organization ID characters:",Array.from(String(s.id)).map(r=>`${r}(${r.charCodeAt(0)})`).join(" ")),ve(l?{id:String(l.id),tier:String(l.tier).toUpperCase(),seats:Number(l.seats||0),status:String(l.status||""),organizationId:l.organizationId}:null),G(m),Q({totalMembers:m.length,activeMembers:p,pendingInvites:0,availableSeats:I,totalSeats:T})}catch(s){if(!a)return;console.error("[TeamPage] Failed to load team data:",s),G([]),Q({totalMembers:0,activeMembers:0,pendingInvites:0,availableSeats:0,totalSeats:0})}})(),()=>{a=!1}},[g==null?void 0:g.email]),S.useEffect(()=>{if(!M)return;let a;return(async()=>{try{const{db:s}=await x(async()=>{const{db:I}=await import("./firebase-CHJUTjcp.js");return{db:I}},__vite__mapDeps([9,1,2,3,4,5,7,6,8])),{collection:i,query:l,where:b,onSnapshot:p}=await x(async()=>{const{collection:I,query:m,where:r,onSnapshot:n}=await import("./index.esm-ClhtutUx.js");return{collection:I,query:m,where:r,onSnapshot:n}},__vite__mapDeps([6,7])),T=l(i(s,"teamMembers"),b("organizationId","==",String(M)));a=p(T,I=>{console.log("[TeamPage] Firestore subscription: received",I.docs.length,"team members");const r=I.docs.filter(t=>{const o=t.data(),d=o&&(o.status==="REMOVED"||o.status==="removed");return d&&console.log("[TeamPage] Filtering out removed member:",o.email,"with status:",o.status),o&&!d}).map(t=>{const o=t.data(),d=String(o.email||"user@example.com"),w=d.split("@")[0]||"User",v=o.firstName||w.charAt(0).toUpperCase()+w.slice(1),y=o.lastName||"",h={INVITED:"pending",ACTIVE:"active",REMOVED:"removed",SUSPENDED:"suspended"},E={OWNER:"owner",ENTERPRISE_ADMIN:"admin",MANAGER:"manager",MEMBER:"member"};return{id:t.id,firstName:v,lastName:y,email:d,role:E[String(o.role)]||"member",status:h[String(o.status)]||"active",department:o.department||"",licenseType:o.licenseType||"PROFESSIONAL",joinedAt:H(o.createdAt),lastActive:H(o.updatedAt||o.createdAt||new Date,{includeTime:!0})}}).sort((t,o)=>{const d=w=>{if(!w)return 0;const v=new Date(w);return isNaN(v.getTime())?0:v.getTime()};return d(o.joinedAt)-d(t.joinedAt)}),n=r.filter(t=>t.status==="active").length;G(r),Q(t=>({...t,totalMembers:r.length,activeMembers:n,pendingInvites:0,availableSeats:Math.max(0,t.totalSeats-n)}))})}catch(s){console.warn("[TeamPage] Firestore subscription failed:",s)}})(),()=>{try{a&&a()}catch{}}},[M]);const re=async()=>{try{let a=null,s=[],i=null,l=null;if(N&&(g!=null&&g.id))try{console.log("[TeamPage] Refresh: Web-only mode - Getting data from Firestore...");const{firestoreLicenseService:m}=await x(async()=>{const{firestoreLicenseService:y}=await import("./FirestoreLicenseService-BX4lrM3F.js");return{firestoreLicenseService:y}},__vite__mapDeps([0,1,2,3,4,5,6,7,8])),{getFirestore:r,collection:n,query:t,where:o,getDocs:d}=await x(async()=>{const{getFirestore:y,collection:h,query:E,where:$,getDocs:R}=await import("./index.esm-ClhtutUx.js");return{getFirestore:y,collection:h,query:E,where:$,getDocs:R}},__vite__mapDeps([6,7])),{db:w}=await x(async()=>{const{db:y}=await import("./firebase-CHJUTjcp.js");return{db:y}},__vite__mapDeps([9,1,2,3,4,5,7,6,8])),v=await d(t(n(w,"users"),o("id","==",g.id)));if(!v.empty){const y=v.docs[0].data();if(y.organizationId){const h=await d(t(n(w,"organizations"),o("id","==",y.organizationId)));h.empty||(a={id:y.organizationId,...h.docs[0].data()},console.log("[TeamPage] Refresh: Found organization in Firestore:",a));const E=t(n(w,"teamMembers"),o("organizationId","==",y.organizationId));s=(await d(E)).docs.map(A=>({id:A.id,...A.data()})),console.log("[TeamPage] Refresh: Found team members in Firestore:",s.length);const R=t(n(w,"org_members"),o("userId","==",g.id)),f=await d(R);f.empty||(l=f.docs[0].data().role,console.log("[TeamPage] Refresh: User role from Firestore:",l))}}}catch(m){console.warn("[TeamPage] Refresh: Failed to get data from Firestore:",m)}if(!a){ne(null),oe(""),G([]),Q({totalMembers:0,activeMembers:0,pendingInvites:0,availableSeats:0,totalSeats:0});return}const b=s.filter(m=>m.status==="ACTIVE").length;let p=0;i&&i.status==="ACTIVE"&&i.organizationId===a.id&&(p=Number(i.seats||0));let T=Math.max(0,p-b);if(N&&(g!=null&&g.id)&&(a!=null&&a.id))try{const{firestoreLicenseService:m}=await x(async()=>{const{firestoreLicenseService:n}=await import("./FirestoreLicenseService-BX4lrM3F.js");return{firestoreLicenseService:n}},__vite__mapDeps([0,1,2,3,4,5,6,7,8]));console.log(`[TeamPage] Refresh - Checking Firestore licenses for organization: ${a.id}`);let r=await m.getUnassignedLicenses(a.id);if(console.log(`[TeamPage] Refresh - Unassigned licenses found: ${r.length}`),r.length===0){console.log("[TeamPage] Refresh - No unassigned licenses found, trying organization licenses...");const n=await m.getOrganizationLicenses(a.id);console.log(`[TeamPage] Refresh - Organization licenses found: ${n.length}`),r=n.filter(t=>t.status==="ACTIVE"&&!t.assignedToUserId&&!t.assignedToEmail),console.log(`[TeamPage] Refresh - Filtered available licenses: ${r.length}`)}if(r.length===0){console.log("[TeamPage] Refresh - No organization licenses found, trying fallback method...");const n=await m.getAllAccessibleLicenses();console.log(`[TeamPage] Refresh - Fallback licenses found: ${n.length}`);const t=n.filter(o=>!o.organizationId||o.organizationId===a.id||!o.assignedToUserId&&!o.assignedToEmail);console.log(`[TeamPage] Refresh - Filtered licenses for org: ${t.length}`),r=t.filter(o=>o.status==="ACTIVE"&&!o.assignedToUserId&&!o.assignedToEmail)}if(r.length===0&&(console.log("[TeamPage] Refresh - Still no licenses found, trying final fallback..."),r=await m.getAllUnassignedLicenses(),console.log(`[TeamPage] Refresh - Final fallback found: ${r.length} unassigned licenses`)),console.log(`[TeamPage] Refresh - Final result: ${r.length} available licenses for organization ${a.id}`),r.length>0){const n=await m.getOrganizationLicenses(a.id);p=n.filter(o=>o.status==="ACTIVE").length;const t=n.filter(o=>o.status==="ACTIVE"&&(o.assignedToUserId||o.assignedToEmail));T=r.length,console.log(`[TeamPage] Refresh - Updated from Firestore: totalSeats=${p}, assignedLicenses=${t.length}, availableSeats=${T}`)}}catch(m){console.warn("[TeamPage] Refresh - Failed to check Firestore licenses:",m)}const I=(Array.isArray(s)?s:[]).filter(m=>m&&m.status!=="REMOVED"&&m.status!=="removed").map(m=>{const r=String(m.email||"user@example.com"),n=r.split("@")[0]||"User",t={OWNER:"owner",ENTERPRISE_ADMIN:"admin",MANAGER:"manager",MEMBER:"member"},o={INVITED:"pending",ACTIVE:"active",REMOVED:"removed"};return{id:String(m.id||`${r}-${Math.random().toString(36).slice(2)}`),firstName:n.charAt(0).toUpperCase()+n.slice(1),lastName:"",email:r,role:t[String(m.role)]||"member",status:o[String(m.status)]||"active",department:m.department||"",licenseType:m.licenseType||"PROFESSIONAL",joinedAt:H(m.joinedAt),lastActive:H(m.updatedAt||m.joinedAt||new Date,{includeTime:!0})}});ne(a.id),oe(a.name||"Organization"),Me(l||null),ve(i?{id:String(i.id),tier:String(i.tier).toUpperCase(),seats:Number(i.seats||0),status:String(i.status||""),organizationId:i.organizationId}:null),G(I),Q({totalMembers:I.length,activeMembers:b,pendingInvites:0,availableSeats:T,totalSeats:p})}catch(a){console.error("[TeamPage] Failed to refresh team data:",a)}},[De,Re]=S.useState(null),[D,Ce]=S.useState(null),[Ke,J]=S.useState(!1),[Xe,ie]=S.useState(!1),[Oe,Ne]=S.useState(0),[Ze,ee]=S.useState(!1),[ae,le]=S.useState(!1),[Le,Fe]=S.useState(!1),[ze,$e]=S.useState(!1),[xe,ea]=S.useState(!1),[Te,aa]=S.useState(!1),[j,K]=S.useState({newPassword:"",confirmPassword:"",email:"",role:"member",status:"active"}),[sa,Pe]=S.useState(!1),[L,ye]=S.useState(null),[c,B]=S.useState({email:"",firstName:"",lastName:"",role:"member",department:"",message:"",password:"",confirmPassword:""}),ta=(a,s)=>{Re(a.currentTarget),Ce(s)},ce=()=>{Re(null)},na=async()=>{var a,s,i,l,b,p,T,I,m,r;if(M){if(c.password||c.confirmPassword){if(c.password!==c.confirmPassword){u("Passwords do not match",{variant:"error"});return}if(c.password.length<8){u("Password must be at least 8 characters long",{variant:"error"});return}}try{if(typeof window<"u"&&(window.WEBONLY_MODE===!0||localStorage.getItem("WEB_ONLY")==="true"||localStorage.getItem("USE_FIRESTORE")==="true"||window.location.hostname.includes("backbone-client.web.app")||window.location.hostname.includes("web.app")||window.location.hostname.includes("firebaseapp.com"))){console.log("[TeamPage] WebOnly mode detected - checking Firebase Auth...");const{db:t,auth:o}=await x(async()=>{const{db:f,auth:A}=await import("./firebase-CHJUTjcp.js");return{db:f,auth:A}},__vite__mapDeps([9,1,2,3,4,5,7,6,8])),{collection:d,addDoc:w,serverTimestamp:v,doc:y,setDoc:h}=await x(async()=>{const{collection:f,addDoc:A,serverTimestamp:_,doc:C,setDoc:q}=await import("./index.esm-ClhtutUx.js");return{collection:f,addDoc:A,serverTimestamp:_,doc:C,setDoc:q}},__vite__mapDeps([6,7])),{createUserWithEmailAndPassword:E,signInAnonymously:$}=await x(async()=>{const{createUserWithEmailAndPassword:f,signInAnonymously:A}=await import("./index.esm-DOG5cvVU.js");return{createUserWithEmailAndPassword:f,signInAnonymously:A}},__vite__mapDeps([8,7]));if(!o.currentUser){console.log("[TeamPage] No Firebase Auth user - attempting anonymous sign-in...");try{await $(o),console.log("[TeamPage] Anonymous sign-in successful")}catch(f){throw console.error("[TeamPage] Anonymous sign-in failed:",f),new Error("Firebase authentication required for team member creation")}}console.log("[TeamPage] Creating Firebase Auth user account...");const R=c.password||He();try{const A=(await E(o,c.email.trim(),R)).user;console.log("[TeamPage] Firebase Auth user created successfully:",A.uid);const _={id:A.uid,email:c.email.trim(),firstName:c.firstName.trim(),lastName:c.lastName.trim(),licenseType:"PROFESSIONAL",organizationId:M,role:"MEMBER",status:"ACTIVE",department:((a=c.department)==null?void 0:a.trim())||void 0,createdBy:((s=o.currentUser)==null?void 0:s.uid)||(g==null?void 0:g.id)||"unknown",createdAt:v(),updatedAt:v(),temporaryPassword:R},C=Object.fromEntries(Object.entries(_).filter(([se,X])=>X!=null));console.log("[TeamPage] Creating team member in Firestore with data:",C);const q=await h(y(t,"teamMembers",A.uid),C);console.log("[TeamPage] Team member created successfully in Firestore:",A.uid);try{console.log("[TeamPage] Attempting to assign license to new team member via API...");const{firestoreLicenseService:se}=await x(async()=>{const{firestoreLicenseService:Ve}=await import("./FirestoreLicenseService-BX4lrM3F.js");return{firestoreLicenseService:Ve}},__vite__mapDeps([0,1,2,3,4,5,6,7,8])),X=await se.getUnassignedLicenses(M);if(console.log(`[TeamPage] Found ${X.length} available licenses for organization ${M}`),X.length>0){const de=X.sort((ha,fa)=>{const Ue={ENTERPRISE:3,PRO:2,BASIC:1},pa=Ue[ha.tier]||0;return(Ue[fa.tier]||0)-pa})[0];console.log(`[TeamPage] Assigning license ${de.id} (${de.tier}) to new team member`),await se.assignLicense(de.id,c.email.trim()),console.log(`[TeamPage] Successfully assigned license ${de.id} to ${c.email}`),u(`License automatically assigned to ${c.email}`,{variant:"info"})}else console.warn("[TeamPage] No available licenses found for automatic assignment"),u("Team member created but no licenses available for automatic assignment",{variant:"warning"})}catch(se){console.error("[TeamPage] Failed to automatically assign license:",se),u("Team member created but license assignment failed",{variant:"warning"})}const ua=c.password?`Team member ${c.email} created successfully with your custom password!`:`Team member ${c.email} created successfully! Temporary password: ${R}`;u(ua,{variant:"success"}),J(!1),B({email:"",firstName:"",lastName:"",role:"member",department:"",message:"",password:"",confirmPassword:""}),await re()}catch(f){throw console.error("[TeamPage] Firebase Auth user creation failed:",f),f.code==="auth/email-already-in-use"?u(`User with email ${c.email} already exists in Firebase Auth`,{variant:"error"}):f.code==="auth/weak-password"?u("Password is too weak. Please use a stronger password.",{variant:"error"}):u(`Failed to create Firebase Auth user: ${f.message}`,{variant:"error"}),f}}else{console.log("[TeamPage] Using HTTP API for team member creation");const t={email:c.email.trim(),firstName:c.firstName.trim(),lastName:c.lastName.trim(),licenseType:"PROFESSIONAL",organizationId:M,createdBy:(g==null?void 0:g.id)||"unknown",sendWelcomeEmail:!0};c.department&&c.department.trim()&&(t.department=c.department.trim()),c.password&&c.password.trim()&&(t.temporaryPassword=c.password.trim());const o=Object.fromEntries(Object.entries(t).filter(([w,v])=>v!=null));console.log("[TeamPage] Creating team member with payload:",o),console.log("[TeamPage] Organization ID:",M,"Type:",typeof M),console.log("[TeamPage] Organization ID validation test:",/^[a-zA-Z0-9\-_\.]+$/.test(String(M))),console.log("[TeamPage] Organization ID characters:",Array.from(String(M)).map(w=>`${w}(${w.charCodeAt(0)})`).join(" "));const d=await We.post(Be.teamMembers.create(),o);if((i=d.data)!=null&&i.success){const w=d.data.data.teamMember,v=d.data.data.temporaryPassword;try{console.log("[TeamPage] Attempting to assign license to new team member via API...");const{firestoreLicenseService:h}=await x(async()=>{const{firestoreLicenseService:$}=await import("./FirestoreLicenseService-BX4lrM3F.js");return{firestoreLicenseService:$}},__vite__mapDeps([0,1,2,3,4,5,6,7,8])),E=await h.getUnassignedLicenses(M);if(console.log(`[TeamPage] Found ${E.length} available licenses for organization ${M}`),E.length>0){const R=E.sort((f,A)=>{const _={ENTERPRISE:3,PRO:2,BASIC:1},C=_[f.tier]||0;return(_[A.tier]||0)-C})[0];console.log(`[TeamPage] Assigning license ${R.id} (${R.tier}) to new team member`),await h.assignLicense(R.id,c.email.trim()),console.log(`[TeamPage] Successfully assigned license ${R.id} to ${c.email}`),u(`License automatically assigned to ${c.email}`,{variant:"info"})}else console.warn("[TeamPage] No available licenses found for automatic assignment"),u("Team member created but no licenses available for automatic assignment",{variant:"warning"})}catch(h){console.error("[TeamPage] Failed to automatically assign license:",h),u("Team member created but license assignment failed",{variant:"warning"})}const y=c.password?`Team member ${w.email} created successfully with your custom password!`:`Team member ${w.email} created successfully! Temporary password: ${v}`;u(y,{variant:"success"}),J(!1),B({email:"",firstName:"",lastName:"",role:"member",department:"",message:"",password:"",confirmPassword:""}),await re()}else throw new Error("Failed to create team member")}}catch(n){if(console.error("[TeamPage] Team member creation failed:",n),n!=null&&n.response){console.error("[TeamPage] Error response:",(l=n==null?void 0:n.response)==null?void 0:l.data),console.error("[TeamPage] Error status:",(b=n==null?void 0:n.response)==null?void 0:b.status),console.error("[TeamPage] Error headers:",(p=n==null?void 0:n.response)==null?void 0:p.headers);const t=((I=(T=n==null?void 0:n.response)==null?void 0:T.data)==null?void 0:I.message)||((r=(m=n==null?void 0:n.response)==null?void 0:m.data)==null?void 0:r.error)||(n==null?void 0:n.message)||"Failed to create team member";u(t,{variant:"error"})}else{const t=(n==null?void 0:n.message)||"Failed to create team member";u(t,{variant:"error"})}}}},oa=S.useMemo(()=>String((g==null?void 0:g.role)||"").toUpperCase()==="SUPERADMIN",[g==null?void 0:g.role]),ra=()=>{if(!z){u("No active subscription found for this organization.",{variant:"warning"});return}Ne(Number(z.seats||0)),ie(!0)},ia=async()=>{var a,s;if(z)try{const i=z.tier,l=Number(Oe||0);if(i==="BASIC"&&l!==1){u("Basic plan supports exactly 1 seat.",{variant:"warning"});return}if(i==="PRO"&&(l<1||l>50)){u("Pro plan seats must be between 1 and 50.",{variant:"warning"});return}if(i==="ENTERPRISE"&&l<10){u("Enterprise requires minimum 10 seats.",{variant:"warning"});return}await We.put(Be.subscriptions.update(z.id),{seats:l}),ve(b=>b&&{...b,seats:l}),Q(b=>({...b,totalSeats:l,availableSeats:Math.max(0,l-(b.activeMembers+b.pendingInvites))})),u("Seats updated successfully",{variant:"success"}),ie(!1)}catch(i){const l=((s=(a=i==null?void 0:i.response)==null?void 0:a.data)==null?void 0:s.message)||(i==null?void 0:i.message)||"Failed to update seats";u(l,{variant:"error"})}},la=()=>{K({newPassword:"",confirmPassword:"",email:(D==null?void 0:D.email)||"",role:(D==null?void 0:D.role)||"member",status:(D==null?void 0:D.status)||"active"}),Fe(!1),$e(!1),ee(!0)},ca=async()=>{var l,b;if(!D)return;if(D.status!=="active"){u("Password can only be set after the member has joined (status Active).",{variant:"warning"});return}const a=D.email,{newPassword:s,confirmPassword:i}=j;if(!s||s.length<8){u("Password must be at least 8 characters.",{variant:"warning"});return}if(s!==i){u("Passwords do not match.",{variant:"warning"});return}try{if(le(!0),N){console.log("[TeamPage] Web-only mode detected - updating password in Firestore...");const{db:p}=await x(async()=>{const{db:r}=await import("./firebase-CHJUTjcp.js");return{db:r}},__vite__mapDeps([9,1,2,3,4,5,7,6,8])),{doc:T,updateDoc:I,serverTimestamp:m}=await x(async()=>{const{doc:r,updateDoc:n,serverTimestamp:t}=await import("./index.esm-ClhtutUx.js");return{doc:r,updateDoc:n,serverTimestamp:t}},__vite__mapDeps([6,7]));await I(T(p,"teamMembers",D.id),{temporaryPassword:s,updatedAt:m()})}u(`Password set for ${a}`,{variant:"success"}),ee(!1)}catch(p){const T=((b=(l=p==null?void 0:p.response)==null?void 0:l.data)==null?void 0:b.message)||(p==null?void 0:p.message)||"Failed to set password";u(T,{variant:"error"})}finally{le(!1)}},da=async()=>{var a,s;if(!(!D||!M))try{le(!0);const i={admin:"ENTERPRISE_ADMIN",owner:"ENTERPRISE_ADMIN",manager:"MANAGER",member:"MEMBER",viewer:"MEMBER"},l={pending:"INVITED",active:"ACTIVE",suspended:"SUSPENDED",removed:"REMOVED"};if(console.log("Updating member:",{memberId:D.id,email:j.email,role:i[j.role],status:l[j.status]}),N){console.log("[TeamPage] Web-only mode detected - updating team member in Firestore...");const{db:b}=await x(async()=>{const{db:m}=await import("./firebase-CHJUTjcp.js");return{db:m}},__vite__mapDeps([9,1,2,3,4,5,7,6,8])),{doc:p,updateDoc:T,serverTimestamp:I}=await x(async()=>{const{doc:m,updateDoc:r,serverTimestamp:n}=await import("./index.esm-ClhtutUx.js");return{doc:m,updateDoc:r,serverTimestamp:n}},__vite__mapDeps([6,7]));await T(p(b,"teamMembers",D.id),{email:j.email,role:i[j.role],status:l[j.status],updatedAt:I()}),j.newPassword&&j.confirmPassword&&j.newPassword===j.confirmPassword&&await T(p(b,"teamMembers",D.id),{temporaryPassword:j.newPassword,updatedAt:I()})}u("Member updated successfully",{variant:"success"}),ee(!1),await re()}catch(i){console.error("[TeamPage] Update member failed:",i);const l=((s=(a=i==null?void 0:i.response)==null?void 0:a.data)==null?void 0:s.message)||(i==null?void 0:i.message)||"Failed to update member";u(l,{variant:"error"})}finally{le(!1)}},ma=()=>{D&&(ye(D),Pe(!0),ce())},ga=async()=>{if(!(!L||!M))try{if(N){console.log("[TeamPage] Web-only mode detected - removing team member in Firestore...");const{db:a}=await x(async()=>{const{db:t}=await import("./firebase-CHJUTjcp.js");return{db:t}},__vite__mapDeps([9,1,2,3,4,5,7,6,8])),{doc:s,updateDoc:i,serverTimestamp:l,deleteDoc:b,collection:p,query:T,where:I,getDocs:m}=await x(async()=>{const{doc:t,updateDoc:o,serverTimestamp:d,deleteDoc:w,collection:v,query:y,where:h,getDocs:E}=await import("./index.esm-ClhtutUx.js");return{doc:t,updateDoc:o,serverTimestamp:d,deleteDoc:w,collection:v,query:y,where:h,getDocs:E}},__vite__mapDeps([6,7])),{firestoreLicenseService:r}=await x(async()=>{const{firestoreLicenseService:t}=await import("./FirestoreLicenseService-BX4lrM3F.js");return{firestoreLicenseService:t}},__vite__mapDeps([0,1,2,3,4,5,6,7,8])),{getAuth:n}=await x(async()=>{const{getAuth:t}=await import("./index.esm-DOG5cvVU.js");return{getAuth:t}},__vite__mapDeps([8,7]));console.log(`[TeamPage] Finding licenses assigned to ${L.email}...`);try{const t=T(p(a,"licenses"),I("assignedToEmail","==",L.email)),o=await m(t);if(o.empty)console.log(`[TeamPage] No licenses found for ${L.email}`);else{console.log(`[TeamPage] Found ${o.size} licenses assigned to ${L.email}`);for(const d of o.docs)console.log(`[TeamPage] Unassigning license ${d.id} from ${L.email}`),await r.unassignLicense(d.id);console.log(`[TeamPage] Successfully released all licenses for ${L.email}`),u(`Released ${o.size} licenses from ${L.email}`,{variant:"info"})}}catch(t){console.error("[TeamPage] Error releasing licenses:",t)}await i(s(a,"teamMembers",L.id),{status:"REMOVED",updatedAt:l()});try{console.log(`[TeamPage] Attempting to delete Firebase Auth user for ${L.email}...`);const t=n();console.log("[TeamPage] Firebase Auth user deletion should be handled by a backend process")}catch(t){console.warn("[TeamPage] Could not delete Firebase Auth user (expected in client code):",t)}}u(`${L.email} removed from team`,{variant:"warning"}),await re()}catch(a){console.error("[TeamPage] Remove member failed:",a),u((a==null?void 0:a.message)||"Failed to remove member",{variant:"error"})}finally{Pe(!1),ye(null)}},ke=()=>{Pe(!1),ye(null)};return S.useMemo(()=>V.totalSeats<=0?0:(V.totalSeats-V.availableSeats)/V.totalSeats*100,[V.totalSeats,V.availableSeats]),e.jsxs(Y,{children:[e.jsx(Y,{children:e.jsxs(Y,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:4},children:[e.jsxs(Y,{children:[e.jsx(U,{variant:"h4",sx:{fontWeight:700,mb:1},children:"Team Management"}),e.jsx(U,{variant:"body1",color:"text.secondary",sx:{mb:2},children:"Create and manage your team members with automatic Firebase Authentication setup. Each member gets their own account and temporary password."})]}),e.jsx(k,{variant:"contained",startIcon:e.jsx(wa,{}),onClick:()=>J(!0),disabled:!1,sx:{background:"linear-gradient(135deg, #00d4ff 0%, #667eea 100%)",color:"#000",fontWeight:600},children:"Add Team Member"}),oa&&e.jsxs(k,{variant:"outlined",onClick:ra,sx:{ml:2},children:["Manage Seats",z?` (${z.seats})`:""]}),typeof window<"u"&&window.location.hostname==="localhost"&&e.jsx(k,{variant:"outlined",onClick:async()=>{try{console.log("🔍 [TeamPage] Debug: Testing license service...");const{firestoreLicenseService:a}=await x(async()=>{const{firestoreLicenseService:s}=await import("./FirestoreLicenseService-BX4lrM3F.js");return{firestoreLicenseService:s}},__vite__mapDeps([0,1,2,3,4,5,6,7,8]));if(M){console.log("🔍 [TeamPage] Debug: Testing with org ID:",M);const s=await a.getUnassignedLicenses(M),i=await a.getOrganizationLicenses(M),l=await a.getAllAccessibleLicenses();console.log("📊 [TeamPage] Debug Results:"),console.log("  - Unassigned licenses:",s.length),console.log("  - Organization licenses:",i.length),console.log("  - All accessible licenses:",l.length),console.log("  - Unassigned details:",s),console.log("  - Org licenses details:",i)}else console.log("❌ [TeamPage] Debug: No org ID available")}catch(a){console.error("❌ [TeamPage] Debug: License service test failed:",a)}},sx:{ml:2},children:"Debug Licenses"})]})}),e.jsxs(P,{container:!0,spacing:3,sx:{mb:4},children:[e.jsx(P,{item:!0,xs:12,sm:6,md:3,children:e.jsx(we,{title:"Team Members",value:V.totalMembers,icon:e.jsx(va,{}),color:"primary",trend:{value:12,direction:"up"}})}),e.jsx(P,{item:!0,xs:12,sm:6,md:3,children:e.jsx(we,{title:"Active Members",value:V.activeMembers,icon:e.jsx(_e,{}),color:"success",trend:{value:8,direction:"up"}})}),e.jsx(P,{item:!0,xs:12,sm:6,md:3,children:e.jsx(we,{title:"Total Seats",value:V.totalSeats,icon:e.jsx(qe,{}),color:"primary"})}),e.jsx(P,{item:!0,xs:12,sm:6,md:3,children:e.jsx(we,{title:"Available Seats",value:V.availableSeats,icon:e.jsx(qe,{}),color:"secondary"})})]}),e.jsx(Y,{children:e.jsx(xa,{component:Ta,sx:{background:"linear-gradient(135deg, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0.05) 100%)",backdropFilter:"blur(20px)",border:"1px solid rgba(255,255,255,0.1)"},children:e.jsxs(Pa,{children:[e.jsx(ya,{children:e.jsxs(Ye,{children:[e.jsx(F,{sx:{fontWeight:600},children:"Member"}),e.jsx(F,{sx:{fontWeight:600},children:"Role"}),e.jsx(F,{sx:{fontWeight:600},children:"Department"}),e.jsx(F,{sx:{fontWeight:600},children:"Status"}),e.jsx(F,{sx:{fontWeight:600},children:"License"}),e.jsx(F,{sx:{fontWeight:600},children:"Last Active"}),e.jsx(F,{sx:{fontWeight:600},children:"Actions"})]})}),e.jsx(Ea,{children:Je.map(a=>e.jsxs(Ye,{hover:!0,children:[e.jsx(F,{children:e.jsxs(Y,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsxs(Sa,{sx:{width:40,height:40},children:[a.firstName[0],a.lastName[0]]}),e.jsxs(Y,{children:[e.jsxs(U,{variant:"body2",sx:{fontWeight:500},children:[a.firstName," ",a.lastName]}),e.jsx(U,{variant:"caption",color:"text.secondary",children:a.email})]})]})}),e.jsx(F,{children:e.jsx(Qe,{icon:a.role==="admin"?e.jsx(Ia,{}):e.jsx(ja,{}),label:a.role.toUpperCase(),color:Na(a.role),size:"small",variant:"outlined"})}),e.jsx(F,{children:e.jsx(U,{variant:"body2",children:a.department||"Not assigned"})}),e.jsx(F,{children:e.jsx(Qe,{icon:Fa(a.status),label:a.status.toUpperCase(),color:La(a.status),size:"small"})}),e.jsx(F,{children:e.jsx(U,{variant:"body2",children:a.licenseType||"PROFESSIONAL"})}),e.jsx(F,{children:e.jsx(U,{variant:"body2",children:a.lastActive?new Date(a.lastActive).toLocaleDateString():"Never"})}),e.jsx(F,{children:e.jsx(te,{onClick:s=>ta(s,a),size:"small",children:e.jsx(Aa,{})})})]},a.id))})]})})}),e.jsx(_a,{color:"primary",sx:{position:"fixed",bottom:24,right:24,background:"linear-gradient(135deg, #00d4ff 0%, #667eea 100%)",color:"#000"},onClick:()=>J(!0),children:e.jsx(Ma,{})}),e.jsxs(Da,{anchorEl:De,open:!!De,onClose:ce,PaperProps:{sx:{backgroundColor:"background.paper",border:"1px solid rgba(255, 255, 255, 0.1)"}},children:[e.jsxs(O,{onClick:()=>{ce(),la()},children:[e.jsx(Ee,{children:e.jsx(Ra,{fontSize:"small"})}),"Edit Member"]}),e.jsxs(O,{onClick:ce,children:[e.jsx(Ee,{children:e.jsx(Ge,{fontSize:"small"})}),"Suspend Member"]}),e.jsxs(O,{onClick:ma,sx:{color:"error.main"},children:[e.jsx(Ee,{children:e.jsx(Se,{fontSize:"small",sx:{color:"error.main"}})}),"Remove Member"]})]}),e.jsx(me,{open:Ke,onClose:()=>J(!1),maxWidth:"sm",fullWidth:!0,PaperProps:{sx:{backgroundColor:"background.paper",border:"1px solid rgba(255, 255, 255, 0.1)"}},children:e.jsxs("form",{onSubmit:a=>{a.preventDefault(),na()},children:[e.jsx(ge,{children:"Create New Team Member"}),e.jsxs(ue,{children:[e.jsx(U,{variant:"body2",color:"text.secondary",sx:{mb:2},children:"Create a new team member account with automatic Firebase Authentication setup. You can set a custom password or leave it blank to auto-generate one. The member will receive a welcome email with their login credentials."}),e.jsxs(P,{container:!0,spacing:3,sx:{mt:1},children:[V.availableSeats<=0&&e.jsx(P,{item:!0,xs:12,children:e.jsx(Z,{severity:"warning",children:"No available licenses. Please check your organization's licenses to add more team members."})}),e.jsx(P,{item:!0,xs:12,sm:6,children:e.jsx(W,{fullWidth:!0,label:"First Name",value:c.firstName,onChange:a=>B(s=>({...s,firstName:a.target.value})),required:!0})}),e.jsx(P,{item:!0,xs:12,sm:6,children:e.jsx(W,{fullWidth:!0,label:"Last Name",value:c.lastName,onChange:a=>B(s=>({...s,lastName:a.target.value})),required:!0})}),e.jsx(P,{item:!0,xs:12,children:e.jsx(W,{fullWidth:!0,label:"Email Address",type:"email",value:c.email,onChange:a=>B(s=>({...s,email:a.target.value})),required:!0})}),e.jsx(P,{item:!0,xs:12,sm:6,children:e.jsxs(Ie,{fullWidth:!0,children:[e.jsx(je,{children:"Role"}),e.jsxs(Ae,{value:c.role,label:"Role",onChange:a=>B(s=>({...s,role:a.target.value})),inputProps:{"aria-label":"Select team member role",title:"Select the role for this team member"},children:[e.jsx(O,{value:"viewer",children:"Viewer"}),e.jsx(O,{value:"member",children:"Member"}),e.jsx(O,{value:"admin",children:"Admin"})]})]})}),e.jsx(P,{item:!0,xs:12,sm:6,children:e.jsx(W,{fullWidth:!0,label:"Department",value:c.department,onChange:a=>B(s=>({...s,department:a.target.value}))})}),e.jsx(P,{item:!0,xs:12,children:e.jsx(Z,{severity:"info",sx:{mb:2},children:e.jsxs(U,{variant:"body2",children:[e.jsx("strong",{children:"Password Setup:"})," You can either set a custom password for the team member or leave it blank to auto-generate a secure temporary password."]})})}),e.jsx(P,{item:!0,xs:12,sm:6,children:e.jsx(W,{fullWidth:!0,label:"Password (Optional)",type:xe?"text":"password",value:c.password,onChange:a=>B(s=>({...s,password:a.target.value})),helperText:"Leave blank to auto-generate a secure password",inputProps:{autoComplete:"new-password"},InputProps:{endAdornment:e.jsx(he,{position:"end",children:e.jsx(te,{onClick:()=>ea(!xe),edge:"end","aria-label":"toggle password visibility",children:xe?e.jsx(fe,{}):e.jsx(pe,{})})})}})}),e.jsx(P,{item:!0,xs:12,sm:6,children:e.jsx(W,{fullWidth:!0,label:"Confirm Password",type:Te?"text":"password",value:c.confirmPassword,onChange:a=>B(s=>({...s,confirmPassword:a.target.value})),disabled:!c.password,helperText:c.password?"Must match the password above":"Enter a password first",inputProps:{autoComplete:"new-password"},InputProps:{endAdornment:e.jsx(he,{position:"end",children:e.jsx(te,{onClick:()=>aa(!Te),edge:"end","aria-label":"toggle confirm password visibility",disabled:!c.password,children:Te?e.jsx(fe,{}):e.jsx(pe,{})})})}})}),e.jsx(P,{item:!0,xs:12,children:e.jsx(W,{fullWidth:!0,label:"Welcome Message (Optional)",multiline:!0,rows:3,value:c.message,onChange:a=>B(s=>({...s,message:a.target.value}))})})]})]}),e.jsxs(be,{children:[e.jsx(k,{onClick:()=>J(!1),children:"Cancel"}),e.jsx(k,{type:"submit",variant:"contained",disabled:!c.email||!c.firstName||!c.lastName||!N,sx:{background:"linear-gradient(135deg, #00d4ff 0%, #667eea 100%)",color:"#000",fontWeight:600},children:"Create Team Member"})]})]})}),e.jsxs(me,{open:Xe,onClose:()=>ie(!1),maxWidth:"xs",fullWidth:!0,PaperProps:{sx:{backgroundColor:"background.paper",border:"1px solid rgba(255, 255, 255, 0.1)"}},children:[e.jsx(ge,{children:"Manage Seats"}),e.jsx(ue,{children:e.jsxs(P,{container:!0,spacing:2,sx:{mt:.5},children:[e.jsx(P,{item:!0,xs:12,children:e.jsx(Z,{severity:"info",children:z?`${z.tier} subscription`:"No active subscription"})}),e.jsx(P,{item:!0,xs:12,children:e.jsx(W,{fullWidth:!0,type:"number",label:"Total Seats",value:Oe,onChange:a=>Ne(parseInt(a.target.value||"0",10)),inputProps:{min:1,max:(z==null?void 0:z.tier)==="PRO"?50:1e3}})})]})}),e.jsxs(be,{children:[e.jsx(k,{onClick:()=>ie(!1),children:"Cancel"}),e.jsx(k,{onClick:ia,variant:"contained",disabled:!z,children:"Save"})]})]}),e.jsxs(me,{open:Ze,onClose:()=>{ee(!1),Ce(null)},maxWidth:"sm",fullWidth:!0,PaperProps:{sx:{backgroundColor:"background.paper",border:"1px solid rgba(255, 255, 255, 0.1)"}},children:[e.jsx(ge,{children:"Edit Member"}),e.jsx(ue,{children:e.jsxs(P,{container:!0,spacing:3,sx:{mt:1},children:[e.jsx(P,{item:!0,xs:12,children:e.jsx(W,{fullWidth:!0,label:"Email",value:j.email,onChange:a=>K(s=>({...s,email:a.target.value}))})}),e.jsx(P,{item:!0,xs:12,sm:6,children:e.jsxs(Ie,{fullWidth:!0,children:[e.jsx(je,{children:"Role"}),e.jsxs(Ae,{value:j.role,label:"Role",onChange:a=>K(s=>({...s,role:a.target.value})),children:[e.jsx(O,{value:"viewer",children:"Viewer"}),e.jsx(O,{value:"member",children:"Member"}),e.jsx(O,{value:"manager",children:"Manager"}),e.jsx(O,{value:"admin",children:"Admin"}),e.jsx(O,{value:"owner",children:"Owner"})]})]})}),e.jsx(P,{item:!0,xs:12,sm:6,children:e.jsxs(Ie,{fullWidth:!0,children:[e.jsx(je,{children:"Status"}),e.jsxs(Ae,{value:j.status,label:"Status",onChange:a=>K(s=>({...s,status:a.target.value})),children:[e.jsx(O,{value:"pending",children:"Pending"}),e.jsx(O,{value:"active",children:"Active"}),e.jsx(O,{value:"suspended",children:"Suspended"}),e.jsx(O,{value:"removed",children:"Removed"})]})]})}),e.jsx(P,{item:!0,xs:12,children:j.status!=="active"?e.jsx(Z,{severity:"warning",children:"This member has not joined yet (Pending/Suspended/Removed). You can only set a password for Active members."}):e.jsx(Z,{severity:"info",children:"Set a temporary password for this user to log into Backbone. They can change it later."})}),e.jsx(P,{item:!0,xs:12,sm:6,children:e.jsx(W,{fullWidth:!0,label:"New Password",type:Le?"text":"password",value:j.newPassword,onChange:a=>K(s=>({...s,newPassword:a.target.value})),inputProps:{minLength:8},helperText:"Minimum 8 characters",InputProps:{endAdornment:e.jsx(he,{position:"end",children:e.jsx(te,{onClick:()=>Fe(a=>!a),edge:"end","aria-label":"toggle password visibility",children:Le?e.jsx(fe,{}):e.jsx(pe,{})})})}})}),e.jsx(P,{item:!0,xs:12,sm:6,children:e.jsx(W,{fullWidth:!0,label:"Confirm Password",type:ze?"text":"password",value:j.confirmPassword,onChange:a=>K(s=>({...s,confirmPassword:a.target.value})),InputProps:{endAdornment:e.jsx(he,{position:"end",children:e.jsx(te,{onClick:()=>$e(a=>!a),edge:"end","aria-label":"toggle password visibility",children:ze?e.jsx(fe,{}):e.jsx(pe,{})})})}})})]})}),e.jsxs(be,{children:[e.jsx(k,{onClick:()=>ee(!1),disabled:ae,children:"Cancel"}),e.jsx(k,{onClick:da,variant:"outlined",disabled:ae,children:ae?"Saving…":"Save Changes"}),e.jsx(k,{onClick:ca,variant:"contained",disabled:ae||!j.newPassword||!j.confirmPassword||j.status!=="active",children:ae?"Saving…":"Save Password Only"})]})]}),e.jsxs(me,{open:sa,onClose:ke,maxWidth:"sm",fullWidth:!0,PaperProps:{sx:{backgroundColor:"background.paper",border:"1px solid rgba(255, 255, 255, 0.1)"}},children:[e.jsx(ge,{children:e.jsxs(Y,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(Se,{color:"error"}),"Remove Team Member"]})}),e.jsxs(ue,{children:[e.jsxs(U,{variant:"body1",sx:{mb:2},children:["Are you sure you want to remove ",e.jsx("strong",{children:L==null?void 0:L.email})," from your team?"]}),e.jsx(Z,{severity:"warning",sx:{mt:2},children:e.jsx(U,{variant:"body2",children:"This action cannot be undone. The member will lose access to all organization resources and data."})})]}),e.jsxs(be,{children:[e.jsx(k,{onClick:ke,color:"inherit",children:"Cancel"}),e.jsx(k,{onClick:ga,color:"error",variant:"contained",startIcon:e.jsx(Se,{}),children:"Remove Member"})]})]})]})};export{Qa as default};
