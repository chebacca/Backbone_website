import{j as r,aD as I,aE as M,a as P,az as w,T as p,I as F,bQ as T,aF as L,t as E,D as U,aN as G,d as y,c as q,G as s,u,aJ as g,aK as h,aL as f,a4 as i}from"./mui-DWJOBiaP.js";import{r as l}from"./vendor-OeuszDaU.js";import{s as R}from"./index-DUm_pVAd.js";const A={name:"",description:"",visibility:"private",storageMode:"local",cloudProvider:"firestore",gcsBucket:"",gcsPrefix:"",enableLocalNetwork:!1,networkPort:3e3,networkAddress:"localhost",maxNetworkUsers:250,networkPassword:"",preferredWebsitePort:3002,preferredApiPort:3003,maxCollaborators:250,enableRealTime:!0,enableComments:!0,enableFileSharing:!0,enableVersionControl:!0,enableEncryption:!1,autoBackup:!0,backupInterval:30,enableAuditLog:!1},H=({open:b,onClose:n,mode:d,onSuccess:x,onCreate:j})=>{const[W,S]=l.useState(0),[e,o]=l.useState(A),[c,k]=l.useState(!1),[v,m]=l.useState(null),[z,C]=l.useState({});l.useEffect(()=>{b&&(o({...A,enableLocalNetwork:d==="standalone",maxCollaborators:d==="shared_network"?25:5,enableRealTime:d==="shared_network"}),S(0),m(null),C({}))},[b,d]);const B=a=>{const t={};switch(a){case 0:e.name.trim()||(t.name="Project name is required"),e.name.length>100&&(t.name="Project name must be less than 100 characters");break;case 1:e.storageMode==="cloud"&&e.cloudProvider==="gcs"&&(e.gcsBucket.trim()||(t.gcsBucket="GCS bucket name is required"));break;case 2:e.enableLocalNetwork&&((e.networkPort<1024||e.networkPort>65535)&&(t.networkPort="Port must be between 1024 and 65535"),e.networkAddress.trim()||(t.networkAddress="Network address is required"),(e.maxNetworkUsers<1||e.maxNetworkUsers>250)&&(t.maxNetworkUsers="Max users must be between 1 and 250")),typeof e.preferredWebsitePort=="number"&&(e.preferredWebsitePort<1024||e.preferredWebsitePort>65535)&&(t.preferredWebsitePort="Website port must be 1024-65535"),typeof e.preferredApiPort=="number"&&(e.preferredApiPort<1024||e.preferredApiPort>65535)&&(t.preferredApiPort="API port must be 1024-65535");break;case 3:(e.maxCollaborators<1||e.maxCollaborators>250)&&(t.maxCollaborators="Max collaborators must be between 1 and 250");break}return C(t),Object.keys(t).length===0},D=async()=>{if(B(W)){k(!0),m(null);try{const a={name:e.name,description:e.description,visibility:e.visibility,storageMode:e.storageMode,preferredPorts:{website:e.preferredWebsitePort,api:e.preferredApiPort},localNetworkConfig:e.enableLocalNetwork?{enabled:!0,port:e.networkPort,address:e.networkAddress,maxUsers:e.maxNetworkUsers}:void 0,cloudConfig:e.storageMode==="cloud"?{provider:e.cloudProvider,bucket:e.gcsBucket,prefix:e.gcsPrefix}:void 0,collaborationSettings:{maxCollaborators:e.maxCollaborators,enableRealTime:e.enableRealTime,enableComments:e.enableComments,enableFileSharing:e.enableFileSharing}},t=j?await j(a):await R.createProject(a);x==null||x(t),n()}catch(a){m(a instanceof Error?a.message:"Failed to create project")}finally{k(!1)}}},N=()=>r.jsxs(P,{sx:{py:2},children:[r.jsx(p,{variant:"h6",gutterBottom:!0,sx:{mb:3,color:"text.primary",fontWeight:600},children:"Create New Cloud Project"}),r.jsxs(q,{elevation:0,sx:{p:3,mb:3,backgroundColor:"background.paper",border:"1px solid",borderColor:"divider"},children:[r.jsx(p,{variant:"subtitle1",gutterBottom:!0,sx:{fontWeight:600,mb:3},children:"Project Information"}),r.jsxs(s,{container:!0,spacing:3,children:[r.jsx(s,{item:!0,xs:12,children:r.jsx(u,{fullWidth:!0,label:"Project Name",value:e.name,onChange:a=>o(t=>({...t,name:a.target.value})),placeholder:"Enter project name",required:!0,sx:{mb:2}})}),r.jsx(s,{item:!0,xs:12,children:r.jsx(u,{fullWidth:!0,label:"Description",value:e.description,onChange:a=>o(t=>({...t,description:a.target.value})),multiline:!0,rows:3,placeholder:"Describe your project",sx:{mb:2}})}),r.jsx(s,{item:!0,xs:12,sm:6,children:r.jsxs(g,{fullWidth:!0,children:[r.jsx(h,{children:"Visibility"}),r.jsxs(f,{value:e.visibility||"private",onChange:a=>o(t=>({...t,visibility:a.target.value})),label:"Visibility",children:[r.jsx(i,{value:"private",children:"Private"}),r.jsx(i,{value:"organization",children:"Organization"}),r.jsx(i,{value:"public",children:"Public"})]})]})}),r.jsx(s,{item:!0,xs:12,sm:6,children:r.jsxs(g,{fullWidth:!0,children:[r.jsx(h,{children:"Storage Backend"}),r.jsxs(f,{value:e.storageMode||"cloud",onChange:a=>o(t=>({...t,storageMode:a.target.value})),label:"Storage Backend",children:[r.jsx(i,{value:"cloud",children:"Cloud (Firebase/GCS)"}),r.jsx(i,{value:"local",children:"Local (.dbproj)"})]})]})}),e.storageMode==="cloud"&&r.jsx(s,{item:!0,xs:12,sm:6,children:r.jsxs(g,{fullWidth:!0,children:[r.jsx(h,{children:"Cloud Type"}),r.jsxs(f,{value:e.cloudProvider||"firestore",onChange:a=>o(t=>({...t,cloudProvider:a.target.value})),label:"Cloud Type",children:[r.jsx(i,{value:"firestore",children:"Firestore (metadata)"}),r.jsx(i,{value:"gcs",children:"Google Cloud Storage (assets)"})]})]})}),e.storageMode==="cloud"&&e.cloudProvider==="gcs"&&r.jsxs(r.Fragment,{children:[r.jsx(s,{item:!0,xs:12,sm:6,children:r.jsx(u,{fullWidth:!0,label:"GCS Bucket",value:e.gcsBucket,onChange:a=>o(t=>({...t,gcsBucket:a.target.value})),placeholder:"my-project-bucket",required:!0})}),r.jsx(s,{item:!0,xs:12,sm:6,children:r.jsx(u,{fullWidth:!0,label:"GCS Prefix (optional)",value:e.gcsPrefix,onChange:a=>o(t=>({...t,gcsPrefix:a.target.value})),placeholder:"projects/my-project/"})})]})]})]})]});return r.jsxs(I,{open:b,onClose:n,maxWidth:"md",fullWidth:!0,sx:{zIndex:1400},PaperProps:{sx:{minHeight:"70vh",backgroundColor:"background.default","& .MuiDialogContent-root":{backgroundColor:"background.default"}}},children:[r.jsxs(M,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",backgroundColor:"background.paper",borderBottom:"1px solid",borderColor:"divider",pb:2},children:[r.jsxs(P,{sx:{display:"flex",alignItems:"center",gap:1},children:[r.jsx(w,{color:"primary"}),r.jsx(p,{variant:"h6",sx:{fontWeight:600},children:"Create New Project"})]}),r.jsx(F,{onClick:n,size:"small",children:r.jsx(T,{})})]}),r.jsxs(L,{sx:{p:3},children:[v&&r.jsx(E,{severity:"error",sx:{mb:3},children:v}),N(),c&&r.jsx(U,{sx:{mt:2}})]}),r.jsxs(G,{sx:{px:3,pb:3,pt:2,backgroundColor:"background.paper",borderTop:"1px solid",borderColor:"divider"},children:[r.jsx(y,{onClick:n,variant:"outlined",disabled:c,sx:{borderColor:"primary.main",color:"primary.main"},children:"Close"}),r.jsx(y,{onClick:D,variant:"contained",disabled:c||!e.name.trim(),startIcon:r.jsx(w,{}),sx:{backgroundColor:"primary.main","&:hover":{backgroundColor:"primary.dark"}},children:c?"Creating...":"Create Project"})]})]})};export{H as U};
