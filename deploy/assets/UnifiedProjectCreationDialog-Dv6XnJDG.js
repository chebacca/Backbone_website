import{j as r,aD as D,aE as F,a as C,az as y,T as g,I as N,bQ as I,aF as T,t as q,D as L,aN as E,d as w,c as R,G as s,u as i,aJ as p,aK as h,aL as f,a4 as l}from"./mui-DWJOBiaP.js";import{r as n}from"./vendor-OeuszDaU.js";import{s as U}from"./index-B_hv_vNC.js";const A={name:"",description:"",visibility:"private",storageMode:"local",cloudProvider:"firestore",gcsBucket:"",gcsPrefix:"",s3Bucket:"",s3Region:"us-east-1",s3Prefix:"",azureStorageAccount:"",azureContainer:"",azurePrefix:"",enableLocalNetwork:!1,networkPort:3e3,networkAddress:"localhost",maxNetworkUsers:250,networkPassword:"",preferredWebsitePort:3002,preferredApiPort:3003,maxCollaborators:250,enableRealTime:!0,enableComments:!0,enableFileSharing:!0,enableVersionControl:!0,enableEncryption:!1,autoBackup:!0,backupInterval:30,enableAuditLog:!1},H=({open:x,onClose:d,mode:u,onSuccess:b,onCreate:j})=>{const[S,z]=n.useState(0),[e,o]=n.useState(A),[c,v]=n.useState(!1),[P,m]=n.useState(null),[G,k]=n.useState({});n.useEffect(()=>{x&&(o({...A,enableLocalNetwork:u==="standalone",maxCollaborators:u==="shared_network"?25:5,enableRealTime:u==="shared_network"}),z(0),m(null),k({}))},[x,u]);const W=a=>{const t={};switch(a){case 0:e.name.trim()||(t.name="Project name is required"),e.name.length>100&&(t.name="Project name must be less than 100 characters");break;case 1:e.storageMode==="cloud"&&(e.cloudProvider==="gcs"&&!e.gcsBucket.trim()&&(t.gcsBucket="GCS bucket name is required"),e.cloudProvider==="s3"&&!e.s3Bucket.trim()&&(t.s3Bucket="S3 bucket name is required"),e.cloudProvider==="azure-blob"&&(e.azureStorageAccount.trim()||(t.azureStorageAccount="Azure storage account is required"),e.azureContainer.trim()||(t.azureContainer="Azure container name is required")));break;case 2:e.enableLocalNetwork&&((e.networkPort<1024||e.networkPort>65535)&&(t.networkPort="Port must be between 1024 and 65535"),e.networkAddress.trim()||(t.networkAddress="Network address is required"),(e.maxNetworkUsers<1||e.maxNetworkUsers>250)&&(t.maxNetworkUsers="Max users must be between 1 and 250")),typeof e.preferredWebsitePort=="number"&&(e.preferredWebsitePort<1024||e.preferredWebsitePort>65535)&&(t.preferredWebsitePort="Website port must be 1024-65535"),typeof e.preferredApiPort=="number"&&(e.preferredApiPort<1024||e.preferredApiPort>65535)&&(t.preferredApiPort="API port must be 1024-65535");break;case 3:(e.maxCollaborators<1||e.maxCollaborators>250)&&(t.maxCollaborators="Max collaborators must be between 1 and 250");break}return k(t),Object.keys(t).length===0},B=async()=>{if(W(S)){v(!0),m(null);try{const a={name:e.name,description:e.description,visibility:e.visibility,storageMode:e.storageMode,preferredPorts:{website:e.preferredWebsitePort,api:e.preferredApiPort},localNetworkConfig:e.enableLocalNetwork?{enabled:!0,port:e.networkPort,address:e.networkAddress,maxUsers:e.maxNetworkUsers}:void 0,cloudConfig:e.storageMode==="cloud"?{provider:e.cloudProvider,bucket:e.cloudProvider==="gcs"?e.gcsBucket:e.cloudProvider==="s3"?e.s3Bucket:e.cloudProvider==="azure-blob"?e.azureContainer:"",prefix:e.cloudProvider==="gcs"?e.gcsPrefix:e.cloudProvider==="s3"?e.s3Prefix:e.cloudProvider==="azure-blob"?e.azurePrefix:"",region:e.cloudProvider==="s3"?e.s3Region:void 0,storageAccount:e.cloudProvider==="azure-blob"?e.azureStorageAccount:void 0}:void 0,collaborationSettings:{maxCollaborators:e.maxCollaborators,enableRealTime:e.enableRealTime,enableComments:e.enableComments,enableFileSharing:e.enableFileSharing}},t=j?await j(a):await U.createProject(a);b==null||b(t),d()}catch(a){m(a instanceof Error?a.message:"Failed to create project")}finally{v(!1)}}},M=()=>r.jsxs(C,{sx:{py:2},children:[r.jsx(g,{variant:"h6",gutterBottom:!0,sx:{mb:3,color:"text.primary",fontWeight:600},children:"Create New Cloud Project"}),r.jsxs(R,{elevation:0,sx:{p:3,mb:3,backgroundColor:"background.paper",border:"1px solid",borderColor:"divider"},children:[r.jsx(g,{variant:"subtitle1",gutterBottom:!0,sx:{fontWeight:600,mb:3},children:"Project Information"}),r.jsxs(s,{container:!0,spacing:3,children:[r.jsx(s,{item:!0,xs:12,children:r.jsx(i,{fullWidth:!0,label:"Project Name",value:e.name,onChange:a=>o(t=>({...t,name:a.target.value})),placeholder:"Enter project name",required:!0,sx:{mb:2}})}),r.jsx(s,{item:!0,xs:12,children:r.jsx(i,{fullWidth:!0,label:"Description",value:e.description,onChange:a=>o(t=>({...t,description:a.target.value})),multiline:!0,rows:3,placeholder:"Describe your project",sx:{mb:2}})}),r.jsx(s,{item:!0,xs:12,sm:6,children:r.jsxs(p,{fullWidth:!0,children:[r.jsx(h,{children:"Visibility"}),r.jsxs(f,{value:e.visibility||"private",onChange:a=>o(t=>({...t,visibility:a.target.value})),label:"Visibility",children:[r.jsx(l,{value:"private",children:"Private"}),r.jsx(l,{value:"organization",children:"Organization"}),r.jsx(l,{value:"public",children:"Public"})]})]})}),r.jsx(s,{item:!0,xs:12,sm:6,children:r.jsxs(p,{fullWidth:!0,children:[r.jsx(h,{children:"Storage Backend"}),r.jsxs(f,{value:e.storageMode||"cloud",onChange:a=>o(t=>({...t,storageMode:a.target.value})),label:"Storage Backend",children:[r.jsx(l,{value:"cloud",children:"Cloud (Firebase/GCS)"}),r.jsx(l,{value:"local",children:"Local (.dbproj)"})]})]})}),e.storageMode==="cloud"&&r.jsx(s,{item:!0,xs:12,sm:6,children:r.jsxs(p,{fullWidth:!0,children:[r.jsx(h,{children:"Cloud Type"}),r.jsxs(f,{value:e.cloudProvider||"firestore",onChange:a=>o(t=>({...t,cloudProvider:a.target.value})),label:"Cloud Type",children:[r.jsx(l,{value:"firestore",children:"Firestore (metadata)"}),r.jsx(l,{value:"gcs",children:"Google Cloud Storage (assets)"}),r.jsx(l,{value:"s3",children:"AWS S3 (object storage)"}),r.jsx(l,{value:"azure-blob",children:"Azure Blob Storage"})]})]})}),e.storageMode==="cloud"&&e.cloudProvider==="gcs"&&r.jsxs(r.Fragment,{children:[r.jsx(s,{item:!0,xs:12,sm:6,children:r.jsx(i,{fullWidth:!0,label:"GCS Bucket",value:e.gcsBucket,onChange:a=>o(t=>({...t,gcsBucket:a.target.value})),placeholder:"my-project-bucket",required:!0})}),r.jsx(s,{item:!0,xs:12,sm:6,children:r.jsx(i,{fullWidth:!0,label:"GCS Prefix (optional)",value:e.gcsPrefix,onChange:a=>o(t=>({...t,gcsPrefix:a.target.value})),placeholder:"projects/my-project/"})})]}),e.storageMode==="cloud"&&e.cloudProvider==="s3"&&r.jsxs(r.Fragment,{children:[r.jsx(s,{item:!0,xs:12,sm:6,children:r.jsx(i,{fullWidth:!0,label:"S3 Bucket",value:e.s3Bucket,onChange:a=>o(t=>({...t,s3Bucket:a.target.value})),placeholder:"my-s3-bucket",required:!0})}),r.jsx(s,{item:!0,xs:12,sm:6,children:r.jsx(i,{fullWidth:!0,label:"AWS Region",value:e.s3Region,onChange:a=>o(t=>({...t,s3Region:a.target.value})),placeholder:"us-east-1"})}),r.jsx(s,{item:!0,xs:12,children:r.jsx(i,{fullWidth:!0,label:"S3 Prefix (optional)",value:e.s3Prefix,onChange:a=>o(t=>({...t,s3Prefix:a.target.value})),placeholder:"projects/my-project/"})})]}),e.storageMode==="cloud"&&e.cloudProvider==="azure-blob"&&r.jsxs(r.Fragment,{children:[r.jsx(s,{item:!0,xs:12,sm:6,children:r.jsx(i,{fullWidth:!0,label:"Storage Account",value:e.azureStorageAccount,onChange:a=>o(t=>({...t,azureStorageAccount:a.target.value})),placeholder:"mystorageaccount",required:!0})}),r.jsx(s,{item:!0,xs:12,sm:6,children:r.jsx(i,{fullWidth:!0,label:"Container",value:e.azureContainer,onChange:a=>o(t=>({...t,azureContainer:a.target.value})),placeholder:"my-container",required:!0})}),r.jsx(s,{item:!0,xs:12,children:r.jsx(i,{fullWidth:!0,label:"Blob Prefix (optional)",value:e.azurePrefix,onChange:a=>o(t=>({...t,azurePrefix:a.target.value})),placeholder:"projects/my-project/"})})]})]})]})]});return r.jsxs(D,{open:x,onClose:d,maxWidth:"md",fullWidth:!0,sx:{zIndex:1400},PaperProps:{sx:{minHeight:"70vh",backgroundColor:"background.default","& .MuiDialogContent-root":{backgroundColor:"background.default"}}},children:[r.jsxs(F,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",backgroundColor:"background.paper",borderBottom:"1px solid",borderColor:"divider",pb:2},children:[r.jsxs(C,{sx:{display:"flex",alignItems:"center",gap:1},children:[r.jsx(y,{color:"primary"}),r.jsx(g,{variant:"h6",sx:{fontWeight:600},children:"Create New Project"})]}),r.jsx(N,{onClick:d,size:"small",children:r.jsx(I,{})})]}),r.jsxs(T,{sx:{p:3},children:[P&&r.jsx(q,{severity:"error",sx:{mb:3},children:P}),M(),c&&r.jsx(L,{sx:{mt:2}})]}),r.jsxs(E,{sx:{px:3,pb:3,pt:2,backgroundColor:"background.paper",borderTop:"1px solid",borderColor:"divider"},children:[r.jsx(w,{onClick:d,variant:"outlined",disabled:c,sx:{borderColor:"primary.main",color:"primary.main"},children:"Close"}),r.jsx(w,{onClick:B,variant:"contained",disabled:c||!e.name.trim(),startIcon:r.jsx(y,{}),sx:{backgroundColor:"primary.main","&:hover":{backgroundColor:"primary.dark"}},children:c?"Creating...":"Create Project"})]})]})};export{H as U};
