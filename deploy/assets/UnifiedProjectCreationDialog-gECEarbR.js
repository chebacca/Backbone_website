import{j as e,aD as I,aE as M,a as P,az as w,T as p,I as F,bQ as T,aF as L,t as E,D as U,aN as G,d as y,c as q,G as s,u,aJ as g,aK as h,aL as f,a4 as i}from"./mui-DWJOBiaP.js";import{r as l}from"./vendor-OeuszDaU.js";import{s as R}from"./index-BfZrtFBg.js";const A={name:"",description:"",visibility:"private",storageMode:"local",cloudProvider:"firestore",gcsBucket:"",gcsPrefix:"",enableLocalNetwork:!1,networkPort:3e3,networkAddress:"localhost",maxNetworkUsers:250,networkPassword:"",preferredWebsitePort:3002,preferredApiPort:3003,maxCollaborators:250,enableRealTime:!0,enableComments:!0,enableFileSharing:!0,enableVersionControl:!0,enableEncryption:!1,autoBackup:!0,backupInterval:30,enableAuditLog:!1},H=({open:x,onClose:n,mode:d,onSuccess:b,onCreate:j})=>{const[W,S]=l.useState(0),[r,o]=l.useState(A),[c,k]=l.useState(!1),[v,m]=l.useState(null),[z,C]=l.useState({});l.useEffect(()=>{x&&(o({...A,enableLocalNetwork:d==="standalone",maxCollaborators:d==="shared_network"?25:5,enableRealTime:d==="shared_network"}),S(0),m(null),C({}))},[x,d]);const B=a=>{const t={};switch(a){case 0:r.name.trim()||(t.name="Project name is required"),r.name.length>100&&(t.name="Project name must be less than 100 characters");break;case 1:r.storageMode==="cloud"&&r.cloudProvider==="gcs"&&(r.gcsBucket.trim()||(t.gcsBucket="GCS bucket name is required"));break;case 2:r.enableLocalNetwork&&((r.networkPort<1024||r.networkPort>65535)&&(t.networkPort="Port must be between 1024 and 65535"),r.networkAddress.trim()||(t.networkAddress="Network address is required"),(r.maxNetworkUsers<1||r.maxNetworkUsers>250)&&(t.maxNetworkUsers="Max users must be between 1 and 250")),typeof r.preferredWebsitePort=="number"&&(r.preferredWebsitePort<1024||r.preferredWebsitePort>65535)&&(t.preferredWebsitePort="Website port must be 1024-65535"),typeof r.preferredApiPort=="number"&&(r.preferredApiPort<1024||r.preferredApiPort>65535)&&(t.preferredApiPort="API port must be 1024-65535");break;case 3:(r.maxCollaborators<1||r.maxCollaborators>250)&&(t.maxCollaborators="Max collaborators must be between 1 and 250");break}return C(t),Object.keys(t).length===0},D=async()=>{if(B(W)){k(!0),m(null);try{const a={name:r.name,description:r.description,storageMode:r.storageMode,preferredPorts:{website:r.preferredWebsitePort,api:r.preferredApiPort},localNetworkConfig:r.enableLocalNetwork?{enabled:!0,port:r.networkPort,address:r.networkAddress,maxUsers:r.maxNetworkUsers}:void 0,cloudConfig:r.storageMode==="cloud"?{provider:r.cloudProvider,bucket:r.gcsBucket,prefix:r.gcsPrefix}:void 0,collaborationSettings:{maxCollaborators:r.maxCollaborators,enableRealTime:r.enableRealTime,enableComments:r.enableComments,enableFileSharing:r.enableFileSharing}},t=j?await j(a):await R.createProject(a);b==null||b(t),n()}catch(a){m(a instanceof Error?a.message:"Failed to create project")}finally{k(!1)}}},N=()=>e.jsxs(P,{sx:{py:2},children:[e.jsx(p,{variant:"h6",gutterBottom:!0,sx:{mb:3,color:"text.primary",fontWeight:600},children:"Create New Cloud Project"}),e.jsxs(q,{elevation:0,sx:{p:3,mb:3,backgroundColor:"background.paper",border:"1px solid",borderColor:"divider"},children:[e.jsx(p,{variant:"subtitle1",gutterBottom:!0,sx:{fontWeight:600,mb:3},children:"Project Information"}),e.jsxs(s,{container:!0,spacing:3,children:[e.jsx(s,{item:!0,xs:12,children:e.jsx(u,{fullWidth:!0,label:"Project Name",value:r.name,onChange:a=>o(t=>({...t,name:a.target.value})),placeholder:"Enter project name",required:!0,sx:{mb:2}})}),e.jsx(s,{item:!0,xs:12,children:e.jsx(u,{fullWidth:!0,label:"Description",value:r.description,onChange:a=>o(t=>({...t,description:a.target.value})),multiline:!0,rows:3,placeholder:"Describe your project",sx:{mb:2}})}),e.jsx(s,{item:!0,xs:12,sm:6,children:e.jsxs(g,{fullWidth:!0,children:[e.jsx(h,{children:"Visibility"}),e.jsxs(f,{value:r.visibility||"private",onChange:a=>o(t=>({...t,visibility:a.target.value})),label:"Visibility",children:[e.jsx(i,{value:"private",children:"Private"}),e.jsx(i,{value:"organization",children:"Organization"}),e.jsx(i,{value:"public",children:"Public"})]})]})}),e.jsx(s,{item:!0,xs:12,sm:6,children:e.jsxs(g,{fullWidth:!0,children:[e.jsx(h,{children:"Storage Backend"}),e.jsxs(f,{value:r.storageMode||"cloud",onChange:a=>o(t=>({...t,storageMode:a.target.value})),label:"Storage Backend",children:[e.jsx(i,{value:"cloud",children:"Cloud (Firebase/GCS)"}),e.jsx(i,{value:"local",children:"Local (.dbproj)"})]})]})}),r.storageMode==="cloud"&&e.jsx(s,{item:!0,xs:12,sm:6,children:e.jsxs(g,{fullWidth:!0,children:[e.jsx(h,{children:"Cloud Type"}),e.jsxs(f,{value:r.cloudProvider||"firestore",onChange:a=>o(t=>({...t,cloudProvider:a.target.value})),label:"Cloud Type",children:[e.jsx(i,{value:"firestore",children:"Firestore (metadata)"}),e.jsx(i,{value:"gcs",children:"Google Cloud Storage (assets)"})]})]})}),r.storageMode==="cloud"&&r.cloudProvider==="gcs"&&e.jsxs(e.Fragment,{children:[e.jsx(s,{item:!0,xs:12,sm:6,children:e.jsx(u,{fullWidth:!0,label:"GCS Bucket",value:r.gcsBucket,onChange:a=>o(t=>({...t,gcsBucket:a.target.value})),placeholder:"my-project-bucket",required:!0})}),e.jsx(s,{item:!0,xs:12,sm:6,children:e.jsx(u,{fullWidth:!0,label:"GCS Prefix (optional)",value:r.gcsPrefix,onChange:a=>o(t=>({...t,gcsPrefix:a.target.value})),placeholder:"projects/my-project/"})})]})]})]})]});return e.jsxs(I,{open:x,onClose:n,maxWidth:"md",fullWidth:!0,sx:{zIndex:1400},PaperProps:{sx:{minHeight:"70vh",backgroundColor:"background.default","& .MuiDialogContent-root":{backgroundColor:"background.default"}}},children:[e.jsxs(M,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",backgroundColor:"background.paper",borderBottom:"1px solid",borderColor:"divider",pb:2},children:[e.jsxs(P,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(w,{color:"primary"}),e.jsx(p,{variant:"h6",sx:{fontWeight:600},children:"Create New Project"})]}),e.jsx(F,{onClick:n,size:"small",children:e.jsx(T,{})})]}),e.jsxs(L,{sx:{p:3},children:[v&&e.jsx(E,{severity:"error",sx:{mb:3},children:v}),N(),c&&e.jsx(U,{sx:{mt:2}})]}),e.jsxs(G,{sx:{px:3,pb:3,pt:2,backgroundColor:"background.paper",borderTop:"1px solid",borderColor:"divider"},children:[e.jsx(y,{onClick:n,variant:"outlined",disabled:c,sx:{borderColor:"primary.main",color:"primary.main"},children:"Close"}),e.jsx(y,{onClick:D,variant:"contained",disabled:c||!r.name.trim(),startIcon:e.jsx(w,{}),sx:{backgroundColor:"primary.main","&:hover":{backgroundColor:"primary.dark"}},children:c?"Creating...":"Create Project"})]})]})};export{H as U};
