import{r as e}from"./vendor-CjD1bmmO.js";import{unifiedDataService as u}from"./UnifiedDataService-CNhRiglU.js";import{u as d}from"./index-Djjh7-O0.js";function g(){const[r,n]=e.useState(null),[c,s]=e.useState(!0),[i,o]=e.useState(null),{isAuthenticated:t,isLoading:a,user:f}=d(),l=e.useCallback(async()=>{if(!(a||!t))try{s(!0),o(null);const m=await u.getCurrentUser();n(m)}catch(m){o(m instanceof Error?m.message:"Failed to fetch user")}finally{s(!1)}},[a,t]);return e.useEffect(()=>{!a&&t?l():!a&&!t&&(s(!1),n(null))},[a,t,l]),e.useEffect(()=>{a&&s(!0)},[a]),{data:r,loading:c||a,error:i,refetch:l}}function b(){const[r,n]=e.useState([]),[c,s]=e.useState(!0),[i,o]=e.useState(null),t=e.useCallback(async()=>{try{s(!0),o(null);const a=await u.getProjectsForUser();n(a)}catch(a){o(a instanceof Error?a.message:"Failed to fetch projects")}finally{s(!1)}},[]);return e.useEffect(()=>{t()},[t]),{data:r,loading:c,error:i,refetch:t}}function S(){const[r,n]=e.useState(null),[c,s]=e.useState(!0),[i,o]=e.useState(null),{data:t,loading:a}=g(),f=e.useCallback(async()=>{if(!(a||!t))try{s(!0),o(null);const l=await u.getOrganizationContext();n(l)}catch(l){o(l instanceof Error?l.message:"Failed to fetch organization context")}finally{s(!1)}},[a,t]);return e.useEffect(()=>{!a&&t?f():!a&&!t&&(s(!1),n(null))},[a,t,f]),e.useEffect(()=>{a&&s(!0)},[a]),{data:r,loading:c||a,error:i,refetch:f}}function L(){const[r,n]=e.useState([]),[c,s]=e.useState(!0),[i,o]=e.useState(null),{data:t,loading:a}=g(),f=e.useCallback(async()=>{if(!(a||!t))try{s(!0),o(null);const l=await u.getLicensesForOrganization();n(l)}catch(l){o(l instanceof Error?l.message:"Failed to fetch licenses")}finally{s(!1)}},[a,t]);return e.useEffect(()=>{!a&&t?f():!a&&!t&&(s(!1),n([]))},[a,t,f]),e.useEffect(()=>{a&&s(!0)},[a]),{data:r,loading:c||a,error:i,refetch:f}}function C(){const[r,n]=e.useState(!1),[c,s]=e.useState(null);return{mutate:e.useCallback(async o=>{try{return n(!0),s(null),await u.createLicense(o)}catch(t){throw s(t instanceof Error?t.message:"Failed to create license"),t}finally{n(!1)}},[]),loading:r,error:c}}function w(){const[r,n]=e.useState(!1),[c,s]=e.useState(null);return{mutate:e.useCallback(async({licenseId:o,updates:t})=>{try{n(!0),s(null),await u.updateLicense(o,t)}catch(a){throw s(a instanceof Error?a.message:"Failed to update license"),a}finally{n(!1)}},[]),loading:r,error:c}}function T(){const[r,n]=e.useState(!1),[c,s]=e.useState(null);return{mutate:e.useCallback(async({licenseId:o,userId:t})=>{try{n(!0),s(null),await u.assignLicense(o,t)}catch(a){throw s(a instanceof Error?a.message:"Failed to assign license"),a}finally{n(!1)}},[]),loading:r,error:c}}function M(){const[r,n]=e.useState(!1),[c,s]=e.useState(null);return{mutate:e.useCallback(async({licenseId:o})=>{try{n(!0),s(null),await u.unassignLicense(o)}catch(t){throw s(t instanceof Error?t.message:"Failed to unassign license"),t}finally{n(!1)}},[]),loading:r,error:c}}function p(){const[r,n]=e.useState([]),[c,s]=e.useState(!0),[i,o]=e.useState(null),t=e.useCallback(async()=>{try{s(!0),o(null);const a=await u.getTeamMembersForOrganization();n(a)}catch(a){o(a instanceof Error?a.message:"Failed to fetch team members")}finally{s(!1)}},[]);return e.useEffect(()=>{t()},[t]),{data:r,loading:c,error:i,refetch:t}}function F(){const[r,n]=e.useState(!1),[c,s]=e.useState(null);return{mutate:e.useCallback(async o=>{try{return n(!0),s(null),await u.inviteTeamMember(o)}catch(t){throw s(t instanceof Error?t.message:"Failed to invite team member"),t}finally{n(!1)}},[]),loading:r,error:c}}function k(){const[r,n]=e.useState(!1),[c,s]=e.useState(null);return{mutate:e.useCallback(async({memberId:o,updates:t})=>{try{n(!0),s(null),await u.updateTeamMember(o,t)}catch(a){throw s(a instanceof Error?a.message:"Failed to update team member"),a}finally{n(!1)}},[]),loading:r,error:c}}function U(){const[r,n]=e.useState(!1),[c,s]=e.useState(null);return{mutate:e.useCallback(async({memberId:o})=>{try{n(!0),s(null),await u.removeTeamMember(o)}catch(t){throw s(t instanceof Error?t.message:"Failed to remove team member"),t}finally{n(!1)}},[]),loading:r,error:c}}function A(){const[r,n]=e.useState(!1),[c,s]=e.useState(null);return{mutate:e.useCallback(async({memberId:o,licenseId:t,licenseKey:a,licenseType:f})=>{try{n(!0),s(null),await u.assignLicenseToTeamMember(o,t,a,f)}catch(l){throw s(l instanceof Error?l.message:"Failed to assign license to team member"),l}finally{n(!1)}},[]),loading:r,error:c}}function z(){var n,c,s;const{data:r}=g();return{canCreateProjects:((n=r==null?void 0:r.license)==null?void 0:n.canCreateProjects)||!1,canManageTeam:((c=r==null?void 0:r.license)==null?void 0:c.canManageTeam)||!1,isAccountOwner:(r==null?void 0:r.userType)==="ACCOUNT_OWNER",isTeamMember:(r==null?void 0:r.userType)==="TEAM_MEMBER",isAdmin:(r==null?void 0:r.userType)==="ADMIN",organizationTier:((s=r==null?void 0:r.organization)==null?void 0:s.tier)||"BASIC"}}export{S as a,L as b,C as c,w as d,T as e,M as f,b as g,z as h,p as i,F as j,k,U as l,A as m,g as u};
