import{r as t}from"./vendor-CjD1bmmO.js";import{unifiedDataService as u}from"./UnifiedDataService-DdOHmGRM.js";import{u as d}from"./index-BxMGX29a.js";function g(){const[r,n]=t.useState(null),[c,s]=t.useState(!0),[i,o]=t.useState(null),{isAuthenticated:e,isLoading:a,user:f}=d(),l=t.useCallback(async()=>{if(!(a||!e))try{s(!0),o(null);const m=await u.getCurrentUser();n(m)}catch(m){o(m instanceof Error?m.message:"Failed to fetch user")}finally{s(!1)}},[a,e]);return t.useEffect(()=>{!a&&e?l():!a&&!e&&(s(!1),n(null))},[a,e,l]),t.useEffect(()=>{a&&s(!0)},[a]),{data:r,loading:c||a,error:i,refetch:l}}function S(){const[r,n]=t.useState([]),[c,s]=t.useState(!0),[i,o]=t.useState(null),e=t.useCallback(async()=>{try{s(!0),o(null);const a=await u.getProjectsForUser();n(a)}catch(a){o(a instanceof Error?a.message:"Failed to fetch projects")}finally{s(!1)}},[]);return t.useEffect(()=>{e()},[e]),{data:r,loading:c,error:i,refetch:e}}function b(){const[r,n]=t.useState(null),[c,s]=t.useState(!0),[i,o]=t.useState(null),{data:e,loading:a}=g(),f=t.useCallback(async()=>{if(!(a||!e))try{s(!0),o(null);const l=await u.getOrganizationContext();n(l)}catch(l){o(l instanceof Error?l.message:"Failed to fetch organization context")}finally{s(!1)}},[a,e]);return t.useEffect(()=>{!a&&e?f():!a&&!e&&(s(!1),n(null))},[a,e,f]),t.useEffect(()=>{a&&s(!0)},[a]),{data:r,loading:c||a,error:i,refetch:f}}function L(){const[r,n]=t.useState([]),[c,s]=t.useState(!0),[i,o]=t.useState(null),{data:e,loading:a}=g(),f=t.useCallback(async()=>{if(!(a||!e))try{s(!0),o(null);const l=await u.getLicensesForOrganization();n(l)}catch(l){o(l instanceof Error?l.message:"Failed to fetch licenses")}finally{s(!1)}},[a,e]);return t.useEffect(()=>{!a&&e?f():!a&&!e&&(s(!1),n([]))},[a,e,f]),t.useEffect(()=>{a&&s(!0)},[a]),{data:r,loading:c||a,error:i,refetch:f}}function C(){const[r,n]=t.useState(!1),[c,s]=t.useState(null);return{mutate:t.useCallback(async o=>{try{return n(!0),s(null),await u.createLicense(o)}catch(e){throw s(e instanceof Error?e.message:"Failed to create license"),e}finally{n(!1)}},[]),loading:r,error:c}}function w(){const[r,n]=t.useState(!1),[c,s]=t.useState(null);return{mutate:t.useCallback(async({licenseId:o,updates:e})=>{try{n(!0),s(null),await u.updateLicense(o,e)}catch(a){throw s(a instanceof Error?a.message:"Failed to update license"),a}finally{n(!1)}},[]),loading:r,error:c}}function T(){const[r,n]=t.useState(!1),[c,s]=t.useState(null);return{mutate:t.useCallback(async({licenseId:o,userId:e})=>{try{n(!0),s(null),await u.assignLicense(o,e)}catch(a){throw s(a instanceof Error?a.message:"Failed to assign license"),a}finally{n(!1)}},[]),loading:r,error:c}}function M(){const[r,n]=t.useState(!1),[c,s]=t.useState(null);return{mutate:t.useCallback(async({licenseId:o})=>{try{n(!0),s(null),await u.unassignLicense(o)}catch(e){throw s(e instanceof Error?e.message:"Failed to unassign license"),e}finally{n(!1)}},[]),loading:r,error:c}}function p(){const[r,n]=t.useState([]),[c,s]=t.useState(!0),[i,o]=t.useState(null),e=t.useCallback(async()=>{try{s(!0),o(null);const a=await u.getTeamMembersForOrganization();n(a)}catch(a){o(a instanceof Error?a.message:"Failed to fetch team members")}finally{s(!1)}},[]);return t.useEffect(()=>{e()},[e]),{data:r,loading:c,error:i,refetch:e}}function F(){const[r,n]=t.useState(!1),[c,s]=t.useState(null);return{mutate:t.useCallback(async o=>{try{return n(!0),s(null),await u.inviteTeamMember(o)}catch(e){throw s(e instanceof Error?e.message:"Failed to invite team member"),e}finally{n(!1)}},[]),loading:r,error:c}}function k(){const[r,n]=t.useState(!1),[c,s]=t.useState(null);return{mutate:t.useCallback(async({memberId:o,updates:e})=>{try{n(!0),s(null),await u.updateTeamMember(o,e)}catch(a){throw s(a instanceof Error?a.message:"Failed to update team member"),a}finally{n(!1)}},[]),loading:r,error:c}}function U(){const[r,n]=t.useState(!1),[c,s]=t.useState(null);return{mutate:t.useCallback(async({memberId:o})=>{try{n(!0),s(null),await u.removeTeamMember(o)}catch(e){throw s(e instanceof Error?e.message:"Failed to remove team member"),e}finally{n(!1)}},[]),loading:r,error:c}}function z(){var n,c,s;const{data:r}=g();return{canCreateProjects:((n=r==null?void 0:r.license)==null?void 0:n.canCreateProjects)||!1,canManageTeam:((c=r==null?void 0:r.license)==null?void 0:c.canManageTeam)||!1,isAccountOwner:(r==null?void 0:r.userType)==="ACCOUNT_OWNER",isTeamMember:(r==null?void 0:r.userType)==="TEAM_MEMBER",isAdmin:(r==null?void 0:r.userType)==="ADMIN",organizationTier:((s=r==null?void 0:r.organization)==null?void 0:s.tier)||"BASIC"}}export{p as a,g as b,b as c,C as d,w as e,T as f,M as g,S as h,z as i,F as j,k,U as l,L as u};
